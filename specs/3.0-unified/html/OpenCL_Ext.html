<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 2.0.16">
<meta name="author" content="Khronos&#174; OpenCL Working Group">
<title>The OpenCL&#8482; Extension Specification</title>
<style>
/*! normalize.css v2.1.2 | MIT License | git.io/normalize */
/* ========================================================================== HTML5 display definitions ========================================================================== */
/** Correct `block` display not defined in IE 8/9. */
article, aside, details, figcaption, figure, footer, header, hgroup, main, nav, section, summary { display: block; }

/** Correct `inline-block` display not defined in IE 8/9. */
audio, canvas, video { display: inline-block; }

/** Prevent modern browsers from displaying `audio` without controls. Remove excess height in iOS 5 devices. */
audio:not([controls]) { display: none; height: 0; }

/** Address `[hidden]` styling not present in IE 8/9. Hide the `template` element in IE, Safari, and Firefox < 22. */
[hidden], template { display: none; }

script { display: none !important; }

/* ========================================================================== Base ========================================================================== */
/** 1. Set default font family to sans-serif. 2. Prevent iOS text size adjust after orientation change, without disabling user zoom. */
html { font-family: sans-serif; /* 1 */ -ms-text-size-adjust: 100%; /* 2 */ -webkit-text-size-adjust: 100%; /* 2 */ }

/** Remove default margin. */
body { margin: 0; }

/* ========================================================================== Links ========================================================================== */
/** Remove the gray background color from active links in IE 10. */
a { background: transparent; }

/** Address `outline` inconsistency between Chrome and other browsers. */
a:focus { outline: thin dotted; }

/** Improve readability when focused and also mouse hovered in all browsers. */
a:active, a:hover { outline: 0; }

/* ========================================================================== Typography ========================================================================== */
/** Address variable `h1` font-size and margin within `section` and `article` contexts in Firefox 4+, Safari 5, and Chrome. */
h1 { font-size: 2em; margin: 0.67em 0; }

/** Address styling not present in IE 8/9, Safari 5, and Chrome. */
abbr[title] { border-bottom: 1px dotted; }

/** Address style set to `bolder` in Firefox 4+, Safari 5, and Chrome. */
b, strong { font-weight: bold; }

/** Address styling not present in Safari 5 and Chrome. */
dfn { font-style: italic; }

/** Address differences between Firefox and other browsers. */
hr { -moz-box-sizing: content-box; box-sizing: content-box; height: 0; }

/** Address styling not present in IE 8/9. */
mark { background: #ff0; color: #000; }

/** Correct font family set oddly in Safari 5 and Chrome. */
code, kbd, pre, samp { font-family: monospace, serif; font-size: 1em; }

/** Improve readability of pre-formatted text in all browsers. */
pre { white-space: pre-wrap; }

/** Set consistent quote types. */
q { quotes: "\201C" "\201D" "\2018" "\2019"; }

/** Address inconsistent and variable font size in all browsers. */
small { font-size: 80%; }

/** Prevent `sub` and `sup` affecting `line-height` in all browsers. */
sub, sup { font-size: 75%; line-height: 0; position: relative; vertical-align: baseline; }

sup { top: -0.5em; }

sub { bottom: -0.25em; }

/* ========================================================================== Embedded content ========================================================================== */
/** Remove border when inside `a` element in IE 8/9. */
img { border: 0; }

/** Correct overflow displayed oddly in IE 9. */
svg:not(:root) { overflow: hidden; }

/* ========================================================================== Figures ========================================================================== */
/** Address margin not present in IE 8/9 and Safari 5. */
figure { margin: 0; }

/* ========================================================================== Forms ========================================================================== */
/** Define consistent border, margin, and padding. */
fieldset { border: 1px solid #c0c0c0; margin: 0 2px; padding: 0.35em 0.625em 0.75em; }

/** 1. Correct `color` not being inherited in IE 8/9. 2. Remove padding so people aren't caught out if they zero out fieldsets. */
legend { border: 0; /* 1 */ padding: 0; /* 2 */ }

/** 1. Correct font family not being inherited in all browsers. 2. Correct font size not being inherited in all browsers. 3. Address margins set differently in Firefox 4+, Safari 5, and Chrome. */
button, input, select, textarea { font-family: inherit; /* 1 */ font-size: 100%; /* 2 */ margin: 0; /* 3 */ }

/** Address Firefox 4+ setting `line-height` on `input` using `!important` in the UA stylesheet. */
button, input { line-height: normal; }

/** Address inconsistent `text-transform` inheritance for `button` and `select`. All other form control elements do not inherit `text-transform` values. Correct `button` style inheritance in Chrome, Safari 5+, and IE 8+. Correct `select` style inheritance in Firefox 4+ and Opera. */
button, select { text-transform: none; }

/** 1. Avoid the WebKit bug in Android 4.0.* where (2) destroys native `audio` and `video` controls. 2. Correct inability to style clickable `input` types in iOS. 3. Improve usability and consistency of cursor style between image-type `input` and others. */
button, html input[type="button"], input[type="reset"], input[type="submit"] { -webkit-appearance: button; /* 2 */ cursor: pointer; /* 3 */ }

/** Re-set default cursor for disabled elements. */
button[disabled], html input[disabled] { cursor: default; }

/** 1. Address box sizing set to `content-box` in IE 8/9. 2. Remove excess padding in IE 8/9. */
input[type="checkbox"], input[type="radio"] { box-sizing: border-box; /* 1 */ padding: 0; /* 2 */ }

/** 1. Address `appearance` set to `searchfield` in Safari 5 and Chrome. 2. Address `box-sizing` set to `border-box` in Safari 5 and Chrome (include `-moz` to future-proof). */
input[type="search"] { -webkit-appearance: textfield; /* 1 */ -moz-box-sizing: content-box; -webkit-box-sizing: content-box; /* 2 */ box-sizing: content-box; }

/** Remove inner padding and search cancel button in Safari 5 and Chrome on OS X. */
input[type="search"]::-webkit-search-cancel-button, input[type="search"]::-webkit-search-decoration { -webkit-appearance: none; }

/** Remove inner padding and border in Firefox 4+. */
button::-moz-focus-inner, input::-moz-focus-inner { border: 0; padding: 0; }

/** 1. Remove default vertical scrollbar in IE 8/9. 2. Improve readability and alignment in all browsers. */
textarea { overflow: auto; /* 1 */ vertical-align: top; /* 2 */ }

/* ========================================================================== Tables ========================================================================== */
/** Remove most spacing between table cells. */
table { border-collapse: collapse; border-spacing: 0; }

meta.foundation-mq-small { font-family: "only screen and (min-width: 768px)"; width: 768px; }

meta.foundation-mq-medium { font-family: "only screen and (min-width:1280px)"; width: 1280px; }

meta.foundation-mq-large { font-family: "only screen and (min-width:1440px)"; width: 1440px; }

*, *:before, *:after { -moz-box-sizing: border-box; -webkit-box-sizing: border-box; box-sizing: border-box; }

html, body { font-size: 100%; }

body { background: #fff; color: #222; padding: 0; margin: 0; font-family: "Helvetica Neue", "Helvetica", Helvetica, Arial, sans-serif; font-weight: normal; font-style: normal; line-height: 1; position: relative; cursor: auto; }

a:hover { cursor: pointer; }

img, object, embed { max-width: 100%; height: auto; }

object, embed { height: 100%; }

img { -ms-interpolation-mode: bicubic; }

#map_canvas img, #map_canvas embed, #map_canvas object, .map_canvas img, .map_canvas embed, .map_canvas object { max-width: none !important; }

.left { float: left !important; }

.right { float: right !important; }

.text-left { text-align: left !important; }

.text-right { text-align: right !important; }

.text-center { text-align: center !important; }

.text-justify { text-align: justify !important; }

.hide { display: none; }

.antialiased { -webkit-font-smoothing: antialiased; }

img { display: inline-block; vertical-align: middle; }

textarea { height: auto; min-height: 50px; }

select { width: 100%; }

object, svg { display: inline-block; vertical-align: middle; }

.center { margin-left: auto; margin-right: auto; }

.spread { width: 100%; }

p.lead, .paragraph.lead > p, #preamble > .sectionbody > .paragraph:first-of-type p { font-size: 1.21875em; line-height: 1.6; }

.subheader, .admonitionblock td.content > .title, .audioblock > .title, .exampleblock > .title, .imageblock > .title, .listingblock > .title, .literalblock > .title, .stemblock > .title, .openblock > .title, .paragraph > .title, .quoteblock > .title, table.tableblock > .title, .verseblock > .title, .videoblock > .title, .dlist > .title, .olist > .title, .ulist > .title, .qlist > .title, .hdlist > .title { line-height: 1.4; color: black; font-weight: 300; margin-top: 0.2em; margin-bottom: 0.5em; }

/* Typography resets */
div, dl, dt, dd, ul, ol, li, h1, h2, h3, #toctitle, .sidebarblock > .content > .title, h4, h5, h6, pre, form, p, blockquote, th, td { margin: 0; padding: 0; direction: ltr; }

/* Default Link Styles */
a { color: #0068b0; text-decoration: none; line-height: inherit; }
a:hover, a:focus { color: #333; }
a img { border: none; }

/* Default paragraph styles */
p { font-family: Noto, sans-serif; font-weight: normal; font-size: 1em; line-height: 1.6; margin-bottom: 0.75em; text-rendering: optimizeLegibility; }
p aside { font-size: 0.875em; line-height: 1.35; font-style: italic; }

/* Default header styles */
h1, h2, h3, #toctitle, .sidebarblock > .content > .title, h4, h5, h6 { font-family: Noto, sans-serif; font-weight: normal; font-style: normal; color: black; text-rendering: optimizeLegibility; margin-top: 0.5em; margin-bottom: 0.5em; line-height: 1.2125em; }
h1 small, h2 small, h3 small, #toctitle small, .sidebarblock > .content > .title small, h4 small, h5 small, h6 small { font-size: 60%; color: #4d4d4d; line-height: 0; }

h1 { font-size: 2.125em; }

h2 { font-size: 1.6875em; }

h3, #toctitle, .sidebarblock > .content > .title { font-size: 1.375em; }

h4 { font-size: 1.125em; }

h5 { font-size: 1.125em; }

h6 { font-size: 1em; }

hr { border: solid #ddd; border-width: 1px 0 0; clear: both; margin: 1.25em 0 1.1875em; height: 0; }

/* Helpful Typography Defaults */
em, i { font-style: italic; line-height: inherit; }

strong, b { font-weight: bold; line-height: inherit; }

small { font-size: 60%; line-height: inherit; }

code { font-family: Consolas, "Liberation Mono", Courier, monospace; font-weight: normal; color: #264357; }

/* Lists */
ul, ol, dl { font-size: 1em; line-height: 1.6; margin-bottom: 0.75em; list-style-position: outside; font-family: Noto, sans-serif; }

ul, ol { margin-left: 1.5em; }
ul.no-bullet, ol.no-bullet { margin-left: 1.5em; }

/* Unordered Lists */
ul li ul, ul li ol { margin-left: 1.25em; margin-bottom: 0; font-size: 1em; /* Override nested font-size change */ }
ul.square li ul, ul.circle li ul, ul.disc li ul { list-style: inherit; }
ul.square { list-style-type: square; }
ul.circle { list-style-type: circle; }
ul.disc { list-style-type: disc; }
ul.no-bullet { list-style: none; }

/* Ordered Lists */
ol li ul, ol li ol { margin-left: 1.25em; margin-bottom: 0; }

/* Definition Lists */
dl dt { margin-bottom: 0.3em; font-weight: bold; }
dl dd { margin-bottom: 0.75em; }

/* Abbreviations */
abbr, acronym { text-transform: uppercase; font-size: 90%; color: black; border-bottom: 1px dotted #ddd; cursor: help; }

abbr { text-transform: none; }

/* Blockquotes */
blockquote { margin: 0 0 0.75em; padding: 0.5625em 1.25em 0 1.1875em; border-left: 1px solid #ddd; }
blockquote cite { display: block; font-size: 0.8125em; color: #365E7A; }
blockquote cite:before { content: "\2014 \0020"; }
blockquote cite a, blockquote cite a:visited { color: #365E7A; }

blockquote, blockquote p { line-height: 1.6; color: #333; }

/* Microformats */
.vcard { display: inline-block; margin: 0 0 1.25em 0; border: 1px solid #ddd; padding: 0.625em 0.75em; }
.vcard li { margin: 0; display: block; }
.vcard .fn { font-weight: bold; font-size: 0.9375em; }

.vevent .summary { font-weight: bold; }
.vevent abbr { cursor: auto; text-decoration: none; font-weight: bold; border: none; padding: 0 0.0625em; }

@media only screen and (min-width: 768px) { h1, h2, h3, #toctitle, .sidebarblock > .content > .title, h4, h5, h6 { line-height: 1.4; }
  h1 { font-size: 2.75em; }
  h2 { font-size: 2.3125em; }
  h3, #toctitle, .sidebarblock > .content > .title { font-size: 1.6875em; }
  h4 { font-size: 1.4375em; } }
/* Tables */
table { background: #fff; margin-bottom: 1.25em; border: solid 1px #d8d8ce; }
table thead, table tfoot { background: #eee; font-weight: bold; }
table thead tr th, table thead tr td, table tfoot tr th, table tfoot tr td { padding: 0.5em 0.625em 0.625em; font-size: inherit; color: #222; text-align: left; }
table tr th, table tr td { padding: 0.5625em 0.625em; font-size: inherit; color: #6d6e71; }
table tr.even, table tr.alt, table tr:nth-of-type(even) { background: #f8f8f8; }
table thead tr th, table tfoot tr th, table tbody tr td, table tr td, table tfoot tr td { display: table-cell; line-height: 1.4; }

body { -moz-osx-font-smoothing: grayscale; -webkit-font-smoothing: antialiased; tab-size: 4; }

h1, h2, h3, #toctitle, .sidebarblock > .content > .title, h4, h5, h6 { line-height: 1.4; }

a:hover, a:focus { text-decoration: underline; }

.clearfix:before, .clearfix:after, .float-group:before, .float-group:after { content: " "; display: table; }
.clearfix:after, .float-group:after { clear: both; }

*:not(pre) > code { font-size: inherit; font-style: normal !important; letter-spacing: 0; padding: 0; background-color: transparent; -webkit-border-radius: 0; border-radius: 0; line-height: inherit; word-wrap: break-word; }
*:not(pre) > code.nobreak { word-wrap: normal; }
*:not(pre) > code.nowrap { white-space: nowrap; }

pre, pre > code { line-height: 1.6; color: #264357; font-family: Consolas, "Liberation Mono", Courier, monospace; font-weight: normal; }

em em { font-style: normal; }

strong strong { font-weight: normal; }

.keyseq { color: #333333; }

kbd { font-family: Consolas, "Liberation Mono", Courier, monospace; display: inline-block; color: black; font-size: 0.65em; line-height: 1.45; background-color: #f7f7f7; border: 1px solid #ccc; -webkit-border-radius: 3px; border-radius: 3px; -moz-box-shadow: 0 1px 0 rgba(0, 0, 0, 0.2), 0 0 0 0.1em white inset; -webkit-box-shadow: 0 1px 0 rgba(0, 0, 0, 0.2), 0 0 0 0.1em white inset; box-shadow: 0 1px 0 rgba(0, 0, 0, 0.2), 0 0 0 0.1em white inset; margin: 0 0.15em; padding: 0.2em 0.5em; vertical-align: middle; position: relative; top: -0.1em; white-space: nowrap; }

.keyseq kbd:first-child { margin-left: 0; }

.keyseq kbd:last-child { margin-right: 0; }

.menuseq, .menuref { color: #000; }

.menuseq b:not(.caret), .menuref { font-weight: inherit; }

.menuseq { word-spacing: -0.02em; }
.menuseq b.caret { font-size: 1.25em; line-height: 0.8; }
.menuseq i.caret { font-weight: bold; text-align: center; width: 0.45em; }

b.button:before, b.button:after { position: relative; top: -1px; font-weight: normal; }

b.button:before { content: "["; padding: 0 3px 0 2px; }

b.button:after { content: "]"; padding: 0 2px 0 3px; }

#header, #content, #footnotes, #footer { width: 100%; margin-left: auto; margin-right: auto; margin-top: 0; margin-bottom: 0; max-width: 62.5em; *zoom: 1; position: relative; padding-left: 1.5em; padding-right: 1.5em; }
#header:before, #header:after, #content:before, #content:after, #footnotes:before, #footnotes:after, #footer:before, #footer:after { content: " "; display: table; }
#header:after, #content:after, #footnotes:after, #footer:after { clear: both; }

#content { margin-top: 1.25em; }

#content:before { content: none; }

#header > h1:first-child { color: black; margin-top: 2.25rem; margin-bottom: 0; }
#header > h1:first-child + #toc { margin-top: 8px; border-top: 1px solid #ddd; }
#header > h1:only-child, body.toc2 #header > h1:nth-last-child(2) { border-bottom: 1px solid #ddd; padding-bottom: 8px; }
#header .details { border-bottom: 1px solid #ddd; line-height: 1.45; padding-top: 0.25em; padding-bottom: 0.25em; padding-left: 0.25em; color: #365E7A; display: -ms-flexbox; display: -webkit-flex; display: flex; -ms-flex-flow: row wrap; -webkit-flex-flow: row wrap; flex-flow: row wrap; }
#header .details span:first-child { margin-left: -0.125em; }
#header .details span.email a { color: #333; }
#header .details br { display: none; }
#header .details br + span:before { content: "\00a0\2013\00a0"; }
#header .details br + span.author:before { content: "\00a0\22c5\00a0"; color: #333; }
#header .details br + span#revremark:before { content: "\00a0|\00a0"; }
#header #revnumber { text-transform: capitalize; }
#header #revnumber:after { content: "\00a0"; }

#content > h1:first-child:not([class]) { color: black; border-bottom: 1px solid #ddd; padding-bottom: 8px; margin-top: 0; padding-top: 1rem; margin-bottom: 1.25rem; }

#toc { border-bottom: 0 solid #ddd; padding-bottom: 0.5em; }
#toc > ul { margin-left: 0.125em; }
#toc ul.sectlevel0 > li > a { font-style: italic; }
#toc ul.sectlevel0 ul.sectlevel1 { margin: 0.5em 0; }
#toc ul { font-family: Noto, sans-serif; list-style-type: none; }
#toc li { line-height: 1.3334; margin-top: 0.3334em; }
#toc a { text-decoration: none; }
#toc a:active { text-decoration: underline; }

#toctitle { color: black; font-size: 1.2em; }

@media only screen and (min-width: 768px) { #toctitle { font-size: 1.375em; }
  body.toc2 { padding-left: 15em; padding-right: 0; }
  #toc.toc2 { margin-top: 0 !important; background-color: #fff; position: fixed; width: 15em; left: 0; top: 0; border-right: 1px solid #ddd; border-top-width: 0 !important; border-bottom-width: 0 !important; z-index: 1000; padding: 1.25em 1em; height: 100%; overflow: auto; }
  #toc.toc2 #toctitle { margin-top: 0; margin-bottom: 0.8rem; font-size: 1.2em; }
  #toc.toc2 > ul { font-size: 0.9em; margin-bottom: 0; }
  #toc.toc2 ul ul { margin-left: 0; padding-left: 1em; }
  #toc.toc2 ul.sectlevel0 ul.sectlevel1 { padding-left: 0; margin-top: 0.5em; margin-bottom: 0.5em; }
  body.toc2.toc-right { padding-left: 0; padding-right: 15em; }
  body.toc2.toc-right #toc.toc2 { border-right-width: 0; border-left: 1px solid #ddd; left: auto; right: 0; } }
@media only screen and (min-width: 1280px) { body.toc2 { padding-left: 20em; padding-right: 0; }
  #toc.toc2 { width: 20em; }
  #toc.toc2 #toctitle { font-size: 1.375em; }
  #toc.toc2 > ul { font-size: 0.95em; }
  #toc.toc2 ul ul { padding-left: 1.25em; }
  body.toc2.toc-right { padding-left: 0; padding-right: 20em; } }
#content #toc { border-style: solid; border-width: 1px; border-color: #e6e6e6; margin-bottom: 1.25em; padding: 1.25em; background: #fff; -webkit-border-radius: 0; border-radius: 0; }
#content #toc > :first-child { margin-top: 0; }
#content #toc > :last-child { margin-bottom: 0; }

#footer { max-width: 100%; background-color: none; padding: 1.25em; }

#footer-text { color: black; line-height: 1.44; }

#content { margin-bottom: 0.625em; }

.sect1 { padding-bottom: 0.625em; }

@media only screen and (min-width: 768px) { #content { margin-bottom: 1.25em; }
  .sect1 { padding-bottom: 1.25em; } }
.sect1:last-child { padding-bottom: 0; }

.sect1 + .sect1 { border-top: 0 solid #ddd; }

#content h1 > a.anchor, h2 > a.anchor, h3 > a.anchor, #toctitle > a.anchor, .sidebarblock > .content > .title > a.anchor, h4 > a.anchor, h5 > a.anchor, h6 > a.anchor { position: absolute; z-index: 1001; width: 1.5ex; margin-left: -1.5ex; display: block; text-decoration: none !important; visibility: hidden; text-align: center; font-weight: normal; }
#content h1 > a.anchor:before, h2 > a.anchor:before, h3 > a.anchor:before, #toctitle > a.anchor:before, .sidebarblock > .content > .title > a.anchor:before, h4 > a.anchor:before, h5 > a.anchor:before, h6 > a.anchor:before { content: "\00A7"; font-size: 0.85em; display: block; padding-top: 0.1em; }
#content h1:hover > a.anchor, #content h1 > a.anchor:hover, h2:hover > a.anchor, h2 > a.anchor:hover, h3:hover > a.anchor, #toctitle:hover > a.anchor, .sidebarblock > .content > .title:hover > a.anchor, h3 > a.anchor:hover, #toctitle > a.anchor:hover, .sidebarblock > .content > .title > a.anchor:hover, h4:hover > a.anchor, h4 > a.anchor:hover, h5:hover > a.anchor, h5 > a.anchor:hover, h6:hover > a.anchor, h6 > a.anchor:hover { visibility: visible; }
#content h1 > a.link, h2 > a.link, h3 > a.link, #toctitle > a.link, .sidebarblock > .content > .title > a.link, h4 > a.link, h5 > a.link, h6 > a.link { color: black; text-decoration: none; }
#content h1 > a.link:hover, h2 > a.link:hover, h3 > a.link:hover, #toctitle > a.link:hover, .sidebarblock > .content > .title > a.link:hover, h4 > a.link:hover, h5 > a.link:hover, h6 > a.link:hover { color: black; }

.audioblock, .imageblock, .literalblock, .listingblock, .stemblock, .videoblock { margin-bottom: 1.25em; }

.admonitionblock td.content > .title, .audioblock > .title, .exampleblock > .title, .imageblock > .title, .listingblock > .title, .literalblock > .title, .stemblock > .title, .openblock > .title, .paragraph > .title, .quoteblock > .title, table.tableblock > .title, .verseblock > .title, .videoblock > .title, .dlist > .title, .olist > .title, .ulist > .title, .qlist > .title, .hdlist > .title { text-rendering: optimizeLegibility; text-align: left; }

table.tableblock > caption.title { white-space: nowrap; overflow: visible; max-width: 0; }

.paragraph.lead > p, #preamble > .sectionbody > .paragraph:first-of-type p { color: black; }

table.tableblock #preamble > .sectionbody > .paragraph:first-of-type p { font-size: inherit; }

.admonitionblock > table { border-collapse: separate; border: 0; background: none; width: 100%; }
.admonitionblock > table td.icon { text-align: center; width: 80px; }
.admonitionblock > table td.icon img { max-width: initial; }
.admonitionblock > table td.icon .title { font-weight: bold; font-family: Noto, sans-serif; text-transform: uppercase; }
.admonitionblock > table td.content { padding-left: 1.125em; padding-right: 1.25em; border-left: 1px solid #ddd; color: #365E7A; }
.admonitionblock > table td.content > :last-child > :last-child { margin-bottom: 0; }

.exampleblock > .content { border-style: solid; border-width: 1px; border-color: #e6e6e6; margin-bottom: 1.25em; padding: 1.25em; background: #fff; -webkit-border-radius: 0; border-radius: 0; }
.exampleblock > .content > :first-child { margin-top: 0; }
.exampleblock > .content > :last-child { margin-bottom: 0; }

.sidebarblock { border-style: solid; border-width: 1px; border-color: #e6e6e6; margin-bottom: 1.25em; padding: 1.25em; background: #fff; -webkit-border-radius: 0; border-radius: 0; }
.sidebarblock > :first-child { margin-top: 0; }
.sidebarblock > :last-child { margin-bottom: 0; }
.sidebarblock > .content > .title { color: black; margin-top: 0; }

.exampleblock > .content > :last-child > :last-child, .exampleblock > .content .olist > ol > li:last-child > :last-child, .exampleblock > .content .ulist > ul > li:last-child > :last-child, .exampleblock > .content .qlist > ol > li:last-child > :last-child, .sidebarblock > .content > :last-child > :last-child, .sidebarblock > .content .olist > ol > li:last-child > :last-child, .sidebarblock > .content .ulist > ul > li:last-child > :last-child, .sidebarblock > .content .qlist > ol > li:last-child > :last-child { margin-bottom: 0; }

.literalblock pre, .listingblock pre:not(.highlight), .listingblock pre[class="highlight"], .listingblock pre[class^="highlight "], .listingblock pre.CodeRay, .listingblock pre.prettyprint { background: #eee; }
.sidebarblock .literalblock pre, .sidebarblock .listingblock pre:not(.highlight), .sidebarblock .listingblock pre[class="highlight"], .sidebarblock .listingblock pre[class^="highlight "], .sidebarblock .listingblock pre.CodeRay, .sidebarblock .listingblock pre.prettyprint { background: #f2f1f1; }

.literalblock pre, .literalblock pre[class], .listingblock pre, .listingblock pre[class] { border: 1px hidden #666; -webkit-border-radius: 0; border-radius: 0; word-wrap: break-word; padding: 1.25em 1.5625em 1.125em 1.5625em; font-size: 0.8125em; }
.literalblock pre.nowrap, .literalblock pre[class].nowrap, .listingblock pre.nowrap, .listingblock pre[class].nowrap { overflow-x: auto; white-space: pre; word-wrap: normal; }
@media only screen and (min-width: 768px) { .literalblock pre, .literalblock pre[class], .listingblock pre, .listingblock pre[class] { font-size: 0.90625em; } }
@media only screen and (min-width: 1280px) { .literalblock pre, .literalblock pre[class], .listingblock pre, .listingblock pre[class] { font-size: 1em; } }

.literalblock.output pre { color: #eee; background-color: #264357; }

.listingblock pre.highlightjs { padding: 0; }
.listingblock pre.highlightjs > code { padding: 1.25em 1.5625em 1.125em 1.5625em; -webkit-border-radius: 0; border-radius: 0; }

.listingblock > .content { position: relative; }

.listingblock code[data-lang]:before { display: none; content: attr(data-lang); position: absolute; font-size: 0.75em; top: 0.425rem; right: 0.5rem; line-height: 1; text-transform: uppercase; color: #999; }

.listingblock:hover code[data-lang]:before { display: block; }

.listingblock.terminal pre .command:before { content: attr(data-prompt); padding-right: 0.5em; color: #999; }

.listingblock.terminal pre .command:not([data-prompt]):before { content: "$"; }

table.pyhltable { border-collapse: separate; border: 0; margin-bottom: 0; background: none; }

table.pyhltable td { vertical-align: top; padding-top: 0; padding-bottom: 0; line-height: 1.6; }

table.pyhltable td.code { padding-left: .75em; padding-right: 0; }

pre.pygments .lineno, table.pyhltable td:not(.code) { color: #999; padding-left: 0; padding-right: .5em; border-right: 1px solid #ddd; }

pre.pygments .lineno { display: inline-block; margin-right: .25em; }

table.pyhltable .linenodiv { background: none !important; padding-right: 0 !important; }

.quoteblock { margin: 0 1em 0.75em 1.5em; display: table; }
.quoteblock > .title { margin-left: -1.5em; margin-bottom: 0.75em; }
.quoteblock blockquote, .quoteblock blockquote p { color: #333; font-size: 1.15rem; line-height: 1.75; word-spacing: 0.1em; letter-spacing: 0; font-style: italic; text-align: justify; }
.quoteblock blockquote { margin: 0; padding: 0; border: 0; }
.quoteblock blockquote:before { content: "\201c"; float: left; font-size: 2.75em; font-weight: bold; line-height: 0.6em; margin-left: -0.6em; color: black; text-shadow: 0 1px 2px rgba(0, 0, 0, 0.1); }
.quoteblock blockquote > .paragraph:last-child p { margin-bottom: 0; }
.quoteblock .attribution { margin-top: 0.5em; margin-right: 0.5ex; text-align: right; }
.quoteblock .quoteblock { margin-left: 0; margin-right: 0; padding: 0.5em 0; border-left: 3px solid #365E7A; }
.quoteblock .quoteblock blockquote { padding: 0 0 0 0.75em; }
.quoteblock .quoteblock blockquote:before { display: none; }

.verseblock { margin: 0 1em 0.75em 1em; }
.verseblock pre { font-family: "Open Sans", "DejaVu Sans", sans; font-size: 1.15rem; color: #333; font-weight: 300; text-rendering: optimizeLegibility; }
.verseblock pre strong { font-weight: 400; }
.verseblock .attribution { margin-top: 1.25rem; margin-left: 0.5ex; }

.quoteblock .attribution, .verseblock .attribution { font-size: 0.8125em; line-height: 1.45; font-style: italic; }
.quoteblock .attribution br, .verseblock .attribution br { display: none; }
.quoteblock .attribution cite, .verseblock .attribution cite { display: block; letter-spacing: -0.025em; color: #365E7A; }

.quoteblock.abstract { margin: 0 0 0.75em 0; display: block; }
.quoteblock.abstract blockquote, .quoteblock.abstract blockquote p { text-align: left; word-spacing: 0; }
.quoteblock.abstract blockquote:before, .quoteblock.abstract blockquote p:first-of-type:before { display: none; }

table.tableblock { max-width: 100%; border-collapse: separate; }
table.tableblock td > .paragraph:last-child p > p:last-child, table.tableblock th > p:last-child, table.tableblock td > p:last-child { margin-bottom: 0; }

table.tableblock, th.tableblock, td.tableblock { border: 0 solid #d8d8ce; }

table.grid-all > thead > tr > .tableblock, table.grid-all > tbody > tr > .tableblock { border-width: 0 1px 1px 0; }

table.grid-all > tfoot > tr > .tableblock { border-width: 1px 1px 0 0; }

table.grid-cols > * > tr > .tableblock { border-width: 0 1px 0 0; }

table.grid-rows > thead > tr > .tableblock, table.grid-rows > tbody > tr > .tableblock { border-width: 0 0 1px 0; }

table.grid-rows > tfoot > tr > .tableblock { border-width: 1px 0 0 0; }

table.grid-all > * > tr > .tableblock:last-child, table.grid-cols > * > tr > .tableblock:last-child { border-right-width: 0; }

table.grid-all > tbody > tr:last-child > .tableblock, table.grid-all > thead:last-child > tr > .tableblock, table.grid-rows > tbody > tr:last-child > .tableblock, table.grid-rows > thead:last-child > tr > .tableblock { border-bottom-width: 0; }

table.frame-all { border-width: 1px; }

table.frame-sides { border-width: 0 1px; }

table.frame-topbot { border-width: 1px 0; }

th.halign-left, td.halign-left { text-align: left; }

th.halign-right, td.halign-right { text-align: right; }

th.halign-center, td.halign-center { text-align: center; }

th.valign-top, td.valign-top { vertical-align: top; }

th.valign-bottom, td.valign-bottom { vertical-align: bottom; }

th.valign-middle, td.valign-middle { vertical-align: middle; }

table thead th, table tfoot th { font-weight: bold; }

tbody tr th { display: table-cell; line-height: 1.4; background: #eee; }

tbody tr th, tbody tr th p, tfoot tr th, tfoot tr th p { color: #222; font-weight: bold; }

p.tableblock > code:only-child { background: none; padding: 0; }

p.tableblock { font-size: 1em; }

td > div.verse { white-space: pre; }

ol { margin-left: 1.75em; }

ul li ol { margin-left: 1.5em; }

dl dd { margin-left: 1.125em; }

dl dd:last-child, dl dd:last-child > :last-child { margin-bottom: 0; }

ol > li p, ul > li p, ul dd, ol dd, .olist .olist, .ulist .ulist, .ulist .olist, .olist .ulist { margin-bottom: 0.375em; }

ul.checklist, ul.none, ol.none, ul.no-bullet, ol.no-bullet, ol.unnumbered, ul.unstyled, ol.unstyled { list-style-type: none; }

ul.no-bullet, ol.no-bullet, ol.unnumbered { margin-left: 0.625em; }

ul.unstyled, ol.unstyled { margin-left: 0; }

ul.checklist { margin-left: 0.625em; }

ul.checklist li > p:first-child > .fa-square-o:first-child, ul.checklist li > p:first-child > .fa-check-square-o:first-child { width: 1.25em; font-size: 0.8em; position: relative; bottom: 0.125em; }

ul.checklist li > p:first-child > input[type="checkbox"]:first-child { margin-right: 0.25em; }

ul.inline { display: -ms-flexbox; display: -webkit-box; display: flex; -ms-flex-flow: row wrap; -webkit-flex-flow: row wrap; flex-flow: row wrap; list-style: none; margin: 0 0 0.375em -0.75em; }

ul.inline > li { margin-left: 0.75em; }

.unstyled dl dt { font-weight: normal; font-style: normal; }

ol.arabic { list-style-type: decimal; }

ol.decimal { list-style-type: decimal-leading-zero; }

ol.loweralpha { list-style-type: lower-alpha; }

ol.upperalpha { list-style-type: upper-alpha; }

ol.lowerroman { list-style-type: lower-roman; }

ol.upperroman { list-style-type: upper-roman; }

ol.lowergreek { list-style-type: lower-greek; }

.hdlist > table, .colist > table { border: 0; background: none; }
.hdlist > table > tbody > tr, .colist > table > tbody > tr { background: none; }

td.hdlist1, td.hdlist2 { vertical-align: top; padding: 0 0.625em; }

td.hdlist1 { font-weight: bold; padding-bottom: 0.75em; }

.literalblock + .colist, .listingblock + .colist { margin-top: -0.5em; }

.colist > table tr > td:first-of-type { padding: 0.4em 0.75em 0 0.75em; line-height: 1; vertical-align: top; }
.colist > table tr > td:first-of-type img { max-width: initial; }
.colist > table tr > td:last-of-type { padding: 0.25em 0; }

.thumb, .th { line-height: 0; display: inline-block; border: solid 4px #fff; -webkit-box-shadow: 0 0 0 1px #ddd; box-shadow: 0 0 0 1px #ddd; }

.imageblock.left, .imageblock[style*="float: left"] { margin: 0.25em 0.625em 1.25em 0; }
.imageblock.right, .imageblock[style*="float: right"] { margin: 0.25em 0 1.25em 0.625em; }
.imageblock > .title { margin-bottom: 0; }
.imageblock.thumb, .imageblock.th { border-width: 6px; }
.imageblock.thumb > .title, .imageblock.th > .title { padding: 0 0.125em; }

.image.left, .image.right { margin-top: 0.25em; margin-bottom: 0.25em; display: inline-block; line-height: 0; }
.image.left { margin-right: 0.625em; }
.image.right { margin-left: 0.625em; }

a.image { text-decoration: none; display: inline-block; }
a.image object { pointer-events: none; }

sup.footnote, sup.footnoteref { font-size: 0.875em; position: static; vertical-align: super; }
sup.footnote a, sup.footnoteref a { text-decoration: none; }
sup.footnote a:active, sup.footnoteref a:active { text-decoration: underline; }

#footnotes { padding-top: 0.75em; padding-bottom: 0.75em; margin-bottom: 0.625em; }
#footnotes hr { width: 20%; min-width: 6.25em; margin: -0.25em 0 0.75em 0; border-width: 1px 0 0 0; }
#footnotes .footnote { padding: 0 0.375em 0 0.225em; line-height: 1.3334; font-size: 0.875em; margin-left: 1.2em; margin-bottom: 0.2em; }
#footnotes .footnote a:first-of-type { font-weight: bold; text-decoration: none; margin-left: -1.05em; }
#footnotes .footnote:last-of-type { margin-bottom: 0; }
#content #footnotes { margin-top: -0.625em; margin-bottom: 0; padding: 0.75em 0; }

.gist .file-data > table { border: 0; background: #fff; width: 100%; margin-bottom: 0; }
.gist .file-data > table td.line-data { width: 99%; }

div.unbreakable { page-break-inside: avoid; }

.big { font-size: larger; }

.small { font-size: smaller; }

.underline { text-decoration: underline; }

.overline { text-decoration: overline; }

.line-through { text-decoration: line-through; }

.aqua { color: #00bfbf; }

.aqua-background { background-color: #00fafa; }

.black { color: black; }

.black-background { background-color: black; }

.blue { color: #0000bf; }

.blue-background { background-color: #0000fa; }

.fuchsia { color: #bf00bf; }

.fuchsia-background { background-color: #fa00fa; }

.gray { color: #606060; }

.gray-background { background-color: #7d7d7d; }

.green { color: #006000; }

.green-background { background-color: #007d00; }

.lime { color: #00bf00; }

.lime-background { background-color: #00fa00; }

.maroon { color: #600000; }

.maroon-background { background-color: #7d0000; }

.navy { color: #000060; }

.navy-background { background-color: #00007d; }

.olive { color: #606000; }

.olive-background { background-color: #7d7d00; }

.purple { color: #600060; }

.purple-background { background-color: #7d007d; }

.red { color: #bf0000; }

.red-background { background-color: #fa0000; }

.silver { color: #909090; }

.silver-background { background-color: #bcbcbc; }

.teal { color: #006060; }

.teal-background { background-color: #007d7d; }

.white { color: #bfbfbf; }

.white-background { background-color: #fafafa; }

.yellow { color: #bfbf00; }

.yellow-background { background-color: #fafa00; }

span.icon > .fa { cursor: default; }
a span.icon > .fa { cursor: inherit; }

.admonitionblock td.icon [class^="fa icon-"] { font-size: 2.5em; text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.5); cursor: default; }
.admonitionblock td.icon .icon-note:before { content: "\f05a"; color: #29475c; }
.admonitionblock td.icon .icon-tip:before { content: "\f0eb"; text-shadow: 1px 1px 2px rgba(155, 155, 0, 0.8); color: #111; }
.admonitionblock td.icon .icon-warning:before { content: "\f071"; color: #bf6900; }
.admonitionblock td.icon .icon-caution:before { content: "\f06d"; color: #bf3400; }
.admonitionblock td.icon .icon-important:before { content: "\f06a"; color: #bf0000; }

.conum[data-value] { display: inline-block; color: #fff !important; background-color: black; -webkit-border-radius: 100px; border-radius: 100px; text-align: center; font-size: 0.75em; width: 1.67em; height: 1.67em; line-height: 1.67em; font-family: "Open Sans", "DejaVu Sans", sans-serif; font-style: normal; font-weight: bold; }
.conum[data-value] * { color: #fff !important; }
.conum[data-value] + b { display: none; }
.conum[data-value]:after { content: attr(data-value); }
pre .conum[data-value] { position: relative; top: -0.125em; }

b.conum * { color: inherit !important; }

.conum:not([data-value]):empty { display: none; }

h1, h2, h3, #toctitle, .sidebarblock > .content > .title, h4, h5, h6 { border-bottom: 1px solid #ddd; }

.sect1 { padding-bottom: 0; }

#toctitle { color: #00406F; font-weight: normal; margin-top: 1.5em; }

.sidebarblock { border-color: #aaa; }

code { -webkit-border-radius: 4px; border-radius: 4px; }

p.tableblock.header { color: #6d6e71; }

.literalblock pre, .listingblock pre { background: #eee; }

/* From https://github.com/KhronosGroup/Vulkan-Docs/pull/901 */
a code { color: inherit; }

/* From https://github.com/KhronosGroup/Vulkan-Docs/pull/1157 */
/* Make VUID anchor handles*/
li > p > a[id^="VUID-"] { visibility: hidden; position: absolute; z-index: 1001; width: 2.2ex; margin-left: -2.2ex; display: block; text-decoration: none !important; text-align: center; font-weight: normal; }

li > p > a[id^="VUID-"]:before { content: "\00A7"; font-size: 1em; display: block; padding-top: 0em; background: #fff; }

li > p:hover > a[id^="VUID-"], li > p > a[id^="VUID-"]:hover { visibility: visible; }

li > p > a[id^="VUID-"].link { color: black; text-decoration: none; }

/* TODO: not quite sure what these two do */
li > p > a[id^="VUID-"].link:hover { color: black; }

.vuid { color: #4d4d4d; font-family: monospace; }

</style>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
<style>
pre.rouge table td { padding: 5px; }
pre.rouge table pre { margin: 0; }
pre.rouge .kp {
  color: #445588;
  font-weight: bold;
  font-style: italic;
}
pre.rouge .fm {
  color: #00c5cd;
  font-weight: bold;
}
pre.rouge .nx {
  color: #ff4500;
  font-weight: bold;
}
pre.rouge .vm {
  color: #ffa500;
  font-weight: bold;
}
pre.rouge .cm {
  color: #555544;
  font-style: italic;
}
pre.rouge .cp {
  color: #555555;
  font-weight: bold;
}
pre.rouge .c1 {
  color: #555544;
  font-style: italic;
}
pre.rouge .cs {
  color: #555555;
  font-weight: bold;
  font-style: italic;
}
pre.rouge .c, pre.rouge .ch, pre.rouge .cd, pre.rouge .cpf {
  color: #555544;
  font-style: italic;
}
pre.rouge .err {
  color: #a61717;
  background-color: #e3d2d2;
}
pre.rouge .gd {
  color: #000000;
  background-color: #ffdddd;
}
pre.rouge .ge {
  color: #000000;
  font-style: italic;
}
pre.rouge .gr {
  color: #aa0000;
}
pre.rouge .gh {
  color: #999999;
}
pre.rouge .gi {
  color: #000000;
  background-color: #ddffdd;
}
pre.rouge .go {
  color: #888888;
}
pre.rouge .gp {
  color: #555555;
}
pre.rouge .gs {
  font-weight: bold;
}
pre.rouge .gu {
  color: #aaaaaa;
}
pre.rouge .gt {
  color: #aa0000;
}
pre.rouge .kc {
  color: #000000;
  font-weight: bold;
}
pre.rouge .kd {
  color: #000000;
  font-weight: bold;
}
pre.rouge .kn {
  color: #000000;
  font-weight: bold;
}
pre.rouge .kr {
  color: #000000;
  font-weight: bold;
}
pre.rouge .kt {
  color: #445588;
  font-weight: bold;
}
pre.rouge .k, pre.rouge .kv {
  color: #000000;
  font-weight: bold;
}
pre.rouge .mf {
  color: #009999;
}
pre.rouge .mh {
  color: #009999;
}
pre.rouge .il {
  color: #009999;
}
pre.rouge .mi {
  color: #009999;
}
pre.rouge .mo {
  color: #009999;
}
pre.rouge .m, pre.rouge .mb, pre.rouge .mx {
  color: #009999;
}
pre.rouge .sb {
  color: #d14;
}
pre.rouge .sc {
  color: #d14;
}
pre.rouge .sd {
  color: #d14;
}
pre.rouge .s2 {
  color: #d14;
}
pre.rouge .se {
  color: #d14;
}
pre.rouge .sh {
  color: #d14;
}
pre.rouge .si {
  color: #d14;
}
pre.rouge .sx {
  color: #d14;
}
pre.rouge .sr {
  color: #009926;
}
pre.rouge .s1 {
  color: #d14;
}
pre.rouge .ss {
  color: #990073;
}
pre.rouge .s, pre.rouge .sa, pre.rouge .dl {
  color: #d14;
}
pre.rouge .na {
  color: #008080;
}
pre.rouge .bp {
  color: #999999;
}
pre.rouge .nb {
  color: #0086B3;
}
pre.rouge .nc {
  color: #445588;
  font-weight: bold;
}
pre.rouge .no {
  color: #008080;
}
pre.rouge .nd {
  color: #3c5d5d;
  font-weight: bold;
}
pre.rouge .ni {
  color: #800080;
}
pre.rouge .ne {
  color: #990000;
  font-weight: bold;
}
pre.rouge .nf {
  color: #990000;
  font-weight: bold;
}
pre.rouge .nl {
  color: #990000;
  font-weight: bold;
}
pre.rouge .nn {
  color: #555555;
}
pre.rouge .nt {
  color: #000080;
}
pre.rouge .vc {
  color: #008080;
}
pre.rouge .vg {
  color: #008080;
}
pre.rouge .vi {
  color: #008080;
}
pre.rouge .nv {
  color: #008080;
}
pre.rouge .ow {
  color: #000000;
  font-weight: bold;
}
pre.rouge .o {
  color: #000000;
  font-weight: bold;
}
pre.rouge .w {
  color: #bbbbbb;
}
pre.rouge {
  background-color: #f8f8f8;
}
</style>
<link rel="stylesheet" href="../katex/katex.min.css">
<script src="../katex/katex.min.js"></script>
<script src="../katex/contrib/auto-render.min.js"></script>
    <!-- Use KaTeX to render math once document is loaded, see
         https://github.com/Khan/KaTeX/tree/master/contrib/auto-render -->
<script>
    document.addEventListener("DOMContentLoaded", function () {
        renderMathInElement(
            document.body,
            {
                delimiters: [
                    { left: "$$", right: "$$", display: true},
                    { left: "\\[", right: "\\]", display: true},
                    { left: "$", right: "$", display: false},
                    { left: "\\(", right: "\\)", display: false}
                ]
            }
        );
    });
</script></head>
<body class="book toc2 toc-left">
<div style="text-align: left;">
    <span class="image"><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAiYAAAD6CAYAAACVrYw7AAAMSHpUWHRSYXcgcHJvZmlsZSB0eXBl
        IGV4aWYAAHjarZhrciS5DYT/8xQ+AkkQJHEcPiN8Ax/fH6pbGo1mdr0TYXWoq1QPPpCJRELh/Off
        N/yLH0mth6KtV6s18lOsWB6c9Pj6sec7xfJ8Pz+5xvy++tP1cMf7pcwl4SivP9v7ehpc1x8vfMyR
        5s/XQ3/fyf09UPoc+PkRn9nP99dFcj2/rqfyHsjO66Rab1+XOt8DrfeDz1Lev+VzWa+D/x1+utCI
        0lYmkpyPJInPd3+tQPw3y+BofCdhUXy350oLHEQ+VkJAftrexzHGrwH6KcgfZ+F79Fv5ffDzeD8h
        32JZ3zHi5Lc3kn67Lp/z568Ty+eK8rcbEucv23n/3rv7vee1u1EqEa1vRj3BTh/D8CCDFHleq3wa
        v8p5ez7Gp8cRF5DvuJhwcm4pg8oNqaSdRrrpPMeVFkss+eTGMeeV5bnWpWXLSxyn4p90cwO9LR0k
        Vz7BMZP8uZb0zGvPfCt1Zt6JR3NisPTA/xef8Hc3/+QT7l0eouTBBPr0Ajg7r1mGI+ffPAUg6b5x
        0yfAH583/PELsaAqCOoT5s4GR5yvIaamH9ySB2fhOeX44l0Kbb8HIETMrSwmCQjEmkRTTbHl3FIi
        jh2ABivPUvIEgaSaN4vMRaTm0HLPPjfvtPQ8mzXX7JfRJoBQqeRT9/wCrFIU/rTS4dBQ0aKqVZv2
        oKajSi1Va62tusiNJq00bbW11pu10aWXrr321nu3PiyboIFq1Zp1Mxsjh8FEg7EGzw+uzDxllqmz
        zjb7tDkW9Fll6aqrrb5sjZ23bGRi191237bHSeGgFKccPfW004+dceHalVuu3nrb7dfu+ETtjeov
        nz9ALb1Ryw9S/lz7RI2robWPIZLLiTpmIJZLAvHmCEDo7JjFnkrJjpxjFi2TFJpZpDo2YSdHDAjL
        SVlv+sTuB3L/CLeg/R/hlv8XcsGh+38gF4DuV9x+g9r2OrcexF5Z6DGNQvZx//QRch9e1Mb/OhKJ
        vFbSAg5GnsvcreigTifWqiOsutkAy9ygcG/euV5L7erotomKaLNJVV1Hk56xR70rNbNZ5RCGSSbq
        3mmHSZDnsV7Z/WwXuUVndwMpu3HMlXflxbVmtXPU2OqglrJ1jbOny5KilrVncA20fXe0A6g9+rzn
        noxiXujYdZbcjG3IhDoHfI9yDdcBfdYp7eZ0Txth12cN2paA5Kh4k8F2B5B1O05oKFFLQrCbia6t
        UwY7BufRsgCbtTNaCSeR3OPsDd7pStlJr7Z2a9Xe7rq2kMe24uC0cX7SstkSMgauWfspRJhohpTb
        mX0c7Rdmy51a2OghSGse3bkQH8FEbTg/fbMrW+vrwCwKfKtEoUNlDVFOFyFspk1YHbPyV6+t7K2H
        5ALLvNeqacqBiLgKUB1nDrVLTraLj0hXg97DCNmoh2PsyUKc3meysku2UN82c3sKTSbq98isdR9G
        P/Ee02WSZ5YZ8CnGygTB7eR0nRuW6fFrjWgW8AT1kjWyTVJFUwFYUs2PRd1pPccQv13426MjXlc9
        lIUJOHVqX8vyvCUGIS/ZLCIzwb1sYD1rXEXKnAm3Zp4eZNvJnsK5GpTY3ZZ09UgT8nPnkjBPZHCW
        nXUppQlkMRANLA+OoKYzD3SYiwz27F55tmMWpQ43FumSWk82BLShpTVTtoVJcRJ7bsI5Stged9rW
        64RKpH/t6AE8Am6CNJHNzApjPbWecG2gHXPtdpIThCI3Hx4jo0DXD0y+E2UhSyUZDLizFZcjlZMH
        k0hh/xYi+OlZPUKQSE31ZcK+FTO0sXFRtd3rKmXMMuJGb0vj3XNaS2VbLqVXlpUDnottSF6MS77K
        hb8JrcDM9Jl2dlYgeEoelnxRiO5kagpF50biEaM0MEUhuT7UPran2+HJuoYWuZtuopBZxh1PXoTa
        U3ZkaFWfRN8MtHzawjZjqOrJrqQkMxC86xws5qQ9+7wMYGGHACfwHO0i4fYtSD4SvyK87XdNCafl
        ir1EKI5YWjehCzruqn1DvHYvgZWzUJJVkelOtVl38FaBBqrGaqkrY7tmD/I5Ly7WeRvaTyrOnQcS
        6PnFhiEk+iLt4F/MC5/uAsVRP+JFLuVcNKTbybG7gRexyaNR+BgCLUz40HtOnwiaXBBBeps5LeNZ
        x+b13EAi2WDRHMiCtTp3JiqOgcjH5DB6WTb65rlkqxawRZxYW55r4YauZ81TuChqd0mroUJWpPmi
        nbQiBUeJL26bUK7FbjC+OhocrJMuRlFWSdvD0Om3eHHsBpORymDkGDnY0EMi8ug3WoKekTnqo0QX
        p4kyXzOvWq3vi6a5i4BaBRdwJoUyeFXN0XcHdyxtVlOYBx2D/bMceAR5bGBIJhm57nM4bHDMVM/k
        /tNHhu4+tNUBUBWguosOUrJ81dtuEcSXgrJzpzZOCiO89XXnQ6OYBsmWz6kwu6FPGbGHJbaxGmBH
        1R+n0lHAo9zPWAPxyXxFisAUhUqTjuOgPuQUYjFcalkRUqqlCRF3taZ4drSvQLXCdjuxzOUwA1a4
        Hrt0HpPn2BN10OgfvWL3HI4KHfWY8fQlewyKaqMojzncotASKQnfmdsIu5sKVO13Khx+J88sCXs3
        +y6VBeCTkOZJJXKXSAKetgd5iWxhFYhcx52NQLtFs0ehh3yjkCqoIeJHeWtP4wVucBn/C5xwNuHT
        aP1QMEGEmWMPoih1B7boSEC0jh1MWybMdgIfiF9pyTw9q2DYas0Q0u4U4gWpZF1ZWjcpuWUFdkGm
        e+yXr5z0RGFI6F05mfiYctzjXSsP6J4hfS+RDbFhSdzsACZboPKQs9TQR9LawVsVLDuCDG1SpUax
        AE234U8oBKgu/o2sUWmv4GMwbwG1vzB7+Mt4KbhScDV4RvQSi2ywi4WRcwhfg9MY4E3YwCS0hRW9
        pbLcpz4RwGZYabpRzANYTQoKnRXdlq3+1PY8zaNPvWVE6LaqXguEi4I+mB4U8ZBCZYCW2GM0ZaIf
        ONiDgwb92C7SkyzirKiTJHpBM+iF29k3RIoe4n0QZsoF2egEps+jucY+Ii+4vIm1o4dGKdd+9KF0
        QdY5G5y7EduukJfupRqOlraxyyVHkCzEHStzPbW9+BBrJMz7DPwZKs4WZqehSaTuHHZhth7lTbKG
        eoiRQeYwS4hgqUiFYJ03Xop0i8+xZ4h5ESTl+cxgO02oRL6HqFQ3LDUVvGMOcY+oZJ2jxcttNJT8
        hYzsCSQb2igkcNkk6xX1MoV/O7wUPLsaubHomZ9ci78eIU5umDmWTNK3VJ//f9nEWndiWtzhBbC1
        WNqmyaHSlUH/tmjO0rMOan+k66I4ItvdWx2SqGYPM70VrCaB8IAyogS09dBhoMlk5bCpcdhSmS7H
        CCMGYK6Kf3mIOqW86Nzj92P47Q1KqDvV4f9Nonnv+BGXgdKBdR/Wm3wXiiQbVXGXgmPDPVGHqcoG
        +tykdGRsmFsWVuxDneemdac2MoUDM1oZgjQ/ZWwMCRkD7m4NpnAPUYyVSjDMi+wu7Yk1m0WYBp1V
        jGQ8Pa65E6L2GVGTRI6lMLwjdp8BA/FhiAp+yWORsv9ribmywNdDk3hAicBi+KvQJePUdndI8QKj
        B9xt2aT3UdZjZT2vqfYuLOigiOrvKQ1fKnOKG2B0Bv/aD4zwsoTJLKMGDC92hjAyX+mozvPPUBTD
        218nKrSdhzoZQbEc/O8TGMklLvLRXJ5jPzFsefQHrmE8Rl28yk6//MFq7RVV+YFsy2l5G/961bua
        4IGlkyN+Y3kpe73IdpgbhadY4kKYnTbwWSH73rhd70BZZGauYaa42mQAipRQnXkbf7Rp4+ixR3pR
        icqJuvSECNCdb7yGPS0fo2ok7YYXfLxGIIPBls4I2ycIBJV3xLUJFOkJheiertfIz/Porh9/CeOK
        F6PovRmoYcLYTykE+0Bf/weWMzcRe7iJeUOa/f8qjnJG+3wtUIR9IkITArJBwe2H7xH2f18OJ566
        cE96TnxI9w1FrA/9f00uj1/EIUrHMAY6/FSWYwGXK9TICZ9LG/FwH6ZT/giJh9ZJga/s+DrqGhsi
        assvJyxrGDZfA4+Izcq2n9FenEAl0F9ISs/wPMN+uw+Um1+y12QIJiOG9SKGRqhqr3vUZzc4shY0
        rq8RaDG208ZXTkGNvjB9RnjvJkz8RP9ypRC/9abvn3SX4U9f+GcD4Wo3tjf8F6DKXZiMmXUwAAAB
        hGlDQ1BJQ0MgcHJvZmlsZQAAeJx9kT1Iw0AcxV9btSpVBzOIOGSoThZERRy1CkWoEGqFVh1MLv0Q
        mjQkKS6OgmvBwY/FqoOLs64OroIg+AHi6OSk6CIl/i8ptIjx4Lgf7+497t4BwVqJaVbbGKDptplK
        xMVMdkUMv6ILvQA6IMjMMmYlKQnf8XWPAF/vYjzL/9yfo0fNWQwIiMQzzDBt4nXiqU3b4LxPLLCi
        rBKfE4+adEHiR64rHr9xLrgc5JmCmU7NEQvEYqGFlRZmRVMjniSOqppO+cGMxyrnLc5aqcIa9+Qv
        jOT05SWu0xxCAgtYhAQRCirYQAk2YrTqpFhI0X7cxz/o+iVyKeTaACPHPMrQILt+8D/43a2Vnxj3
        kiJxoP3FcT6GgfAuUK86zvex49RPgNAzcKU3/eUaMP1JerWpRY+Avm3g4rqpKXvA5Q4w8GTIpuxK
        IZrBfB54P6NvygL9t0D3qtdbYx+nD0CaukreAAeHwEiBstd83t3Z2tu/Zxr9/QDps3Jw8p/mbgAA
        AAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB+YJDgAHInsnkF4A
        ACAASURBVHja7Z1/aF1lnv9fIzmcs2zgm80GybBZJrJdJsN2mpSpfFutmLK1VqdlGqZhFBUrVlRU
        bJmKFSujjKJiB1tUrIyDFSt2aKUZ7MSqHazYSSpTMYldzDAZJst0+WZLKPlCFs7h5gvfP54n02tt
        mnvvec6ve98vuFTbe8899/P8OO/n83yezweEEEIIIYQQQgghhBBCCCGEEEIIIYQQQgghhBBCCCGE
        EEIIIYQQQgghhBBCCCGEEEIIIYQQQgghhBBCCCGEEEIIIYQQQgghhBBCCCGEEEIIIYQQQgghhBBC
        CCGEEEIIIYQQQgghhLgk35IJhBALMfvhlV1AJ9Be9tedC7w9KHvfLDC9wPtm7AsgBKbsf0/Z/59p
        XnduRtYXQsJECFGHHBpZ1WYFQzvQYV9tQIsVGWf7e4ZvX0CYfAH0ZHTr01bg/GeZ0Jm0f05bITMJ
        nG1ed25OLS1EfdAkEwhReOHRAiyxr86yP//JipDmy3x8DrhuAVGyJENRghVPbSzsoSm/13mR8l/2
        z0lgwr4mJVyEkDARQrgXIF1A+eu7VoS0xbjsa/09w6cW+LdbCmSeeY/QQsJlHPgzMG7Fyggwri0j
        IfKHtnKEyJ8AaQFWAEsxHotuK0QCx181CXy/v2d4doGHeZbbOGkxBXxuBctp4EzzunNn1AuFkDAR
        otFFSA+wEvgBFWxdOGJjf8/w0QVEyRLgTw3aLLNWqPzeipURiRUh0kNbOUKkK0S6gNVWhPxvjFck
        Cw4uJEostzRwMzVbsbiiTKjNAKeAz+yfJ5vXnZtVjxbCPfKYCJGsEOkBeu3rWuLFg7hiBvjX/p7h
        6QVdBo2xjROHOeAM8AlwAjiheBUhJEyEyKMQ6bIiZC3w75gjuXnjrv6e4f2XESWNvI0ThxHggzKh
        EsokQkiYCJG2EGm2ImQ9cCPpxYfUyvH+nuEbLveG2Q+v3AX8XK0bixA4aYXK0eZ158ZlEiEkTIRI
        SowsATYAP8TEiwQFufUQ+F5/z/DkIsJE2zjumbQiZQB5U4SQMBHCgRjpATYDPyK7gNW4PNLfM7x7
        EVGibZzkmS0TKQMKohXi6+hUjhALi5HVZWKks+A/5zSwp4L33aKWT5xm4Mf2Fc5+eOUJ4F0rUqZl
        HtHoyGMixNfFyLxn5LY6ECPzzAFX9/cMjyy6lNc2TpaEwLEykSJPipAwEaJBxUgHcLsVI0vr8Cf+
        or9neEcFokTbOPkSKe8CB4DjqvUjGglt5YhGFSMBxjNyJ+ZUTb0yAeyq8L3axskPgRXKtwFTsx9e
        +Tawr3nduQmZRkiYCFFfgmQFsBX4CfnMMeKae/p7his9AfJj9ZDcipRZQPEnQsJEiDoRIwGwBbib
        sjTjDcD+/p7hE5W80W7jKLYkX8wAe4E9yiorJEyEqA9BsgR4ELNd09JgP38a2F7F+7WNkx9C4DXg
        ueZ156YWe/P57mU9wBJgoHV0TLEoQsJEiBwKkvXAA5gkaI3K/f09w9WssrWNUzxB0oSJH3rczuVT
        57uX7QVebx0d07aPKCw6lSPqRYwEmJM1D1OfJ2uq4Wh/z/DGSt+s0zjFEiRWlHQBb3HprckQeBPY
        3To6pmBZUTjkMRFFFyQtwH1WkLTLIswC91f5GW3jZMMc8DawswpB0gRsw9QyWqgUQgDcC9x7vnvZ
        APB86+jYKZlbFAV5TERRBUm7naDvpfHiRy7HQ/09wy9XpWSUVC0rQfJ0Ncd/rZfkDWBlDd95Anim
        dXTsuMwvJEyEcC9IdlpBEsgiX+NUf8/wqipFibZx8i9IKvGSVMoI8FTr6NiAmkPkFW3liCKJkq3A
        SxIkCz707qrhc9rGSYcDwFPVJkiL6SW5FD3AkfPdyyRQhISJEA4YkShZkGf6e4bHa/icTuMky4AV
        JCPVfMixl+RyAuU08Ejr6NgJNZXIC9rKEYXi0MiqQ5hU8uIC48DyKjK8AtrGyaMgsaLEtZekEk5Y
        gXJaTSey5gqZQOSJa47c3HTNkZt7L/OWxzDbFuICd1UrSizaxklGkCxvXneurxYvyfnuZTuAL1IW
        JQC9wB/Ody9753z3siVqRiFhIoQRJRuAL4F3FnpPf8/wBCbngzC80t8zXOtRUG3juPU4rKlFkFhR
        0gV8CrxAttuVtwBfne9etvt89zKddhOZoK0ckQdBshR4ka9X+f2Hob7BS2YutSdzvkLHhM8C368y
        wyugbRzHguSp5nXnTtTy4RRiSeIwg/FQvq5U9yJN5DERWQqSlmuO3LwP47pee9E/dy30uf6e4SlM
        cbNG5/5aREnZyljEEyRrmtedWxNDlOTFS7IQLcCrwBfnu5f1qslFWuhUjshCkDQBW4FnWdjr0QNc
        botiNyaXSaNme329v2f4aIzP36ieWBMjwCPN687VnKgs516SS7EU+Ph897KDwPbW0bEpdQORJPKY
        iLRFyQq7SnyVy2/FXDYAr79neBZ4qkHNeBJ4qNYPz354ZQewWr2xakHS17zu3PKYoiTvXpLLMR9/
        ss2KKyESQZ1LpCVImoGnMVV/K+l3XZV4DTA1croayJQngZtqPIUzj45bVydInmpedy5WIrICekkW
        ogUTD3bb+e5l97SOjo2oiwjXyGMi0hAlGzDBqg9XIYa/u9gb+nuG5zDBeY3CgBUlszGvo9M4izPO
        BQ9JXFHSCXxMMb0kC7ECc7x49/nuZUp6KJyiUzkiSUHShkkhX2ug5d8N9Q0u6hk4NLLqY0wehnpl
        Bnii2uJ8l8Ju4/xVvXNBJoBngAPN687FPolyvnvZg5hYquY6F3F3qYKxcIW2ckRSomQzJo6kLcZl
        ujCu9MV4DBiuQzPOAr8CnrMnkVygbZx0BEknJntrbwPYrgv49Hz3sr3ArtbRsVDdScRBHhPhWpDM
        HzF0cRy1f6hv8HAlb6yjVPWTwGfAUWDAwbbN15XOh1f2YgJfmzDxAi1WPDYD3yn7OwmS2kVJI3hJ
        FmIcuFWxJ0LCRORFlKy1q8QOR5d8aqhv8MkKhckSTBxLnr2Ac/ZB+J9WgExikqT97RUzqNWVeGmy
        bVj+6rSv72BOTBU9rmAKeB7Y17zunBObN5iXZLF+/gSwW4nZhISJyEqQNGHyijzs+NK/HuobrNjz
        cmhk1cuYUz9ZM2NXjqP2z3FgwqbTrwtsrEpX2evfMPku2nJ+684FiRUljewlWYgTwB2to2NnZQoh
        YSLSFCVLgEOYhGiuGRnqG1xehTBpw6RZT3Mr4izwOXAaOAOc7u8ZbtiJePbDK9swBei67J/dLJKT
        puCCpBN5SRYT6Xe1jo4NyBRCwkSkIUq2YE7dJLVKDIf6Bv+umg8cGlm1C5MrIpH7wQTj/h6TT6Sh
        RUgNYmUlcK39M62toEQEiRUl8pJUzl5gh7Z2hISJSEqQBJgA1y0pfN1VQ32Dk1UIkwD4C25S1YeY
        tPifYNzSp/IQA1IHQqUJkwejF7je/ulaqJzEnGg6mIAg6UReklo4DfRpa0dImAjXoiTJrZtLsXGo
        b7CqmjCHRlZtsQ+OWhgHPgCOASddn4oRlxQqAcaLst4KlRVUH8Q8Y0Xkb4GB5nXnEnn4yUsSm2nM
        qZ3jMoWQMBEuRMl64B3SjeHYPtQ3uKdKYdKEqVi8tIK3z2G8Ib8Bjvb3DE+qpXMhVJZi4lSWYLxf
        wSWEyFnMKafx5nXnxpO8J3lJnDIHPNE6OvacTCEkTEQcUbIL+BnpH8d9bahv8L5qP3RoZNUG4L0F
        /jnEeETeJYFcIaK+kJckMQ4A97eOjmn8CQkTUZUgaQZ+iZuEabXwu6G+wbW1fPCiVPUSI6JaQdIB
        vIW8JElyGtjYOjo2JVOIeZSSXlxOlLRjvA4rCtpHH8FUQn3TipFptaqoUJRssX2nRdZIlBXAF+e7
        l21sHR07LXMIkMdELCxKeoD3cXO6JQ4fDPUNrleLiJQESQfmxNkGWSNVZjHJ2JTvRHCFTCAuIUo2
        AJ/mQJSACW4UIg1RsgX4UqIkE5qBQzaeR0iYCPE1UbIVOEJ+Av3k3hVJC5KO893L3sOcutHWTXY0
        AS+d716m0zoSJkL8TZTswgS65iX2aA5TZVeIpETJFuQlyRuPnu9e9sb57mWKgWxQFGMi5kXJi8C2
        nN3W4aG+wX61jkhAkCiWJP8cxiRjUxr7BkOKVIKkCZM0bXPObm2+dLoQSfCiREnu2Qy02RM7Ot7f
        QGgrR6Ikj6IE4KmhvsFxtZJIgtbRsX5gOSbrr8gvvcD757uXKbmdhImQKMmUw4AC4ETS4mSkdXRs
        DbBGAiXXrJY4aSwUYyJRkjcOAncM9Q1qX1mkyvnuZWuBF0ivQKWojpPATdrWkTAREiVpMYvZvtmt
        VhIZC5TbMXWhlsgaEidCwkQ0pig5ADw21Dd4Vq0kciJOAswptUdRbpM8ipMbWkfHQplCwkRIlLjm
        NPDQUN/gKbWQyKlAacPEO92JTjHmCR0lrmM00BqHF3MkSmYwHpJ9ahaRZ1pHx6aBree7l+2zY2i1
        rJILNmMqht8hU9Qf8pg0ANccuflp4PGc3M4BYPtQ36Aq/YrCYTPFvgC0yRq5YHfr6NgjMoOEiSiW
        KHkQeCkHtzIJ3DPUN3hcrSIKLk5agN3A3bJGLtjeOjq2R2aQMBHFECWbgENkv2X3CrBzqG9QkfSi
        ngTKakxtqS5ZI1PmgP7W0bEBmULCRORblKwAPibbKsGTwF1DfYMn1CKiTsVJAOzEbJUqZi87ZoE1
        raNjqkYuYSJyKkragS+A9gxv4wBwv7wkokEESg/wBkrOliVTwPLW0bEpmULCRORLlDRjPCUrMrqF
        GStIDqo1RIOJkyZgF/KeZMkpjOdEOU4KjGrl1B+vZihKTgPLJUpEI9I6OjbXOjr2JHA1oAKU2bDS
        zoFCwkTkgWuO3LwDuD2jr98LrBrqG5xUS4gGFygjmMrFe2WNTNhyvnvZfTJDcdFWTv2IkrXA+6Tv
        Qp7FBLgeVisI8XVsYcA3gA5ZI1XmgFUKhpUwEdmJkqyCXSeAvqG+wTNqBSEWFCdtmGPFm2SNVJnE
        BMPOyBTFQls5xRclTcBbGYiS48DVEiVCXJ7W0bHp1tGxPuAejIdRpEMnxlslJExEyuwC1qb8nfuA
        m4b6BrUSEaJygfI6JvZERSvTY9P57mUPygzFQls5BeaaIzevxhwNTiuuZA54ZKhvUOmfhagRHStO
        nRC4unV0TN5dCRORsChpBr7EuCvTQEGuQrgVKD2Y2JMVskbijFhxMidT5B9t5RSXl1IWJTdJlAjh
        DnuseBWwHZOYUCRHD/CkzFAM5DEpINccuXkD8F5KXzcFrBnqG1TCKCESwlYsfhK4E2iRRRJhDriu
        dXRMMT4SJsKxKGnBbOGkkRdBokSI9AXKFuBeVLU4CbSlUwC0lVM8XkxJlIxjjgNLlAiREq2jYzOt
        o2N7WkfHvgdch8kee1aWcUYPphq0yDHymBSIa47c3Is5hZOGKFkz1DeoKp1C5IDz3cuWYtICrAZ+
        QHrxZfVICHy/dXRsQqaQMBHxREmAye6atHv3LMZTIlEiRH6FSoudC5bYVwfQholP+Ueg2b61CaXD
        vxTHW0fHbpAZ8onO0BeHHSmIkingBokSIfKNTbN+CiVrE3WIPCYF4JojN3cCXwFBgl8zDVynmBIh
        hBBZouDXYvBswqJkBlOMT6JECCFEpshjknNs2vlPE/yKCWCjRIkQQog8II9J/nkxoevOAa8AyyVK
        hBBC5AUFv+aYa47cfAvu62iEwLvAc0N9gypqJYQQQsJEVMzdwKSD60wBn2Mi+AeG+gZnZVohhBBC
        CCGEEEIIIYQQQgghhBBCCCGEEEIIIYQQQgghhBBCCCGEEEIIIYQQQghRj6hWThmeHzQDnUA70AE0
        A22XeGuISVo2Y/+cLEXhlCwohKiDeTAAuuxrqZ0LO4F/LJsTmy/x0Uk7N/43cNb+/xlgHDhTisI5
        WVdImFx+8LUAvcBqO/i6rSCplVk7AD8HTgMnS1GoGjRCiKLMhb3A9XY+dJ0VPARGgE+AE8CJUhSG
        sr5oeGHi+UEPsBm4Efc1aC7FWeAD4ChwTANRCJGTubAN2AT8xAqStMuTzALHgV8DA3mYGz0/2Ams
        T+jyx0pR+Nwi378F2FLh9bbZhfTOi/5+oBSFe8quuQHYUe29ZE1TgwzArcCdGNdkmnRg6t3cDUx7
        fvAusK8UhSOaGoUQGcyHa4F7rSjJcv5vtvewCZjx/OBt4OWMvcxdGI9REkxW8J7OKr6/xQqTi9//
        v4A9Zf+/+RLvmcx7P72ijgfgEs8PXgf+CjybgSi5mDY7IXzh+cHHVskKIUQa8+Emzw++AD6yD6s8
        LUpbgAeArzw/OOL5wUq1WM302K25ea4v4o+4og4HYKfnB/uBr6ynIsjhbfYC73l+8IXnB70aS0KI
        hObDDVaQHAF6CnDLm4BhK1C6Gqy59gNryl7lByrevOjfLva6lwcWr59/FmK8MIWjqY4GYADsAn6a
        UzFySXULfOz5wTHgoVIUTmgqFUI4mA+7gJeAtQX9CZuADZ4fvALsKkXhbL23WSkKJynbZvH8oDzu
        ZrIUhScuauPy/x3BBC0HduF7kK/Hy4yT/a5BxVxRJ4NwPcZD8niBRAkXKdwvPT/Y5flB3cf9CCES
        mwubPD/YBXxRYFFSvnB+2M6NvWrdy/I/wCn73/PbN/M2mwY+K9KPuaLgg7DZ84NXgfcpqMuqjAD4
        OfCHBnRhCiHiz4edwKd2Hgnq6Kd1YjzLz2nhdlk+sH92eX5QHhj7u6L9kCsKPAiXAsPAfXXWuXqs
        ONmicSaEqHA+3AR8CdRz4OijwEf2pKX4JsfK/nsHF/JyHZMwSWcQbrCiZGmddrBm4A3PD17UCkEI
        sch8+CQmuLW5AX5uL/CpvMrfxKahmA+YfaDsn45LmCQ/CLc10CDcBhyxqfKFEKJ8Lmzy/OAN4GcN
        9tO7MFs7EiffZH47Z34r70wpCs9KmCQ7EJ8GXqQBEsOVsQF4X+JECFEuSoB3qDxTaL3RLnFySY4v
        IFQkTBIaiC9iTt00IqslToQQF4mSzQ1uinZMzEm7esXfOLbI/xeCpoIMxB2YbY00mMFUxPwz5kz5
        NKauQ7nNOjCZXDuBfyOdE0Hz4uSmRjjTL4RYkDckSv5Gh50Xr6vDefHsRc+li5nlQt6TKYBSFE7b
        vFhdmKRrJ+2/T5e9dzrvPzz3Rfw8P7gdeCvBr5izqvK3mIqX4zXcYxsmKGs98CMrWpLicCkK+zUf
        CdF42O3sx2WJb3CgFIV3xLTtfkxNtSR4sxSFW9RMlXFFzgfhSrs6SEqNPgJ8uxSFG0tRuK/WAlKl
        KJwuReHhUhRuBb4N9GNKeyfBZjs5CSEaS5TcIlGyILd7frBVZpAwSXoQtmNO37jebpoGHgKuKkXh
        7lIUOnVrlaJwzoqU+ZoGpxMwz+M2b4EQojFEyVLgl7LEZXnRJpkTEiaJ8RYXEsS4Yj/wr6UofLkU
        hXNJ/wBb22CVFUKu9z/f0CAUoiFESWDnQwW/X55m4FWZQcIkqYG4A7d1HmaBvlIU3lWKwpk0f4v1
        oLwMLOebFSHj0GLFiRKwCVHfPE2+KgOHmEDK8tdcTu5tvecHCgyWMHEuSrowtR5cMQ5cXYrCgSx/
        l60cvApT9dEVvdRfSn4hxIX5cCWmkF1WnAXeBO4Brgb+oRSFf1eKwqsuenmY+LqNwPOOF2HV8qwW
        bMXmWzkciB/hzlsyDqwpReFUzn7ji7g7/jwLfK+I2f2EEJedJ5owpTdWpPzVc8CvgX2lKDwZ4/6X
        AluBe0m/qOD2UhTuqfJ+96NTObngipwNxFvqXZQAlKJwO7DH0eWagRfUlYWoO7ZmIEoO2IXO7XFE
        iZ3nzpSicBtwFfAK6W73PCyviYSJC1ESAM86utxUXkXJReLE1fbSLZ4frFZ3FqI+8PyghXRr4Eza
        OfMOu+3scq6bKkXhg5itoDMp/Z5OQCcXJUxicx9uMqjOYQJdpwpg/zscDtSfqzsLUTdsw/2pxIU4
        Ciy3pwiTXIyN4D7O7nI8oG4kYRJndRAAjzq63BOlKDxVBOPbFMp3YKLc49Lr+UGvurQQxcZ6S9IK
        eH3ZLuRSOa1YisLZUhTeirut7MXmxA71KAmTWrnP0ergFLC7SA1gVxHPOLrcz9SlhSg8WzHpAJJm
        TykKH0ojp9Ml5r3twL4Uvup2dafikXlwkA1QcuFymwMyGWQOeA64DVN4Ke4KoceKnaKtEjvt7++w
        L6xYneNC0alpTPzQJDCRdk6ajO3TDiwts08T5qRDO+ZI5xzmhNYUMGHtM42Y90B02VdnWd8KuVAc
        7WxZ3xrPah6x82Ea3pIBTEmOLHkIWILbnFUX80M7vwoJk6pYbztnXN4uReHpIjZCKQrnPD94BHjP
        weW2AVsK8LBYCmwArgdW1rJC9PzgLPAZpi7RMddBexnbZ4UdG9fGtM/vrX2ONtKRchsMvgm40Qq6
        qhY5nh+MWNsdBU6WojBM6dY3lQnzpJgA7sh6EWfnvTuAL0mu8OlKzw9aGmkRUw98KwcTyHv2ARWH
        EJNqvtATr+cHH2OSpsW1xbdrGYi2CFatp3t2LLZCt1WYt2ByBSxNwIQjmPwL+wsS/HyxfTox25q3
        JfRwOgm8janEOpvyb9td48NnuhSFO6rwjGzFeGA7Hd7+NPAu8HIpCs8kbKf3rSBNijngujzF4aVQ
        Qb6vkgSbymMiYTLfEdqBvxLfc/MrW9m36Ku89cD7Di51fykK99Xw/XEG5lWlKJy8jCDZRXqJlkL7
        AH6uCF4Uzw96MPFBaR1vnAF+Ze0zndJv/EuNYmGyFIVXLXLtJoyn8HGSj80YAB6rtRL5Ir+jA/gL
        yXqyXytF4X05HANfkFza/V9UIm4lTPJD1sGvtzgahLvroTFKUXgMN8eHb8vRhLMF+BNm3zyt7I8B
        cDfwlecHu+1KOpceEs8P3gG+IN2cCy3AT4E/eX6w056KK6qYX4nZCniBdAJGNwFfen7wXAIJvDYn
        LEpmgJ05bcpnErx2tx71EibV8GMH1ziWxOolQ15xcI3VWR+T8/yg2fODt4A3UnpgXIom+wD+Kk+F
        vTw/aLKFKr+y4jwrWjBJDb+wD/iiiZIngU+JHzReS796FPiD4wrfP074vvfmONZigAtB7q5ZgZAw
        qXBSaaf2eIZy3q6zNjmIm7wmGzJs22bMllRejuq1A4c8P3g1a++AfZB9alf4efFUdAGfJuQFSEr0
        HsJsf2V5vz3AsA1Ujvub2hzNhwsxSzq5Q2rCBuJ+kJQAt/YVEiapPDhngcP11CB2RXPMwaV+lLEo
        yWOK/PvsA7g9I9usx2zb5NE7Me8F+Cgr+1TZv/LiAWsHPranzPK8kHizACdTkgzIXYKQMKkAF2fX
        P0jxGF+avOvgGqsz8g68mlNRMs8KK05Sdf97fvAg5jh4S877Xq/1AnTl7cZsf86j6G0G3o8p6HoT
        vsfXCzDvJZnuoVOP++KQpRv0egfXOFqn7XIUc6wvTvs025X5iRQfHPdRjEyLS+wqd9VCJ4kc22Ub
        8GKB+l+ntc+anMVv/TLHorcDE091U4bz4UJMFCTp4hngrgKKHlEPwsSuxly4i4/VY6OUonDG84PT
        xHf5pylMOnBXHToN2u0qd1WSLu4CipJy++RGnFg75l30rvf84PZSFB6o8rd1JLyi/3VB5r1ZYL8e
        yyKrrRwXUdITRUyiVQWfOLhGmrEMz5L/bYqL6cIExSYi0G3iqBcL3AfbyUHMic3z8kJBbPZCDVuo
        SZ8aOa5HnSgSWW3luBiIn9V527gIBPtBivcb18U+g6lT8n8v+vt/IdkU3WsxuR2edvwwXYHZekiC
        +ZouUdnf/aNddTc7/q4O4IjnB9dllMI8wGyRNNXYpyaA/yn7Ox+zlZfUKY12TPbZl3MiTEKSDSoV
        om6EiYuEN/U+2FzsiXZ4ftCW02Ju08BvMPE0py7n/bInMeZrn/w4gYfKzzw/OO4qTbc9mngEd8eB
        ZzAB0fN1W6YX8S5sAH6Cu7T/KzFHTR/MoJ+0U/m27xxme/dd4MTl4oesF6jX9qdNjufCe6sUJkuT
        nEfq9ICAqGOy2spxMRBH6rlhbN0fF4Iib6crzgC3Yur5bC1F4cBiW3KlKJwtReExm0r7n4Ht1mvg
        UqD/0uGWzqu48fJMAvdfZKvpRWw1UorCp0tR+H1gDe6C/h7w/GBDTofLHPAm8L1SFG4sReH+xYKa
        S1E4VYrCg6Uo7Ae+h9u0A0utQKyU7yZom8/1mBMSJouvJlscrXjPNED7uPiNeREms1ZQLLcPhJq2
        BUpRGJaicI99mLg8ArkUk+ckbv/eTPwcG3OYFN3fK0XhvlpXvKUoPFGKwqsx5eVdFO171Xqv8sQE
        pijdllrrIpWicMIKlHus7V1QTYmBJHNs1PUCTkiYuKLTwTWmG6SM9R8dXKMjB79jElhVisI9ruIU
        SlE4U4rCe4A7HD10AX4ep66O/exLMe9hClhTisJdrlzwpSh8GbgaGHfQl57M0fg4aoXuKUd2et2K
        ExdcX2Gf6STZLfV6KtchJEwSw8WDcqJB2mcyJ0Iw7sS4Kqly8fZo5k2OxEkLpkptrewg3jH4eVud
        TMBO45itnbgPqoc9P8hDFs3DmHL2s47ttB83R1ZXVrg1mPTCoVHmSiFhEgsX2zj/1SDtc9bBNbI8
        6jkF3JD0sW77IHclTh6oJWOuDab8aUxb3ZRkwjfbDmtiPqyagF0Zj4vTwF0JnhJ6jPj1qgIq20ZN
        soZLmNPAdyFyJ0xcrBAaZbC5ECZ/n9G9zwF32CDexLHixEXWyDZqq/i7k9pP4czZ1f9kCnaaAvpi
        Pnhvy9BrMgv0u/aUXMJGv3JwqUpslGTun3rO8yQkTJzSpAFXMS7iaLKKMdlbisJUEzuVovAw8IqD
        S91bzZttbMmdMb7vGVdxEhXa6QzwRMwxvC2jfvVUGgION4HVlYy9JD2aZxFCwiTXZQeX7wAAEG9J
        REFUD8pGFSZZMEV2QZI7HUzIK6v0CNweY+U7juPkbhWyh3invu7M4ITOhL3vNMTbCPFjvCrZpkmy
        0Ob/0xQqJEwqX23FZVJNl2ueT9LVvsgDZRYTIxCXarZz7o7xPY9lkVHVfmccr0kz8Y9FV8velG0V
        tyxE1iUaFF8iJExELknbQzUF7MvyB9uTOnHzN/ywkjd5frAU6KnxO8ZLUTiQoZ0GYor821K83SwK
        vMXtQ1kLk1mEkDAROSTt1fibOUmBvTfm51dWmNMkjtfgtRzYKU6QZ2+cvC9V8psMvHBnEEJImAjn
        pB0o/HpOfvdB4ruyeyt4zw9jXP9ATuxUK03A+pTu82gGtpks+NhvQggJk4pwsZruVNPlkpFa04K7
        xnptfhPzMpetmGyL9dVaGfZUHnJM2PaKk3StN6VbPZmBeYp+qkUHDYSESU5X8EWmpWD3+0HO7udg
        zM8vVgV7dYxrf5YjO8UJ8rw+hfubTisfziXErRCiAYSJC9obpH1cCJM0heCJnNnvJPE8dIt5Q+II
        kzwVV4tzL10pxJnUc1r1yQSv/R094oSESXoDsa1B2qfTwTX+J8X7PZUn49kVb5x7arGp5heiO+Nx
        4Iq4QZ5JV7D+7zoe40kG9DbKAk5ImMTGxb56o6wEXEwsabnAJ3Na8TnulsnlEq0trRNhEreP9CR8
        f/VcSTzJOKPAxkEJUSiyiNp28aDsbJD26cyJvSvhjzm14WkHbfCNwEub9TSOcPyL5wf10k8VZJlf
        gboEJVoTBaOwWzkp5k/Iku8WYOJLWwBVS9z4hI4GF8cSJgli6/4kmWuoR1YWRaMpg4E44/nBNPHj
        RJaSzRHCNFnq4BrjKd1rXoVJXGG2kACWi/wCimWIL56TitNZWiRDeH6wGtia0OV3ZXG6SxRAmJQN
        xLgT+4p6FiaeH3Q4evilJUxy6S62QnguRl9vl5dgUQKZIBZ/TFCYXFswW6wkXqXuy/GkuloxyOq4
        8OcOrrGiztvGxe+bTjGJV57rciSxSlJWTeGKJFPf92RQBToOS5K6sN02ExImC+Iih8O1dd42qx1c
        4zN1cSFyz+mEr7++QLboTui6SuwpYZLKQOz0/KCzjtvm2pzYudHRlo1ImqTz/xRCmHh+0ERyMTGT
        6mYSJpelFIUjuMlN0FuPjWJPHLnYyjmpLh4bBcuJpOfDqYQfnD/y/KAIcUArgKS2nf6oniZhUgmf
        uBhwddouG4gfwxBKmIiUkJs8Pr9L8Nptdk7JO2sTvPYZdTEJk0o45uAa6wsW2FUpP3ZwjVMpFyHL
        85ZHZwLXnEPMowRe8Tme8PUfaJB5byFG1MWKQ5YnC1wIkwDYBByolwax2zgu9oR/m/Ktt+XUnnHv
        a6GHbtwtnlvryNMwqak0Nket2E1qTu71/KDHbqPncZx2kWwyOMXbSZgsTikKJz0/GHHQGe+uJ2EC
        3I6bvBADKd93Z07tGdeTM1Pl31fKKR1fFGXz4aznBydIdjvj58DGnJrgvgSvPZ7TOl5iAa7I+Pvf
        dbQS6KqjNrnXwTVGSlGYdqn4f8mpPePmRThb5d+nJZhE/fHrhK+/wfODtXn70dZLfGeCX/GJupaE
        STW48nTsrIfG8PxgE26Oy72Zwe135TTyP649JxZY4U4TL6mcUtqLizmMCVpPkpdyOE63sXDpBxcc
        V9eSMKkY68o+4eBSt3l+sKQO2uNRB9eYAw5mcO9N5LNgWNx7mqjx3xajHvqrcDsfzgC/SXoBATyd
        o8VYp6N5byFC3MQzikYRJpbXHD0UdxW5Iay3ZKWDSw3YvAhZsDaHpr0+xmdnFrHlf2QomER98nIK
        3/FTzw/ycnz4JZKttXSsFIWz6lYSJtVyGDenE+70/GBlERvBulZfcHS5vRn+lBtzZtcVxHMRL5b7
        IE6k/w80/YiLKUXhSdI52vqO5wc9GY/PbSSfX+Vd9SoJk1oG4hzwiqPLvWrTGheNnbhx7Y/YiS0r
        VtuqyHkh7rHrxWoNxUkl3lXnJRVE7fwihe9oBt73/GBpFj/Q84Neh4uxhZgl/dOJoh6EieVl3KSo
        76FgWzp21fK4o8s9lYOfdEuOzBs30n8xkTdCvGDFTZqCxCU4SLz4pUppB4bTPqnj+cFq4D2ST1fx
        trZxikkuvAulKJzx/GAv8DMHl3vc84PjGXsOKh2gzcAhR+0wUorCPKwOHvD8YI/1hGVp27XE90Kd
        WKTfhjb3RK2emZ8Ae3LQD3uBJ2v8+L5SFB5EuJwP5zw/eAZ4I4Wvm/ecPAM8nfS4tePyCMnVxLl4
        wSskTGKxB5PDo93Bbzrk+cHVpSjMbQE2u+X0Du5OZzyWk5/WiUkStz/j+4jrhTpdYVKm38YQJitz
        ko3zAWoPEn5O02gi4mS/5wcPk06QdJNdFN7o+cFDpSh0niXVxtHtwpzASeO5M1CKQtXHkTCJPRBn
        PD94CnjVweXagY88P1iT4QmVxXgRd4Ffx0tRmKcjcT/z/OBgyrV6Ll6V9ca8zAeVToCYkwU12wro
        y1AgL6H2LaUQN8f9xaV5CPg0xe9bCfzB84O3gd0uBLNdgN1uFwppHpF/Kmdtea3nB/sL2AfHS1GY
        +uIjb4Gir2NSzK9wcK0u4OO8iRM7UF8AHnR0yTk7geWJTkyuhB0Z2DeIKRTmOVyhoD5rt3NqFUKb
        PD9YneHW464Y88CxrMRnI1CKwpOeHxywD/Y0uQ2TG+o05lTLsWpEip3jVtiF152kn+V4IIc1gZZQ
        zNxFn5CBV7QpZwNxzvODe4A/OLq3Lkxw18Y8uPVsTMkbwGaHl32mFIXjOezQD3t+cKwUhWlnXXzO
        tnsczlQ5sb1GPA/NL+3W42zK/XEl8QKEdRQzebZjtgqzyBS8wr6e9fxgFnN8/o+Yoo0hF9I8NNv7
        6wC+i9l+yqrq+xz52dYWdeIxoRSFI54fPI+7kyqdVpzck2WQnq3n8w5u94xHyFEWx0v0rXc8P7gu
        LeHk+cEtwMMOLlVtSv8BO0nXGh/VhfHy3JWBSK6VGSr0KolY8+G0XawdyfhWmjFbPXnPFfWLnC7U
        RBVckdP7ehK3Zaqb7UPykOcHqa48PD9o8vxgB/CFY1ESAndkffplEdqA99LIbWKPIL7lyK6vV/nw
        CImf2G6L5we70uqT1lZxPEu/0jZOauJkANgnSyzKZI4XaqLowsQ+bPtxk9uknM3Anzw/2JFGISsb
        hPkFJqbE9fc9VJCo8yWYgLqlCdp5M/A+bjyAr9VYIn0f8TMY/9zzg6cT7pNNmADzODlUQmC3ps9U
        2e54sVZvzAF3KW+JhEnS4mQSuMN2OJe0WKHwF88Pdnp+0O7y4p4fBJ4f3OL5wTDwEW6qBV/M66Uo
        fL1A/Ww+kdNW1w9Z+yA/hJs97ZAaA72smHnGwT087vnBe0l49uw13wPitsPeHJ92q0usd6oPN+U7
        6pFnSlF4QmaQMEljMB4luUCmduBZ4K+eH3zk+cG2WmtHeH7QYcXIAeD/YGJJktqLPQHcX8C+1owJ
        8nzfRSVoWwdnGHexSC4euPtwU+dkA/CV5wdbXZVY8Pzgdoz3Lm6a/imUuySr+fAssBGTal1c4Dja
        wqkrmgowGHd7fvBPwLYEbbDWvrDR5+OY6POzdhIoT9TWZh+yHZjA2n8jflK4ShkH+nIeV7IY6+1D
        913g5WqOydqH9FpMIj7X6dxjP3DtqbK7cHOqrA34JfCo5wevAQerTRhovYGbMQnUuhzZ6aEat7qE
        m/nwtOcHGzHe2CZZhHGgv+BzoiiaMLGDcbt1Q6dxnr+ZC8fk8jYA19TJQ6EJk479J54fTGHOyp/G
        1AeZAaYxMTnzxxCXYDxQ1xOvWnDiD1x7quwJjDfOBUswW48veH4wAvze9oUJzNZTua1arGDuAq7F
        fdbQ10tRqJM42c+HJzw/uBXjmW1kcTIF3CShLGGSJXdZ78V9DboqWFOn+/rt8yIlw3s46PKBW4rC
        5zw/uBb3Jd17SCdF+aU4gwnAFPkQJ4etqH+f7HKGZC1K1thYRFFnXFGggThXisL7gecbrI1OFkSU
        nKWY6ckngHsSuO6tuIk3yctDYKNOPORuTjwJrKHxAmLnRYnylUiY5GYw7rQPkkbYUzyIcVUWYeKZ
        w3i1iuRWnU3qgWuveRPG21VkZoEbtDLN7Xx4GlgOnGqQn3wGuFqiRMIkj4PxdeA6vh6UWk/MAY+V
        ovDWIq1S7cPr1oKIxlkr+sYTtMeUXdEWdRKdsqJEVVrzPe6m7Hy4t85/6gCwKs9V40UDCxM7GE/Z
        lcJAnbXJJHBdFhUdHbXLsQKIk3lRcjIFe0wBqyjeNtcExl3eKCvxoouTuVIUbsN46ertwT0HbC9F
        YZ+2EyVMijAYp0tR2IdJxDZdB4NvL/D9oj8MbCBpP/nMtzDvBTiZoj1mgBsKtKI9htzlRR17x4Dv
        A69QH9vdp21f3KPWlTAp2mA8APwrpsprEQfjSYyLclu9rAhsfY/ryNc2xkk7yZ3KwB5FWNHOYo5N
        6whmscfeTCkKHwSuppgB6WBi1bbbeXFErSphUuTBeJ9dLRRle2cEkzDtOhvEVm8T5IidHLNevc0B
        T2G2Js5mbJNjwPcwp8vyVATvMMZb97KmxfoZf6UoXIPx1hXFCztfEPOqUhTuUeI0CZN6GYzjdntn
        OfA2+fSgnLaCZLn1LNTz5Dhbtno7nsEtHLcP3CfzMslZm+y0IvrNjPvocUxMU79O3tTtGDxeisJV
        mEDsozm9zRkr1q+ynmN57CRM6na1cDvwz8ATmGC+LJkFfoVxTV5d74Jkgfa4ARMIejiFh/EJjIfk
        hrzGSpSicKIUhVtsH32e9LZ4ZjHbnsutfU4iGmEMnihF4UbgKowHcSIHt3UCk2bg26Uo3KnikALg
        W430Y22Rvs3AD0kng+YU8AFma+mYrRCaZ/vsB+6s8eOTpSi8qorvasPUu/kJsBqTVj0uE8BvgP1F
        POJqawH1Wrv8O+7q22BFz++y6oueH6yM0cZTWYlLzw9644z/vAcQ2zlxA3AjpuxD0tnAZzGxXr8F
        BvJ09Nfzgy7Sq3tWFGayiPH5VqNa2/ODFvsQWAksxRTj64zTgJhAz88xsSMni3aqIU1hctH3BrYd
        emxbfBdT86VjgYlyzj5o/2xtftrae6LO+mh7mV26gO/YifNy/XTaCuI/W6F2ChipN9uIRPpbeZ2w
        FXYcLqH2lPeztg/+hx2jp4DTihsREibVPyA7LnooXurheLbs4TgNnC1F4XQd/P5MhEkF9zXfBnNK
        rvQN4RKUrc5DWUUk0M/arCBuu2g+7CwTw7Nlc+OMnRO1LSNqQmWzy7AT+wT52HsVF9pFYuTSdtHE
        L9LoZ9MUP0+UKBBXyARCCCGEkDARQgghhJAwEUIIIYSEiRBCCCGEhIkQQgghJEyEEEIIISRMhBBC
        CCFhIoQQQgghYSKEEEIICRMhhBBCCAkTIYQQQkiYCCGEEEJImAghhBBCwkQIIYQQQsJECCGEEBIm
        QgghhBASJkIIIYQQEiZCCCGEkDARQgghhJAwEUIIIYSEiRBCCCGEhIkQQgghhBBCCCGEEEIIIYQQ
        QgghhBBCCCGEEEIIIYQQQgghhBBCCCGEEEIIIYQQQgghhBBCCCGEEEI0OP8fG27L2aBIXd8AAAAA
        SUVORK5CYII=" alt="OpenCL Logo" width="550" height="250">
    </span>
</div>
<div id="header" style="max-width: 100%;">
<h1>The OpenCL<sup>&#8482;</sup> Extension Specification</h1>
<div class="details">
<span id="author" class="author">Khronos<sup>&#174;</sup> OpenCL Working Group</span><br>
<span id="revnumber">version v3.0.14,</span>
<span id="revdate">Mon, 17 Apr 2023 18:00:00 +0000</span>
<br><span id="revremark">from git branch: main commit: 8a5ddd4101834b5e376d286fd1a8c02d5c235e7a</span>
</div>
<div id="toc" class="toc2">
<div id="toctitle">Table of Contents</div>
<ul class="sectlevel1">
<li><a href="#extensions-overview">1. Extensions Overview</a></li>
<li><a href="#cl_khr_icd-opencl">2. Installable Client Drivers</a></li>
<li><a href="#cl_khr_byte_addressable_store">3. Byte Addressable Stores</a></li>
<li><a href="#cl_khr_3d_image_writes">4. Writing to 3D Image Objects</a></li>
<li><a href="#cl_khr_fp16">5. Half Precision Floating-Point</a></li>
<li><a href="#cl_khr_fp64">6. Double Precision Floating-Point</a></li>
<li><a href="#cl_khr_int32_atomics">7. 32-bit Atomics</a></li>
<li><a href="#cl_khr_int64_atomics">8. 64-bit Atomics</a></li>
<li><a href="#cl_khr_select_fprounding_mode">9. Selecting the Rounding Mode <strong>(DEPRECATED)</strong></a></li>
<li><a href="#cl_khr_gl_sharing">10. Creating an OpenCL Context from an OpenGL Context or Share Group</a></li>
<li><a href="#cl_khr_gl_sharing__memobjs">11. Creating OpenCL Memory Objects from OpenGL Objects</a></li>
<li><a href="#cl_khr_gl_event">12. Creating OpenCL Event Objects from OpenGL Sync Objects</a></li>
<li><a href="#cl_khr_d3d10_sharing">13. Creating OpenCL Memory Objects from Direct3D 10 Buffers and Textures</a></li>
<li><a href="#cl_khr_d3d11_sharing">14. Creating OpenCL Memory Objects from Direct3D 11 Buffers and Textures</a></li>
<li><a href="#cl_khr_dx9_media_sharing">15. Creating OpenCL Memory Objects from DirectX 9 Media Surfaces</a></li>
<li><a href="#cl_khr_depth_images">16. Depth Images</a></li>
<li><a href="#cl_khr_gl_depth_images">17. Sharing OpenGL and OpenGL ES Depth and Depth-Stencil Images</a></li>
<li><a href="#cl_khr_gl_msaa_sharing">18. Creating OpenCL Memory Objects from OpenGL MSAA Textures</a></li>
<li><a href="#cl_khr_egl_event">19. Creating OpenCL Event Objects from EGL Sync Objects</a></li>
<li><a href="#cl_khr_egl_image">20. Creating OpenCL Memory Objects from EGL Images</a></li>
<li><a href="#cl_khr_image2d_from_buffer">21. Creating a 2D Image From A Buffer</a></li>
<li><a href="#cl_khr_initialize_memory">22. Local and Private Memory Initialization</a></li>
<li><a href="#cl_khr_terminate_context">23. Terminating OpenCL Contexts</a></li>
<li><a href="#cl_khr_spir">24. Standard Portable Intermediate Representation Binaries</a></li>
<li><a href="#cl_khr_il_program">25. Intermediate Language Programs</a></li>
<li><a href="#cl_khr_create_command_queue">26. Creating Command Queues with Properties</a></li>
<li><a href="#cl_khr_device_enqueue_local_arg_types">27. Device Enqueue Local Argument Types</a></li>
<li><a href="#cl_khr_subgroups">28. Subgroups</a></li>
<li><a href="#cl_khr_mipmap_image">29. Mipmaps</a></li>
<li><a href="#cl_khr_srgb_image_writes">30. sRGB Image Writes</a></li>
<li><a href="#cl_khr_priority_hints">31. Priority Hints</a></li>
<li><a href="#cl_khr_throttle_hints">32. Throttle Hints</a></li>
<li><a href="#cl_khr_subgroup_named_barrier">33. Named Barriers for Subgroups</a></li>
<li><a href="#cl_khr_extended_async_copies">34. Extended Async Copies</a></li>
<li><a href="#cl_khr_async_work_group_copy_fence">35. Async Work Group Copy Fence</a></li>
<li><a href="#cl_khr_device_uuid">36. Unique Device Identifiers</a></li>
<li><a href="#cl_khr_extended_versioning">37. Extended versioning</a></li>
<li><a href="#_extended_subgroup_functions">38. Extended Subgroup Functions</a></li>
<li><a href="#cl_khr_pci_bus_info">39. PCI Bus Information Query</a></li>
<li><a href="#cl_khr_extended_bit_ops">40. Extended Bit Operations</a></li>
<li><a href="#cl_khr_suggested_local_work_size">41. Suggested Local Work Size Query</a></li>
<li><a href="#cl_khr_integer_dot_product">42. Integer dot product</a></li>
<li><a href="#cl_khr_semaphore">43. Semaphores (Provisional)</a></li>
<li><a href="#cl_khr_external_semaphore">44. External Semaphores (Provisional)</a></li>
<li><a href="#cl_khr_external_memory">45. External Memory (Provisional)</a></li>
<li><a href="#cl_khr_command_buffer">46. Command Buffers (Provisional)</a></li>
<li><a href="#cl_khr_expect_assume">47. Kernel Optimization Hints</a></li>
<li><a href="#cl_khr_subgroup_rotate">48. Subgroup Rotation</a></li>
<li><a href="#cl_khr_work_group_uniform_arithmetic">49. Work Group Uniform Arithmetic</a></li>
<li><a href="#cl_khr_command_buffer_mutable_dispatch">50. Command Buffers - Mutable Dispatch (Provisional)</a></li>
<li><a href="#cl_khr_command_buffer_multi_device">51. Command Buffers - Multiple Devices (Provisional)</a></li>
<li><a href="#spirv_extensions">52. Extensions to the OpenCL SPIR-V Environment</a></li>
<li><a href="#_extensions_promoted_to_core_features">Appendix A: Extensions Promoted to Core Features</a></li>
<li><a href="#_deprecated_extensions">Appendix B: Deprecated Extensions</a></li>
<li><a href="#_quick_reference">Appendix C: Quick Reference</a></li>
</ul>
</div>
</div>
<div id="content" style="max-width: 100%;">
<div id="preamble">
<div class="sectionbody">
<div style="page-break-after: always;"></div>
<div class="paragraph">
<p>Copyright 2008-2023 The Khronos Group Inc.</p>
</div>
<div class="paragraph">
<p>This Specification is protected by copyright laws and contains material proprietary to Khronos.
Except as described by these terms, it or any components may not be reproduced, republished,
distributed, transmitted, displayed, broadcast or otherwise exploited in any manner without the
express prior written permission of Khronos.</p>
</div>
<div class="paragraph">
<p>This Specification has been created under the Khronos Intellectual Property Rights
Policy, which is Attachment A of the Khronos Group Membership Agreement available at
www.khronos.org/files/member_agreement.pdf and defines the terms 'Scope', 'Compliant Portion',
and 'Necessary Patent Claims'.</p>
</div>
<div class="paragraph">
<p>Khronos grants a conditional copyright license to use and reproduce the
unmodified Specification for any purpose, without fee or royalty, EXCEPT no licenses
to any patent, trademark or other intellectual property rights are granted under these
terms. Parties desiring to implement the Specification and make use of Khronos trademarks
in relation to that implementation, and receive reciprocal patent license protection under
the Khronos Intellectual Property Rights Policy must become Adopters and confirm the
implementation as conformant under the process defined by Khronos for this Specification;
see <a href="https://www.khronos.org/adopters" class="bare">https://www.khronos.org/adopters</a>.</p>
</div>
<div class="paragraph">
<p>Khronos makes no, and expressly disclaims any, representations or warranties,
express or implied, regarding this Specification, including, without limitation:
merchantability, fitness for a particular purpose, non-infringement of any
intellectual property, correctness, accuracy, completeness, timeliness, and
reliability. Under no circumstances will Khronos, or any of its Promoters,
Contributors or Members, or their respective partners, officers, directors,
employees, agents or representatives be liable for any damages, whether direct,
indirect, special or consequential damages for lost revenues, lost profits, or
otherwise, arising from or in connection with these materials.</p>
</div>
<div class="paragraph">
<p>Where this Specification identifies specific sections of external references, only those
specifically identified sections define normative functionality. The Khronos Intellectual
Property Rights Policy excludes external references to materials and associated enabling
technology not created by Khronos from the Scope of this specification, and any licenses
that may be required to implement such referenced materials and associated technologies
must be obtained separately and may involve royalty payments.</p>
</div>
<div class="paragraph">
<p>Khronos and Vulkan are registered trademarks, and SPIR, SPIR-V, and SYCL are trademarks
of The Khronos Group Inc. OpenCL is a trademark of Apple Inc. used under license by Khronos.
OpenGL is a registered trademark and the OpenGL ES and OpenGL SC logos
are trademarks of Hewlett Packard Enterprise used under license by Khronos.
All other product names, trademarks, and/or company names are used solely for identification
and belong to their respective owners.</p>
</div>
<div style="page-break-after: always;"></div>
</div>
</div>
<div class="sect1">
<h2 id="extensions-overview"><a class="anchor" href="#extensions-overview"></a>1. Extensions Overview</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This document describes the list of optional features supported by OpenCL.
Optional extensions are not required to be supported by a conformant OpenCL
implementation, but are expected to be widely available, and in some cases may define
functionality that is likely to be required in a future revision of the
OpenCL specification.</p>
</div>
<div class="paragraph">
<p>This document describes all extensions that have been approved by the OpenCL
working group.
It is a <em>unified</em> specification, meaning that the extensions described in this
document are not specific to a specific core OpenCL specification version.</p>
</div>
<div class="paragraph">
<p>OpenCL extensions approved by the OpenCL working group may be <em>promoted</em> to
core features in later revisions of OpenCL.
When this occurs, the feature described by the extension specification
is merged into the core OpenCL specification.
The extension will continue to be documented in this specification, both for
backwards compatibility and for devices that wish to support the feature
but that are unable to support the newer core OpenCL version.</p>
</div>
<div class="sect2">
<h3 id="naming-convention-for-optional-extensions"><a class="anchor" href="#naming-convention-for-optional-extensions"></a>1.1. Naming Convention for Optional Extensions</h3>
<div class="paragraph">
<p>OpenCL extensions approved by the OpenCL working group use the following
naming convention:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>A unique <em>name string</em> of the form <code>"<strong>cl_khr_&lt;<em>name</em>&gt;</strong>"</code> is associated
with each extension.
If the extension is supported by an implementation, this string will be
present in the implementation&#8217;s <code>CL_PLATFORM_EXTENSIONS</code> string or
<code>CL_DEVICE_EXTENSIONS</code> string.</p>
</li>
<li>
<p>All API functions defined by the extension will have names of the form
<strong>cl&lt;<em>function_name</em>&gt;KHR</strong>.</p>
</li>
<li>
<p>All enumerants defined by the extension will have names of the form
<strong>CL_&lt;<em>enum_name</em>&gt;_KHR.</strong></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Functions and enumerants defined by extensions that are promoted to
core features will have their <strong>KHR</strong> affix removed.
OpenCL implementations of such later revisions must also export the name
strings of promoted extensions in the <code>CL_PLATFORM_EXTENSIONS</code> or
<code>CL_DEVICE_EXTENSIONS</code> string, and support the <strong>KHR</strong>-affixed versions of
functions and enumerants as a transition aid.</p>
</div>
<div class="paragraph">
<p>Vendor extensions are strongly encouraged to follow a similar naming
convention:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>A unique <em>name string</em> of the form <code>"<strong>cl_&lt;<em>vendor_name</em>&gt;_&lt;<em>name&gt;</em></strong>"</code>
is associated with each extension.
If the extension is supported by an implementation, this string will be
present in the implementation&#8217;s <code>CL_PLATFORM_EXTENSIONS</code> string or
<code>CL_DEVICE_EXTENSIONS</code> string.</p>
</li>
<li>
<p>All API functions defined by the vendor extension will have names of the
form <strong>cl&lt;<em>function_name</em>&gt;&lt;<em>vendor_name</em>&gt;</strong>.</p>
</li>
<li>
<p>All enumerants defined by the vendor extension will have names of the
form <strong>CL_&lt;<em>enum_name</em>&gt;_&lt;<em>vendor_name</em>&gt;.</strong></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="compiler-directives-for-optional-extensions"><a class="anchor" href="#compiler-directives-for-optional-extensions"></a>1.2. Compiler Directives for Optional Extensions</h3>
<div class="paragraph">
<p>The <strong>#pragma OPENCL EXTENSION</strong> directive controls the behavior of the OpenCL
compiler with respect to extensions.
The <strong>#pragma OPENCL EXTENSION</strong> directive is defined as:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="opencl_c"><span class="cp">#pragma OPENCL EXTENSION &lt;extension_name&gt; : &lt;behavior&gt;
#pragma OPENCL EXTENSION all : &lt;behavior&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>where <em>extension_name</em> is the name of the extension.
The <em>extension_name</em> will have names of the form <strong>cl_khr_&lt;<em>name</em>&gt;</strong> for an
extension approved by the OpenCL working group and will have names of the
form <strong>cl_&lt;<em>vendor_name</em>&gt;_&lt;<em>name</em>&gt;</strong> for vendor extensions.
The token <strong>all</strong> means that the behavior applies to all extensions supported
by the compiler.
The <em>behavior</em> can be set to one of the following values given by the table
below.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 25%;">
<col style="width: 75%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><strong>behavior</strong></th>
<th class="tableblock halign-left valign-top"><strong>Description</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>enable</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Behave as specified by the extension <em>extension_name</em>.</p>
<p class="tableblock">  Report an error on the <strong><code>#pragma OPENCL EXTENSION</code></strong> if the
  <em>extension_name</em> is not supported, or if <strong>all</strong> is specified.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>disable</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Behave (including issuing errors and warnings) as if the extension
  <em>extension_name</em> is not part of the language definition.</p>
<p class="tableblock">  If <strong>all</strong> is specified, then behavior must revert back to that of the
  non-extended core version of the language being compiled to.</p>
<p class="tableblock">  Warn on the <strong><code>#pragma OPENCL EXTENSION</code></strong> if the extension <em>extension_name</em>
  is not supported.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>The <strong><code>#pragma OPENCL EXTENSION</code></strong> directive is a simple, low-level mechanism
to set the behavior for each extension.
It does not define policies such as which combinations are appropriate;
those must be defined elsewhere.
The order of directives matter in setting the behavior for each extension.
Directives that occur later override those seen earlier.
The <strong>all</strong> variant sets the behavior for all extensions, overriding all
previously issued extension directives, but only if the <em>behavior</em> is set to
<strong>disable</strong>.</p>
</div>
<div class="paragraph">
<p>The initial state of the compiler is as if the directive</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="opencl_c"><span class="cp">#pragma OPENCL EXTENSION all : disable</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>was issued, telling the compiler that all error and warning reporting must
be done according to this specification, ignoring any extensions.</p>
</div>
<div class="paragraph">
<p>Every extension which affects the OpenCL language semantics, syntax or adds
built-in functions to the language must create a preprocessor <code>#define</code> that
matches the extension name string.
This <code>#define</code> would be available in the language if and only if the
extension is supported on a given implementation.</p>
</div>
<div class="paragraph">
<p><strong>Example</strong>:</p>
</div>
<div class="paragraph">
<p>An extension which adds the extension string <code>"cl_khr_3d_image_writes"</code>
should also add a preprocessor <code>#define</code> called <strong><code>cl_khr_3d_image_writes</code></strong>.
A kernel can now use this preprocessor <code>#define</code> to do something like:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="opencl_c"><span class="cp">#ifdef cl_khr_3d_image_writes
</span>    <span class="c1">// do something using the extension</span>
<span class="cp">#else
</span>    <span class="c1">// do something else or #error!</span>
<span class="cp">#endif</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="getting-opencl-api-extension-function-pointers"><a class="anchor" href="#getting-opencl-api-extension-function-pointers"></a>1.3. Getting OpenCL API Extension Function Pointers</h3>
<div class="paragraph">
<p>The function
</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="opencl"><span class="kt">void</span><span class="o">*</span> <span class="n">clGetExtensionFunctionAddressForPlatform</span><span class="p">(</span><span class="kt">cl_platform_id</span> <span class="n">platform</span><span class="p">,</span>
                                               <span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">funcname</span><span class="p">)</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>returns the address of the extension function named by <em>funcname</em> for a
given <em>platform</em> The pointer returned should be cast to a function pointer
type matching the extension function&#8217;s definition defined in the appropriate
extension specification and header file.
A return value of <code>NULL</code> indicates that the specified function does not
exist for the implementation or <em>platform</em> is not a valid platform.
A non-<code>NULL</code> return value for <strong>clGetExtensionFunctionAddressForPlatform</strong>
does not guarantee that an extension function is actually supported by the
platform.
The application must also make a corresponding query using
<strong>clGetPlatformInfo</strong>(platform, CL_PLATFORM_EXTENSIONS, &#8230;&#8203;) or
<strong>clGetDeviceInfo</strong>(device, CL_DEVICE_EXTENSIONS, &#8230;&#8203;) to determine if an
extension is supported by the OpenCL implementation.</p>
</div>
<div class="paragraph">
<p>Since there is no way to qualify the query with a
device, the function pointer returned must work for all implementations of
that extension on different devices for a platform.
The behavior of calling a device extension function on a device not
supporting that extension is undefined.</p>
</div>
<div class="paragraph">
<p><strong>clGetExtensionFunctionAddressForPlatform</strong> may not be be used to query for core
(non-extension) functions in OpenCL.
For extension functions that may be queried using
<strong>clGetExtensionFunctionAddressForPlatform</strong>, implementations may also choose to
export those functions statically from the object libraries
implementing those functions, however, portable applications cannot rely on
this behavior.</p>
</div>
<div class="paragraph">
<p>Function pointer typedefs must be declared for all extensions that add API
entrypoints.
These typedefs are a required part of the extension interface, to be
provided in an appropriate header (such as cl_ext.h if the extension is an
OpenCL extension, or cl_gl_ext.h if the extension is an OpenCL / OpenGL
sharing extension).</p>
</div>
<div class="paragraph">
<p>The following convention must be followed for all extensions affecting the
host API:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="opencl"><span class="cp">#ifndef extension_name
#define extension_name 1
</span>
<span class="c1">// all data typedefs, token #defines, prototypes, and</span>
<span class="c1">// function pointer typedefs for this extension</span>

<span class="c1">// function pointer typedefs must use the</span>
<span class="c1">// following naming convention</span>

<span class="k">typedef</span> <span class="nf">return_type</span>
            <span class="p">(</span><span class="n">CL_API_CALL</span> <span class="o">*</span><span class="n">clExtensionFunctionNameTAG_fn</span><span class="p">)(...);</span>

<span class="cp">#endif // _extension_name_</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>where <code>TAG</code> can be <code>KHR</code>, <code>EXT</code> or <code>vendor-specific</code>.</p>
</div>
<div class="paragraph">
<p>Consider, for example, the <strong>cl_khr_gl_sharing</strong> extension.
This extension would add the following to cl_gl_ext.h:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="opencl"><span class="cp">#ifndef cl_khr_gl_sharing
#define cl_khr_gl_sharing 1
</span>
<span class="c1">// all data typedefs, token #defines, prototypes, and</span>
<span class="c1">// function pointer typedefs for this extension</span>
<span class="cp">#define CL_INVALID_GL_SHAREGROUP_REFERENCE_KHR  -1000
#define CL_CURRENT_DEVICE_FOR_GL_CONTEXT_KHR    0x2006
#define CL_DEVICES_FOR_GL_CONTEXT_KHR           0x2007
#define CL_GL_CONTEXT_KHR                       0x2008
#define CL_EGL_DISPLAY_KHR                      0x2009
#define CL_GLX_DISPLAY_KHR                      0x200A
#define CL_WGL_HDC_KHR                          0x200B
#define CL_CGL_SHAREGROUP_KHR                   0x200C
</span>
<span class="c1">// function pointer typedefs must use the</span>
<span class="c1">// following naming convention</span>
<span class="k">typedef</span> <span class="nf">cl_int</span>
        <span class="p">(</span><span class="n">CL_API_CALL</span> <span class="o">*</span><span class="n">clGetGLContextInfoKHR_fn</span><span class="p">)(</span>
            <span class="k">const</span> <span class="kt">cl_context_properties</span> <span class="o">*</span> <span class="cm">/* properties */</span><span class="p">,</span>
            <span class="kt">cl_gl_context_info</span> <span class="cm">/* param_name */</span><span class="p">,</span>
            <span class="kt">size_t</span> <span class="cm">/* param_value_size */</span><span class="p">,</span>
            <span class="kt">void</span> <span class="o">*</span> <span class="cm">/* param_value */</span><span class="p">,</span>
            <span class="kt">size_t</span> <span class="o">*</span> <span class="cm">/*param_value_size_ret*/</span><span class="p">);</span>

<span class="cp">#endif // cl_khr_gl_sharing</span></code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="cl_khr_icd-opencl"><a class="anchor" href="#cl_khr_icd-opencl"></a>2. Installable Client Drivers</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="cl_khr_icd-overview"><a class="anchor" href="#cl_khr_icd-overview"></a>2.1. Overview</h3>
<div class="paragraph">
<p>This section describes a platform extension which defines a simple mechanism
through which the Khronos OpenCL installable client driver loader (ICD
Loader) may expose multiple separate vendor installable client drivers
(Vendor ICDs) for OpenCL.
An application written against the ICD Loader will be able to access all
<code>cl_platform_<wbr>id</code>s exposed by all vendor implementations with the ICD Loader
acting as a demultiplexor.</p>
</div>
<div class="paragraph">
<p>This is a platform extension, so if this extension is supported by an
implementation, the string <strong>cl_khr_icd</strong> will be present in the
<code>CL_PLATFORM_<wbr>EXTENSIONS</code> string.</p>
</div>
</div>
<div class="sect2">
<h3 id="_general_information"><a class="anchor" href="#_general_information"></a>2.2. General information</h3>
<div class="sect3">
<h4 id="_version_history"><a class="anchor" href="#_version_history"></a>2.2.1. Version history</h4>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 60%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><strong>Date</strong></th>
<th class="tableblock halign-left valign-top"><strong>Version</strong></th>
<th class="tableblock halign-left valign-top"><strong>Description</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">2020-04-21</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.0.0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">First assigned version.</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect2">
<h3 id="cl_khr_icd-inferring-vendors-from-function-call-arguments"><a class="anchor" href="#cl_khr_icd-inferring-vendors-from-function-call-arguments"></a>2.3. Inferring Vendors from Function Call Arguments</h3>
<div class="paragraph">
<p>At every OpenCL function call, the ICD Loader infers the vendor ICD function
to call from the arguments to the function.
An object is said to be ICD compatible if it is of the following structure:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="opencl"><span class="k">struct</span> <span class="nc">_cl_</span><span class="o">&lt;</span><span class="n">object</span><span class="o">&gt;</span>
<span class="p">{</span>
    <span class="k">struct</span> <span class="nc">_cl_icd_dispatch</span> <span class="o">*</span><span class="n">dispatch</span><span class="p">;</span>
    <span class="c1">// ... remainder of internal data</span>
<span class="p">};</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>&lt;object&gt; is one of platform_id, device_id, context, command_queue, mem,
program, kernel, event, or sampler.</p>
</div>
<div class="paragraph">
<p>The structure <code>_cl_icd_dispatch</code> is a function pointer dispatch table which
is used to direct calls to a particular vendor implementation.
All objects created from ICD compatible objects must be ICD compatible.</p>
</div>
<div class="paragraph">
<p>The definition for <code>_cl_icd_dispatch</code> is provided along with the OpenCL
headers. Existing members can never be removed from that structure but new
members can be appended.</p>
</div>
<div class="paragraph">
<p>Functions which do not have an argument from which the vendor implementation
may be inferred have been deprecated and may be ignored.</p>
</div>
</div>
<div class="sect2">
<h3 id="cl_khr_icd-icd-data"><a class="anchor" href="#cl_khr_icd-icd-data"></a>2.4. ICD Data</h3>
<div class="paragraph">
<p>A Vendor ICD is defined by two pieces of data:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The Vendor ICD library specifies a library which contains the OpenCL
entry points for the vendor&#8217;s OpenCL implementation.
The vendor ICD&#8217;s library file name should include the vendor name, or a
vendor-specific implementation identifier.</p>
</li>
<li>
<p>The Vendor ICD extension suffix is a short string which specifies the
default suffix for extensions implemented only by that vendor.
The vendor suffix string is optional.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="cl_khr_icd-icd-loader-vendor-enumeration-on-windows"><a class="anchor" href="#cl_khr_icd-icd-loader-vendor-enumeration-on-windows"></a>2.5. ICD Loader Vendor Enumeration on Windows</h3>
<div class="paragraph">
<p>To enumerate Vendor ICDs on Windows, the ICD Loader will first
scan for REG_SZ string values in the "Display Adapter" and
"Software Components" HKR registry keys.  The exact registry
keys to scan should be obtained via PnP Configuration Manager
APIs, but will look like:</p>
</div>
<div class="paragraph">
<p>For 64-bit ICDs:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>HKLM\SYSTEM\CurrentControlSet\Control\Class\
{Display Adapter GUID}\{Instance ID}\OpenCLDriverName, or

HKLM\SYSTEM\CurrentControlSet\Control\Class\
{Software Component GUID}\{Instance ID}\OpenCLDriverName</pre>
</div>
</div>
<div class="paragraph">
<p>For 32-bit ICDs:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>HKLM\SYSTEM\CurrentControlSet\Control\Class\
{Display Adapter GUID}\{Instance ID}\OpenCLDriverNameWoW, or

HKLM\SYSTEM\CurrentControlSet\Control\Class\
{Software Component GUID}\{Instance ID}\OpenCLDriverNameWoW</pre>
</div>
</div>
<div class="paragraph">
<p>These registry values contain the path to the Vendor ICD library.
For example, if the registry contains the value:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>[HKLM\SYSTEM\CurrentControlSet\Control\Class\{GUID}\{Instance}]
"OpenCLDriverName"="c:\\vendor a\\vndra_ocl.dll"</pre>
</div>
</div>
<div class="paragraph">
<p>Then the ICD Loader will open the Vendor ICD library:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>c:\vendor a\vndra_ocl.dll</pre>
</div>
</div>
<div class="paragraph">
<p>The ICD Loader will also scan for REG_DWORD values in the registry
key:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>HKLM\SOFTWARE\Khronos\OpenCL\Vendors</pre>
</div>
</div>
<div class="paragraph">
<p>For each registry value in this key which has data set to 0, the
ICD Loader will open the Vendor ICD library specified by the name
of the registry value.</p>
</div>
<div class="paragraph">
<p>For example, if the registry contains the value:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>[HKLM\SOFTWARE\Khronos\OpenCL\Vendors]
"c:\\vendor a\\vndra_ocl.dll"=dword:00000000</pre>
</div>
</div>
<div class="paragraph">
<p>Then the ICD Loader will open the Vendor ICD library:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>c:\vendor a\vndra_ocl.dll</pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="cl_khr_icd-icd-loader-vendor-enumeration-on-linux"><a class="anchor" href="#cl_khr_icd-icd-loader-vendor-enumeration-on-linux"></a>2.6. ICD Loader Vendor Enumeration on Linux</h3>
<div class="paragraph">
<p>To enumerate vendor ICDs on Linux, the ICD Loader scans the files in the
path <code>/etc/OpenCL/vendors</code>.
For each file in this path, the ICD Loader opens the file as a text file.
The expected format for the file is a single line of text which specifies
the Vendor ICD&#8217;s library.
The ICD Loader will attempt to open that file as a shared object using
dlopen().
Note that the library specified may be an absolute path or just a file name.</p>
</div>
<div class="paragraph">
<p>For example, if the following file exists</p>
</div>
<div class="literalblock">
<div class="content">
<pre>/etc/OpenCL/vendors/VendorA.icd</pre>
</div>
</div>
<div class="paragraph">
<p>and contains the text</p>
</div>
<div class="literalblock">
<div class="content">
<pre>libVendorAOpenCL.so</pre>
</div>
</div>
<div class="paragraph">
<p>then the ICD Loader will load the library <code>libVendorAOpenCL.so</code>.</p>
</div>
</div>
<div class="sect2">
<h3 id="cl_khr_icd-icd-loader-vendor-enumeration-on-android"><a class="anchor" href="#cl_khr_icd-icd-loader-vendor-enumeration-on-android"></a>2.7. ICD Loader Vendor Enumeration on Android</h3>
<div class="paragraph">
<p>To enumerate vendor ICDs on Android, the ICD Loader scans the files in the
path <code>/system/vendor/Khronos/OpenCL/vendors</code>.
For each file in this path, the ICD Loader opens the file as a text file.
The expected format for the file is a single line of text which specifies
the Vendor ICD&#8217;s library.
The ICD Loader will attempt to open that file as a shared object using
dlopen().
Note that the library specified may be an absolute path or just a file name.</p>
</div>
<div class="paragraph">
<p>For example, if the following file exists</p>
</div>
<div class="literalblock">
<div class="content">
<pre>/system/vendor/Khronos/OpenCL/vendors/VendorA.icd</pre>
</div>
</div>
<div class="paragraph">
<p>and contains the text</p>
</div>
<div class="literalblock">
<div class="content">
<pre>libVendorAOpenCL.so</pre>
</div>
</div>
<div class="paragraph">
<p>then the ICD Loader will load the library <code>libVendorAOpenCL.so</code>.</p>
</div>
</div>
<div class="sect2">
<h3 id="cl_khr_icd-adding-a-vendor-library"><a class="anchor" href="#cl_khr_icd-adding-a-vendor-library"></a>2.8. Adding a Vendor Library</h3>
<div class="paragraph">
<p>Upon successfully loading a Vendor ICD&#8217;s library, the ICD Loader queries the
following functions from the library: <strong>clIcdGetPlatformIDsKHR</strong>,
<strong>clGetPlatformInfo</strong>, and <strong>clGetExtensionFunctionAddress</strong> (note:
<strong>clGetExtensionFunctionAddress</strong> has been deprecated, but is still required
for the ICD Loader).
If any of these functions are not present then the ICD Loader will close and
ignore the library.</p>
</div>
<div class="paragraph">
<p>Next the ICD Loader queries available ICD-enabled platforms in the library
using <strong>clIcdGetPlatformIDsKHR</strong>.
For each of these platforms, the ICD Loader queries the platform&#8217;s extension
string to verify that <strong>cl_khr_icd</strong> is supported, then queries the platform&#8217;s
Vendor ICD extension suffix using <strong>clGetPlatformInfo</strong> with the value
<code>CL_PLATFORM_<wbr>ICD_<wbr>SUFFIX_<wbr>KHR</code>.</p>
</div>
<div class="paragraph">
<p>If any of these steps fail, the ICD Loader will ignore the Vendor ICD and
continue on to the next.</p>
</div>
</div>
<div class="sect2">
<h3 id="cl_khr_icd-new-procedures-and-functions"><a class="anchor" href="#cl_khr_icd-new-procedures-and-functions"></a>2.9. New Procedures and Functions</h3>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="opencl"><span class="kt">cl_int</span> <span class="nf">clIcdGetPlatformIDsKHR</span><span class="p">(</span><span class="kt">cl_uint</span> <span class="n">num_entries</span><span class="p">,</span>
                              <span class="kt">cl_platform_id</span> <span class="o">*</span><span class="n">platforms</span><span class="p">,</span>
                              <span class="kt">cl_uint</span> <span class="o">*</span><span class="n">num_platforms</span><span class="p">);</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="cl_khr_icd-new-tokens"><a class="anchor" href="#cl_khr_icd-new-tokens"></a>2.10. New Tokens</h3>
<div class="paragraph">
<p>Accepted as <em>param_name</em> to the function <strong>clGetPlatformInfo</strong>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="opencl"><span class="n">CL_PLATFORM_ICD_SUFFIX_KHR</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Returned by <strong>clGetPlatformIDs</strong> when no platforms are found:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="opencl"><span class="n">CL_PLATFORM_NOT_FOUND_KHR</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="cl_khr_icd-additions-to-chapter-4"><a class="anchor" href="#cl_khr_icd-additions-to-chapter-4"></a>2.11. Additions to Chapter 4 of the OpenCL 2.2 Specification</h3>
<div class="paragraph">
<p>In <em>section 4.1</em>, replace the description of the return values of
<strong>clGetPlatformIDs</strong> with:</p>
</div>
<div class="paragraph">
<p>"<strong>clGetPlatformIDs</strong> returns <code>CL_SUCCESS</code> if the function is executed
successfully and there are a non zero number of platforms available.
It returns <code>CL_PLATFORM_<wbr>NOT_<wbr>FOUND_<wbr>KHR</code> if zero platforms are available.
It returns <code>CL_INVALID_<wbr>VALUE</code> if <em>num_entries</em> is equal to zero and
<em>platforms</em> is not <code>NULL</code> or if both <em>num_platforms</em> and <em>platforms</em> are
<code>NULL</code>."</p>
</div>
<div class="paragraph">
<p>In <em>section 4.1</em>, add the following after the description of
<strong>clGetPlatformIDs</strong>:</p>
</div>
<div class="paragraph">
<p>"The list of platforms accessible through the Khronos ICD Loader can be
obtained using the following function:</p>
</div>
<div id="clIcdGetPlatformIDsKHR" class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="opencl"><span class="kt">cl_int</span> <span class="nf">clIcdGetPlatformIDsKHR</span><span class="p">(</span>
    <span class="kt">cl_uint</span> <span class="n">num_entries</span><span class="p">,</span>
    <span class="kt">cl_platform_id</span><span class="o">*</span> <span class="n">platforms</span><span class="p">,</span>
    <span class="kt">cl_uint</span><span class="o">*</span> <span class="n">num_platforms</span><span class="p">);</span></code></pre>
</div>
</div>
<div class="paragraph">
<p><em>num_entries</em> is the number of <code>cl_platform_<wbr>id</code> entries that can be added to
<em>platforms</em>.
If <em>platforms</em> is not <code>NULL</code>, then <em>num_entries</em> must be greater than zero.</p>
</div>
<div class="paragraph">
<p><em>platforms</em> returns a list of OpenCL platforms available for access through
the Khronos ICD Loader.
The <code>cl_platform_<wbr>id</code> values returned in <em>platforms</em> are ICD compatible and can
be used to identify a specific OpenCL platform.
If the <em>platforms</em> argument is <code>NULL</code>, then this argument is ignored.
The number of OpenCL platforms returned is the minimum of the value
specified by <em>num_entries</em> or the number of OpenCL platforms available.</p>
</div>
<div class="paragraph">
<p><em>num_platforms</em> returns the number of OpenCL platforms available.
If <em>num_platforms</em> is <code>NULL</code>, then this argument is ignored.</p>
</div>
<div class="paragraph">
<p><strong>clIcdGetPlatformIDsKHR</strong> returns <code>CL_SUCCESS</code> if the function is executed
successfully and there are a non zero number of platforms available.
It returns <code>CL_PLATFORM_<wbr>NOT_<wbr>FOUND_<wbr>KHR</code> if zero platforms are available.
It returns <code>CL_INVALID_<wbr>VALUE</code> if <em>num_entries</em> is equal to zero and
<em>platforms</em> is not <code>NULL</code> or if both <em>num_platforms</em> and <em>platforms</em> are
<code>NULL</code>."</p>
</div>
<div class="paragraph">
<p>Add the following to <em>table 4.1</em>:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 40%;">
<col style="width: 20%;">
<col style="width: 40%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Platform Info</th>
<th class="tableblock halign-left valign-top">Return Type</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CL_PLATFORM_<wbr>ICD_<wbr>SUFFIX_<wbr>KHR</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>char</code>[]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The function name suffix used to identify extension functions to be
  directed to this platform by the ICD Loader.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="cl_khr_icd-source-code"><a class="anchor" href="#cl_khr_icd-source-code"></a>2.12. Source Code</h3>
<div class="paragraph">
<p>The official source for the ICD Loader is available on github, at:</p>
</div>
<div class="paragraph">
<p><a href="https://github.com/KhronosGroup/OpenCL-ICD-Loader" class="bare">https://github.com/KhronosGroup/OpenCL-ICD-Loader</a></p>
</div>
<div class="paragraph">
<p>The complete <code>_cl_icd_dispatch</code> structure is defined in the header
<strong>cl_icd.h</strong>, which is available as a part of the OpenCL headers.</p>
</div>
</div>
<div class="sect2">
<h3 id="cl_khr_icd-issues"><a class="anchor" href="#cl_khr_icd-issues"></a>2.13. Issues</h3>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Some OpenCL functions do not take an object argument from which their
vendor library may be identified (e.g, <strong>clUnloadCompiler</strong>), how will they
be handled?</p>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>RESOLVED: Such functions will be a noop for all calls through the ICD Loader.</p>
</div>
</div>
</div>
</li>
<li>
<p>How are OpenCL extension to be handled?</p>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>RESOLVED: Extension APIs must be queried using
<strong>clGetExtensionFunctionAddressForPlatform</strong>.</p>
</div>
</div>
</div>
</li>
<li>
<p>How will the ICD Loader handle a <code>NULL</code> <code>cl_platform_<wbr>id</code>?</p>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>RESOLVED: The ICD will by default choose the first enumerated platform as
the <code>NULL</code> platform.</p>
</div>
</div>
</div>
</li>
<li>
<p>There exists no mechanism to unload the ICD Loader, should there be one?</p>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>RESOLVED: As there is no standard mechanism for unloading a vendor
implementation, do not add one for the ICD Loader.</p>
</div>
</div>
</div>
</li>
<li>
<p>How will the ICD Loader handle <code>NULL</code> objects passed to the OpenCL
functions?</p>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>RESOLVED: The ICD Loader will check for <code>NULL</code> objects passed to the OpenCL
functions without trying to dereference the <code>NULL</code> objects for obtaining the
ICD dispatch table.
On detecting a <code>NULL</code> object it will return one of the an invalid object error
values (e.g. <code>CL_INVALID_<wbr>DEVICE</code> corresponding to the object in question.</p>
</div>
</div>
</div>
</li>
</ol>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="cl_khr_byte_addressable_store"><a class="anchor" href="#cl_khr_byte_addressable_store"></a>3. Byte Addressable Stores</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This section describes the <strong>cl_khr_byte_addressable_store</strong> extension.
This extension relaxes restrictions on pointers to <code>char</code>, <code>uchar</code>, <code>char2</code>, <code>uchar2</code>, <code>short</code>, <code>ushort</code> and <code>half</code> that were present in <em>Section 6.8m: Restrictions</em> of the OpenCL 1.0 specification.
With this extension, applications are able to read from and write to pointers to these types.</p>
</div>
<div class="paragraph">
<p>This extension became a core feature in OpenCL 1.1.</p>
</div>
<div class="sect2">
<h3 id="_general_information_2"><a class="anchor" href="#_general_information_2"></a>3.1. General information</h3>
<div class="sect3">
<h4 id="_version_history_2"><a class="anchor" href="#_version_history_2"></a>3.1.1. Version history</h4>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 60%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><strong>Date</strong></th>
<th class="tableblock halign-left valign-top"><strong>Version</strong></th>
<th class="tableblock halign-left valign-top"><strong>Description</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">2020-04-21</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.0.0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">First assigned version.</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="cl_khr_3d_image_writes"><a class="anchor" href="#cl_khr_3d_image_writes"></a>4. Writing to 3D Image Objects</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This section describes the <strong>cl_khr_3d_image_writes</strong> extension.</p>
</div>
<div class="paragraph">
<p>This extension adds built-in functions that allow a kernel to write to 3D image objects in addition to 2D image objects.</p>
</div>
<div class="paragraph">
<p>This extension became a core feature in OpenCL 2.0.</p>
</div>
<div class="sect2">
<h3 id="_general_information_3"><a class="anchor" href="#_general_information_3"></a>4.1. General information</h3>
<div class="sect3">
<h4 id="_version_history_3"><a class="anchor" href="#_version_history_3"></a>4.1.1. Version history</h4>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 60%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><strong>Date</strong></th>
<th class="tableblock halign-left valign-top"><strong>Version</strong></th>
<th class="tableblock halign-left valign-top"><strong>Description</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">2020-04-21</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.0.0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">First assigned version.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>The new built-in functions are described in the table below:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 1. <em>3D Image Built-in Image Write Functions</em></caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><strong>Function</strong></th>
<th class="tableblock halign-left valign-top"><strong>Description</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">void <strong>write_imagef</strong> (<br>
image3d_t <em>image</em>,<br>
int4 <em>coord</em>,<br>
float4 <em>color</em>)<br>
<br>
void <strong>write_imagei</strong> (<br>
image3d_t <em>image</em>,<br>
int4 <em>coord</em>,<br>
int4 <em>color</em>)<br>
<br>
void <strong>write_imageui</strong> (<br>
image3d_t <em>image</em>,<br>
int4 <em>coord</em>,<br>
uint4 <em>color</em>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Write <em>color</em> value to the location specified by coordinate (<em>x</em>, <em>y</em>, <em>z</em>) in the 3D image specified by <em>image</em>.
The appropriate data format conversion to the specified image format is done before writing the color value.
<em>coord.x</em>, <em>coord.y</em>, and <em>coord.z</em> are considered to be unnormalized coordinates and must be in the range 0 &#8230;&#8203; image width - 1, 0 &#8230;&#8203; image height - 1, and 0 &#8230;&#8203; image depth - 1.<br>
<br>
<strong>write_imagef</strong> can only be used with image objects created with <em>image_channel_data_type</em> set to one of the pre-defined packed formats or set to <code>CL_SNORM_<wbr>INT8</code>, <code>CL_UNORM_<wbr>INT8</code>, <code>CL_SNORM_<wbr>INT16</code>, <code>CL_UNORM_<wbr>INT16</code>, <code>CL_HALF_<wbr>FLOAT</code>, or <code>CL_FLOAT</code>.  Appropriate data format conversion will be done to convert the channel data from a floating-point value to the actual data format in which the channels are stored.<br>
<br>
<strong>write_imagei</strong> can only be used with image objects created with <em>image_channel_data_type</em> set to one of the following values:<br>
<code>CL_SIGNED_<wbr>INT8</code>,<br>
<code>CL_SIGNED_<wbr>INT16</code>, or<br>
<code>CL_SIGNED_<wbr>INT32</code>.<br>
<br>
<strong>write_imageui</strong> can only be used with image objects created with <em>image_channel_data_type</em> set to one of the following values:<br>
<code>CL_UNSIGNED_<wbr>INT8</code>,<br>
<code>CL_UNSIGNED_<wbr>INT16</code>, or<br>
<code>CL_UNSIGNED_<wbr>INT32</code>.<br>
<br>
The behavior of <strong>write_imagef</strong>, <strong>write_imagei</strong>, and <strong>write_imageui</strong> for image objects created with <em>image_channel_data_type</em> values not specified in the description above, or with (<em>x</em>, <em>y</em>, <em>z</em>) coordinate values that are not in the range (0 &#8230;&#8203; image width - 1, 0 &#8230;&#8203; image height - 1, 0 &#8230;&#8203; image depth - 1) respectively, is undefined.</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="cl_khr_fp16"><a class="anchor" href="#cl_khr_fp16"></a>5. Half Precision Floating-Point</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This section describes the <strong>cl_khr_fp16</strong> extension.
This extension adds support for half scalar and vector types as built-in
types that can be used for arithmetic operations, conversions etc.</p>
</div>
<div class="sect2">
<h3 id="_general_information_4"><a class="anchor" href="#_general_information_4"></a>5.1. General information</h3>
<div class="sect3">
<h4 id="_version_history_4"><a class="anchor" href="#_version_history_4"></a>5.1.1. Version history</h4>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 60%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><strong>Date</strong></th>
<th class="tableblock halign-left valign-top"><strong>Version</strong></th>
<th class="tableblock halign-left valign-top"><strong>Description</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">2020-04-21</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.0.0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">First assigned version.</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect2">
<h3 id="cl_khr_fp16-additions-to-chapter-6-of-the-opencl-2.0-specification"><a class="anchor" href="#cl_khr_fp16-additions-to-chapter-6-of-the-opencl-2.0-specification"></a>5.2. Additions to Chapter 6 of the OpenCL 2.0 C Specification</h3>
<div class="paragraph">
<p>The list of built-in scalar, and vector data types defined in <em>tables 6.1</em>,
and <em>6.2</em> are extended to include the following:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 25%;">
<col style="width: 75%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><strong>Type</strong></th>
<th class="tableblock halign-left valign-top"><strong>Description</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>half2</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A 2-component half-precision floating-point vector.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>half3</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A 3-component half-precision floating-point vector.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>half4</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A 4-component half-precision floating-point vector.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>half8</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A 8-component half-precision floating-point vector.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>half16</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A 16-component half-precision floating-point vector.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>The built-in vector data types for <code>halfn</code> are also declared as appropriate
types in the OpenCL API (and header files) that can be used by an
application.
The following table describes the built-in vector data types for <code>halfn</code> as
defined in the OpenCL C programming language and the corresponding data type
available to the application:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><strong>Type in OpenCL Language</strong></th>
<th class="tableblock halign-left valign-top"><strong>API type for application</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>half2</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>cl_half2</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>half3</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>cl_half3</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>half4</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>cl_half4</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>half8</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>cl_half8</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>half16</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>cl_half16</strong></p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>The relational, equality, logical and logical unary operators described in
<em>section 6.3</em> can be used with <code>half</code> scalar and <code>halfn</code> vector types and
shall produce a scalar <code>int</code> and vector <code>shortn</code> result respectively.</p>
</div>
<div class="paragraph">
<p>The OpenCL compiler accepts an h and H suffix on floating point literals,
indicating the literal is typed as a half.</p>
</div>
<div class="sect3">
<h4 id="cl_khr_fp16-conversions"><a class="anchor" href="#cl_khr_fp16-conversions"></a>5.2.1. Conversions</h4>
<div class="paragraph">
<p>The implicit conversion rules specified in <em>section 6.2.1</em> now include the
<code>half</code> scalar and <code>halfn</code> vector data types.</p>
</div>
<div class="paragraph">
<p>The explicit casts described in <em>section 6.2.2</em> are extended to take a
<code>half</code> scalar data type and a <code>halfn</code> vector data type.</p>
</div>
<div class="paragraph">
<p>The explicit conversion functions described in <em>section 6.2.3</em> are extended
to take a <code>half</code> scalar data type and a <code>halfn</code> vector data type.</p>
</div>
<div class="paragraph">
<p>The <code>as_typen()</code> function for re-interpreting types as described in <em>section
6.2.4.2</em> is extended to allow conversion-free casts between <code>shortn</code>,
<code>ushortn</code>, and <code>halfn</code> scalar and vector data types.</p>
</div>
</div>
<div class="sect3">
<h4 id="cl_khr_fp16-math-functions"><a class="anchor" href="#cl_khr_fp16-math-functions"></a>5.2.2. Math Functions</h4>
<div class="paragraph">
<p>The built-in math functions defined in <em>table 6.8</em> (also listed below) are
extended to include appropriate versions of functions that take <code>half</code> and
<code>half{2|3|4|8|16}</code> as arguments and return values.
<code>gentype</code> now also includes <code>half</code>, <code>half2</code>, <code>half3</code>, <code>half4</code>, <code>half8</code>, and
<code>half16</code>.</p>
</div>
<div class="paragraph">
<p>For any specific use of a function, the actual type has to be the same for
all arguments and the return type.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 2. <em>Half Precision Built-in Math Functions</em></caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><strong>Function</strong></th>
<th class="tableblock halign-left valign-top"><strong>Description</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">gentype <strong>acos</strong> (gentype <em>x</em>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Arc cosine function.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">gentype <strong>acosh</strong> (gentype <em>x</em>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Inverse hyperbolic cosine.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">gentype <strong>acospi</strong> (gentype <em>x</em>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Compute <strong>acos</strong> (<em>x</em>) / .</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">gentype <strong>asin</strong> (gentype <em>x</em>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Arc sine function.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">gentype <strong>asinh</strong> (gentype <em>x</em>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Inverse hyperbolic sine.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">gentype <strong>asinpi</strong> (gentype <em>x</em>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Compute <strong>asin</strong> (<em>x</em>) / .</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">gentype <strong>atan</strong> (gentype <em>y_over_x</em>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Arc tangent function.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">gentype <strong>atan2</strong> (gentype <em>y</em>, gentype <em>x</em>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Arc tangent of <em>y</em> / <em>x</em>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">gentype <strong>atanh</strong> (gentype <em>x</em>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Hyperbolic arc tangent.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">gentype <strong>atanpi</strong> (gentype <em>x</em>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Compute <strong>atan</strong> (<em>x</em>) / .</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">gentype <strong>atan2pi</strong> (gentype <em>y</em>, gentype <em>x</em>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Compute <strong>atan2</strong> (<em>y</em>, <em>x</em>) / .</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">gentype <strong>cbrt</strong> (gentype <em>x</em>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Compute cube-root.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">gentype <strong>ceil</strong> (gentype <em>x</em>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Round to integral value using the round to positive infinity rounding
  mode.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">gentype <strong>copysign</strong> (gentype <em>x</em>, gentype <em>y</em>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Returns <em>x</em> with its sign changed to match the sign of <em>y</em>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">gentype <strong>cos</strong> (gentype <em>x</em>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Compute cosine.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">gentype <strong>cosh</strong> (gentype <em>x</em>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Compute hyperbolic cosine.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">gentype <strong>cospi</strong> (gentype <em>x</em>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Compute <strong>cos</strong> ( <em>x</em>).</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">gentype <strong>erfc</strong> (gentype <em>x</em>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Complementary error function.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">gentype <strong>erf</strong> (gentype <em>x</em>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Error function encountered in integrating the normal distribution.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">gentype <strong>exp</strong> (gentype <em>x</em>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Compute the base- e exponential of <em>x</em>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">gentype <strong>exp2</strong> (gentype <em>x</em>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Exponential base 2 function.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">gentype <strong>exp10</strong> (gentype <em>x</em>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Exponential base 10 function.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">gentype <strong>expm1</strong> (gentype <em>x</em>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Compute <em>e<sup>x</sup></em>- 1.0.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">gentype <strong>fabs</strong> (gentype <em>x</em>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Compute absolute value of a floating-point number.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">gentype <strong>fdim</strong> (gentype <em>x</em>, gentype <em>y</em>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>x</em> - <em>y</em> if <em>x</em> &gt; <em>y</em>, +0 if x is less than or equal to y.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">gentype <strong>floor</strong> (gentype <em>x</em>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Round to integral value using the round to negative infinity rounding
  mode.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">gentype <strong>fma</strong> (gentype <em>a</em>, gentype <em>b</em>, gentype <em>c</em>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Returns the correctly rounded floating-point representation of the sum of
  <em>c</em> with the infinitely precise product of <em>a</em> and <em>b</em>.
  Rounding of intermediate products shall not occur.
  Edge case behavior is per the IEEE 754-2008 standard.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">gentype <strong>fmax</strong> (gentype <em>x</em>, gentype <em>y</em>)<br>
  gentype <strong>fmax</strong> (gentype <em>x</em>, half <em>y</em>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Returns <em>y</em> if <em>x</em> &lt; <em>y</em>, otherwise it returns <em>x</em>.
  If one argument is a NaN, <strong>fmax()</strong> returns the other argument.
  If both arguments are NaNs, <strong>fmax()</strong> returns a NaN.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">gentype <strong>fmin</strong> (gentype <em>x</em>, gentype <em>y</em>)<br>
  gentype <strong>fmin</strong> (gentype <em>x</em>, half <em>y</em>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Returns <em>y</em> if <em>y</em> &lt; <em>x</em>, otherwise it returns <em>x</em>.
  If one argument is a NaN, <strong>fmin()</strong> returns the other argument.
  If both arguments are NaNs, <strong>fmin()</strong> returns a NaN.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">gentype <strong>fmod</strong> (gentype <em>x</em>, gentype <em>y</em>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Modulus.
  Returns <em>x</em> - <em>y</em> * <strong>trunc</strong> (<em>x</em>/<em>y</em>) .</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">gentype <strong>fract</strong> (gentype <em>x</em>, __global gentype *<em>iptr</em>)<br>
  gentype <strong>fract</strong> (gentype <em>x</em>, __local gentype *<em>iptr</em>)<br>
  gentype <strong>fract</strong> (gentype <em>x</em>, __private gentype *<em>iptr</em>)<br></p>
<p class="tableblock">  For OpenCL C 2.0 or with the <code>__opencl_c_generic_address_space</code>
  feature macro:<br></p>
<p class="tableblock">  gentype <strong>fract</strong> (gentype <em>x</em>, gentype *<em>iptr</em>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Returns <strong>fmin</strong>( <em>x</em> - <strong>floor</strong> (<em>x</em>), 0x1.ffcp-1f ).</p>
<p class="tableblock">  <strong>floor</strong>(x) is returned in <em>iptr</em>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">half<em>n</em> <strong>frexp</strong> (half<em>n x</em>, __global int<em>n</em> *exp)<br>
  half <strong>frexp</strong> (half <em>x</em>, __global int *exp)<br></p>
<p class="tableblock">  half<em>n</em> <strong>frexp</strong> (half<em>n x</em>, __local int<em>n</em> *exp)<br>
  half <strong>frexp</strong> (half <em>x</em>, __local int *exp)<br></p>
<p class="tableblock">  half<em>n</em> <strong>frexp</strong> (half<em>n x</em>, __private int<em>n</em> *exp)<br>
  half <strong>frexp</strong> (half <em>x</em>, __private int *exp)<br></p>
<p class="tableblock">  For OpenCL C 2.0 or with the <code>__opencl_c_generic_address_space</code>
  feature macro:<br></p>
<p class="tableblock">  half<em>n</em> <strong>frexp</strong> (half<em>n</em> <em>x</em>, int<em>n</em> *exp)<br>
  half <strong>frexp</strong> (half <em>x</em>, int *exp)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Extract mantissa and exponent from <em>x</em>.
  For each component the mantissa returned is a float with magnitude in the
  interval [1/2, 1) or 0.
  Each component of <em>x</em> equals mantissa returned * 2<em><sup>exp</sup></em>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">gentype <strong>hypot</strong> (gentype <em>x</em>, gentype <em>y</em>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Compute the value of the square root of <em>x</em><sup>2</sup>+ <em>y</em><sup>2</sup> without undue
  overflow or underflow.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">int<em>n</em> <strong>ilogb</strong> (half<em>n</em> <em>x</em>)<br>
  int <strong>ilogb</strong> (half <em>x</em>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Return the exponent as an integer value.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">half<em>n</em> <strong>ldexp</strong> (half<em>n</em> <em>x</em>, int<em>n</em> <em>k</em>)<br>
  half<em>n</em> <strong>ldexp</strong> (half<em>n</em> <em>x</em>, int <em>k</em>)<br>
  half <strong>ldexp</strong> (half <em>x</em>, int <em>k</em>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Multiply <em>x</em> by 2 to the power <em>k</em>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">gentype <strong>lgamma</strong> (gentype <em>x</em>)<br></p>
<p class="tableblock">  half<em>n</em> <strong>lgamma_r</strong> (half<em>n</em> <em>x</em>, __global int<em>n</em> *<em>signp</em>)<br>
  half <strong>lgamma_r</strong> (half <em>x</em>, __global int *<em>signp</em>)<br></p>
<p class="tableblock">  half<em>n</em> <strong>lgamma_r</strong> (half<em>n</em> <em>x</em>, __local int<em>n</em> *<em>signp</em>)<br>
  half <strong>lgamma_r</strong> (half <em>x</em>, __local int *<em>signp</em>)<br></p>
<p class="tableblock">  half<em>n</em> <strong>lgamma_r</strong> (half<em>n</em> <em>x</em>, __private int<em>n</em> *<em>signp</em>)<br>
  half <strong>lgamma_r</strong> (half <em>x</em>, __private int *<em>signp</em>)<br></p>
<p class="tableblock">  For OpenCL C 2.0 or with the <code>__opencl_c_generic_address_space</code>
  feature macro:<br></p>
<p class="tableblock">  half<em>n</em> <strong>lgamma_r</strong> (half<em>n</em> <em>x</em>, int<em>n</em> *<em>signp</em>)<br>
  half <strong>lgamma_r</strong> (half <em>x</em>, int *<em>signp</em>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Log gamma function.
  Returns the natural logarithm of the absolute value of the gamma function.
  The sign of the gamma function is returned in the <em>signp</em> argument of
  <strong>lgamma_r</strong>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">gentype <strong>log</strong> (gentype <em>x</em>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Compute natural logarithm.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">gentype <strong>log2</strong> (gentype <em>x</em>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Compute a base 2 logarithm.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">gentype <strong>log10</strong> (gentype <em>x</em>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Compute a base 10 logarithm.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">gentype <strong>log1p</strong> (gentype <em>x</em>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Compute log<sub>e</sub>(1.0 + <em>x</em>) .</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">gentype <strong>logb</strong> (gentype <em>x</em>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Compute the exponent of <em>x</em>, which is the integral part of
  log<em><sub>r</sub></em>|<em>x</em>|.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">gentype <strong>mad</strong> (gentype <em>a</em>, gentype <em>b</em>, gentype <em>c</em>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>mad</strong> computes <em>a</em> * <em>b</em> + <em>c</em>.
  The function may compute <em>a</em> * <em>b</em> + <em>c</em> with reduced accuracy
  in the embedded profile.  See the OpenCL SPIR-V Environment Specification
  for details. On some hardware the mad instruction may provide better
  performance than expanded computation of <em>a</em> * <em>b</em> + <em>c</em>.</p>
<p class="tableblock">  Note: For some usages, e.g. <strong>mad</strong>(a, b, -a*b), the half precision
  definition of <strong>mad</strong>() is loose enough that almost any result is allowed
  from <strong>mad</strong>() for some values of a and b.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">gentype <strong>maxmag</strong> (gentype <em>x</em>, gentype <em>y</em>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Returns <em>x</em> if |<em>x</em>| &gt; |<em>y</em>|, <em>y</em> if |<em>y</em>| &gt; |<em>x</em>|, otherwise
  <strong>fmax</strong>(<em>x</em>, <em>y</em>).</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">gentype <strong>minmag</strong> (gentype <em>x</em>, gentype <em>y</em>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Returns <em>x</em> if |<em>x</em>| &lt; |<em>y</em>|, <em>y</em> if |<em>y</em>| &lt; |<em>x</em>|, otherwise
  <strong>fmin</strong>(<em>x</em>, <em>y</em>).</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">gentype <strong>modf</strong> (gentype <em>x</em>, __global gentype *<em>iptr</em>)<br>
  gentype <strong>modf</strong> (gentype <em>x</em>, __local gentype *<em>iptr</em>)<br>
  gentype <strong>modf</strong> (gentype <em>x</em>, __private gentype *<em>iptr</em>)<br></p>
<p class="tableblock">  For OpenCL C 2.0 or with the <code>__opencl_c_generic_address_space</code>
  feature macro:<br></p>
<p class="tableblock">  gentype <strong>modf</strong> (gentype <em>x</em>, gentype *<em>iptr</em>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Decompose a floating-point number.
  The <strong>modf</strong> function breaks the argument <em>x</em> into integral and fractional
  parts, each of which has the same sign as the argument.
  It stores the integral part in the object pointed to by <em>iptr</em>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">half<em>n</em> <strong>nan</strong> (ushort<em>n</em> <em>nancode</em>)<br>
  half <strong>nan</strong> (ushort <em>nancode</em>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Returns a quiet NaN.
  The <em>nancode</em> may be placed in the significand of the resulting NaN.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">gentype <strong>nextafter</strong> (gentype <em>x</em>, gentype <em>y</em>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Computes the next representable half-precision floating-point value
  following <em>x</em> in the direction of <em>y</em>.
  Thus, if <em>y</em> is less than <em>x</em>, <strong>nextafter</strong>() returns the largest
  representable floating-point number less than <em>x</em>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">gentype <strong>pow</strong> (gentype <em>x</em>, gentype <em>y</em>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Compute <em>x</em> to the power <em>y</em>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">half<em>n</em> <strong>pown</strong> (half<em>n</em> <em>x</em>, int<em>n</em> <em>y</em>)<br>
  half <strong>pown</strong> (half <em>x</em>, int <em>y</em>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Compute <em>x</em> to the power <em>y</em>, where <em>y</em> is an integer.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">gentype <strong>powr</strong> (gentype <em>x</em>, gentype <em>y</em>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Compute <em>x</em> to the power <em>y</em>, where <em>x</em> is &gt;= 0.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">gentype <strong>remainder</strong> (gentype <em>x</em>, gentype <em>y</em>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Compute the value <em>r</em> such that <em>r</em> = <em>x</em> - <em>n</em>*<em>y</em>, where <em>n</em> is the
  integer nearest the exact value of <em>x</em>/<em>y</em>.
  If there are two integers closest to <em>x</em>/<em>y</em>, <em>n</em> shall be the even one.
  If <em>r</em> is zero, it is given the same sign as <em>x</em>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">half<em>n</em> <strong>remquo</strong> (half<em>n</em> <em>x</em>, half<em>n</em> <em>y</em>, __global int<em>n</em> *<em>quo</em>)<br>
  half <strong>remquo</strong> (half <em>x</em>, half <em>y</em>, __global int *<em>quo</em>)<br></p>
<p class="tableblock">  half<em>n</em> <strong>remquo</strong> (half<em>n</em> <em>x</em>, half<em>n</em> <em>y</em>, __local int<em>n</em> *<em>quo</em>)<br>
  half <strong>remquo</strong> (half <em>x</em>, half <em>y</em>, __local int *<em>quo</em>)<br></p>
<p class="tableblock">  half<em>n</em> <strong>remquo</strong> (half<em>n</em> <em>x</em>, half<em>n</em> <em>y</em>, __private int<em>n</em> *<em>quo</em>)<br>
  half <strong>remquo</strong> (half <em>x</em>, half <em>y</em>, __private int *<em>quo</em>)<br></p>
<p class="tableblock">  For OpenCL C 2.0 or with the <code>__opencl_c_generic_address_space</code>
  feature macro:<br></p>
<p class="tableblock">  half<em>n</em> <strong>remquo</strong> (half<em>n</em> <em>x</em>, half<em>n</em> <em>y</em>, int<em>n</em> *<em>quo</em>)<br>
  half <strong>remquo</strong> (half <em>x</em>, half <em>y</em>, int *<em>quo</em>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The <strong>remquo</strong> function computes the value r such that <em>r</em> = <em>x</em> - <em>k</em>*<em>y</em>,
  where <em>k</em> is the integer nearest the exact value of <em>x</em>/<em>y</em>.
  If there are two integers closest to <em>x</em>/<em>y</em>, <em>k</em> shall be the even one.
  If <em>r</em> is zero, it is given the same sign as <em>x</em>.
  This is the same value that is returned by the <strong>remainder</strong> function.
  <strong>remquo</strong> also calculates the lower seven bits of the integral quotient
  <em>x</em>/<em>y</em>, and gives that value the same sign as <em>x</em>/<em>y</em>.
  It stores this signed value in the object pointed to by <em>quo</em>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">gentype <strong>rint</strong> (gentype <em>x</em>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Round to integral value (using round to nearest even rounding mode) in
  floating-point format.
  Refer to section 7.1 for description of rounding modes.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">half<em>n</em> <strong>rootn</strong> (half<em>n</em> <em>x</em>, int<em>n</em> <em>y</em>)<br>
  half <strong>rootn</strong> (half <em>x</em>, int <em>y</em>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Compute <em>x</em> to the power 1/<em>y</em>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">gentype <strong>round</strong> (gentype <em>x</em>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Return the integral value nearest to <em>x</em> rounding halfway cases away from
  zero, regardless of the current rounding direction.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">gentype <strong>rsqrt</strong> (gentype <em>x</em>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Compute inverse square root.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">gentype <strong>sin</strong> (gentype <em>x</em>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Compute sine.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">gentype <strong>sincos</strong> (gentype <em>x</em>, __global gentype *<em>cosval</em>)<br>
  gentype <strong>sincos</strong> (gentype <em>x</em>, __local gentype *<em>cosval</em>)<br>
  gentype <strong>sincos</strong> (gentype <em>x</em>, __private gentype *<em>cosval</em>)<br></p>
<p class="tableblock">  For OpenCL C 2.0 or with the <code>__opencl_c_generic_address_space</code>
  feature macro:<br></p>
<p class="tableblock">  gentype <strong>sincos</strong> (gentype <em>x</em>, gentype *<em>cosval</em>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Compute sine and cosine of x.
  The computed sine is the return value and computed cosine is returned in
  <em>cosval</em>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">gentype <strong>sinh</strong> (gentype <em>x</em>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Compute hyperbolic sine.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">gentype <strong>sinpi</strong> (gentype <em>x</em>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Compute <strong>sin</strong> ( <em>x</em>).</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">gentype <strong>sqrt</strong> (gentype <em>x</em>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Compute square root.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">gentype <strong>tan</strong> (gentype <em>x</em>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Compute tangent.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">gentype <strong>tanh</strong> (gentype <em>x</em>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Compute hyperbolic tangent.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">gentype <strong>tanpi</strong> (gentype <em>x</em>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Compute <strong>tan</strong> ( <em>x</em>).</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">gentype <strong>tgamma</strong> (gentype <em>x</em>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Compute the gamma function.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">gentype <strong>trunc</strong> (gentype <em>x</em>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Round to integral value using the round to zero rounding mode.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>The <strong>FP_FAST_FMA_HALF</strong> macro indicates whether the <strong>fma()</strong> family of
functions are fast compared with direct code for half precision
floating-point.
If defined, the <strong>FP_FAST_FMA_HALF</strong> macro shall indicate that the <strong>fma()</strong>
function generally executes about as fast as, or faster than, a multiply and
an add of <strong>half</strong> operands.</p>
</div>
<div class="paragraph">
<p>The macro names given in the following list must use the values specified.
These constant expressions are suitable for use in #if preprocessing
directives.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="opencl_c"><span class="cp">#define HALF_DIG            3
#define HALF_MANT_DIG       11
#define HALF_MAX_10_EXP     +4
#define HALF_MAX_EXP        +16
#define HALF_MIN_10_EXP     -4
#define HALF_MIN_EXP        -13
#define HALF_RADIX          2
#define HALF_MAX            0x1.ffcp15h
#define HALF_MIN            0x1.0p-14h
#define HALF_EPSILON        0x1.0p-10h</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The following table describes the built-in macro names given above in the
OpenCL C programming language and the corresponding macro names available to
the application.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><strong>Macro in OpenCL Language</strong></th>
<th class="tableblock halign-left valign-top"><strong>Macro for application</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>HALF_DIG</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CL_HALF_<wbr>DIG</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>HALF_MANT_DIG</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CL_HALF_<wbr>MANT_<wbr>DIG</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>HALF_MAX_10_EXP</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CL_HALF_<wbr>MAX_<wbr>10_<wbr>EXP</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>HALF_MAX_EXP</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CL_HALF_<wbr>MAX_<wbr>EXP</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>HALF_MIN_10_EXP</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CL_HALF_<wbr>MIN_<wbr>10_<wbr>EXP</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>HALF_MIN_EXP</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CL_HALF_<wbr>MIN_<wbr>EXP</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>HALF_RADIX</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CL_HALF_<wbr>RADIX</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>HALF_MAX</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CL_HALF_<wbr>MAX</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>HALF_MIN</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CL_HALF_<wbr>MIN</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>HALF_EPSILSON</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CL_HALF_<wbr>EPSILON</code></p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>The following constants are also available.
They are of type <code>half</code> and are accurate within the precision of the <code>half</code>
type.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><strong>Constant</strong></th>
<th class="tableblock halign-left valign-top"><strong>Description</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>M_E_H</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Value of e</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>M_LOG2E_H</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Value of log<sub>2</sub>e</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>M_LOG10E_H</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Value of log<sub>10</sub>e</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>M_LN2_H</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Value of log<sub>e</sub>2</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>M_LN10_H</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Value of log<sub>e</sub>10</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>M_PI_H</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Value of </p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>M_PI_2_H</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Value of  / 2</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>M_PI_4_H</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Value of  / 4</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>M_1_PI_H</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Value of 1 / </p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>M_2_PI_H</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Value of 2 / </p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>M_2_SQRTPI_H</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Value of 2 / </p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>M_SQRT2_H</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Value of 2</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>M_SQRT1_2_H</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Value of 1 / 2</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="cl_khr_fp16-common-functions"><a class="anchor" href="#cl_khr_fp16-common-functions"></a>5.2.3. Common Functions</h4>
<div class="paragraph">
<p>The built-in common functions defined in <em>table 6.12</em> (also listed below)
are extended to include appropriate versions of functions that take <code>half</code>
and <code>half{2|3|4|8|16}</code> as arguments and return values.
gentype now also includes <code>half</code>, <code>half2</code>, <code>half3</code>, <code>half4</code>, <code>half8</code> and
<code>half16</code>.
These are described below.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 3. <em>Half Precision Built-in Common Functions</em></caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><strong>Function</strong></th>
<th class="tableblock halign-left valign-top"><strong>Description</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">gentype <strong>clamp</strong> (<br>
  gentype <em>x</em>, gentype <em>minval</em>, gentype <em>maxval</em>)</p>
<p class="tableblock">  gentype <strong>clamp</strong> (<br>
  gentype <em>x</em>, half <em>minval</em>, half <em>maxval</em>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Returns <strong>fmin</strong>(<strong>fmax</strong>(<em>x</em>, <em>minval</em>), <em>maxval</em>).</p>
<p class="tableblock">  Results are undefined if <em>minval</em> &gt; <em>maxval</em>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">gentype <strong>degrees</strong> (gentype <em>radians</em>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Converts <em>radians</em> to degrees,<br>
  i.e. (180 / ) * <em>radians</em>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">gentype <strong>max</strong> (gentype <em>x</em>, gentype <em>y</em>)<br>
  gentype <strong>max</strong> (gentype <em>x</em>, half <em>y</em>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Returns <em>y</em> if <em>x</em> &lt; <em>y</em>, otherwise it returns <em>x</em>.
  If <em>x</em> and <em>y</em> are infinite or NaN, the return values are undefined.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">gentype <strong>min</strong> (gentype <em>x</em>, gentype <em>y</em>)<br>
  gentype <strong>min</strong> (gentype <em>x</em>, half <em>y</em>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Returns <em>y</em> if <em>y</em> &lt; <em>x</em>, otherwise it returns <em>x</em>.
  If <em>x</em> and <em>y</em> are infinite or NaN, the return values are undefined.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">gentype <strong>mix</strong> (gentype <em>x</em>, gentype <em>y</em>, gentype <em>a</em>)<br>
  gentype <strong>mix</strong> (gentype <em>x</em>, gentype <em>y</em>, half <em>a</em>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Returns the linear blend of <em>x</em> and <em>y</em> implemented as:</p>
<p class="tableblock">  <em>x</em> + (<em>y</em> - <em>x)</em> * <em>a</em></p>
<p class="tableblock">  <em>a</em> must be a value in the range 0.0 &#8230;&#8203; 1.0.
  If <em>a</em> is not in the range 0.0 &#8230;&#8203; 1.0, the return values are undefined.</p>
<p class="tableblock">  Note: The half precision <strong>mix</strong> function can be implemented using contractions such as <strong>mad</strong> or <strong>fma</strong>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">gentype <strong>radians</strong> (gentype <em>degrees</em>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Converts <em>degrees</em> to radians, i.e. ( / 180) * <em>degrees</em>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">gentype <strong>step</strong> (gentype <em>edge</em>, gentype <em>x</em>)<br>
  gentype <strong>step</strong> (half <em>edge</em>, gentype <em>x</em>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Returns 0.0 if <em>x</em> &lt; <em>edge</em>, otherwise it returns 1.0.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">gentype <strong>smoothstep</strong> (<br>
  gentype <em>edge0</em>, gentype <em>edge1</em>, gentype <em>x</em>)</p>
<p class="tableblock">  gentype <strong>smoothstep</strong> (<br>
  half <em>edge0</em>, half <em>edge1</em>, gentype <em>x</em>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Returns 0.0 if <em>x</em> &lt;= <em>edge0</em> and 1.0 if <em>x</em> &gt;= <em>edge1</em> and performs
  smooth Hermite interpolation between 0 and 1 when <em>edge0</em> &lt; <em>x</em> &lt; <em>edge1</em>.
  This is useful in cases where you would want a threshold function with a
  smooth transition.</p>
<p class="tableblock">  This is equivalent to:</p>
<p class="tableblock">  gentype <em>t</em>;<br>
  <em>t</em> = clamp ((<em>x</em> - <em>edge0</em>) / (<em>edge1</em> - <em>edge0</em>), 0, 1);<br>
  return <em>t</em> * <em>t</em> * (3 - 2 * <em>t</em>);<br></p>
<p class="tableblock">  Results are undefined if <em>edge0</em> &gt;= <em>edge1</em>.</p>
<p class="tableblock">  Note: The half precision <strong>smoothstep</strong> function can be implemented using contractions such as <strong>mad</strong> or <strong>fma</strong>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">gentype <strong>sign</strong> (gentype <em>x</em>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Returns 1.0 if <em>x</em> &gt; 0, -0.0 if <em>x</em> = -0.0, +0.0 if <em>x</em> = +0.0, or -1.0 if
  <em>x</em> &lt; 0.
  Returns 0.0 if <em>x</em> is a NaN.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="cl_khr_fp16-geometric-functions"><a class="anchor" href="#cl_khr_fp16-geometric-functions"></a>5.2.4. Geometric Functions</h4>
<div class="paragraph">
<p>The built-in geometric functions defined in <em>table 6.13</em> (also listed below)
are extended to include appropriate versions of functions that take <code>half</code>
and <code>half{2|3|4}</code> as arguments and return values.
gentype now also includes <code>half</code>, <code>half2</code>, <code>half3</code> and <code>half4</code>.
These are described below.</p>
</div>
<div class="paragraph">
<p>Note: The half precision geometric functions can be implemented using
contractions such as <strong>mad</strong> or <strong>fma</strong>.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 4. <em>Half Precision Built-in Geometric Functions</em></caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><strong>Function</strong></th>
<th class="tableblock halign-left valign-top"><strong>Description</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">half4 <strong>cross</strong> (half4 <em>p0</em>, half4 <em>p1</em>)<br>
  half3 <strong>cross</strong> (half3 <em>p0</em>, half3 <em>p1</em>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Returns the cross product of <em>p0.xyz</em> and <em>p1.xyz</em>.
  The <em>w</em> component of the result will be 0.0.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">half <strong>dot</strong> (gentype <em>p0</em>, gentype <em>p1</em>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Compute the dot product of <em>p0</em> and <em>p1</em>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">half <strong>distance</strong> (gentype <em>p0</em>, gentype <em>p1</em>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Returns the distance between <em>p0</em> and <em>p1</em>.
  This is calculated as <strong>length</strong>(<em>p0</em> - <em>p1</em>).</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">half <strong>length</strong> (gentype <em>p</em>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Return the length of vector x, i.e.,<br>
  sqrt( <em>p.x</em><sup>2</sup> + <em>p.y</em><sup>2</sup> + &#8230;&#8203; )</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">gentype <strong>normalize</strong> (gentype <em>p</em>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Returns a vector in the same direction as <em>p</em> but with a length of 1.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="cl_khr_fp16-relational-functions"><a class="anchor" href="#cl_khr_fp16-relational-functions"></a>5.2.5. Relational Functions</h4>
<div class="paragraph">
<p>The scalar and vector relational functions described in <em>table 6.14</em> are
extended to include versions that take <code>half</code>, <code>half2</code>, <code>half3</code>, <code>half4</code>,
<code>half8</code> and <code>half16</code> as arguments.</p>
</div>
<div class="paragraph">
<p>The relational and equality operators (&lt;, &lt;=, &gt;, &gt;=, !=, ==) can be used
with <code>halfn</code> vector types and shall produce a vector <code>shortn</code> result as
described in <em>section 6.3</em>.</p>
</div>
<div class="paragraph">
<p>The functions <strong>isequal</strong>, <strong>isnotequal</strong>, <strong>isgreater</strong>, <strong>isgreaterequal</strong>,
<strong>isless</strong>, <strong>islessequal</strong>, <strong>islessgreater</strong>, <strong>isfinite</strong>, <strong>isinf</strong>, <strong>isnan</strong>,
<strong>isnormal</strong>, <strong>isordered</strong>, <strong>isunordered</strong> and <strong>signbit</strong> shall return a 0 if the
specified relation is <em>false</em> and a 1 if the specified relation is true for
scalar argument types.
These functions shall return a 0 if the specified relation is <em>false</em> and a
-1 (i.e. all bits set) if the specified relation is <em>true</em> for vector
argument types.</p>
</div>
<div class="paragraph">
<p>The relational functions <strong>isequal</strong>, <strong>isgreater</strong>, <strong>isgreaterequal</strong>, <strong>isless</strong>,
<strong>islessequal</strong>, and <strong>islessgreater</strong> always return 0 if either argument is not
a number (NaN).
<strong>isnotequal</strong> returns 1 if one or both arguments are not a number (NaN) and
the argument type is a scalar and returns -1 if one or both arguments are
not a number (NaN) and the argument type is a vector.</p>
</div>
<div class="paragraph">
<p>The functions described in <em>table 6.14</em> are extended to include the <code>halfn</code>
vector types.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 5. <em>Half Precision Relational Functions</em></caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><strong>Function</strong></th>
<th class="tableblock halign-left valign-top"><strong>Description</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">int <strong>isequal</strong> (half <em>x</em>, half <em>y</em>)<br>
  short<em>n</em> <strong>isequal</strong> (half<em>n x</em>, half<em>n y</em>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Returns the component-wise compare of <em>x</em> == <em>y</em>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">int <strong>isnotequal</strong> (half <em>x</em>, half <em>y</em>)<br>
  short<em>n</em> <strong>isnotequal</strong> (half<em>n x</em>, half<em>n y</em>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Returns the component-wise compare of <em>x</em> != <em>y</em>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">int <strong>isgreater</strong> (half <em>x</em>, half <em>y</em>)<br>
  short<em>n</em> <strong>isgreater</strong> (half<em>n x</em>, half<em>n y</em>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Returns the component-wise compare of <em>x</em> &gt; <em>y</em>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">int <strong>isgreaterequal</strong> (half <em>x</em>, half <em>y</em>)<br>
  short<em>n</em> <strong>isgreaterequal</strong> (half<em>n x</em>, half<em>n y</em>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Returns the component-wise compare of <em>x</em> &gt;= <em>y</em>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">int <strong>isless</strong> (half <em>x</em>, half <em>y</em>)<br>
  short<em>n</em> <strong>isless</strong> (half<em>n x</em>, half<em>n y</em>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Returns the component-wise compare of <em>x</em> &lt; <em>y</em>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">int <strong>islessequal</strong> (half <em>x</em>, half <em>y</em>)<br>
  short<em>n</em> <strong>islessequal</strong> (half<em>n x</em>, half<em>n y</em>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Returns the component-wise compare of <em>x</em> &lt;= <em>y</em>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">int <strong>islessgreater</strong> (half <em>x</em>, half <em>y</em>)<br>
  short<em>n</em> <strong>islessgreater</strong> (half<em>n x</em>, half<em>n y</em>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Returns the component-wise compare of (<em>x</em> &lt; <em>y</em>) || (<em>x</em> &gt; <em>y</em>) .</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">int <strong>isfinite</strong> (half)<br>
  short<em>n</em> <strong>isfinite</strong> (half<em>n</em>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Test for finite value.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">int <strong>isinf</strong> (half)<br>
  short<em>n</em> <strong>isinf</strong> (half<em>n</em>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Test for infinity value (positive or negative) .</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">int <strong>isnan</strong> (half)<br>
  short<em>n</em> <strong>isnan</strong> (half<em>n</em>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Test for a NaN.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">int <strong>isnormal</strong> (half)<br>
  short<em>n</em> <strong>isnormal</strong> (half<em>n</em>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Test for a normal value.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">int <strong>isordered</strong> (half <em>x</em>, half <em>y</em>)<br>
  short<em>n</em> <strong>isordered</strong> (half<em>n x</em>, half<em>n y</em>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Test if arguments are ordered.
  <strong>isordered</strong>() takes arguments <em>x</em> and <em>y</em>, and returns the result
  <strong>isequal</strong>(<em>x</em>, <em>x</em>) &amp;&amp; <strong>isequal</strong>(<em>y</em>, <em>y</em>).</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">int <strong>isunordered</strong> (half <em>x</em>, half <em>y</em>)<br>
  short<em>n</em> <strong>isunordered</strong> (half<em>n x</em>, half<em>n y</em>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Test if arguments are unordered.
  <strong>isunordered</strong>() takes arguments <em>x</em> and <em>y</em>, returning non-zero if <em>x</em> or
  <em>y</em> is a NaN, and zero otherwise.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">int <strong>signbit</strong> (half)<br>
  short<em>n</em> <strong>signbit</strong> (half<em>n</em>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Test for sign bit.
  The scalar version of the function returns a 1 if the sign bit in the half
  is set else returns 0.
  The vector version of the function returns the following for each
  component in half<em>n</em>: -1 (i.e all bits set) if the sign bit in the half
  is set else returns 0.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">half<em>n</em> <strong>bitselect</strong> (half<em>n a</em>, half<em>n b</em>, half<em>n c</em>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Each bit of the result is the corresponding bit of <em>a</em> if the
  corresponding bit of <em>c</em> is 0.
  Otherwise it is the corresponding bit of <em>b</em>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">half<em>n</em> <strong>select</strong> (half<em>n a</em>, half<em>n b</em>, short<em>n</em> <em>c</em>)<br>
  half<em>n</em> <strong>select</strong> (half<em>n a</em>, half<em>n b</em>, ushort<em>n</em> <em>c</em>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">For each component,<br>
  <em>result[i]</em> = if MSB of <em>c[i]</em> is set ? <em>b[i]</em> : <em>a[i]</em>.<br></p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="cl_khr_fp16-vector-data-load-and-store-functions"><a class="anchor" href="#cl_khr_fp16-vector-data-load-and-store-functions"></a>5.2.6. Vector Data Load and Store Functions</h4>
<div class="paragraph">
<p>The vector data load (<strong>vload<em>n</em></strong>) and store (<strong>vstore<em>n</em></strong>) functions
described in <em>table 6.13</em> (also listed below) are extended to include
versions that read or write half vector values.
The generic type <code>gentype</code> is extended to include <code>half</code>.
The generic type <code>gentypen</code> is extended to include <code>half2</code>, <code>half3</code>,
<code>half4</code>, <code>half8</code>, and <code>half16</code>.</p>
</div>
<div class="paragraph">
<p>Note: <strong>vload3</strong> reads <em>x</em>, <em>y</em>, <em>z</em> components from address
(<em>p</em> + (<em>offset</em> * 3)) into a 3-component vector and <strong>vstore3</strong> writes <em>x</em>, <em>y</em>, <em>z</em>
components from a 3-component vector to address (<em>p</em> + (<em>offset</em> * 3)).</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 6. <em>Half Precision Vector Data Load and Store Functions</em></caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><strong>Function</strong></th>
<th class="tableblock halign-left valign-top"><strong>Description</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">gentype<em>n</em> <strong>vload<em>n</em></strong>(size_t <em>offset</em>, const __global gentype *<em>p</em>)<br>
  gentype<em>n</em> <strong>vload<em>n</em></strong>(size_t <em>offset</em>, const __local gentype *<em>p</em>)<br>
  gentype<em>n</em> <strong>vload<em>n</em></strong>(size_t <em>offset</em>, const __constant gentype *<em>p</em>)<br>
  gentype<em>n</em> <strong>vload<em>n</em></strong>(size_t <em>offset</em>, const __private gentype *<em>p</em>)<br></p>
<p class="tableblock">  For OpenCL C 2.0 or with the <code>__opencl_c_generic_address_space</code>
  feature macro:<br></p>
<p class="tableblock">  gentype<em>n</em> <strong>vload<em>n</em></strong>(size_t <em>offset</em>, const gentype *<em>p</em>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Return sizeof (gentype<em>n</em>) bytes of data read from address
  (<em>p</em> + (<em>offset * n</em>)).
  If gentype is half, the read address computed as (<em>p</em> + (<em>offset * n</em>))
  must be 16-bit aligned.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">void <strong>vstore<em>n</em></strong>(gentype<em>n</em> <em>data</em>, size_t <em>offset</em>, __global gentype *<em>p</em>)<br>
  void <strong>vstore<em>n</em></strong>(gentype<em>n</em> <em>data</em>, size_t <em>offset</em>, __local gentype *<em>p</em>)<br>
  void <strong>vstore<em>n</em></strong>(gentype<em>n</em> <em>data</em>, size_t <em>offset</em>, __private gentype *<em>p</em>)<br></p>
<p class="tableblock">  For OpenCL C 2.0 or with the <code>__opencl_c_generic_address_space</code>
  feature macro:<br></p>
<p class="tableblock">  void <strong>vstore<em>n</em></strong>(gentype<em>n</em> <em>data</em>, size_t <em>offset</em>, gentype *<em>p</em>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Write sizeof (gentype<em>n</em>) bytes given by <em>data</em> to address
  (<em>p</em> + (<em>offset * n</em>)).
  If gentype is half, the write address computed as (<em>p</em> + (<em>offset * n</em>))
  must be 16-bit aligned.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="cl_khr_fp16-async-copies-from-global-to-local-memory-local-to-global-memory-and-prefetch"><a class="anchor" href="#cl_khr_fp16-async-copies-from-global-to-local-memory-local-to-global-memory-and-prefetch"></a>5.2.7. Async Copies from Global to Local Memory, Local to Global Memory, and Prefetch</h4>
<div class="paragraph">
<p>The OpenCL C programming language implements the following functions that
provide asynchronous copies between global and local memory and a prefetch
from global memory.</p>
</div>
<div class="paragraph">
<p>The generic type <code>gentype</code> is extended to include <code>half</code>, <code>half2</code>, <code>half3</code>,
<code>half4</code>, <code>half8</code>, and <code>half16</code>.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 7. <em>Half Precision Built-in Async Copy and Prefetch Functions</em></caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><strong>Function</strong></th>
<th class="tableblock halign-left valign-top"><strong>Description</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">event_t <strong>async_work_group_copy</strong> (<br>
  __local gentype *<em>dst</em>,<br>
  const __global gentype *<em>src</em>,<br>
  size_t <em>num_gentypes</em>, event_t <em>event</em>)</p>
<p class="tableblock">  event_t <strong>async_work_group_copy</strong> (<br>
  __global gentype <em>*dst</em>,<br>
  const __local gentype *<em>src</em>,<br>
  size_t <em>num_gentypes</em>, event_t <em>event</em>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Perform an async copy of <em>num_gentypes</em> gentype elements from <em>src</em> to
  <em>dst</em>.
  The async copy is performed by all work-items in a work-group and this
  built-in function must therefore be encountered by all work-items in a
  work-group executing the kernel with the same argument values; otherwise
  the results are undefined.</p>
<p class="tableblock">  Returns an event object that can be used by <strong>wait_group_events</strong> to wait
  for the async copy to finish.
  The <em>event</em> argument can also be used to associate the
  <strong>async_work_group_copy</strong> with a previous async copy allowing an event to be
  shared by multiple async copies; otherwise <em>event</em> should be zero.</p>
<p class="tableblock">  If <em>event</em> argument is not zero, the event object supplied in <em>event</em>
  argument will be returned.</p>
<p class="tableblock">  This function does not perform any implicit synchronization of source data
  such as using a <strong>barrier</strong> before performing the copy.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">event_t <strong>async_work_group_strided_copy</strong> (<br>
  __local gentype <em>*dst</em>,<br>
  const __global gentype *<em>src</em>,<br>
  size_t <em>num_gentypes</em>,<br>
  size_t <em>src_stride</em>, event_t <em>event</em>)</p>
<p class="tableblock">  event_t <strong>async_work_group_strided_copy</strong> (<br>
  __global gentype <em>*dst</em>,<br>
  const __local gentype *<em>src</em>,<br>
  size_t <em>num_gentypes</em>,<br>
  size_t <em>dst_stride</em>, event_t <em>event</em>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Perform an async gather of <em>num_gentypes</em> gentype elements from <em>src</em> to
  <em>dst</em>.
  The <em>src_stride</em> is the stride in elements for each gentype element read
  from <em>src</em>.
  The async gather is performed by all work-items in a work-group and this
  built-in function must therefore be encountered by all work-items in a
  work-group executing the kernel with the same argument values; otherwise
  the results are undefined.</p>
<p class="tableblock">  Returns an event object that can be used by <strong>wait_group_events</strong> to wait
  for the async copy to finish.
  The <em>event</em> argument can also be used to associate the
  <strong>async_work_group_strided_copy</strong> with a previous async copy allowing an
  event to be shared by multiple async copies; otherwise <em>event</em> should be
  zero.</p>
<p class="tableblock">  If <em>event</em> argument is not zero, the event object supplied in <em>event</em>
  argument will be returned.</p>
<p class="tableblock">  This function does not perform any implicit synchronization of source data
  such as using a <strong>barrier</strong> before performing the copy.</p>
<p class="tableblock">  The behavior of <strong>async_work_group_strided_copy</strong> is undefined if
  <em>src_stride</em> or <em>dst_stride</em> is 0, or if the <em>src_stride</em> or <em>dst_stride</em>
  values cause the <em>src</em> or <em>dst</em> pointers to exceed the upper bounds of the
  address space during the copy.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">void <strong>wait_group_events</strong> (<br>
  int <em>num_events</em>, event_t *<em>event_list</em>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Wait for events that identify the <strong>async_work_group_copy</strong> operations to
  complete.
  The event objects specified in <em>event_list</em> will be released after the
  wait is performed.</p>
<p class="tableblock">  This function must be encountered by all work-items in a work-group
  executing the kernel with the same <em>num_events</em> and event objects
  specified in <em>event_list</em>; otherwise the results are undefined.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">void <strong>prefetch</strong> (<br>
  const __global gentype *<em>p</em>, size_t <em>num_gentypes</em>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Prefetch <em>num_gentypes</em> * sizeof(gentype) bytes into the global cache.
  The prefetch instruction is applied to a work-item in a work-group and
  does not affect the functional behavior of the kernel.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="cl_khr_fp16-image-read-and-write-functions"><a class="anchor" href="#cl_khr_fp16-image-read-and-write-functions"></a>5.2.8. Image Read and Write Functions</h4>
<div class="paragraph">
<p>The image read and write functions defined in <em>tables 6.23</em>, <em>6.24</em> and
<em>6.25</em> are extended to support image color values that are a <code>half</code> type.</p>
</div>
</div>
<div class="sect3">
<h4 id="_built_in_image_read_functions"><a class="anchor" href="#_built_in_image_read_functions"></a>5.2.9. Built-in Image Read Functions</h4>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 8. <em>Half Precision Built-in Image Read Functions</em></caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><strong>Function</strong></th>
<th class="tableblock halign-left valign-top"><strong>Description</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">half4 <strong>read_imageh</strong> (<br>
  read_only image2d_t <em>image</em>,<br>
  sampler_t <em>sampler</em>,<br>
  int2 <em>coord</em>)</p>
<p class="tableblock">  half4 <strong>read_imageh</strong> (<br>
  read_only image2d_t <em>image</em>,<br>
  sampler_t <em>sampler</em>,<br>
  float2 <em>coord</em>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Use the coordinate <em>(coord.x, coord.y)</em> to do an element lookup in the 2D
  image object specified by <em>image</em>.</p>
<p class="tableblock">  <strong>read_imageh</strong> returns half precision floating-point values in the range
  [0.0 &#8230;&#8203; 1.0] for image objects created with <em>image_channel_data_type</em> set
  to one of the pre-defined packed formats, <code>CL_UNORM_<wbr>INT8</code>, or
  <code>CL_UNORM_<wbr>INT16</code>.</p>
<p class="tableblock">  <strong>read_imageh</strong> returns half precision floating-point values in the range
  [-1.0 &#8230;&#8203; 1.0] for image objects created with <em>image_channel_data_type</em>
  set to <code>CL_SNORM_<wbr>INT8</code>, or <code>CL_SNORM_<wbr>INT16</code>.</p>
<p class="tableblock">  <strong>read_imageh</strong> returns half precision floating-point values for image
  objects created with <em>image_channel_data_type</em> set to <code>CL_HALF_<wbr>FLOAT</code>.</p>
<p class="tableblock">  The <strong>read_imageh</strong> calls that take integer coordinates must use a sampler
  with filter mode set to <code>CLK_FILTER_NEAREST</code>, normalized coordinates set to
  <code>CLK_NORMALIZED_COORDS_FALSE</code> and addressing mode set to
  <code>CLK_ADDRESS_CLAMP_TO_EDGE</code>, <code>CLK_ADDRESS_CLAMP</code> or <code>CLK_ADDRESS_NONE</code>;
  otherwise the values returned are undefined.</p>
<p class="tableblock">  Values returned by <strong>read_imageh</strong> for image objects with
  <em>image_channel_data_type</em> values not specified in the description above
  are undefined.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">half4 <strong>read_imageh</strong> (<br>
  read_only image3d_t <em>image</em>,<br>
  sampler_t <em>sampler</em>,<br>
  int4 <em>coord</em> )</p>
<p class="tableblock">  half4 <strong>read_imageh</strong> (<br>
  read_only image3d_t <em>image</em>,<br>
  sampler_t <em>sampler</em>,<br>
  float4 <em>coord</em>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Use the coordinate <em>(coord.x</em>, <em>coord.y</em>, <em>coord.z)</em> to do an
  elementlookup in the 3D image object specified by <em>image</em>. <em>coord.w</em> is
  ignored.</p>
<p class="tableblock">  <strong>read_imageh</strong> returns half precision floating-point values in the range
  [0.0 &#8230;&#8203; 1.0] for image objects created with <em>image_channel_data_type</em> set
  to one of the pre-defined packed formats or <code>CL_UNORM_<wbr>INT8</code>, or
  <code>CL_UNORM_<wbr>INT16</code>.</p>
<p class="tableblock">  <strong>read_imageh</strong> returns half precision floating-point values in the range
  [-1.0 &#8230;&#8203; 1.0] for image objects created with <em>image_channel_data_type</em>
  set to <code>CL_SNORM_<wbr>INT8</code>, or <code>CL_SNORM_<wbr>INT16</code>.</p>
<p class="tableblock">  <strong>read_imageh</strong>returns half precision floating-point values for image
  objects created with <em>image_channel_data_type</em> set to <code>CL_HALF_<wbr>FLOAT</code>.</p>
<p class="tableblock">  The <strong>read_imageh</strong> calls that take integer coordinates must use a sampler
  with filter mode set to <code>CLK_FILTER_NEAREST</code>, normalized coordinates set to
  <code>CLK_NORMALIZED_COORDS_FALSE</code> and addressing mode set to
  <code>CLK_ADDRESS_CLAMP_TO_EDGE</code>, <code>CLK_ADDRESS_CLAMP</code> or <code>CLK_ADDRESS_NONE</code>;
  otherwise the values returned are undefined.</p>
<p class="tableblock">  Values returned by <strong>read_imageh</strong> for image objects with
  <em>image_channel_data_type</em> values not specified in the description are
  undefined.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">half4 <strong>read_imageh</strong> (<br>
  read_only image2d_array_t <em>image</em>,<br>
  sampler_t <em>sampler</em>,<br>
  int4 <em>coord</em>)</p>
<p class="tableblock">  half4 <strong>read_imageh</strong> (<br>
  read_only image2d_array_t <em>image</em>,<br>
  sampler_t <em>sampler</em>,<br>
  float4 <em>coord</em>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Use <em>coord.xy</em> to do an element lookup in the 2D image identified by
  <em>coord.z</em> in the 2D image array specified by <em>image</em>.</p>
<p class="tableblock">  <strong>read_imageh</strong> returns half precision floating-point values in the range
  [0.0 &#8230;&#8203; 1.0] for image objects created with image_channel_data_type set
  to one of the pre-defined packed formats or <code>CL_UNORM_<wbr>INT8</code>, or
  <code>CL_UNORM_<wbr>INT16</code>.</p>
<p class="tableblock">  <strong>read_imageh</strong> returns half precision floating-point values in the range
  [-1.0 &#8230;&#8203; 1.0] for image objects created with image_channel_data_type set
  to <code>CL_SNORM_<wbr>INT8</code>, or <code>CL_SNORM_<wbr>INT16</code>.</p>
<p class="tableblock">  <strong>read_imageh</strong> returns half precision floating-point values for image
  objects created with image_channel_data_type set to <code>CL_HALF_<wbr>FLOAT</code>.</p>
<p class="tableblock">  The <strong>read_imageh</strong> calls that take integer coordinates must use a sampler
  with filter mode set to <code>CLK_FILTER_NEAREST</code>, normalized coordinates set to
  <code>CLK_NORMALIZED_COORDS_FALSE</code> and addressing mode set to
  <code>CLK_ADDRESS_CLAMP_TO_EDGE</code>, <code>CLK_ADDRESS_CLAMP</code> or <code>CLK_ADDRESS_NONE</code>;
  otherwise the values returned are undefined.</p>
<p class="tableblock">  Values returned by <strong>read_imageh</strong> for image objects with
  image_channel_data_type values not specified in the description above are
  undefined.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">half4 <strong>read_imageh</strong> (<br>
  read_only image1d_t <em>image</em>,<br>
  sampler_t <em>sampler</em>,<br>
  int <em>coord</em>)</p>
<p class="tableblock">  half4 <strong>read_imageh</strong> (<br>
  read_only image1d_t <em>image</em>,<br>
  sampler_t <em>sampler</em>,<br>
  float <em>coord</em>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Use <em>coord</em> to do an element lookup in the 1D image object specified by
  <em>image</em>.</p>
<p class="tableblock">  <strong>read_imageh</strong> returns half precision floating-point values in the range
  [0.0 &#8230;&#8203; 1.0] for image objects created with <em>image_channel_data_type</em> set
  to one of the pre-defined packed formats or <code>CL_UNORM_<wbr>INT8</code>, or
  <code>CL_UNORM_<wbr>INT16</code>.</p>
<p class="tableblock">  <strong>read_imageh</strong> returns half precision floating-point values in the range
  [-1.0 &#8230;&#8203; 1.0] for image objects created with <em>image_channel_data_type</em>
  set to <code>CL_SNORM_<wbr>INT8</code>, or <code>CL_SNORM_<wbr>INT16</code>.</p>
<p class="tableblock">  <strong>read_imageh</strong> returns half precision floating-point values for image
  objects created with <em>image_channel_data_type</em> set to <code>CL_HALF_<wbr>FLOAT</code>.</p>
<p class="tableblock">  The <strong>read_imageh</strong> calls that take integer coordinates must use a sampler
  with filter mode set to <code>CLK_FILTER_NEAREST</code>, normalized coordinates set to
  <code>CLK_NORMALIZED_COORDS_FALSE</code> and addressing mode set to
  <code>CLK_ADDRESS_CLAMP_TO_EDGE</code>, <code>CLK_ADDRESS_CLAMP</code> or <code>CLK_ADDRESS_NONE</code>;
  otherwise the values returned are undefined.</p>
<p class="tableblock">  Values returned by <strong>read_imageh</strong> for image objects with
  <em>image_channel_data_type</em> values not specified in the description above
  are undefined.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">half4 <strong>read_imageh</strong> (<br>
  read_only image1d_array_t <em>image</em>,<br>
  sampler_t <em>sampler</em>,<br>
  int2 <em>coord</em>)</p>
<p class="tableblock">  half4 <strong>read_imageh</strong> (<br>
  read_only image1d_array_t <em>image</em>,<br>
  sampler_t <em>sampler</em>,<br>
  float2 <em>coord</em>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Use <em>coord.x</em> to do an element lookup in the 1D image identified by
  <em>coord.y</em> in the 1D image array specified by <em>image</em>.</p>
<p class="tableblock">  <strong>read_imageh</strong> returns half precision floating-point values in the range
  [0.0 &#8230;&#8203; 1.0] for image objects created with image_channel_data_type set
  to one of the pre-defined packed formats or <code>CL_UNORM_<wbr>INT8</code>, or
  <code>CL_UNORM_<wbr>INT16</code>.</p>
<p class="tableblock">  <strong>read_imageh</strong> returns half precision floating-point values in the range
  [-1.0 &#8230;&#8203; 1.0] for image objects created with image_channel_data_type set
  to <code>CL_SNORM_<wbr>INT8</code>, or <code>CL_SNORM_<wbr>INT16</code>.</p>
<p class="tableblock">  <strong>read_imageh</strong> returns half precision floating-point values for image
  objects created with image_channel_data_type set to <code>CL_HALF_<wbr>FLOAT</code>.</p>
<p class="tableblock">  The <strong>read_imageh</strong> calls that take integer coordinates must use a sampler
  with filter mode set to <code>CLK_FILTER_NEAREST</code>, normalized coordinates set to
  <code>CLK_NORMALIZED_COORDS_FALSE</code> and addressing mode set to
  <code>CLK_ADDRESS_CLAMP_TO_EDGE</code>, <code>CLK_ADDRESS_CLAMP</code> or <code>CLK_ADDRESS_NONE</code>;
  otherwise the values returned are undefined.</p>
<p class="tableblock">  Values returned by <strong>read_imageh</strong> for image objects with
  image_channel_data_type values not specified in the description above are
  undefined.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="_built_in_image_sampler_less_read_functions"><a class="anchor" href="#_built_in_image_sampler_less_read_functions"></a>5.2.10. Built-in Image Sampler-less Read Functions</h4>
<div class="paragraph">
<p><em>aQual</em> in Table 6.24 refers to one of the access qualifiers.
For sampler-less read functions this may be <em>read_only</em> or <em>read_write</em>.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 9. <em>Half Precision Built-in Image Sampler-less Read Functions</em></caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><strong>Function</strong></th>
<th class="tableblock halign-left valign-top"><strong>Description</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">half4 <strong>read_imageh</strong> (<br>
  <em>aQual</em> image2d_t <em>image</em>,<br>
  int2 <em>coord</em>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Use the coordinate <em>(coord.x, coord.y)</em> to do an element lookup in the 2D
  image object specified by <em>image</em>.</p>
<p class="tableblock">  <strong>read_imageh</strong> returns half precision floating-point values in the range
  [0.0 &#8230;&#8203; 1.0] for image objects created with <em>image_channel_data_type</em> set
  to one of the pre-defined packed formats or <code>CL_UNORM_<wbr>INT8</code>, or
  <code>CL_UNORM_<wbr>INT16</code>.</p>
<p class="tableblock">  <strong>read_imageh</strong> returns half precision floating-point values in the range
  [-1.0 &#8230;&#8203; 1.0] for image objects created with <em>image_channel_data_type</em>
  set to <code>CL_SNORM_<wbr>INT8</code>, or <code>CL_SNORM_<wbr>INT16</code>.</p>
<p class="tableblock">  <strong>read_imageh</strong> returns half precision floating-point values for image
  objects created with <em>image_channel_data_type</em> set to <code>CL_HALF_<wbr>FLOAT</code>.</p>
<p class="tableblock">  Values returned by <strong>read_imageh</strong> for image objects with
  <em>image_channel_data_type</em> values not specified in the description above
  are undefined.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">half4 <strong>read_imageh</strong> (<br>
  <em>aQual</em> image3d_t <em>image</em>,<br>
  int4 <em>coord</em> )</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Use the coordinate <em>(coord.x</em>, <em>coord.y</em>, <em>coord.z)</em> to do an element
  lookup in the 3D image object specified by <em>image</em>. <em>coord.w</em> is ignored.</p>
<p class="tableblock">  <strong>read_imageh</strong> returns half precision floating-point values in the range
  [0.0 &#8230;&#8203; 1.0] for image objects created with <em>image_channel_data_type</em> set
  to one of the pre-defined packed formats or <code>CL_UNORM_<wbr>INT8</code>, or
  <code>CL_UNORM_<wbr>INT16</code>.</p>
<p class="tableblock">  <strong>read_imageh</strong> returns half precision floating-point values in the range
  [-1.0 &#8230;&#8203; 1.0] for image objects created with <em>image_channel_data_type</em>
  set to <code>CL_SNORM_<wbr>INT8</code>, or <code>CL_SNORM_<wbr>INT16</code>.</p>
<p class="tableblock">  <strong>read_imageh</strong> returns half precision floating-point values for image
  objects created with <em>image_channel_data_type</em> set to <code>CL_HALF_<wbr>FLOAT</code>.</p>
<p class="tableblock">  Values returned by <strong>read_imageh</strong> for image objects with
  <em>image_channel_data_type</em> values not specified in the description are
  undefined.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">half4 <strong>read_imageh</strong> (<br>
  <em>aQual</em> image2d_array_t <em>image</em>,<br>
  int4 <em>coord</em>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Use <em>coord.xy</em> to do an element lookup in the 2D image identified by
  <em>coord.z</em> in the 2D image array specified by <em>image</em>.</p>
<p class="tableblock">  <strong>read_imageh</strong> returns half precision floating-point values in the range
  [0.0 &#8230;&#8203; 1.0] for image objects created with <em>image_channel_data_type</em> set
  to one of the pre-defined packed formats or <code>CL_UNORM_<wbr>INT8</code>, or
  <code>CL_UNORM_<wbr>INT16</code>.</p>
<p class="tableblock">  <strong>read_imageh</strong> returns half precision floating-point values in the range
  [-1.0 &#8230;&#8203; 1.0] for image objects created with <em>image_channel_data_type</em>
  set to <code>CL_SNORM_<wbr>INT8</code>, or <code>CL_SNORM_<wbr>INT16</code>.</p>
<p class="tableblock">  <strong>read_imageh</strong> returns half precision floating-point values for image
  objects created with <em>image_channel_data_type</em> set to <code>CL_HALF_<wbr>FLOAT</code>.</p>
<p class="tableblock">  Values returned by <strong>read_imageh</strong> for image objects with
  <em>image_channel_data_type</em> values not specified in the description above
  are undefined.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">half4 <strong>read_imageh</strong> (<br>
  <em>aQual</em> image1d_t <em>image</em>,<br>
  int <em>coord</em>)</p>
<p class="tableblock">  half4 <strong>read_imageh</strong> (<br>
  <em>aQual</em> image1d_buffer_t <em>image</em>,<br>
  int <em>coord</em>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Use <em>coord</em> to do an element lookup in the 1D image or 1D image buffer
  object specified by <em>image</em>.</p>
<p class="tableblock">  <strong>read_imageh</strong> returns half precision floating-point values in the range
  [0.0 &#8230;&#8203; 1.0] for image objects created with <em>image_channel_data_type</em> set
  to one of the pre-defined packed formats or <code>CL_UNORM_<wbr>INT8</code>, or
  <code>CL_UNORM_<wbr>INT16</code>.</p>
<p class="tableblock">  <strong>read_imageh</strong> returns half precision floating-point values in the range
  [-1.0 &#8230;&#8203; 1.0] for image objects created with <em>image_channel_data_type</em>
  set to <code>CL_SNORM_<wbr>INT8</code>, or <code>CL_SNORM_<wbr>INT16</code>.</p>
<p class="tableblock">  <strong>read_imageh</strong> returns half precision floating-point values for image
  objects created with <em>image_channel_data_type</em> set to <code>CL_HALF_<wbr>FLOAT</code>.</p>
<p class="tableblock">  Values returned by <strong>read_imageh</strong> for image objects with
  <em>image_channel_data_type</em> values not specified in the description above
  are undefined.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">half4 <strong>read_imageh</strong> (<br>
  <em>aQual</em> image1d_array_t <em>image</em>,<br>
  int2 <em>coord</em>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Use <em>coord.x</em> to do an element lookup in the 2D image identified by
  <em>coord.y</em> in the 2D image array specified by <em>image</em>.</p>
<p class="tableblock">  <strong>read_imageh</strong> returns half precision floating-point values in the range
  [0.0 &#8230;&#8203; 1.0] for image objects created with <em>image_channel_data_type</em> set
  to one of the pre-defined packed formats or <code>CL_UNORM_<wbr>INT8</code>, or
  <code>CL_UNORM_<wbr>INT16</code>.</p>
<p class="tableblock">  <strong>read_imageh</strong> returns half precision floating-point values in the range
  [-1.0 &#8230;&#8203; 1.0] for image objects created with <em>image_channel_data_type</em>
  set to <code>CL_SNORM_<wbr>INT8</code>, or <code>CL_SNORM_<wbr>INT16</code>.</p>
<p class="tableblock">  <strong>read_imageh</strong> returns half precision floating-point values for image
  objects created with <em>image_channel_data_type</em> set to <code>CL_HALF_<wbr>FLOAT</code>.</p>
<p class="tableblock">  Values returned by <strong>read_imageh</strong> for image objects with
  <em>image_channel_data_type</em> values not specified in the description above
  are undefined.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="_built_in_image_write_functions"><a class="anchor" href="#_built_in_image_write_functions"></a>5.2.11. Built-in Image Write Functions</h4>
<div class="paragraph">
<p><em>aQual</em> in Table 6.25 refers to one of the access qualifiers.
For write functions this may be <em>write_only</em> or <em>read_write</em>.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 10. <em>Half Precision Built-in Image Write Functions</em></caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><strong>Function</strong></th>
<th class="tableblock halign-left valign-top"><strong>Description</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">void <strong>write_imageh</strong> (<br>
  <em>aQual</em> image2d_t <em>image</em>,<br>
  int2 <em>coord</em>,<br>
  half4 <em>color</em>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Write <em>color</em> value to location specified by <em>coord.xy</em> in the 2D image
  specified by <em>image</em>.</p>
<p class="tableblock">  Appropriate data format conversion to the specified image format is done
  before writing the color value. <em>x</em> &amp; <em>y</em> are considered to be
  unnormalized coordinates and must be in the range 0 &#8230;&#8203; width - 1, and 0
  &#8230;&#8203; height - 1.</p>
<p class="tableblock">  <strong>write_imageh</strong> can only be used with image objects created with
  <em>image_channel_data_type</em> set to one of the pre-defined packed formats or
  set to <code>CL_SNORM_<wbr>INT8</code>, <code>CL_UNORM_<wbr>INT8</code>, <code>CL_SNORM_<wbr>INT16</code>, <code>CL_UNORM_<wbr>INT16</code> or
  <code>CL_HALF_<wbr>FLOAT</code>.</p>
<p class="tableblock">  The behavior of <strong>write_imageh</strong> for image objects created with
  <em>image_channel_data_type</em> values not specified in the description above or
  with (<em>x</em>, <em>y</em>) coordinate values that are not in the range (0 &#8230;&#8203; width -
  1, 0 &#8230;&#8203; height - 1) respectively, is undefined.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">void <strong>write_imageh</strong> (<br>
  <em>aQual</em> image2d_array_t <em>image</em>,<br>
  int4 <em>coord</em>,<br>
  half4 <em>color</em>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Write <em>color</em> value to location specified by <em>coord.xy</em> in the 2D image
  identified by <em>coord.z</em> in the 2D image array specified by <em>image</em>.</p>
<p class="tableblock">  Appropriate data format conversion to the specified image format is done
  before writing the color value. <em>coord.x</em>, <em>coord.y</em> and <em>coord.z</em> are
  considered to be unnormalized coordinates and must be in the range 0 &#8230;&#8203;
  image width - 1, 0 &#8230;&#8203; image height - 1 and 0 &#8230;&#8203; image number of layers -
  1.</p>
<p class="tableblock">  <strong>write_imageh</strong> can only be used with image objects created with
  <em>image_channel_data_type</em> set to one of the pre-defined packed formats or
  set to <code>CL_SNORM_<wbr>INT8</code>, <code>CL_UNORM_<wbr>INT8</code>, <code>CL_SNORM_<wbr>INT16</code>, <code>CL_UNORM_<wbr>INT16</code> or
  <code>CL_HALF_<wbr>FLOAT</code>.</p>
<p class="tableblock">  The behavior of <strong>write_imageh</strong> for image objects created with
  <em>image_channel_data_type</em> values not specified in the description above or
  with (<em>x</em>, <em>y, z</em>) coordinate values that are not in the range (0 &#8230;&#8203;
  image width - 1, 0 &#8230;&#8203; image height - 1, 0 &#8230;&#8203; image number of layers -
  1), respectively, is undefined.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">void <strong>write_imageh</strong> (<br>
  <em>aQual</em> image1d_t <em>image</em>,<br>
  int <em>coord</em>,<br>
  half4 <em>color</em>)</p>
<p class="tableblock">  void <strong>write_imageh</strong> (<br>
  <em>aQual</em> image1d_buffer_t <em>image</em>,<br>
  int <em>coord</em>,<br>
  half4 <em>color</em>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Write <em>color</em> value to location specified by <em>coord</em> in the 1D image or 1D
  image buffer object specified by <em>image</em>.
  Appropriate data format conversion to the specified image format is done
  before writing the color value.
  <em>coord</em> is considered to be unnormalized coordinates and must be in the
  range 0 &#8230;&#8203; image width - 1.</p>
<p class="tableblock">  <strong>write_imageh</strong> can only be used with image objects created with
  <em>image_channel_data_type</em> set to one of the pre-defined packed formats or
  set to <code>CL_SNORM_<wbr>INT8</code>, <code>CL_UNORM_<wbr>INT8</code>, <code>CL_SNORM_<wbr>INT16</code>, <code>CL_UNORM_<wbr>INT16</code> or
  <code>CL_HALF_<wbr>FLOAT</code>.
  Appropriate data format conversion will be done to convert channel data
  from a floating-point value to actual data format in which the channels
  are stored.</p>
<p class="tableblock">  The behavior of <strong>write_imageh</strong> for image objects created with
  <em>image_channel_data_type</em> values not specified in the description above or
  with coordinate values that is not in the range (0 &#8230;&#8203; image width - 1),
  is undefined.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">void <strong>write_imageh</strong> (<br>
  <em>aQual</em> image1d_array_t <em>image</em>,<br>
  int2 <em>coord</em>,<br>
  half4 <em>color</em>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Write <em>color</em> value to location specified by <em>coord.x</em> in the 1D image
  identified by <em>coord.y</em> in the 1D image array specified by <em>image</em>.
  Appropriate data format conversion to the specified image format is done
  before writing the color value. <em>coord.x</em> and <em>coord.y</em> are considered to
  be unnormalized coordinates and must be in the range 0 &#8230;&#8203; image width - 1
  and 0 &#8230;&#8203; image number of layers - 1.</p>
<p class="tableblock">  <strong>write_imageh</strong> can only be used with image objects created with
  <em>image_channel_data_type</em> set to one of the pre-defined packed formats or
  set to <code>CL_SNORM_<wbr>INT8</code>, <code>CL_UNORM_<wbr>INT8</code>, <code>CL_SNORM_<wbr>INT16</code>, <code>CL_UNORM_<wbr>INT16</code> or
  <code>CL_HALF_<wbr>FLOAT</code>.
  Appropriate data format conversion will be done to convert channel data
  from a floating-point value to actual data format in which the channels
  are stored.</p>
<p class="tableblock">  The behavior of <strong>write_imageh</strong> for image objects created with
  <em>image_channel_data_type</em> values not specified in the description above or
  with (<em>x</em>, <em>y</em>) coordinate values that are not in the range (0 &#8230;&#8203; image
  width - 1, 0 &#8230;&#8203; image number of layers - 1), respectively, is undefined.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">void <strong>write_imageh</strong> (<br>
  <em>aQual</em> image3d_t <em>image</em>,<br>
  int4 <em>coord</em>,<br>
  half4 <em>color</em>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Write color value to location specified by coord.xyz in the 3D image
  object specified by <em>image</em>.</p>
<p class="tableblock">  Appropriate data format conversion to the specified image format is done
  before writing the color value.
  coord.x, coord.y and coord.z are considered to be unnormalized coordinates
  and must be in the range 0 &#8230;&#8203; image width - 1, 0 &#8230;&#8203; image height - 1 and
  0 &#8230;&#8203; image depth - 1.</p>
<p class="tableblock">  <strong>write_imageh</strong> can only be used with image objects created with
  image_channel_data_type set to one of the pre-defined packed formats or
  set to <code>CL_SNORM_<wbr>INT8</code>, <code>CL_UNORM_<wbr>INT8</code>, <code>CL_SNORM_<wbr>INT16</code>, <code>CL_UNORM_<wbr>INT16</code> or
  <code>CL_HALF_<wbr>FLOAT</code>.</p>
<p class="tableblock">  The behavior of <strong>write_imageh</strong> for image objects created with
  image_channel_data_type values not specified in the description above or
  with (x, y, z) coordinate values that are not in the range (0 &#8230;&#8203; image
  width - 1, 0 &#8230;&#8203; image height - 1, 0 &#8230;&#8203; image depth - 1), respectively,
  is undefined.</p>
<p class="tableblock">  Note: This built-in function is only available if the
  cl_khr_3d_image_writes extension is also supported by the device.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="cl_khr_fp16-ieee754-compliance"><a class="anchor" href="#cl_khr_fp16-ieee754-compliance"></a>5.2.12. IEEE754 Compliance</h4>
<div class="paragraph">
<p>The following table entry describes the additions to <em>table 4.3,</em> which
allows applications to query the configuration information using
<strong>clGetDeviceInfo</strong> for an OpenCL device that supports half precision
floating-point.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><strong>Op-code</strong></th>
<th class="tableblock halign-left valign-top"><strong>Return Type</strong></th>
<th class="tableblock halign-left valign-top"><strong>Description</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CL_DEVICE_<wbr>HALF_<wbr>FP_<wbr>CONFIG</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>cl_device_<wbr>fp_<wbr>config</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Describes half precision floating-point capability of the OpenCL device.
  This is a bit-field that describes one or more of the following values:</p>
<p class="tableblock">  <code>CL_FP_<wbr>DENORM</code>&#8201;&#8212;&#8201;denorms are supported</p>
<p class="tableblock">  <code>CL_FP_<wbr>INF_<wbr>NAN</code>&#8201;&#8212;&#8201;INF and NaNs are supported</p>
<p class="tableblock">  <code>CL_FP_<wbr>ROUND_<wbr>TO_<wbr>NEAREST</code>&#8201;&#8212;&#8201;round to nearest even rounding mode supported</p>
<p class="tableblock">  <code>CL_FP_<wbr>ROUND_<wbr>TO_<wbr>ZERO</code>&#8201;&#8212;&#8201;round to zero rounding mode supported</p>
<p class="tableblock">  <code>CL_FP_<wbr>ROUND_<wbr>TO_<wbr>INF</code>&#8201;&#8212;&#8201;round to positive and negative infinity rounding
  modes supported</p>
<p class="tableblock">  <code>CL_FP_<wbr>FMA</code>&#8201;&#8212;&#8201;IEEE754-2008 fused multiply-add is supported</p>
<p class="tableblock">  <code>CL_FP_<wbr>SOFT_<wbr>FLOAT</code>&#8201;&#8212;&#8201;Basic floating-point operations (such as addition,
  subtraction, multiplication) are implemented in software.</p>
<p class="tableblock">  The required minimum half precision floating-point capability as
  implemented by this extension is:</p>
<p class="tableblock">  <code>CL_FP_<wbr>ROUND_<wbr>TO_<wbr>ZERO</code>, or <code>CL_FP_<wbr>ROUND_<wbr>TO_<wbr>NEAREST</code> | <code>CL_FP_<wbr>INF_<wbr>NAN</code>.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="cl_khr_fp16-rounding-modes"><a class="anchor" href="#cl_khr_fp16-rounding-modes"></a>5.2.13. Rounding Modes</h4>
<div class="paragraph">
<p>If <code>CL_FP_<wbr>ROUND_<wbr>TO_<wbr>NEAREST</code> is supported, the default rounding mode for
half-precision floating-point operations will be round to nearest even;
otherwise the default rounding mode will be round to zero.</p>
</div>
<div class="paragraph">
<p>Conversions to half floating point format must be correctly rounded using
the indicated <code>convert</code> operator rounding mode or the default rounding mode
for half-precision floating-point operations if no rounding mode is
specified by the operator, or a C-style cast is used.</p>
</div>
<div class="paragraph">
<p>Conversions from half to integer format shall correctly round using the
indicated <code>convert</code> operator rounding mode, or towards zero if no rounding
mode is specified by the operator or a C-style cast is used.
All conversions from half to floating point formats are exact.</p>
</div>
</div>
<div class="sect3">
<h4 id="cl_khr_fp16-relative-error-as-ulps"><a class="anchor" href="#cl_khr_fp16-relative-error-as-ulps"></a>5.2.14. Relative Error as ULPs</h4>
<div class="paragraph">
<p>In this section we discuss the maximum relative error defined as <em>ulp</em>
(units in the last place).</p>
</div>
<div class="paragraph">
<p>Addition, subtraction, multiplication, fused multiply-add operations on half
types are required to be correctly rounded using the default rounding mode
for half-precision floating-point operations.</p>
</div>
<div class="paragraph">
<p>The following table describes the minimum accuracy of half precision
floating-point arithmetic operations given as ULP values.
0 ULP is used for math functions that do not require rounding.
The reference value used to compute the ULP value of an arithmetic operation
is the infinitely precise result.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 11. <em>ULP Values for Half Precision Floating-Point Arithmetic Operations</em></caption>
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><strong>Function</strong></th>
<th class="tableblock halign-left valign-top"><strong>Min Accuracy - Full Profile</strong></th>
<th class="tableblock halign-left valign-top"><strong>Min Accuracy - Embedded Profile</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong><em>x</em> + <em>y</em></strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Correctly rounded</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Correctly rounded</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong><em>x</em> - <em>y</em></strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Correctly rounded</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Correctly rounded</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong><em>x</em> * <em>y</em></strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Correctly rounded</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Correctly rounded</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>1.0 / <em>x</em></strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Correctly rounded</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&lt;= 1 ulp</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong><em>x</em> / <em>y</em></strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Correctly rounded</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&lt;= 1 ulp</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>acos</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&lt;= 2 ulp</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&lt;= 3 ulp</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>acosh</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&lt;= 2 ulp</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&lt;= 3 ulp</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>acospi</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&lt;= 2 ulp</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&lt;= 3 ulp</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>asin</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&lt;= 2 ulp</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&lt;= 3 ulp</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>asinh</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&lt;= 2 ulp</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&lt;= 3 ulp</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>asinpi</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&lt;= 2 ulp</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&lt;= 3 ulp</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>atan</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&lt;= 2 ulp</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&lt;= 3 ulp</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>atanh</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&lt;= 2 ulp</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&lt;= 3 ulp</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>atanpi</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&lt;= 2 ulp</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&lt;= 3 ulp</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>atan2</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&lt;= 2 ulp</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&lt;= 3 ulp</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>atan2pi</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&lt;= 2 ulp</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&lt;= 3 ulp</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>cbrt</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&lt;= 2 ulp</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&lt;= 2 ulp</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>ceil</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Correctly rounded</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Correctly rounded</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>clamp</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0 ulp</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0 ulp</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>copysign</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0 ulp</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0 ulp</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>cos</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&lt;= 2 ulp</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&lt;= 2 ulp</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>cosh</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&lt;= 2 ulp</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&lt;= 3 ulp</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>cospi</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&lt;= 2 ulp</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&lt;= 2 ulp</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>cross</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">absolute error tolerance of 'max * max * (3 * HALF_EPSILON)' per vector component, where <em>max</em> is the maximum input operand magnitude</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Implementation-defined</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>degrees</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&lt;= 2 ulp</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&lt;= 2 ulp</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>distance</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&lt;= 2n ulp, for gentype with vector width <em>n</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Implementation-defined</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>dot</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">absolute error tolerance of 'max * max * (2n - 1) * HALF_EPSILON', for vector width <em>n</em> and maximum input operand magnitude <em>max</em> across all vector components</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Implementation-defined</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>erfc</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&lt;= 4 ulp</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&lt;= 4 ulp</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>erf</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&lt;= 4 ulp</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&lt;= 4 ulp</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>exp</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&lt;= 2 ulp</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&lt;= 3 ulp</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>exp2</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&lt;= 2 ulp</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&lt;= 3 ulp</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>exp10</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&lt;= 2 ulp</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&lt;= 3 ulp</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>expm1</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&lt;= 2 ulp</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&lt;= 3 ulp</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>fabs</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0 ulp</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0 ulp</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>fdim</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Correctly rounded</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Correctly rounded</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>floor</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Correctly rounded</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Correctly rounded</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>fma</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Correctly rounded</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Correctly rounded</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>fmax</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0 ulp</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0 ulp</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>fmin</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0 ulp</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0 ulp</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>fmod</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0 ulp</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0 ulp</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>fract</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Correctly rounded</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Correctly rounded</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>frexp</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0 ulp</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0 ulp</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>hypot</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&lt;= 2 ulp</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&lt;= 3 ulp</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>ilogb</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0 ulp</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0 ulp</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>ldexp</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Correctly rounded</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Correctly rounded</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>length</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&lt;= 0.25 + 0.5n ulp, for gentype with vector width <em>n</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Implementation-defined</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>log</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&lt;= 2 ulp</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&lt;= 3 ulp</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>log2</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&lt;= 2 ulp</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&lt;= 3 ulp</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>log10</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&lt;= 2 ulp</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&lt;= 3 ulp</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>log1p</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&lt;= 2 ulp</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&lt;= 3 ulp</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>logb</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0 ulp</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0 ulp</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>mad</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Implementation-defined</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Implementation-defined</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>max</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0 ulp</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0 ulp</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>maxmag</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0 ulp</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0 ulp</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>min</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0 ulp</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0 ulp</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>minmag</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0 ulp</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0 ulp</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>mix</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Implementation-defined</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Implementation-defined</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>modf</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0 ulp</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0 ulp</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>nan</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0 ulp</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0 ulp</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>nextafter</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0 ulp</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0 ulp</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>normalize</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&lt;= 1 + n ulp, for gentype with vector width <em>n</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Implementation-defined</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>pow(x, y)</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&lt;= 4 ulp</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&lt;= 5 ulp</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>pown(x, y)</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&lt;= 4 ulp</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&lt;= 5 ulp</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>powr(x, y)</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&lt;= 4 ulp</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&lt;= 5 ulp</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>radians</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&lt;= 2 ulp</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&lt;= 2 ulp</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>remainder</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0 ulp</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0 ulp</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>remquo</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0 ulp for the remainder, at least the lower 7 bits of the integral quotient</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0 ulp for the remainder, at least the lower 7 bits of the integral quotient</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>rint</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Correctly rounded</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Correctly rounded</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>rootn</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&lt;= 4 ulp</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&lt;= 5 ulp</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>round</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Correctly rounded</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Correctly rounded</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>rsqrt</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&lt;=1 ulp</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&lt;=1 ulp</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>sign</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0 ulp</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0 ulp</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>sin</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&lt;= 2 ulp</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&lt;= 2 ulp</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>sincos</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&lt;= 2 ulp for sine and cosine values</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&lt;= 2 ulp for sine and cosine values</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>sinh</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&lt;= 2 ulp</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&lt;= 3 ulp</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>sinpi</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&lt;= 2 ulp</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&lt;= 2 ulp</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>smoothstep</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Implementation-defined</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Implementation-defined</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>sqrt</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Correctly rounded</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&lt;= 1 ulp</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>step</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0 ulp</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0 ulp</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>tan</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&lt;= 2 ulp</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&lt;= 3 ulp</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>tanh</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&lt;= 2 ulp</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&lt;= 3 ulp</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>tanpi</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&lt;= 2 ulp</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&lt;= 3 ulp</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>tgamma</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&lt;= 4 ulp</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&lt;= 4 ulp</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>trunc</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Correctly rounded</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Correctly rounded</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Note: <em>Implementations may perform floating-point operations on</em> <code>half</code>
<em>scalar or vector data types by converting the</em> <code>half</code> <em>values to single
precision floating-point values and performing the operation in single
precision floating-point.
In this case, the implementation will use the</em> <code>half</code> <em>scalar or vector data
type as a storage only format</em>.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="cl_khr_fp16-additions-to-chapter-8-of-the-opencl-2.0-specification"><a class="anchor" href="#cl_khr_fp16-additions-to-chapter-8-of-the-opencl-2.0-specification"></a>5.3. Additions to Chapter 8 of the OpenCL 2.0 C Specification</h3>
<div class="paragraph">
<p>Add new sub-sections to <em>section 8.3.1. Conversion rules for normalized integer channel data types</em>:</p>
</div>
<div class="sect3">
<h4 id="cl_khr_fp16-converting-normalized-integer-channel-data-types-to-floating-point-values"><a class="anchor" href="#cl_khr_fp16-converting-normalized-integer-channel-data-types-to-floating-point-values"></a>5.3.1. Converting normalized integer channel data types to half precision floating-point values</h4>
<div class="paragraph">
<p>For images created with image channel data type of <code>CL_UNORM_<wbr>INT8</code> and
<code>CL_UNORM_<wbr>INT16</code>, <strong>read_imagef</strong> will convert the channel values from an
8-bit or 16-bit unsigned integer to normalized half precision
floating-point values in the range [<code>0.0h</code>, <code>1.0h</code>].</p>
</div>
<div class="paragraph">
<p>For images created with image channel data type of <code>CL_SNORM_<wbr>INT8</code> and
<code>CL_SNORM_<wbr>INT16</code>, <strong>read_imagef</strong> will convert the channel values from an
8-bit or 16-bit signed integer to normalized half precision floating-point
values in the range [<code>-1.0h</code>, <code>1.0h</code>].</p>
</div>
<div class="paragraph">
<p>These conversions are performed as follows:</p>
</div>
<div class="paragraph">
<p><code>CL_UNORM_<wbr>INT8</code> (8-bit unsigned integer)  <code>half</code></p>
</div>
<div class="ulist none">
<ul class="none">
<li>
<p>normalized <code>half</code> value = <code>round_to_half(c / 255)</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p><code>CL_UNORM_<wbr>INT_<wbr>101010</code> (10-bit unsigned integer)  <code>half</code></p>
</div>
<div class="ulist none">
<ul class="none">
<li>
<p>normalized <code>half</code> value = <code>round_to_half(c / 1023)</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p><code>CL_UNORM_<wbr>INT16</code> (16-bit unsigned integer)  <code>half</code></p>
</div>
<div class="ulist none">
<ul class="none">
<li>
<p>normalized <code>half</code> value = <code>round_to_half(c / 65535)</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p><code>CL_SNORM_<wbr>INT8</code> (8-bit signed integer)  <code>half</code></p>
</div>
<div class="ulist none">
<ul class="none">
<li>
<p>normalized <code>half</code> value = <code>max(-1.0h, round_to_half(c / 127))</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p><code>CL_SNORM_<wbr>INT16</code> (16-bit signed integer)  <code>half</code></p>
</div>
<div class="ulist none">
<ul class="none">
<li>
<p>normalized <code>half</code> value = <code>max(-1.0h, round_to_half(c / 32767))</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The accuracy of the above conversions must be &lt;= 1.5 ulp except for the
following cases.</p>
</div>
<div class="paragraph">
<p>For <code>CL_UNORM_<wbr>INT8</code></p>
</div>
<div class="ulist none">
<ul class="none">
<li>
<p>0 must convert to <code>0.0h</code> and</p>
</li>
<li>
<p>255 must convert to <code>1.0h</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>For <code>CL_UNORM_<wbr>INT_<wbr>101010</code></p>
</div>
<div class="ulist none">
<ul class="none">
<li>
<p>0 must convert to <code>0.0h</code> and</p>
</li>
<li>
<p>1023 must convert to <code>1.0h</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>For <code>CL_UNORM_<wbr>INT16</code></p>
</div>
<div class="ulist none">
<ul class="none">
<li>
<p>0 must convert to <code>0.0h</code> and</p>
</li>
<li>
<p>65535 must convert to <code>1.0h</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>For <code>CL_SNORM_<wbr>INT8</code></p>
</div>
<div class="ulist none">
<ul class="none">
<li>
<p>-128 and -127 must convert to <code>-1.0h</code>,</p>
</li>
<li>
<p>0 must convert to <code>0.0h</code> and</p>
</li>
<li>
<p>127 must convert to <code>1.0h</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>For <code>CL_SNORM_<wbr>INT16</code></p>
</div>
<div class="ulist none">
<ul class="none">
<li>
<p>-32768 and -32767 must convert to <code>-1.0h</code>,</p>
</li>
<li>
<p>0 must convert to <code>0.0h</code> and</p>
</li>
<li>
<p>32767 must convert to <code>1.0h</code></p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="cl_khr_fp16-converting-floating-point-values-to-normalized-integer-channel-data-types"><a class="anchor" href="#cl_khr_fp16-converting-floating-point-values-to-normalized-integer-channel-data-types"></a>5.3.2. Converting half precision floating-point values to normalized integer channel data types</h4>
<div class="paragraph">
<p>For images created with image channel data type of <code>CL_UNORM_<wbr>INT8</code> and
<code>CL_UNORM_<wbr>INT16</code>, <strong>write_imagef</strong> will convert the floating-point color value
to an 8-bit or 16-bit unsigned integer.</p>
</div>
<div class="paragraph">
<p>For images created with image channel data type of <code>CL_SNORM_<wbr>INT8</code> and
<code>CL_SNORM_<wbr>INT16</code>, <strong>write_imagef</strong> will convert the floating-point color value
to an 8-bit or 16-bit signed integer.</p>
</div>
<div class="paragraph">
<p>The preferred conversion uses the round to nearest even (<code>_rte</code>) rounding
mode, but OpenCL implementations may choose to approximate the rounding mode
used in the conversions described below.
When approximate rounding is used instead of the preferred rounding,
the result of the conversion must satisfy the bound given below.</p>
</div>
<div class="paragraph">
<p><code>half</code>  <code>CL_UNORM_<wbr>INT8</code> (8-bit unsigned integer)</p>
</div>
<div class="ulist none">
<ul class="none">
<li>
<p>Let f<sub>exact</sub> = <strong>max</strong>(<code>0</code>, <strong>min</strong>(<code>f * 255</code>, <code>255</code>))</p>
</li>
<li>
<p>Let f<sub>preferred</sub> = <strong>convert_uchar_sat_rte</strong>(<code>f * 255.0f</code>)</p>
</li>
<li>
<p>Let f<sub>approx</sub> = <strong>convert_uchar_sat_&lt;impl-rounding-mode&gt;</strong>(<code>f * 255.0f</code>)</p>
</li>
<li>
<p><strong>fabs</strong>(f<sub>exact</sub> - f<sub>approx</sub>) must be &lt;= 0.6</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><code>half</code>  <code>CL_UNORM_<wbr>INT_<wbr>101010</code> (10-bit unsigned integer)</p>
</div>
<div class="ulist none">
<ul class="none">
<li>
<p>Let f<sub>exact</sub> = <strong>max</strong>(<code>0</code>, <strong>min</strong>(<code>f * 1023</code>, <code>1023</code>))</p>
</li>
<li>
<p>Let f<sub>preferred</sub> = <strong>min</strong>(<strong>convert_ushort_sat_rte</strong>(<code>f * 1023.0f</code>), <code>1023</code>)</p>
</li>
<li>
<p>Let f<sub>approx</sub> = <strong>convert_ushort_sat_&lt;impl-rounding-mode&gt;</strong>(<code>f * 1023.0f</code>)</p>
</li>
<li>
<p><strong>fabs</strong>(f<sub>exact</sub> - f<sub>approx</sub>) must be &lt;= 0.6</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><code>half</code>  <code>CL_UNORM_<wbr>INT16</code> (16-bit unsigned integer)</p>
</div>
<div class="ulist none">
<ul class="none">
<li>
<p>Let f<sub>exact</sub> = <strong>max</strong>(<code>0</code>, <strong>min</strong>(<code>f * 65535</code>, <code>65535</code>))</p>
</li>
<li>
<p>Let f<sub>preferred</sub> = <strong>convert_ushort_sat_rte</strong>(<code>f * 65535.0f</code>)</p>
</li>
<li>
<p>Let f<sub>approx</sub> = <strong>convert_ushort_sat_&lt;impl-rounding-mode&gt;</strong>(<code>f * 65535.0f</code>)</p>
</li>
<li>
<p><strong>fabs</strong>(f<sub>exact</sub> - f<sub>approx</sub>) must be &lt;= 0.6</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><code>half</code>  <code>CL_SNORM_<wbr>INT8</code> (8-bit signed integer)</p>
</div>
<div class="ulist none">
<ul class="none">
<li>
<p>Let f<sub>exact</sub> = <strong>max</strong>(<code>-128</code>, <strong>min</strong>(<code>f * 127</code>, <code>127</code>))</p>
</li>
<li>
<p>Let f<sub>preferred</sub> = <strong>convert_char_sat_rte</strong>(<code>f * 127.0f</code>)</p>
</li>
<li>
<p>Let f<sub>approx</sub> = <strong>convert_char_sat_&lt;impl_rounding_mode&gt;</strong>(<code>f * 127.0f</code>)</p>
</li>
<li>
<p><strong>fabs</strong>(f<sub>exact</sub> - f<sub>approx</sub>) must be &lt;= 0.6</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><code>half</code>  <code>CL_SNORM_<wbr>INT16</code> (16-bit signed integer)</p>
</div>
<div class="ulist none">
<ul class="none">
<li>
<p>Let f<sub>exact</sub> = <strong>max</strong>(<code>-32768</code>, <strong>min</strong>(<code>f * 32767</code>, <code>32767</code>))</p>
</li>
<li>
<p>Let f<sub>preferred</sub> = <strong>convert_short_sat_rte</strong>(<code>f * 32767.0f</code>)</p>
</li>
<li>
<p>Let f<sub>approx</sub> = <strong>convert_short_sat_&lt;impl-rounding-mode&gt;</strong>(<code>f * 32767.0f</code>)</p>
</li>
<li>
<p><strong>fabs</strong>(f<sub>exact</sub> - f<sub>approx</sub>) must be &lt;= 0.6</p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="cl_khr_fp64"><a class="anchor" href="#cl_khr_fp64"></a>6. Double Precision Floating-Point</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This section describes the <strong>cl_khr_fp64</strong> extension.
This extension became an optional core feature in OpenCL 1.2.</p>
</div>
<div class="sect2">
<h3 id="_general_information_5"><a class="anchor" href="#_general_information_5"></a>6.1. General information</h3>
<div class="sect3">
<h4 id="_version_history_5"><a class="anchor" href="#_version_history_5"></a>6.1.1. Version history</h4>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 60%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><strong>Date</strong></th>
<th class="tableblock halign-left valign-top"><strong>Version</strong></th>
<th class="tableblock halign-left valign-top"><strong>Description</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">2020-04-21</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.0.0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">First assigned version.</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect2">
<h3 id="cl_khr_fp64-additions-to-chapter-6"><a class="anchor" href="#cl_khr_fp64-additions-to-chapter-6"></a>6.2. Additions to Chapter 6</h3>
<div class="paragraph">
<p>The list of built-in scalar, and vector data types defined in <em>tables 6.1</em>
and <em>6.2</em> are extended to include the following:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 25%;">
<col style="width: 75%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><strong>Type</strong></th>
<th class="tableblock halign-left valign-top"><strong>Description</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>double</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A double precision float.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>double2</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A 2-component double-precision floating-point vector.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>double3</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A 3-component double-precision floating-point vector.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>double4</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A 4-component double-precision floating-point vector.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>double8</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A 8-component double-precision floating-point vector.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>double16</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A 16-component double-precision floating-point vector.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>The built-in scalar and vector data types for <code>doublen</code> are also declared as appropriate
types in the OpenCL API (and header files) that can be used by an
application.
The following table describes the built-in scalar and vector data types for <code>doublen</code> as
defined in the OpenCL C programming language and the corresponding data type
available to the application:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><strong>Type in OpenCL Language</strong></th>
<th class="tableblock halign-left valign-top"><strong>API type for application</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>double</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>cl_double</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>double2</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>cl_double2</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>double3</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>cl_double3</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>double4</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>cl_double4</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>double8</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>cl_double8</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>double16</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>cl_double16</strong></p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>The double data type must conform to the IEEE-754 double precision storage format.</p>
</div>
<div class="paragraph">
<p>The following text is added to <em>Section 6.1.1.1 The half data type</em>:</p>
</div>
<div class="paragraph">
<p>Conversions from double to half are correctly rounded.
Conversions from half to double are lossless.</p>
</div>
<div class="sect3">
<h4 id="cl_khr_fp64-conversions"><a class="anchor" href="#cl_khr_fp64-conversions"></a>6.2.1. Conversions</h4>
<div class="paragraph">
<p>The implicit conversion rules specified in <em>section 6.2.1</em> now include the
<code>double</code> scalar and <code>doublen</code> vector data types.</p>
</div>
<div class="paragraph">
<p>The explicit casts described in <em>section 6.2.2</em> are extended to take a
<code>double</code> scalar data type and a <code>doublen</code> vector data type.</p>
</div>
<div class="paragraph">
<p>The explicit conversion functions described in <em>section 6.2.3</em> are extended
to take a <code>double</code> scalar data type and a <code>doublen</code> vector data type.</p>
</div>
<div class="paragraph">
<p>The <code>as_typen()</code> function for re-interpreting types as described in <em>section
6.2.4.2</em> is extended to allow conversion-free casts between <code>longn</code>,
<code>ulongn</code> and <code>doublen</code> scalar and vector data types.</p>
</div>
</div>
<div class="sect3">
<h4 id="cl_khr_fp64-math-functions"><a class="anchor" href="#cl_khr_fp64-math-functions"></a>6.2.2. Math Functions</h4>
<div class="paragraph">
<p>The built-in math functions defined in <em>table 6.8</em> (also listed below) are
extended to include appropriate versions of functions that take <code>double</code> and
<code>double{2|3|4|8|16}</code> as arguments and return values.
<code>gentype</code> now also includes <code>double</code>, <code>double2</code>, <code>double3</code>, <code>double4</code>, <code>double8</code> and
<code>double16</code>.</p>
</div>
<div class="paragraph">
<p>For any specific use of a function, the actual type has to be the same for
all arguments and the return type.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 12. <em>Double Precision Built-in Math Functions</em></caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><strong>Function</strong></th>
<th class="tableblock halign-left valign-top"><strong>Description</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">gentype <strong>acos</strong> (gentype <em>x</em>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Arc cosine function.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">gentype <strong>acosh</strong> (gentype <em>x</em>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Inverse hyperbolic cosine.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">gentype <strong>acospi</strong> (gentype <em>x</em>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Compute <strong>acos</strong> (<em>x</em>) / .</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">gentype <strong>asin</strong> (gentype <em>x</em>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Arc sine function.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">gentype <strong>asinh</strong> (gentype <em>x</em>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Inverse hyperbolic sine.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">gentype <strong>asinpi</strong> (gentype <em>x</em>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Compute <strong>asin</strong> (<em>x</em>) / .</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">gentype <strong>atan</strong> (gentype <em>y_over_x</em>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Arc tangent function.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">gentype <strong>atan2</strong> (gentype <em>y</em>, gentype <em>x</em>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Arc tangent of <em>y</em> / <em>x</em>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">gentype <strong>atanh</strong> (gentype <em>x</em>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Hyperbolic arc tangent.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">gentype <strong>atanpi</strong> (gentype <em>x</em>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Compute <strong>atan</strong> (<em>x</em>) / .</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">gentype <strong>atan2pi</strong> (gentype <em>y</em>, gentype <em>x</em>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Compute <strong>atan2</strong> (<em>y</em>, <em>x</em>) / .</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">gentype <strong>cbrt</strong> (gentype <em>x</em>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Compute cube-root.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">gentype <strong>ceil</strong> (gentype <em>x</em>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Round to integral value using the round to positive infinity rounding
  mode.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">gentype <strong>copysign</strong> (gentype <em>x</em>, gentype <em>y</em>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Returns <em>x</em> with its sign changed to match the sign of <em>y</em>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">gentype <strong>cos</strong> (gentype <em>x</em>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Compute cosine.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">gentype <strong>cosh</strong> (gentype <em>x</em>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Compute hyperbolic cosine.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">gentype <strong>cospi</strong> (gentype <em>x</em>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Compute <strong>cos</strong> ( <em>x</em>).</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">gentype <strong>erfc</strong> (gentype <em>x</em>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Complementary error function.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">gentype <strong>erf</strong> (gentype <em>x</em>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Error function encountered in integrating the normal distribution.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">gentype <strong>exp</strong> (gentype <em>x</em>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Compute the base- e exponential of <em>x</em>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">gentype <strong>exp2</strong> (gentype <em>x</em>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Exponential base 2 function.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">gentype <strong>exp10</strong> (gentype <em>x</em>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Exponential base 10 function.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">gentype <strong>expm1</strong> (gentype <em>x</em>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Compute <em>e<sup>x</sup></em>- 1.0.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">gentype <strong>fabs</strong> (gentype <em>x</em>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Compute absolute value of a floating-point number.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">gentype <strong>fdim</strong> (gentype <em>x</em>, gentype <em>y</em>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>x</em> - <em>y</em> if <em>x</em> &gt; <em>y</em>, +0 if x is less than or equal to y.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">gentype <strong>floor</strong> (gentype <em>x</em>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Round to integral value using the round to negative infinity rounding
  mode.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">gentype <strong>fma</strong> (gentype <em>a</em>, gentype <em>b</em>, gentype <em>c</em>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Returns the correctly rounded floating-point representation of the sum of
  <em>c</em> with the infinitely precise product of <em>a</em> and <em>b</em>.
  Rounding of intermediate products shall not occur.
  Edge case behavior is per the IEEE 754-2008 standard.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">gentype <strong>fmax</strong> (gentype <em>x</em>, gentype <em>y</em>)<br>
  gentype <strong>fmax</strong> (gentype <em>x</em>, double <em>y</em>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Returns <em>y</em> if <em>x</em> &lt; <em>y</em>, otherwise it returns <em>x</em>.
  If one argument is a NaN, <strong>fmax()</strong> returns the other argument.
  If both arguments are NaNs, <strong>fmax()</strong> returns a NaN.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">gentype <strong>fmin</strong> (gentype <em>x</em>, gentype <em>y</em>)<br>
  gentype <strong>fmin</strong> (gentype <em>x</em>, double <em>y</em>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Returns <em>y</em> if <em>y</em> &lt; <em>x</em>, otherwise it returns <em>x</em>.
  If one argument is a NaN, <strong>fmin()</strong> returns the other argument.
  If both arguments are NaNs, <strong>fmin()</strong> returns a NaN.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">gentype <strong>fmod</strong> (gentype <em>x</em>, gentype <em>y</em>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Modulus.
  Returns <em>x</em> - <em>y</em> * <strong>trunc</strong> (<em>x</em>/<em>y</em>) .</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">gentype <strong>fract</strong> (gentype <em>x</em>, __global gentype *<em>iptr</em>)<br>
  gentype <strong>fract</strong> (gentype <em>x</em>, __local gentype *<em>iptr</em>)<br>
  gentype <strong>fract</strong> (gentype <em>x</em>, __private gentype *<em>iptr</em>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Returns <strong>fmin</strong>( <em>x</em> - <strong>floor</strong> (<em>x</em>), 0x1. fffffffffffffp-1 ).</p>
<p class="tableblock">  <strong>floor</strong>(x) is returned in <em>iptr</em>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">double<em>n</em> <strong>frexp</strong> (double<em>n x</em>, __global int<em>n</em> *exp)<br>
  double<em>n</em> <strong>frexp</strong> (double<em>n x</em>, __local int<em>n</em> *exp)<br>
  double<em>n</em> <strong>frexp</strong> (double<em>n x</em>, __private int<em>n</em> *exp)<br>
  double <strong>frexp</strong> (double <em>x</em>, __global int *exp)<br>
  double <strong>frexp</strong> (double <em>x</em>, __local int *exp)<br>
  double <strong>frexp</strong> (double <em>x</em>, __private int *exp)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Extract mantissa and exponent from <em>x</em>.
  For each component the mantissa returned is a float with magnitude in the
  interval [1/2, 1) or 0.
  Each component of <em>x</em> equals mantissa returned * 2<em><sup>exp</sup></em>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">gentype <strong>hypot</strong> (gentype <em>x</em>, gentype <em>y</em>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Compute the value of the square root of <em>x</em><sup>2</sup>+ <em>y</em><sup>2</sup> without undue
  overflow or underflow.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">int<em>n</em> <strong>ilogb</strong> (double<em>n</em> <em>x</em>)<br>
  int <strong>ilogb</strong> (double <em>x</em>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Return the exponent as an integer value.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">double<em>n</em> <strong>ldexp</strong> (double<em>n</em> <em>x</em>, int<em>n</em> <em>k</em>)<br>
  double<em>n</em> <strong>ldexp</strong> (double<em>n</em> <em>x</em>, int <em>k</em>)<br>
  double <strong>ldexp</strong> (double <em>x</em>, int <em>k</em>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Multiply <em>x</em> by 2 to the power <em>k</em>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">gentype <strong>lgamma</strong> (gentype <em>x</em>)<br>
  double<em>n</em> <strong>lgamma_r</strong> (double<em>n</em> <em>x</em>, __global int<em>n</em> *<em>signp</em>)<br>
  double<em>n</em> <strong>lgamma_r</strong> (double<em>n</em> <em>x</em>, __local int<em>n</em> *<em>signp</em>)<br>
  double<em>n</em> <strong>lgamma_r</strong> (double<em>n</em> <em>x</em>, __private int<em>n</em> *<em>signp</em>)<br>
  double <strong>lgamma_r</strong> (double <em>x</em>, __global int *<em>signp</em>)<br>
  double <strong>lgamma_r</strong> (double <em>x</em>, __local int *<em>signp</em>)<br>
  double <strong>lgamma_r</strong> (double <em>x</em>, __private int *<em>signp</em>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Log gamma function.
  Returns the natural logarithm of the absolute value of the gamma function.
  The sign of the gamma function is returned in the <em>signp</em> argument of
  <strong>lgamma_r</strong>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">gentype <strong>log</strong> (gentype <em>x</em>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Compute natural logarithm.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">gentype <strong>log2</strong> (gentype <em>x</em>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Compute a base 2 logarithm.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">gentype <strong>log10</strong> (gentype <em>x</em>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Compute a base 10 logarithm.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">gentype <strong>log1p</strong> (gentype <em>x</em>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Compute log<sub>e</sub>(1.0 + <em>x</em>) .</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">gentype <strong>logb</strong> (gentype <em>x</em>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Compute the exponent of <em>x</em>, which is the integral part of
  log<em><sub>r</sub></em>|<em>x</em>|.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">gentype <strong>mad</strong> (gentype <em>a</em>, gentype <em>b</em>, gentype <em>c</em>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>mad</strong> computes <em>a</em> * <em>b</em> + <em>c</em>.
  The function may compute <em>a</em> * <em>b</em> + <em>c</em> with reduced accuracy
  in the embedded profile.  See the OpenCL SPIR-V Environment Specification
  for details. On some hardware the mad instruction may provide better
  performance than expanded computation of <em>a</em> * <em>b</em> + <em>c</em>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">gentype <strong>maxmag</strong> (gentype <em>x</em>, gentype <em>y</em>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Returns <em>x</em> if |<em>x</em>| &gt; |<em>y</em>|, <em>y</em> if |<em>y</em>| &gt; |<em>x</em>|, otherwise
  <strong>fmax</strong>(<em>x</em>, <em>y</em>).</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">gentype <strong>minmag</strong> (gentype <em>x</em>, gentype <em>y</em>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Returns <em>x</em> if |<em>x</em>| &lt; |<em>y</em>|, <em>y</em> if |<em>y</em>| &lt; |<em>x</em>|, otherwise
  <strong>fmin</strong>(<em>x</em>, <em>y</em>).</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">gentype <strong>modf</strong> (gentype <em>x</em>, __global gentype *<em>iptr</em>)<br>
  gentype <strong>modf</strong> (gentype <em>x</em>, __local gentype *<em>iptr</em>)<br>
  gentype <strong>modf</strong> (gentype <em>x</em>, __private gentype *<em>iptr</em>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Decompose a floating-point number.
  The <strong>modf</strong> function breaks the argument <em>x</em> into integral and fractional
  parts, each of which has the same sign as the argument.
  It stores the integral part in the object pointed to by <em>iptr</em>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">double<em>n</em> <strong>nan</strong> (ulong<em>n nancode</em>)<br>
  double <strong>nan</strong> (ulong <em>nancode</em>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Returns a quiet NaN.
  The <em>nancode</em> may be placed in the significand of the resulting NaN.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">gentype <strong>nextafter</strong> (gentype <em>x</em>, gentype <em>y</em>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Computes the next representable double-precision floating-point value
  following <em>x</em> in the direction of <em>y</em>.
  Thus, if <em>y</em> is less than <em>x</em>, <strong>nextafter</strong>() returns the largest
  representable floating-point number less than <em>x</em>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">gentype <strong>pow</strong> (gentype <em>x</em>, gentype <em>y</em>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Compute <em>x</em> to the power <em>y</em>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">double<em>n</em> <strong>pown</strong> (double<em>n</em> <em>x</em>, int<em>n</em> <em>y</em>)<br>
  double <strong>pown</strong> (double <em>x</em>, int <em>y</em>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Compute <em>x</em> to the power <em>y</em>, where <em>y</em> is an integer.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">gentype <strong>powr</strong> (gentype <em>x</em>, gentype <em>y</em>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Compute <em>x</em> to the power <em>y</em>, where <em>x</em> is &gt;= 0.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">gentype <strong>remainder</strong> (gentype <em>x</em>, gentype <em>y</em>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Compute the value <em>r</em> such that <em>r</em> = <em>x</em> - <em>n</em>*<em>y</em>, where <em>n</em> is the
  integer nearest the exact value of <em>x</em>/<em>y</em>.
  If there are two integers closest to <em>x</em>/<em>y</em>, <em>n</em> shall be the even one.
  If <em>r</em> is zero, it is given the same sign as <em>x</em>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">double<em>n</em> <strong>remquo</strong> (double<em>n</em> <em>x</em>, double<em>n</em> <em>y</em>, __global int<em>n</em> *<em>quo</em>)<br>
  double<em>n</em> <strong>remquo</strong> (double<em>n</em> <em>x</em>, double<em>n</em> <em>y</em>, __local int<em>n</em> *<em>quo</em>)<br>
  double<em>n</em> <strong>remquo</strong> (double<em>n</em> <em>x</em>, double<em>n</em> <em>y</em>, __private int<em>n</em> *<em>quo</em>)<br>
  double <strong>remquo</strong> (double <em>x</em>, double <em>y</em>, __global int *<em>quo</em>)<br>
  double <strong>remquo</strong> (double <em>x</em>, double <em>y</em>, __local int *<em>quo</em>)<br>
  double <strong>remquo</strong> (double <em>x</em>, double <em>y</em>, __private int *<em>quo</em>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The <strong>remquo</strong> function computes the value r such that <em>r</em> = <em>x</em> - <em>k</em>*<em>y</em>,
  where <em>k</em> is the integer nearest the exact value of <em>x</em>/<em>y</em>.
  If there are two integers closest to <em>x</em>/<em>y</em>, <em>k</em> shall be the even one.
  If <em>r</em> is zero, it is given the same sign as <em>x</em>.
  This is the same value that is returned by the <strong>remainder</strong> function.
  <strong>remquo</strong> also calculates the lower seven bits of the integral quotient
  <em>x</em>/<em>y</em>, and gives that value the same sign as <em>x</em>/<em>y</em>.
  It stores this signed value in the object pointed to by <em>quo</em>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">gentype <strong>rint</strong> (gentype <em>x</em>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Round to integral value (using round to nearest even rounding mode) in
  floating-point format.
  Refer to section 7.1 for description of rounding modes.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">double<em>n</em> <strong>rootn</strong> (double<em>n</em> <em>x</em>, int<em>n</em> <em>y</em>)<br>
  double <strong>rootn</strong> (double <em>x</em>, int <em>y</em>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Compute <em>x</em> to the power 1/<em>y</em>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">gentype <strong>round</strong> (gentype <em>x</em>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Return the integral value nearest to <em>x</em> rounding halfway cases away from
  zero, regardless of the current rounding direction.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">gentype <strong>rsqrt</strong> (gentype <em>x</em>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Compute inverse square root.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">gentype <strong>sin</strong> (gentype <em>x</em>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Compute sine.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">gentype <strong>sincos</strong> (gentype <em>x</em>, __global gentype *<em>cosval</em>)<br>
  gentype <strong>sincos</strong> (gentype <em>x</em>, __local gentype *<em>cosval</em>)<br>
  gentype <strong>sincos</strong> (gentype <em>x</em>, __private gentype *<em>cosval</em>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Compute sine and cosine of x.
  The computed sine is the return value and computed cosine is returned in
  <em>cosval</em>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">gentype <strong>sinh</strong> (gentype <em>x</em>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Compute hyperbolic sine.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">gentype <strong>sinpi</strong> (gentype <em>x</em>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Compute <strong>sin</strong> ( <em>x</em>).</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">gentype <strong>sqrt</strong> (gentype <em>x</em>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Compute square root.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">gentype <strong>tan</strong> (gentype <em>x</em>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Compute tangent.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">gentype <strong>tanh</strong> (gentype <em>x</em>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Compute hyperbolic tangent.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">gentype <strong>tanpi</strong> (gentype <em>x</em>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Compute <strong>tan</strong> ( <em>x</em>).</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">gentype <strong>tgamma</strong> (gentype <em>x</em>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Compute the gamma function.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">gentype <strong>trunc</strong> (gentype <em>x</em>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Round to integral value using the round to zero rounding mode.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>In addition, the following symbolic constant will also be available:</p>
</div>
<div class="paragraph">
<p><strong>HUGE_VAL</strong> - A positive double expression that evaluates to infinity.
Used as an error value returned by the built-in math functions.</p>
</div>
<div class="paragraph">
<p>The <strong>FP_FAST_FMA</strong> macro indicates whether the <strong>fma()</strong> family of
functions are fast compared with direct code for double precision
floating-point.
If defined, the <strong>FP_FAST_FMA</strong> macro shall indicate that the <strong>fma()</strong>
function generally executes about as fast as, or faster than, a multiply and
an add of <strong>double</strong> operands.</p>
</div>
<div class="paragraph">
<p>The macro names given in the following list must use the values specified.
These constant expressions are suitable for use in #if preprocessing
directives.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="opencl_c"><span class="cp">#define DBL_DIG             15
#define DBL_MANT_DIG        53
#define DBL_MAX_10_EXP      +308
#define DBL_MAX_EXP         +1024
#define DBL_MIN_10_EXP      -307
#define DBL_MIN_EXP         -1021
#define DBL_RADIX           2
#define DBL_MAX             0x1.fffffffffffffp1023
#define DBL_MIN             0x1.0p-1022
#define DBL_EPSILON         0x1.0p-52</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The following table describes the built-in macro names given above in the
OpenCL C programming language and the corresponding macro names available to
the application.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><strong>Macro in OpenCL Language</strong></th>
<th class="tableblock halign-left valign-top"><strong>Macro for application</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>DBL_DIG</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CL_DBL_<wbr>DIG</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>DBL_MANT_DIG</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CL_DBL_<wbr>MANT_<wbr>DIG</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>DBL_MAX_10_EXP</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CL_DBL_<wbr>MAX_<wbr>10_<wbr>EXP</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>DBL_MAX_EXP</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CL_DBL_<wbr>MAX_<wbr>EXP</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>DBL_MIN_10_EXP</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CL_DBL_<wbr>MIN_<wbr>10_<wbr>EXP</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>DBL_MIN_EXP</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CL_DBL_<wbr>MIN_<wbr>EXP</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>DBL_RADIX</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CL_DBL_<wbr>RADIX</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>DBL_MAX</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CL_DBL_<wbr>MAX</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>DBL_MIN</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CL_DBL_<wbr>MIN</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>DBL_EPSILSON</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CL_DBL_<wbr>EPSILON</code></p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>The following constants are also available.
They are of type <code>double</code> and are accurate within the precision of the <code>double</code>
type.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><strong>Constant</strong></th>
<th class="tableblock halign-left valign-top"><strong>Description</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>M_E</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Value of e</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>M_LOG2E</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Value of log<sub>2</sub>e</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>M_LOG10E</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Value of log<sub>10</sub>e</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>M_LN2</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Value of log<sub>e</sub>2</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>M_LN10</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Value of log<sub>e</sub>10</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>M_PI</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Value of </p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>M_PI_2</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Value of  / 2</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>M_PI_4</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Value of  / 4</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>M_1_PI</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Value of 1 / </p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>M_2_PI</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Value of 2 / </p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>M_2_SQRTPI</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Value of 2 / </p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>M_SQRT2</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Value of 2</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>M_SQRT1_2</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Value of 1 / 2</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="cl_khr_fp64-common-functions"><a class="anchor" href="#cl_khr_fp64-common-functions"></a>6.2.3. Common Functions</h4>
<div class="paragraph">
<p>The built-in common functions defined in <em>table 6.12</em> (also listed below)
are extended to include appropriate versions of functions that take <code>double</code>
and <code>double{2|3|4|8|16}</code> as arguments and return values.
gentype now also includes <code>double</code>, <code>double2</code>, <code>double3</code>, <code>double4</code>, <code>double8</code> and
<code>double16</code>.
These are described below.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 13. Double Precision Built-in Common Functions</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><strong>Function</strong></th>
<th class="tableblock halign-left valign-top"><strong>Description</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">gentype <strong>clamp</strong> (<br>
  gentype <em>x</em>, gentype <em>minval</em>, gentype <em>maxval</em>)</p>
<p class="tableblock">  gentype <strong>clamp</strong> (<br>
  gentype <em>x</em>, double <em>minval</em>, double <em>maxval</em>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Returns <strong>fmin</strong>(<strong>fmax</strong>(<em>x</em>, <em>minval</em>), <em>maxval</em>).</p>
<p class="tableblock">  Results are undefined if <em>minval</em> &gt; <em>maxval</em>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">gentype <strong>degrees</strong> (gentype <em>radians</em>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Converts <em>radians</em> to degrees,<br>
  i.e. (180 / ) * <em>radians</em>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">gentype <strong>max</strong> (gentype <em>x</em>, gentype <em>y</em>)<br>
  gentype <strong>max</strong> (gentype <em>x</em>, double <em>y</em>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Returns <em>y</em> if <em>x</em> &lt; <em>y</em>, otherwise it returns <em>x</em>.
  If <em>x</em> and <em>y</em> are infinite or NaN, the return values are undefined.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">gentype <strong>min</strong> (gentype <em>x</em>, gentype <em>y</em>)<br>
  gentype <strong>min</strong> (gentype <em>x</em>, double <em>y</em>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Returns <em>y</em> if <em>y</em> &lt; <em>x</em>, otherwise it returns <em>x</em>.
  If <em>x</em> and <em>y</em> are infinite or NaN, the return values are undefined.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">gentype <strong>mix</strong> (gentype <em>x</em>, gentype <em>y</em>, gentype <em>a</em>)<br>
  gentype <strong>mix</strong> (gentype <em>x</em>, gentype <em>y</em>, double <em>a</em>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Returns the linear blend of <em>x</em> and <em>y</em> implemented as:</p>
<p class="tableblock">  <em>x</em> + (<em>y</em> - <em>x)</em> * <em>a</em></p>
<p class="tableblock">  <em>a</em> must be a value in the range 0.0 &#8230;&#8203; 1.0.
  If <em>a</em> is not in the range 0.0 &#8230;&#8203; 1.0, the return values are undefined.</p>
<p class="tableblock">  Note: The double precision <strong>mix</strong> function can be implemented using contractions such as <strong>mad</strong> or <strong>fma</strong>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">gentype <strong>radians</strong> (gentype <em>degrees</em>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Converts <em>degrees</em> to radians, i.e. ( / 180) * <em>degrees</em>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">gentype <strong>step</strong> (gentype <em>edge</em>, gentype <em>x</em>)<br>
  gentype <strong>step</strong> (double <em>edge</em>, gentype <em>x</em>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Returns 0.0 if <em>x</em> &lt; <em>edge</em>, otherwise it returns 1.0.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">gentype <strong>smoothstep</strong> (<br>
  gentype <em>edge0</em>, gentype <em>edge1</em>, gentype <em>x</em>)<br></p>
<p class="tableblock">  gentype <strong>smoothstep</strong> (<br>
  double <em>edge0</em>, double <em>edge1</em>, gentype <em>x</em>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Returns 0.0 if <em>x</em> &lt;= <em>edge0</em> and 1.0 if <em>x</em> &gt;= <em>edge1</em> and performs
  smooth Hermite interpolation between 0 and 1 when <em>edge0</em> &lt; <em>x</em> &lt; <em>edge1</em>.
  This is useful in cases where you would want a threshold function with a
  smooth transition.</p>
<p class="tableblock">  This is equivalent to:</p>
<p class="tableblock">  gentype <em>t</em>;<br>
  <em>t</em> = clamp ((<em>x</em> - <em>edge0</em>) / (<em>edge1</em> - <em>edge0</em>), 0, 1);<br>
  return <em>t</em> * <em>t</em> * (3 - 2 * <em>t</em>);<br></p>
<p class="tableblock">  Results are undefined if <em>edge0</em> &gt;= <em>edge1</em>.</p>
<p class="tableblock">  Note: The double precision <strong>smoothstep</strong> function can be implemented using contractions such as <strong>mad</strong> or <strong>fma</strong>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">gentype <strong>sign</strong> (gentype <em>x</em>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Returns 1.0 if <em>x</em> &gt; 0, -0.0 if <em>x</em> = -0.0, +0.0 if <em>x</em> = +0.0, or -1.0 if
  <em>x</em> &lt; 0.
  Returns 0.0 if <em>x</em> is a NaN.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="cl_khr_fp64-geometric-functions"><a class="anchor" href="#cl_khr_fp64-geometric-functions"></a>6.2.4. Geometric Functions</h4>
<div class="paragraph">
<p>The built-in geometric functions defined in <em>table 6.13</em> (also listed below)
are extended to include appropriate versions of functions that take <code>double</code>
and <code>double{2|3|4}</code> as arguments and return values.
gentype now also includes <code>double</code>, <code>double2</code>, <code>double3</code> and <code>double4</code>.
These are described below.</p>
</div>
<div class="paragraph">
<p>Note: The double precision geometric functions can be implemented using
contractions such as <strong>mad</strong> or <strong>fma</strong>.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 14. <em>Double Precision Built-in Geometric Functions</em></caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><strong>Function</strong></th>
<th class="tableblock halign-left valign-top"><strong>Description</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">double4 <strong>cross</strong> (double4 <em>p0</em>, double4 <em>p1</em>)<br>
  double3 <strong>cross</strong> (double3 <em>p0</em>, double3 <em>p1</em>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Returns the cross product of <em>p0.xyz</em> and <em>p1.xyz</em>.
  The <em>w</em> component of the result will be 0.0.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">double <strong>dot</strong> (gentype <em>p0</em>, gentype <em>p1</em>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Compute the dot product of <em>p0</em> and <em>p1</em>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">double <strong>distance</strong> (gentype <em>p0</em>, gentype <em>p1</em>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Returns the distance between <em>p0</em> and <em>p1</em>.
  This is calculated as <strong>length</strong>(<em>p0</em> - <em>p1</em>).</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">double <strong>length</strong> (gentype <em>p</em>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Return the length of vector x, i.e.,<br>
  sqrt( <em>p.x</em><sup>2</sup> + <em>p.y</em><sup>2</sup> + &#8230;&#8203; )</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">gentype <strong>normalize</strong> (gentype <em>p</em>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Returns a vector in the same direction as <em>p</em> but with a length of 1.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="cl_khr_fp64-relational-functions"><a class="anchor" href="#cl_khr_fp64-relational-functions"></a>6.2.5. Relational Functions</h4>
<div class="paragraph">
<p>The scalar and vector relational functions described in <em>table 6.14</em> are
extended to include versions that take <code>double</code>, <code>double2</code>, <code>double3</code>, <code>double4</code>,
<code>double8</code> and <code>double16</code> as arguments.</p>
</div>
<div class="paragraph">
<p>The relational and equality operators (&lt;, &lt;=, &gt;, &gt;=, !=, ==) can be used
with <code>doublen</code> vector types and shall produce a vector <code>longn</code> result as
described in <em>section 6.3</em>.</p>
</div>
<div class="paragraph">
<p>The functions <strong>isequal</strong>, <strong>isnotequal</strong>, <strong>isgreater</strong>, <strong>isgreaterequal</strong>,
<strong>isless</strong>, <strong>islessequal</strong>, <strong>islessgreater</strong>, <strong>isfinite</strong>, <strong>isinf</strong>, <strong>isnan</strong>,
<strong>isnormal</strong>, <strong>isordered</strong>, <strong>isunordered</strong> and <strong>signbit</strong> shall return a 0 if the
specified relation is <em>false</em> and a 1 if the specified relation is true for
scalar argument types.
These functions shall return a 0 if the specified relation is <em>false</em> and a
-1 (i.e. all bits set) if the specified relation is <em>true</em> for vector
argument types.</p>
</div>
<div class="paragraph">
<p>The relational functions <strong>isequal</strong>, <strong>isgreater</strong>, <strong>isgreaterequal</strong>, <strong>isless</strong>,
<strong>islessequal</strong>, and <strong>islessgreater</strong> always return 0 if either argument is not
a number (NaN).
<strong>isnotequal</strong> returns 1 if one or both arguments are not a number (NaN) and
the argument type is a scalar and returns -1 if one or both arguments are
not a number (NaN) and the argument type is a vector.</p>
</div>
<div class="paragraph">
<p>The functions described in <em>table 6.14</em> are extended to include the <code>doublen</code>
vector types.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 15. <em>Double Precision Relational Functions</em></caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><strong>Function</strong></th>
<th class="tableblock halign-left valign-top"><strong>Description</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">int <strong>isequal</strong> (double <em>x</em>, double <em>y</em>)<br>
  long<em>n</em> <strong>isequal</strong> (double<em>n x</em>, double<em>n y</em>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Returns the component-wise compare of <em>x</em> == <em>y</em>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">int <strong>isnotequal</strong> (double <em>x</em>, double <em>y</em>)<br>
  long<em>n</em> <strong>isnotequal</strong> (double<em>n x</em>, double<em>n y</em>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Returns the component-wise compare of <em>x</em> != <em>y</em>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">int <strong>isgreater</strong> (double <em>x</em>, double <em>y</em>)<br>
  long<em>n</em> <strong>isgreater</strong> (double<em>n x</em>, double<em>n y</em>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Returns the component-wise compare of <em>x</em> &gt; <em>y</em>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">int <strong>isgreaterequal</strong> (double <em>x</em>, double <em>y</em>)<br>
  long<em>n</em> <strong>isgreaterequal</strong> (double<em>n x</em>, double<em>n y</em>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Returns the component-wise compare of <em>x</em> &gt;= <em>y</em>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">int <strong>isless</strong> (double <em>x</em>, double <em>y</em>)<br>
  long<em>n</em> <strong>isless</strong> (double<em>n x</em>, double<em>n y</em>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Returns the component-wise compare of <em>x</em> &lt; <em>y</em>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">int <strong>islessequal</strong> (double <em>x</em>, double <em>y</em>)<br>
  long<em>n</em> <strong>islessequal</strong> (double<em>n x</em>, double<em>n y</em>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Returns the component-wise compare of <em>x</em> &lt;= <em>y</em>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">int <strong>islessgreater</strong> (double <em>x</em>, double <em>y</em>)<br>
  long<em>n</em> <strong>islessgreater</strong> (double<em>n x</em>, double<em>n y</em>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Returns the component-wise compare of (<em>x</em> &lt; <em>y</em>) || (<em>x</em> &gt; <em>y</em>) .</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">int <strong>isfinite</strong> (double)<br>
  long<em>n</em> <strong>isfinite</strong> (double<em>n</em>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Test for finite value.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">int <strong>isinf</strong> (double)<br>
  long<em>n</em> <strong>isinf</strong> (double<em>n</em>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Test for infinity value (positive or negative) .</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">int <strong>isnan</strong> (double)<br>
  long<em>n</em> <strong>isnan</strong> (double<em>n</em>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Test for a NaN.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">int <strong>isnormal</strong> (double)<br>
  long<em>n</em> <strong>isnormal</strong> (double<em>n</em>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Test for a normal value.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">int <strong>isordered</strong> (double <em>x</em>, double <em>y</em>)<br>
  long<em>n</em> <strong>isordered</strong> (double<em>n x</em>, double<em>n y</em>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Test if arguments are ordered.
  <strong>isordered</strong>() takes arguments <em>x</em> and <em>y</em>, and returns the result
  <strong>isequal</strong>(<em>x</em>, <em>x</em>) &amp;&amp; <strong>isequal</strong>(<em>y</em>, <em>y</em>).</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">int <strong>isunordered</strong> (double <em>x</em>, double <em>y</em>)<br>
  long<em>n</em> <strong>isunordered</strong> (double<em>n x</em>, double<em>n y</em>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Test if arguments are unordered.
  <strong>isunordered</strong>() takes arguments <em>x</em> and <em>y</em>, returning non-zero if <em>x</em> or
  <em>y</em> is a NaN, and zero otherwise.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">int <strong>signbit</strong> (double)<br>
  long<em>n</em> <strong>signbit</strong> (double<em>n</em>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Test for sign bit.
  The scalar version of the function returns a 1 if the sign bit in the double
  is set else returns 0.
  The vector version of the function returns the following for each
  component in double<em>n</em>: -1 (i.e all bits set) if the sign bit in the double
  is set else returns 0.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">double<em>n</em> <strong>bitselect</strong> (double<em>n a</em>, double<em>n b</em>, double<em>n c</em>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Each bit of the result is the corresponding bit of <em>a</em> if the
  corresponding bit of <em>c</em> is 0.
  Otherwise it is the corresponding bit of <em>b</em>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">double<em>n</em> <strong>select</strong> (double<em>n a</em>, double<em>n b</em>, long<em>n c</em>)<br>
  double<em>n</em> <strong>select</strong> (double<em>n a</em>, double<em>n b</em>, ulong<em>n c</em>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">For each component,<br>
  <em>result[i]</em> = if MSB of <em>c[i]</em> is set ? <em>b[i]</em> : <em>a[i]</em>.<br></p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="cl_khr_fp64-vector-data-load-and-store-functions"><a class="anchor" href="#cl_khr_fp64-vector-data-load-and-store-functions"></a>6.2.6. Vector Data Load and Store Functions</h4>
<div class="paragraph">
<p>The vector data load (<strong>vload<em>n</em></strong>) and store (<strong>vstore<em>n</em></strong>) functions
described in <em>table 6.13</em> (also listed below) are extended to include
versions that read from or write to double scalar or vector values.
The generic type <code>gentype</code> is extended to include <code>double</code>.
The generic type <code>gentypen</code> is extended to include <code>double2</code>, <code>double3</code>,
<code>double4</code>, <code>double8</code> and <code>double16</code>.
The <strong>vstore_half</strong>, <strong>vstore_half<em>n </em></strong>and <strong>vstorea_half<em>n </em></strong>
functions are extended to allow a double precision scalar or vector
value to be written to memory as half values.</p>
</div>
<div class="paragraph">
<p>Note: <strong>vload3</strong> reads (<em>x</em>,<em>y</em>,<em>z</em>) components from address
<code>(<em>p</em> + (<em>offset</em> * 3))</code> into a 3-component vector.
<strong>vstore3</strong>, and <strong>vstore_half3</strong> write (<em>x</em>,<em>y</em>,<em>z</em>) components from a
3-component vector to address <code>(<em>p</em> + (<em>offset</em> * 3))</code>.
In addition, <strong>vloada_half3</strong> reads (<em>x</em>,<em>y</em>,<em>z</em>) components from address
<code>(<em>p</em> + (<em>offset</em> * 4))</code> into a 3-component vector and <strong>vstorea_half3</strong>
writes (<em>x</em>,<em>y</em>,<em>z</em>) components from a 3-component vector to address
<code>(<em>p</em> + (<em>offset</em> * 4))</code>.
Whether <strong>vloada_half3</strong> and <strong>vstorea_half3</strong> read/write padding data
between the third vector element and the next alignment boundary is
implementation defined.
<strong>vloada_</strong> and <strong>vstoreaa_</strong> variants are provided to access data that is
aligned to the size of the vector, and are intended to enable performance
on hardware that can take advantage of the increased alignment.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 16. <em>Double Precision Vector Data Load and Store Functions</em></caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><strong>Function</strong></th>
<th class="tableblock halign-left valign-top"><strong>Description</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">gentype<em>n</em> <strong>vload<em>n</em></strong>(size_t <em>offset</em>, const __global gentype *<em>p</em>)</p>
<p class="tableblock">  gentype<em>n</em> <strong>vload<em>n</em></strong>(size_t <em>offset</em>, const __local gentype *<em>p</em>)</p>
<p class="tableblock">  gentype<em>n</em> <strong>vload<em>n</em></strong>(size_t <em>offset</em>, const __constant gentype *<em>p</em>)</p>
<p class="tableblock">  gentype<em>n</em> <strong>vload<em>n</em></strong>(size_t <em>offset</em>, const __private gentype *<em>p</em>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Return sizeof (gentype<em>n</em>) bytes of data read from address
  (<em>p</em> + (<em>offset * n</em>)).
  If gentype is double, the read address computed as (<em>p</em> + (<em>offset * n</em>))
  must be 64-bit aligned.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">void <strong>vstore<em>n</em></strong>(gentype<em>n</em> <em>data</em>, size_t <em>offset</em>, __global gentype *<em>p</em>)</p>
<p class="tableblock">  void <strong>vstore<em>n</em></strong>(gentype<em>n</em> <em>data</em>, size_t <em>offset</em>, __local gentype *<em>p</em>)</p>
<p class="tableblock">  void <strong>vstore<em>n</em></strong>(gentype<em>n</em> <em>data</em>, size_t <em>offset</em>, __private gentype *<em>p</em>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Write sizeof (gentype<em>n</em>) bytes given by <em>data</em> to address
  (<em>p</em> + (<em>offset * n</em>)).
  If gentype is double, the write address computed as (<em>p</em> + (<em>offset * n</em>))
  must be 64-bit aligned.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">void <strong>vstore_half</strong>(double <em>data</em>, size_t <em>offset</em>, __global half *<em>p</em>)<br>
  void <strong>vstore_half_rte</strong>(double <em>data</em>, size_t <em>offset</em>, __global half *<em>p</em>)<br>
  void <strong>vstore_half_rtz</strong>(double <em>data</em>, size_t <em>offset</em>, __global half *<em>p</em>)<br>
  void <strong>vstore_half_rtp</strong>(double <em>data</em>, size_t <em>offset</em>, __global half *<em>p</em>)<br>
  void <strong>vstore_half_rtn</strong>(double <em>data</em>, size_t <em>offset</em>, __global half *<em>p</em>)<br></p>
<p class="tableblock">  void <strong>vstore_half</strong>(double <em>data</em>, size_t <em>offset</em>, __local half *<em>p</em>)<br>
  void <strong>vstore_half_rte</strong>(double <em>data</em>, size_t <em>offset</em>, __local half *<em>p</em>)<br>
  void <strong>vstore_half_rtz</strong>(double <em>data</em>, size_t <em>offset</em>, __local half *<em>p</em>)<br>
  void <strong>vstore_half_rtp</strong>(double <em>data</em>, size_t <em>offset</em>, __local half *<em>p</em>)<br>
  void <strong>vstore_half_rtn</strong>(double <em>data</em>, size_t <em>offset</em>, __local half *<em>p</em>)<br></p>
<p class="tableblock">  void <strong>vstore_half</strong>(double <em>data</em>, size_t <em>offset</em>, __private half *<em>p</em>)<br>
  void <strong>vstore_half_rte</strong>(double <em>data</em>, size_t <em>offset</em>, __private half *<em>p</em>)<br>
  void <strong>vstore_half_rtz</strong>(double <em>data</em>, size_t <em>offset</em>, __private half *<em>p</em>)<br>
  void <strong>vstore_half_rtp</strong>(double <em>data</em>, size_t <em>offset</em>, __private half *<em>p</em>)<br>
  void <strong>vstore_half_rtn</strong>(double <em>data</em>, size_t <em>offset</em>, __private half *<em>p</em>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The double value given by <em>data</em> is first converted to a half value
  using the appropriate rounding mode.
  The half value is then written to the address computed as
  (<em>p</em> + <em>offset</em>).
  The address computed as (<em>p</em> + <em>offset</em>) must be 16-bit aligned.</p>
<p class="tableblock">  <strong>vstore_half</strong> uses the current rounding mode.
  The default current rounding mode is round to nearest even.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">void <strong>vstore_half<em>n</em></strong>(double<em>n</em> <em>data</em>, size_t <em>offset</em>, __global half *<em>p</em>)<br>
  void <strong>vstore_half<em>n</em>_rte</strong>(double<em>n</em> <em>data</em>, size_t <em>offset</em>, __global half *<em>p</em>)<br>
  void <strong>vstore_half<em>n</em>_rtz</strong>(double<em>n</em> <em>data</em>, size_t <em>offset</em>, __global half *<em>p</em>)<br>
  void <strong>vstore_half<em>n</em>_rtp</strong>(double<em>n</em> <em>data</em>, size_t <em>offset</em>, __global half *<em>p</em>)<br>
  void <strong>vstore_half<em>n</em>_rtn</strong>(double<em>n</em> <em>data</em>, size_t <em>offset</em>, __global half *<em>p</em>)<br></p>
<p class="tableblock">  void <strong>vstore_half<em>n</em></strong>(double<em>n</em> <em>data</em>, size_t <em>offset</em>, __local half *<em>p</em>)<br>
  void <strong>vstore_half<em>n</em>_rte</strong>(double<em>n</em> <em>data</em>, size_t <em>offset</em>, __local half *<em>p</em>)<br>
  void <strong>vstore_half<em>n</em>_rtz</strong>(double<em>n</em> <em>data</em>, size_t <em>offset</em>, __local half *<em>p</em>)<br>
  void <strong>vstore_half<em>n</em>_rtp</strong>(double<em>n</em> <em>data</em>, size_t <em>offset</em>, __local half *<em>p</em>)<br>
  void <strong>vstore_half<em>n</em>_rtn</strong>(double<em>n</em> <em>data</em>, size_t <em>offset</em>, __local half *<em>p</em>)<br></p>
<p class="tableblock">  void <strong>vstore_half<em>n</em></strong>(double<em>n</em> <em>data</em>, size_t <em>offset</em>, __private half *<em>p</em>)<br>
  void <strong>vstore_half<em>n</em>_rte</strong>(double<em>n</em> <em>data</em>, size_t <em>offset</em>, __private half *<em>p</em>)<br>
  void <strong>vstore_half<em>n</em>_rtz</strong>(double<em>n</em> <em>data</em>, size_t <em>offset</em>, __private half *<em>p</em>)<br>
  void <strong>vstore_half<em>n</em>_rtp</strong>(double<em>n</em> <em>data</em>, size_t <em>offset</em>, __private half *<em>p</em>)<br>
  void <strong>vstore_half<em>n</em>_rtn</strong>(double<em>n</em> <em>data</em>, size_t <em>offset</em>, __private half *<em>p</em>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The double<em>n</em> value given by <em>data</em> is converted to a half<em>n</em> value
  using the appropriate rounding mode.
  The half<em>n </em>value is then written to the address computed as
  (<em>p</em> + (<em>offset * n</em>)).
  The address computed as (<em>p</em> + (<em>offset * n</em>)) must be 16-bit
  aligned.</p>
<p class="tableblock">  <strong>vstore_half<em>n </em></strong>uses the current rounding mode.
  The default current rounding mode is round to nearest even.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">void <strong>vstorea_half<em>n</em></strong>(double<em>n</em> <em>data</em>, size_t <em>offset</em>, __global half *<em>p</em>)<br>
  void <strong>vstorea_half<em>n</em>_rte</strong>(double<em>n</em> <em>data</em>, size_t <em>offset</em>, __global half *<em>p</em>)<br>
  void <strong>vstorea_half<em>n</em>_rtz</strong>(double<em>n</em> <em>data</em>, size_t <em>offset</em>, __global half *<em>p</em>)<br>
  void <strong>vstorea_half<em>n</em>_rtp</strong>(double<em>n</em> <em>data</em>, size_t <em>offset</em>, __global half *<em>p</em>)<br>
  void <strong>vstorea_half<em>n</em>_rtn</strong>(double<em>n</em> <em>data</em>, size_t <em>offset</em>, __global half *<em>p</em>)<br></p>
<p class="tableblock">  void <strong>vstorea_half<em>n</em></strong>(double<em>n</em> <em>data</em>, size_t <em>offset</em>, __local half *<em>p</em>)<br>
  void <strong>vstorea_half<em>n</em>_rte</strong>(double<em>n</em> <em>data</em>, size_t <em>offset</em>, __local half *<em>p</em>)<br>
  void <strong>vstorea_half<em>n</em>_rtz</strong>(double<em>n</em> <em>data</em>, size_t <em>offset</em>, __local half *<em>p</em>)<br>
  void <strong>vstorea_half<em>n</em>_rtp</strong>(double<em>n</em> <em>data</em>, size_t <em>offset</em>, __local half *<em>p</em>)<br>
  void <strong>vstorea_half<em>n</em>_rtn</strong>(double<em>n</em> <em>data</em>, size_t <em>offset</em>, __local half *<em>p</em>)<br></p>
<p class="tableblock">  void <strong>vstorea_half<em>n</em></strong>(double<em>n</em> <em>data</em>, size_t <em>offset</em>, __private half *<em>p</em>)<br>
  void <strong>vstorea_half<em>n</em>_rte</strong>(double<em>n</em> <em>data</em>, size_t <em>offset</em>, __private half *<em>p</em>)<br>
  void <strong>vstorea_half<em>n</em>_rtz</strong>(double<em>n</em> <em>data</em>, size_t <em>offset</em>, __private half *<em>p</em>)<br>
  void <strong>vstorea_half<em>n</em>_rtp</strong>(double<em>n</em> <em>data</em>, size_t <em>offset</em>, __private half *<em>p</em>)<br>
  void <strong>vstorea_half<em>n</em>_rtn</strong>(double<em>n</em> <em>data</em>, size_t <em>offset</em>, __private half *<em>p</em>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The double<em>n</em> value is converted to a half<em>n</em> value
  using the appropriate rounding mode.</p>
<p class="tableblock">  For n = 1, 2, 4, 8 or 16, the half<em>n</em> value is written to the
  address computed as
  (<em>p</em> + (<em>offset * n</em>)).
  The address computed as (<em>p</em> + (<em>offset * n</em>)) must be aligned to
  sizeof (half<em>n</em>) bytes.</p>
<p class="tableblock">  For n = 3, the half<em>3</em> value is written to the address computed as
  (<em>p</em> + (<em>offset * 4</em>)).
  The address computed as (<em>p</em> + (<em>offset * 4</em>)) must be aligned to
  sizeof (half) * 4 bytes.</p>
<p class="tableblock">  <strong>vstorea_half<em>n</em></strong> uses the current rounding mode.
  The default current rounding mode is round to nearest even.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="cl_khr_fp64-async-copies-from-global-to-local-memory-local-to-global-memory-and-prefetch"><a class="anchor" href="#cl_khr_fp64-async-copies-from-global-to-local-memory-local-to-global-memory-and-prefetch"></a>6.2.7. Async Copies from Global to Local Memory, Local to Global Memory, and Prefetch</h4>
<div class="paragraph">
<p>The OpenCL C programming language implements the following functions that
provide asynchronous copies between global and local memory and a prefetch
from global memory.</p>
</div>
<div class="paragraph">
<p>The generic type gentype is extended to include <code>double</code>, <code>double2</code>, <code>double3</code>,
<code>double4</code>, <code>double8</code> and <code>double16</code>.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 17. <em>Double Precision Built-in Async Copy and Prefetch Functions</em></caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><strong>Function</strong></th>
<th class="tableblock halign-left valign-top"><strong>Description</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">event_t <strong>async_work_group_copy</strong> (<br>
  __local gentype *<em>dst</em>,<br>
  const __global gentype *<em>src</em>,<br>
  size_t <em>num_gentypes</em>, event_t <em>event</em>)</p>
<p class="tableblock">  event_t <strong>async_work_group_copy</strong> (<br>
  __global gentype <em>*dst</em>,<br>
  const __local gentype *<em>src</em>,<br>
  size_t <em>num_gentypes</em>, event_t <em>event</em>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Perform an async copy of <em>num_gentypes</em> gentype elements from <em>src</em> to
  <em>dst</em>.
  The async copy is performed by all work-items in a work-group and this
  built-in function must therefore be encountered by all work-items in a
  work-group executing the kernel with the same argument values; otherwise
  the results are undefined.</p>
<p class="tableblock">  Returns an event object that can be used by <strong>wait_group_events</strong> to wait
  for the async copy to finish.
  The <em>event</em> argument can also be used to associate the
  <strong>async_work_group_copy</strong> with a previous async copy allowing an event to be
  shared by multiple async copies; otherwise <em>event</em> should be zero.</p>
<p class="tableblock">  If <em>event</em> argument is not zero, the event object supplied in <em>event</em>
  argument will be returned.</p>
<p class="tableblock">  This function does not perform any implicit synchronization of source data
  such as using a <strong>barrier</strong> before performing the copy.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">event_t <strong>async_work_group_strided_copy</strong> (<br>
  __local gentype <em>*dst</em>,<br>
  const __global gentype *<em>src</em>,<br>
  size_t <em>num_gentypes</em>,<br>
  size_t <em>src_stride</em>, event_t <em>event</em>)</p>
<p class="tableblock">  event_t <strong>async_work_group_strided_copy</strong> (<br>
  __global gentype <em>*dst</em>,<br>
  const __local gentype *<em>src</em>,<br>
  size_t <em>num_gentypes</em>,<br>
  size_t <em>dst_stride</em>, event_t <em>event</em>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Perform an async gather of <em>num_gentypes</em> gentype elements from <em>src</em> to
  <em>dst</em>.
  The <em>src_stride</em> is the stride in elements for each gentype element read
  from <em>src</em>.
  The async gather is performed by all work-items in a work-group and this
  built-in function must therefore be encountered by all work-items in a
  work-group executing the kernel with the same argument values; otherwise
  the results are undefined.</p>
<p class="tableblock">  Returns an event object that can be used by <strong>wait_group_events</strong> to wait
  for the async copy to finish.
  The <em>event</em> argument can also be used to associate the
  <strong>async_work_group_strided_copy</strong> with a previous async copy allowing an
  event to be shared by multiple async copies; otherwise <em>event</em> should be
  zero.</p>
<p class="tableblock">  If <em>event</em> argument is not zero, the event object supplied in <em>event</em>
  argument will be returned.</p>
<p class="tableblock">  This function does not perform any implicit synchronization of source data
  such as using a <strong>barrier</strong> before performing the copy.</p>
<p class="tableblock">  The behavior of <strong>async_work_group_strided_copy</strong> is undefined if
  <em>src_stride</em> or <em>dst_stride</em> is 0, or if the <em>src_stride</em> or <em>dst_stride</em>
  values cause the <em>src</em> or <em>dst</em> pointers to exceed the upper bounds of the
  address space during the copy.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">void <strong>wait_group_events</strong> (<br>
  int <em>num_events</em>, event_t *<em>event_list</em>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Wait for events that identify the <strong>async_work_group_copy</strong> operations to
  complete.
  The event objects specified in <em>event_list</em> will be released after the
  wait is performed.</p>
<p class="tableblock">  This function must be encountered by all work-items in a work-group
  executing the kernel with the same <em>num_events</em> and event objects
  specified in <em>event_list</em>; otherwise the results are undefined.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">void <strong>prefetch</strong> (<br>
  const __global gentype *<em>p</em>, size_t <em>num_gentypes</em>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Prefetch <em>num_gentypes</em> * sizeof(gentype) bytes into the global cache.
  The prefetch instruction is applied to a work-item in a work-group and
  does not affect the functional behavior of the kernel.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="cl_khr_fp64-ieee754-compliance"><a class="anchor" href="#cl_khr_fp64-ieee754-compliance"></a>6.2.8. IEEE754 Compliance</h4>
<div class="paragraph">
<p>The following table entry describes the additions to <em>table 4.3,</em> which
allows applications to query the configuration information using
<strong>clGetDeviceInfo</strong> for an OpenCL device that supports double precision
floating-point.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><strong>Op-code</strong></th>
<th class="tableblock halign-left valign-top"><strong>Return Type</strong></th>
<th class="tableblock halign-left valign-top"><strong>Description</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CL_DEVICE_<wbr>DOUBLE_<wbr>FP_<wbr>CONFIG</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>cl_device_<wbr>fp_<wbr>config</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Describes double precision floating-point capability of the OpenCL device.
  This is a bit-field that describes one or more of the following values:</p>
<p class="tableblock">  <code>CL_FP_<wbr>DENORM</code>&#8201;&#8212;&#8201;denorms are supported</p>
<p class="tableblock">  <code>CL_FP_<wbr>INF_<wbr>NAN</code>&#8201;&#8212;&#8201;INF and NaNs are supported</p>
<p class="tableblock">  <code>CL_FP_<wbr>ROUND_<wbr>TO_<wbr>NEAREST</code>&#8201;&#8212;&#8201;round to nearest even rounding mode supported</p>
<p class="tableblock">  <code>CL_FP_<wbr>ROUND_<wbr>TO_<wbr>ZERO</code>&#8201;&#8212;&#8201;round to zero rounding mode supported</p>
<p class="tableblock">  <code>CL_FP_<wbr>ROUND_<wbr>TO_<wbr>INF</code>&#8201;&#8212;&#8201;round to positive and negative infinity rounding
  modes supported</p>
<p class="tableblock">  <code>CL_FP_<wbr>FMA</code>&#8201;&#8212;&#8201;IEEE754-2008 fused multiply-add is supported</p>
<p class="tableblock">  <code>CL_FP_<wbr>SOFT_<wbr>FLOAT</code>&#8201;&#8212;&#8201;Basic floating-point operations (such as addition,
  subtraction, multiplication) are implemented in software.</p>
<p class="tableblock">  The required minimum double precision floating-point capability as
  implemented by this extension is:</p>
<p class="tableblock">  <code>CL_FP_<wbr>FMA</code> |<br>
  <code>CL_FP_<wbr>ROUND_<wbr>TO_<wbr>NEAREST</code> |<br>
  <code>CL_FP_<wbr>ROUND_<wbr>TO_<wbr>ZERO</code> |<br>
  <code>CL_FP_<wbr>ROUND_<wbr>TO_<wbr>INF</code> |<br>
  <code>CL_FP_<wbr>INF_<wbr>NAN</code> |<br>
  <code>CL_FP_<wbr>DENORM</code>.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>IEEE754 fused multiply-add, denorms, INF and NaNs are required to be
supported for double precision floating-point numbers and operations
on double precision floating-point numbers.</p>
</div>
</div>
<div class="sect3">
<h4 id="cl_khr_fp64-relative-error-as-ulps"><a class="anchor" href="#cl_khr_fp64-relative-error-as-ulps"></a>6.2.9. Relative Error as ULPs</h4>
<div class="paragraph">
<p>In this section we discuss the maximum relative error defined as <em>ulp</em>
(units in the last place).</p>
</div>
<div class="paragraph">
<p>Addition, subtraction, multiplication, fused multiply-add and conversion
between integer and a floating-point format are IEEE 754 compliant and
are therefore correctly rounded using round-to-nearest even rounding mode.</p>
</div>
<div class="paragraph">
<p>The following table describes the minimum accuracy of double precision
floating-point arithmetic operations given as ULP values.
0 ULP is used for math functions that do not require rounding.
The reference value used to compute the ULP value of an arithmetic operation
is the infinitely precise result.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 18. <em>ULP Values for Double Precision Floating-Point Arithmetic Operations</em></caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><strong>Function</strong></th>
<th class="tableblock halign-left valign-top"><strong>Min Accuracy</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong><em>x</em> + <em>y</em></strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Correctly rounded</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong><em>x</em> - <em>y</em></strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Correctly rounded</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong><em>x</em> * <em>y</em></strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Correctly rounded</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>1.0 / <em>x</em></strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Correctly rounded</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong><em>x</em> / <em>y</em></strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Correctly rounded</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>acos</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&lt;= 4 ulp</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>acosh</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&lt;= 4 ulp</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>acospi</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&lt;= 5 ulp</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>asin</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&lt;= 4 ulp</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>asinh</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&lt;= 4 ulp</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>asinpi</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&lt;= 5 ulp</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>atan</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&lt;= 5 ulp</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>atanh</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&lt;= 5 ulp</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>atanpi</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&lt;= 5 ulp</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>atan2</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&lt;= 6 ulp</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>atan2pi</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&lt;= 6 ulp</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>cbrt</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&lt;= 2 ulp</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>ceil</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Correctly rounded</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>clamp</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0 ulp</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>copysign</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0 ulp</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>cos</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&lt;= 4 ulp</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>cosh</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&lt;= 4 ulp</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>cospi</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&lt;= 4 ulp</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>cross</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">absolute error tolerance of 'max * max * (3 * FLT_EPSILON)' per vector component, where <em>max</em> is the maximum input operand magnitude</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>degrees</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&lt;= 2 ulp</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>distance</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&lt;= 5.5 + 2n ulp, for gentype with vector width <em>n</em></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>dot</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">absolute error tolerance of 'max * max * (2n - 1) * FLT_EPSILON', for vector width <em>n</em> and maximum input operand magnitude <em>max</em> across all vector components</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>erfc</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&lt;= 16 ulp</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>erf</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&lt;= 16 ulp</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>exp</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&lt;= 3 ulp</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>exp2</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&lt;= 3 ulp</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>exp10</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&lt;= 3 ulp</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>expm1</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&lt;= 3 ulp</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>fabs</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0 ulp</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>fdim</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Correctly rounded</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>floor</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Correctly rounded</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>fma</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Correctly rounded</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>fmax</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0 ulp</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>fmin</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0 ulp</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>fmod</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0 ulp</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>fract</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Correctly rounded</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>frexp</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0 ulp</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>hypot</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&lt;= 4 ulp</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>ilogb</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0 ulp</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>ldexp</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Correctly rounded</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>length</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&lt;= 5.5 + n ulp, for gentype with vector width <em>n</em></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>log</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&lt;= 3 ulp</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>log2</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&lt;= 3 ulp</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>log10</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&lt;= 3 ulp</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>log1p</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&lt;= 2 ulp</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>logb</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0 ulp</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>mad</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Implementation-defined</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>max</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0 ulp</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>maxmag</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0 ulp</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>min</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0 ulp</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>minmag</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0 ulp</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>mix</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Implementation-defined</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>modf</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0 ulp</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>nan</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0 ulp</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>nextafter</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0 ulp</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>normalize</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&lt;= 4.5 + n ulp, for gentype with vector width <em>n</em></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>pow(x, y)</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&lt;= 16 ulp</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>pown(x, y)</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&lt;= 16 ulp</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>powr(x, y)</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&lt;= 16 ulp</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>radians</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&lt;= 2 ulp</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>remainder</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0 ulp</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>remquo</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0 ulp for the remainder, at least the lower 7 bits of the integral quotient</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>rint</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Correctly rounded</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>rootn</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&lt;= 16 ulp</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>round</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Correctly rounded</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>rsqrt</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&lt;= 2 ulp</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>sign</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0 ulp</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>sin</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&lt;= 4 ulp</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>sincos</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&lt;= 4 ulp for sine and cosine values</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>sinh</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&lt;= 4 ulp</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>sinpi</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&lt;= 4 ulp</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>smoothstep</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Implementation-defined</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>sqrt</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Correctly rounded</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>step</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0 ulp</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>tan</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&lt;= 5 ulp</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>tanh</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&lt;= 5 ulp</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>tanpi</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&lt;= 6 ulp</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>tgamma</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&lt;= 16 ulp</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>trunc</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Correctly rounded</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="cl_khr_int32_atomics"><a class="anchor" href="#cl_khr_int32_atomics"></a>7. 32-bit Atomics</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This section describes the extensions <strong>cl_khr_global_int32_base_atomics</strong>, <strong>cl_khr_global_int32_extended_atomics</strong>, <strong>cl_khr_local_int32_base_atomics</strong>, and <strong>cl_khr_local_int32_extended_atomics</strong>.
These extensions allow atomic operations to be performed on 32-bit signed and unsigned integers in global and local memory.</p>
</div>
<div class="paragraph">
<p>These extensions became core features in OpenCL 1.1, except the built-in atomic function names are changed to use the <strong>atomic_</strong> prefix instead of <strong>atom_</strong> and the volatile qualifier was added to the pointer parameter <em>p</em>.</p>
</div>
<div class="sect2">
<h3 id="_general_information_6"><a class="anchor" href="#_general_information_6"></a>7.1. General information</h3>
<div class="sect3">
<h4 id="_version_history_6"><a class="anchor" href="#_version_history_6"></a>7.1.1. Version history</h4>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 60%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><strong>Date</strong></th>
<th class="tableblock halign-left valign-top"><strong>Version</strong></th>
<th class="tableblock halign-left valign-top"><strong>Description</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">2020-04-21</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.0.0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">First assigned version.</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_global_atomics_for_32_bit_integers"><a class="anchor" href="#_global_atomics_for_32_bit_integers"></a>7.2. Global Atomics for 32-bit Integers</h3>
<div class="sect3">
<h4 id="_base_atomics"><a class="anchor" href="#_base_atomics"></a>7.2.1. Base Atomics</h4>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 19. <em>Built-in Atomic Functions for</em> <strong>cl_khr_global_int32_base_atomics</strong></caption>
<colgroup>
<col style="width: 64.2857%;">
<col style="width: 35.7143%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><strong>Function</strong></th>
<th class="tableblock halign-left valign-top"><strong>Description</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">int <strong>atom_add</strong> (volatile __global int *<em>p</em>, int <em>val</em>)<br>
uint <strong>atom_add</strong> (volatile __global uint *<em>p</em>, uint <em>val</em>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Read the 32-bit value (referred to as <em>old</em>) stored at location
pointed by <em>p</em>. Compute (<em>old</em> + <em>val</em>) and store result at location
pointed by <em>p</em>. The function returns <em>old</em>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">int <strong>atom_sub</strong> (volatile __global int *<em>p</em>, int <em>val</em>)<br>
uint <strong>atom_sub</strong> (volatile __global uint *<em>p</em>, uint <em>val</em>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Read the 32-bit value (referred to as <em>old</em>) stored at location
pointed by <em>p</em>. Compute (<em>old</em> - <em>val</em>) and store result at location
pointed by <em>p</em>. The function returns <em>old</em>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">int <strong>atom_xchg</strong> (volatile __global int *<em>p</em>, int <em>val</em>)<br>
uint <strong>atom_xchg</strong> (volatile __global uint *<em>p</em>, uint <em>val</em>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Swaps the <em>old</em> value stored at location <em>p</em> with new value given by
<em>val</em>. Returns <em>old</em> value.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">int <strong>atom_inc</strong> (volatile __global int *<em>p</em>)<br>
uint <strong>atom_inc</strong> (volatile __global uint *<em>p</em>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Read the 32-bit value (referred to as <em>old</em>) stored at location
pointed by <em>p</em>. Compute (<em>old</em> + <em>1</em>) and store result at location
pointed by <em>p</em>. The function returns <em>old</em>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">int <strong>atom_dec</strong> (volatile __global int *<em>p</em>)<br>
uint <strong>atom_dec</strong> (volatile __global uint *<em>p</em>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Read the 32-bit value (referred to as <em>old</em>) stored at location
pointed by <em>p</em>. Compute (<em>old</em> - <em>1</em>) and store result at location
pointed by <em>p</em>. The function returns <em>old</em>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">int <strong>atom_cmpxchg</strong> (volatile __global int *<em>p</em>, int <em>cmp</em>, int <em>val</em>)<br>
uint <strong>atom_cmpxchg</strong> (volatile __global uint *<em>p</em>, uint <em>cmp</em>, uint <em>val</em>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Read the 32-bit value (referred to as <em>old</em>) stored at location
pointed by <em>p</em>. Compute (<em>old</em> == <em>cmp</em>) ? <em>val</em> : <em>old</em> and store
result at location pointed by <em>p</em>. The function returns <em>old</em>.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="_extended_atomics"><a class="anchor" href="#_extended_atomics"></a>7.2.2. Extended Atomics</h4>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 20. <em>Built-in Atomic Functions for</em> <strong>cl_khr_global_int32_extended_atomics</strong></caption>
<colgroup>
<col style="width: 64.2857%;">
<col style="width: 35.7143%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><strong>Function</strong></th>
<th class="tableblock halign-left valign-top"><strong>Description</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">int <strong>atom_min</strong> (volatile __global int *<em>p</em>, int <em>val</em>)<br>
uint <strong>atom_min</strong> (volatile __global uint *<em>p</em>, uint <em>val</em>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Read the 32-bit value (referred to as <em>old</em>) stored at location
pointed by <em>p</em>. Compute <strong>min</strong>(<em>old</em>, <em>val</em>) and store minimum value at
location pointed by <em>p</em>. The function returns <em>old</em>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">int <strong>atom_max</strong> (volatile __global int *<em>p</em>, int <em>val</em>)<br>
uint <strong>atom_max</strong> (volatile __global uint *<em>p</em>, uint <em>val</em>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Read the 32-bit value (referred to as <em>old</em>) stored at location
pointed by <em>p</em>. Compute <strong>max</strong>(<em>old</em>, <em>val</em>) and store maximum value at
location pointed by <em>p</em>. The function returns <em>old</em>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">int <strong>atom_and</strong> (volatile __global int *<em>p</em>, int <em>val</em>)<br>
uint <strong>atom_and</strong> (volatile __global uint *<em>p</em>, uint <em>val</em>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Read the 32-bit value (referred to as <em>old</em>) stored at location
pointed by <em>p</em>. Compute (<em>old</em> &amp; val) and store result at location
pointed by <em>p</em>. The function returns <em>old</em>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">int <strong>atom_or</strong> (volatile __global int *<em>p</em>, int <em>val</em>)<br>
uint <strong>atom_or</strong> (volatile __global uint *<em>p</em>, uint <em>val</em>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Read the 32-bit value (referred to as <em>old</em>) stored at location
pointed by <em>p</em>. Compute (<em>old</em> | val) and store result at location
pointed by <em>p</em>. The function returns <em>old</em>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">int <strong>atom_xor</strong> (volatile __global int *<em>p</em>, int <em>val</em>)<br>
uint <strong>atom_xor</strong> (volatile __global uint *<em>p</em>, uint <em>val</em>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Read the 32-bit value (referred to as <em>old</em>) stored at location
pointed by <em>p</em>. Compute (<em>old</em> ^ val) and store result at location
pointed by <em>p</em>. The function returns <em>old</em>.</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_local_atomics_for_32_bit_integers"><a class="anchor" href="#_local_atomics_for_32_bit_integers"></a>7.3. Local Atomics for 32-bit Integers</h3>
<div class="sect3">
<h4 id="_base_atomics_2"><a class="anchor" href="#_base_atomics_2"></a>7.3.1. Base Atomics</h4>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 21. <em>Built-in Atomic Functions for</em> <strong>cl_khr_local_int32_base_atomics</strong></caption>
<colgroup>
<col style="width: 64.2857%;">
<col style="width: 35.7143%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><strong>Function</strong></th>
<th class="tableblock halign-left valign-top"><strong>Description</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">int <strong>atom_add</strong> (volatile __local int *<em>p</em>, int <em>val</em>)<br>
uint <strong>atom_add</strong> (volatile __local uint *<em>p</em>, uint <em>val</em>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Read the 32-bit value (referred to as <em>old</em>) stored at location
pointed by <em>p</em>. Compute (<em>old</em> + <em>val</em>) and store result at location
pointed by <em>p</em>. The function returns <em>old</em>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">int <strong>atom_sub</strong> (volatile __local int *<em>p</em>, int <em>val</em>)<br>
uint <strong>atom_sub</strong> (volatile __local uint *<em>p</em>, uint <em>val</em>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Read the 32-bit value (referred to as <em>old</em>) stored at location
pointed by <em>p</em>. Compute (<em>old</em> - <em>val</em>) and store result at location
pointed by <em>p</em>. The function returns <em>old</em>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">int <strong>atom_xchg</strong> (volatile __local int *<em>p</em>, int <em>val</em>)<br>
uint <strong>atom_xchg</strong> (volatile __local uint *<em>p</em>, uint <em>val</em>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Swaps the <em>old</em> value stored at location <em>p</em> with new value given by
<em>val</em>. Returns <em>old</em> value.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">int <strong>atom_inc</strong> (volatile __local int *<em>p</em>)<br>
uint <strong>atom_inc</strong> (volatile __local uint *<em>p</em>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Read the 32-bit value (referred to as <em>old</em>) stored at location
pointed by <em>p</em>. Compute (<em>old</em> + <em>1</em>) and store result at location
pointed by <em>p</em>. The function returns <em>old</em>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">int <strong>atom_dec</strong> (volatile __local int *<em>p</em>)<br>
uint <strong>atom_dec</strong> (volatile __local uint *<em>p</em>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Read the 32-bit value (referred to as <em>old</em>) stored at location
pointed by <em>p</em>. Compute (<em>old</em> - <em>1</em>) and store result at location
pointed by <em>p</em>. The function returns <em>old</em>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">int <strong>atom_cmpxchg</strong> (volatile __local int *<em>p</em>, int <em>cmp</em>, int <em>val</em>)<br>
uint <strong>atom_cmpxchg</strong> (volatile __local uint *<em>p</em>, uint <em>cmp</em>, uint <em>val</em>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Read the 32-bit value (referred to as <em>old</em>) stored at location
pointed by <em>p</em>. Compute (<em>old</em> == <em>cmp</em>) ? <em>val</em> : <em>old</em> and store
result at location pointed by <em>p</em>. The function returns <em>old</em>.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="_extended_atomics_2"><a class="anchor" href="#_extended_atomics_2"></a>7.3.2. Extended Atomics</h4>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 22. <em>Built-in Atomic Functions for</em> <strong>cl_khr_local_int32_extended_atomics</strong></caption>
<colgroup>
<col style="width: 64.2857%;">
<col style="width: 35.7143%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><strong>Function</strong></th>
<th class="tableblock halign-left valign-top"><strong>Description</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">int <strong>atom_min</strong> (volatile __local int *<em>p</em>, int <em>val</em>)<br>
uint <strong>atom_min</strong> (volatile __local uint *<em>p</em>, uint <em>val</em>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Read the 32-bit value (referred to as <em>old</em>) stored at location
pointed by <em>p</em>. Compute <strong>min</strong>(<em>old</em>, <em>val</em>) and store minimum value at
location pointed by <em>p</em>. The function returns <em>old</em>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">int <strong>atom_max</strong> (volatile __local int *<em>p</em>, int <em>val</em>)<br>
uint <strong>atom_max</strong> (volatile __local uint *<em>p</em>, uint <em>val</em>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Read the 32-bit value (referred to as <em>old</em>) stored at location
pointed by <em>p</em>. Compute <strong>max</strong>(<em>old</em>, <em>val</em>) and store maximum value at
location pointed by <em>p</em>. The function returns <em>old</em>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">int <strong>atom_and</strong> (volatile __local int *<em>p</em>, int <em>val</em>)<br>
uint <strong>atom_and</strong> (volatile __local uint *<em>p</em>, uint <em>val</em>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Read the 32-bit value (referred to as <em>old</em>) stored at location
pointed by <em>p</em>. Compute (<em>old</em> &amp; val) and store result at location
pointed by <em>p</em>. The function returns <em>old</em>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">int <strong>atom_or</strong> (volatile __local int *<em>p</em>, int <em>val</em>)<br>
uint <strong>atom_or</strong> (volatile __local uint *<em>p</em>, uint <em>val</em>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Read the 32-bit value (referred to as <em>old</em>) stored at location
pointed by <em>p</em>. Compute (<em>old</em> | val) and store result at location
pointed by <em>p</em>. The function returns <em>old</em>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">int <strong>atom_xor</strong> (volatile __local int *<em>p</em>, int <em>val</em>)<br>
uint <strong>atom_xor</strong> (volatile __local uint *<em>p</em>, uint <em>val</em>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Read the 32-bit value (referred to as <em>old</em>) stored at location
pointed by <em>p</em>. Compute (<em>old</em> ^ val) and store result at location
pointed by <em>p</em>. The function returns <em>old</em>.</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="cl_khr_int64_atomics"><a class="anchor" href="#cl_khr_int64_atomics"></a>8. 64-bit Atomics</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This section describes the <strong>cl_khr_int64_base_atomics</strong> and <strong>cl_khr_int64_extended_atomics</strong> extensions. These extensions allow atomic operations to be performed on 64-bit signed and unsigned integers in global and local memory.</p>
</div>
<div class="sect2">
<h3 id="_general_information_7"><a class="anchor" href="#_general_information_7"></a>8.1. General information</h3>
<div class="sect3">
<h4 id="_version_history_7"><a class="anchor" href="#_version_history_7"></a>8.1.1. Version history</h4>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 60%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><strong>Date</strong></th>
<th class="tableblock halign-left valign-top"><strong>Version</strong></th>
<th class="tableblock halign-left valign-top"><strong>Description</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">2020-04-21</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.0.0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">First assigned version.</p></td>
</tr>
</tbody>
</table>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 23. <em>Built-in Atomic Functions for</em> <strong>cl_khr_int64_base_atomics</strong></caption>
<colgroup>
<col style="width: 64.2857%;">
<col style="width: 35.7143%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><strong>Function</strong></th>
<th class="tableblock halign-left valign-top"><strong>Description</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">long <strong>atom_add</strong> (volatile __global long *<em>p</em>, long <em>val</em>)<br>
long <strong>atom_add</strong> (volatile __local long *<em>p</em>, long <em>val</em>)<br>
<br>
ulong <strong>atom_add</strong> (volatile __global ulong *<em>p</em>, ulong <em>val</em>)<br>
ulong <strong>atom_add</strong> (volatile __local ulong *<em>p</em>, ulong <em>val</em>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Read the 64-bit value (referred to as <em>old</em>) stored at location
pointed by <em>p</em>. Compute (<em>old</em> + <em>val</em>) and store result at location
pointed by <em>p</em>. The function returns <em>old</em>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">long <strong>atom_sub</strong> (volatile __global long *<em>p</em>, long <em>val</em>)<br>
long <strong>atom_sub</strong> (volatile __local long *<em>p</em>, long <em>val</em>)<br>
<br>
ulong <strong>atom_sub</strong> (volatile __global ulong *<em>p</em>, ulong <em>val</em>)<br>
ulong <strong>atom_sub</strong> (volatile __local ulong *<em>p</em>, ulong <em>val</em>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Read the 64-bit value (referred to as <em>old</em>) stored at location
pointed by <em>p</em>. Compute (<em>old</em> - <em>val</em>) and store result at location
pointed by <em>p</em>. The function returns <em>old</em>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">long <strong>atom_xchg</strong> (volatile __global long *<em>p</em>, long <em>val</em>)<br>
long <strong>atom_xchg</strong> (volatile __local long *<em>p</em>, long <em>val</em>)<br>
<br>
ulong <strong>atom_xchg</strong> (volatile __global ulong *<em>p</em>, ulong <em>val</em>)<br>
ulong <strong>atom_xchg</strong> (volatile __local ulong *<em>p</em>, ulong <em>val</em>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Swaps the <em>old</em> value stored at location <em>p</em> with new value given by
<em>val</em>. Returns <em>old</em> value.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">long <strong>atom_inc</strong> (volatile __global long *<em>p</em>)<br>
long <strong>atom_inc</strong> (volatile __local long *<em>p</em>)<br>
<br>
ulong <strong>atom_inc</strong> (volatile __global ulong *<em>p</em>)<br>
ulong <strong>atom_inc</strong> (volatile __local ulong *<em>p</em>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Read the 64-bit value (referred to as <em>old</em>) stored at location
pointed by <em>p</em>. Compute (<em>old</em> + <em>1</em>) and store result at location
pointed by <em>p</em>. The function returns <em>old</em>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">long <strong>atom_dec</strong> (volatile __global long *<em>p</em>)<br>
long <strong>atom_dec</strong> (volatile __local long *<em>p</em>)<br>
<br>
ulong <strong>atom_dec</strong> (volatile __global ulong *<em>p</em>)<br>
ulong <strong>atom_dec</strong> (volatile __local ulong *<em>p</em>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Read the 64-bit value (referred to as <em>old</em>) stored at location
pointed by <em>p</em>. Compute (<em>old</em> - <em>1</em>) and store result at location
pointed by <em>p</em>. The function returns <em>old</em>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">long <strong>atom_cmpxchg</strong> (volatile __global long *<em>p</em>, long <em>cmp</em>, long <em>val</em>)<br>
long <strong>atom_cmpxchg</strong> (volatile __local long *<em>p</em>, long <em>cmp</em>, long <em>val</em>)<br>
<br>
ulong <strong>atom_cmpxchg</strong> (volatile __global ulong *<em>p</em>, ulong <em>cmp</em>, ulong <em>val</em>)<br>
ulong <strong>atom_cmpxchg</strong> (volatile __local ulong *<em>p</em>, ulong <em>cmp</em>, ulong <em>val</em>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Read the 64-bit value (referred to as <em>old</em>) stored at location
pointed by <em>p</em>. Compute (<em>old</em> == <em>cmp</em>) ? <em>val</em> : <em>old</em> and store
result at location pointed by <em>p</em>. The function returns <em>old</em>.</p></td>
</tr>
</tbody>
</table>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 24. <em>Built-in Atomic Functions for</em> <strong>cl_khr_int64_extended_atomics</strong></caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><strong>Function</strong></th>
<th class="tableblock halign-left valign-top"><strong>Description</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">long <strong>atom_min</strong> (volatile __global long *<em>p</em>, long <em>val</em>)<br>
long <strong>atom_min</strong> (volatile __local long *<em>p</em>, long <em>val</em>)<br>
<br>
ulong <strong>atom_min</strong> (volatile __global ulong *<em>p</em>, ulong <em>val</em>)<br>
ulong <strong>atom_min</strong> (volatile __local ulong *<em>p</em>, ulong <em>val</em>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Read the 64-bit value (referred to as <em>old</em>) stored at location
pointed by <em>p</em>. Compute <strong>min</strong>(<em>old</em>, <em>val</em>) and store minimum value at
location pointed by <em>p</em>. The function returns <em>old</em>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">long <strong>atom_max</strong> (volatile __global long *<em>p</em>, long <em>val</em>)<br>
long <strong>atom_max</strong> (volatile __local long *<em>p</em>, long <em>val</em>)<br>
<br>
ulong <strong>atom_max</strong> (volatile __global ulong *<em>p</em>, ulong <em>val</em>)<br>
ulong <strong>atom_max</strong> (volatile __local ulong *<em>p</em>, ulong <em>val</em>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Read the 64-bit value (referred to as <em>old</em>) stored at location
pointed by <em>p</em>. Compute <strong>max</strong>(<em>old</em>, <em>val</em>) and store maximum value at
location pointed by <em>p</em>. The function returns <em>old</em>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">long <strong>atom_and</strong> (volatile __global long *<em>p</em>, long <em>val</em>)<br>
long <strong>atom_and</strong> (volatile __local long *<em>p</em>, long <em>val</em>)<br>
<br>
ulong <strong>atom_and</strong> (volatile __global ulong *<em>p</em>, ulong <em>val</em>)<br>
ulong <strong>atom_and</strong> (volatile __local ulong *<em>p</em>, ulong <em>val</em>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Read the 64-bit value (referred to as <em>old</em>) stored at location
pointed by <em>p</em>. Compute (<em>old</em> &amp; val) and store result at location
pointed by <em>p</em>. The function returns <em>old</em>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">long <strong>atom_or</strong> (volatile __global long *<em>p</em>, long <em>val</em>)<br>
long <strong>atom_or</strong> (volatile __local long *<em>p</em>, long <em>val</em>)<br>
<br>
ulong <strong>atom_or</strong> (volatile __global ulong *<em>p</em>, ulong <em>val</em>)<br>
ulong <strong>atom_or</strong> (volatile __local ulong *<em>p</em>, ulong <em>val</em>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Read the 64-bit value (referred to as <em>old</em>) stored at location
pointed by <em>p</em>. Compute (<em>old</em> | val) and store result at location
pointed by <em>p</em>. The function returns <em>old</em>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">long <strong>atom_xor</strong> (volatile __global long *<em>p</em>, long <em>val</em>)<br>
long <strong>atom_xor</strong> (volatile __local long *<em>p</em>, long <em>val</em>)<br>
<br>
ulong <strong>atom_xor</strong> (volatile __global ulong *<em>p</em>, ulong <em>val</em>)<br>
ulong <strong>atom_xor</strong> (volatile __local ulong *<em>p</em>, ulong <em>val</em>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Read the 64-bit value (referred to as <em>old</em>) stored at location
pointed by <em>p</em>. Compute (<em>old</em> ^ val) and store result at location
pointed by <em>p</em>. The function returns <em>old</em>.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Note: Atomic operations on 64-bit integers and 32-bit integers (and
float) are also atomic w.r.t. each other.</p>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="cl_khr_select_fprounding_mode"><a class="anchor" href="#cl_khr_select_fprounding_mode"></a>9. Selecting the Rounding Mode <strong>(DEPRECATED)</strong></h2>
<div class="sectionbody">
<div class="paragraph">
<p>This section describes the <strong>cl_khr_select_fprounding_mode</strong> extension.
It allows an application to specify the rounding mode for an instruction or group of instructions in the program source.</p>
</div>
<div class="paragraph">
<p><strong>This extension was deprecated in OpenCL 1.1 and its use is not recommended.</strong></p>
</div>
<div class="sect2">
<h3 id="_general_information_8"><a class="anchor" href="#_general_information_8"></a>9.1. General information</h3>
<div class="sect3">
<h4 id="_version_history_8"><a class="anchor" href="#_version_history_8"></a>9.1.1. Version history</h4>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 60%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><strong>Date</strong></th>
<th class="tableblock halign-left valign-top"><strong>Version</strong></th>
<th class="tableblock halign-left valign-top"><strong>Description</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">2020-04-21</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.0.0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">First assigned version.</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_changes_to_opencl_c_specification"><a class="anchor" href="#_changes_to_opencl_c_specification"></a>9.2. Changes to OpenCL C specification</h3>
<div class="paragraph">
<p>With this extension, the rounding mode may be specified using the following <strong>#pragma</strong> in the OpenCL program source:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="opencl_c"><span class="cp">#pragma OPENCL SELECT_ROUNDING_MODE &lt;rounding-mode&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The <em>&lt;rounding-mode&gt;</em> may be one of the following values:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>rte</strong> - round to nearest even</p>
</li>
<li>
<p><strong>rtz</strong> - round to zero</p>
</li>
<li>
<p><strong>rtp</strong> - round to positive infinity</p>
</li>
<li>
<p><strong>rtn</strong> - round to negative infinity</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>If this extensions is supported then the OpenCL implementation must support all four rounding modes for single precision floating-point.</p>
</div>
<div class="paragraph">
<p>The <strong>#pragma</strong> sets the rounding mode for all instructions that operate on floating-point types (scalar or vector types) or produce floating-point values that follow this pragma in the program source until the next <strong>#pragma</strong>.
Note that the rounding mode specified for a block of code is known at compile time.
When inside a compound statement, the pragma takes effect from its occurrence until another <strong>#pragma</strong> is encountered (including within a nested compound statement), or until the end of the compound statement; at the end of a compound statement the state for the pragma is restored to its condition just before the compound statement.
Except where otherwise documented, the callee functions do not inherit the rounding mode of the caller function.</p>
</div>
<div class="paragraph">
<p>If this extension is enabled, the <code>__ROUNDING_MODE__</code> preprocessor symbol shall be defined to be one of the following according to the current rounding mode:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="opencl_c"><span class="cp">#define __ROUNDING_MODE__ rte
#define __ROUNDING_MODE__ rtz
#define __ROUNDING_MODE__ rtp
#define __ROUNDING_MODE__ rtz</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>This is intended to enable remapping <code>foo()</code> to <code>foo_rte()</code> by the preprocessor by using:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="opencl_c"><span class="cp">#define foo foo ## __ROUNDING_MODE__</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The default rounding mode is round to nearest even.
The built-in math functions described in <em>section 6.11.2</em>, the common functions described in <em>section 6.11.4</em> and the geometric functions described in <em>section 6.11.5</em> are implemented with the round to nearest even rounding mode.
Various built-in conversions and the <strong>vstore_half</strong> and <strong>vstorea_half</strong> built-in functions that do not specify a rounding mode inherit the current rounding mode.
Conversions from floating-point to integer type always use <code>rtz</code> mode, except where the user specifically asks for another rounding mode.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="cl_khr_gl_sharing"><a class="anchor" href="#cl_khr_gl_sharing"></a>10. Creating an OpenCL Context from an OpenGL Context or Share Group</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="cl_khr_gl_sharing-overview"><a class="anchor" href="#cl_khr_gl_sharing-overview"></a>10.1. Overview</h3>
<div class="paragraph">
<p>This section describes functionality in the <strong>cl_khr_gl_sharing</strong> extension
to associate an OpenCL context with an OpenGL context or share group object.
Once an OpenCL context is associated with an OpenGL context or share group
object, the functionality described in the section
<a href="#cl_khr_gl_sharing__memobjs">Creating OpenCL Memory Objects from OpenGL Objects</a>
may be used to share OpenGL buffer, texture, and renderbuffer objects with the OpenCL context.</p>
</div>
<div class="paragraph">
<p>An OpenGL implementation supporting buffer objects and sharing of texture
and buffer object images with OpenCL is required by this extension.</p>
</div>
</div>
<div class="sect2">
<h3 id="_general_information_9"><a class="anchor" href="#_general_information_9"></a>10.2. General information</h3>
<div class="sect3">
<h4 id="_version_history_9"><a class="anchor" href="#_version_history_9"></a>10.2.1. Version history</h4>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 60%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><strong>Date</strong></th>
<th class="tableblock halign-left valign-top"><strong>Version</strong></th>
<th class="tableblock halign-left valign-top"><strong>Description</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">2020-04-21</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.0.0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">First assigned version.</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect2">
<h3 id="cl_khr_gl_sharing-new-procedures-and-functions"><a class="anchor" href="#cl_khr_gl_sharing-new-procedures-and-functions"></a>10.3. New Procedures and Functions</h3>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="opencl"><span class="kt">cl_int</span> <span class="nf">clGetGLContextInfoKHR</span><span class="p">(</span><span class="k">const</span> <span class="kt">cl_context_properties</span> <span class="o">*</span><span class="n">properties</span><span class="p">,</span>
                             <span class="kt">cl_gl_context_info</span> <span class="n">param_name</span><span class="p">,</span>
                             <span class="kt">size_t</span> <span class="n">param_value_size</span><span class="p">,</span>
                             <span class="kt">void</span> <span class="o">*</span><span class="n">param_value</span><span class="p">,</span>
                             <span class="kt">size_t</span> <span class="o">*</span><span class="n">param_value_size_ret</span><span class="p">);</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="cl_khr_gl_sharing-new-tokens"><a class="anchor" href="#cl_khr_gl_sharing-new-tokens"></a>10.4. New Tokens</h3>
<div class="paragraph">
<p>Returned by <strong>clCreateContext</strong>, <strong>clCreateContextFromType</strong>, and
<strong>clGetGLContextInfoKHR</strong> when an invalid OpenGL context or share group object
handle is specified in <em>properties</em>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="opencl"><span class="n">CL_INVALID_GL_SHAREGROUP_REFERENCE_KHR</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Accepted as the <em>param_name</em> argument of <strong>clGetGLContextInfoKHR</strong>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="opencl"><span class="n">CL_CURRENT_DEVICE_FOR_GL_CONTEXT_KHR</span>
<span class="n">CL_DEVICES_FOR_GL_CONTEXT_KHR</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Accepted as an attribute name in the <em>properties</em> argument of
<strong>clCreateContext</strong> and <strong>clCreateContextFromType</strong>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="opencl"><span class="n">CL_GL_CONTEXT_KHR</span>
<span class="n">CL_EGL_DISPLAY_KHR</span>
<span class="n">CL_GLX_DISPLAY_KHR</span>
<span class="n">CL_WGL_HDC_KHR</span>
<span class="n">CL_CGL_SHAREGROUP_KHR</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="cl_khr_gl_sharing-additions-to-chapter-4"><a class="anchor" href="#cl_khr_gl_sharing-additions-to-chapter-4"></a>10.5. Additions to Chapter 4 of the OpenCL 2.2 Specification</h3>
<div class="paragraph">
<p>In <em>section 4.4</em>, replace the description of <em>properties</em> under
<strong>clCreateContext</strong> with:</p>
</div>
<div class="paragraph">
<p>"`<em>properties</em> points to an attribute list, which is a array of ordered
&lt;attribute name, value&gt; pairs terminated with zero.
If an attribute is not specified in <em>properties</em>, then its default value
(listed in <em>table 4.5</em>) is used (it is said to be specified implicitly).
If <em>properties</em> is <code>NULL</code> or empty (points to a list whose first value is
zero), all attributes take on their default values.</p>
</div>
<div class="paragraph">
<p>Attributes control sharing of OpenCL memory objects with OpenGL buffer,
texture, and renderbuffer objects.
Depending on the platform-specific API used to bind OpenGL contexts to the
window system, the following attributes may be set to identify an OpenGL
context:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>When the CGL binding API is supported, the attribute
CL_CGL_SHAREGROUP_KHR should be set to a CGLShareGroup handle to a CGL
share group object.</p>
</li>
<li>
<p>When the EGL binding API is supported, the attribute CL_GL_CONTEXT_KHR
should be set to an EGLContext handle to an OpenGL ES or OpenGL context,
and the attribute CL_EGL_DISPLAY_KHR should be set to the EGLDisplay
handle of the display used to create the OpenGL ES or OpenGL context.</p>
</li>
<li>
<p>When the GLX binding API is supported, the attribute CL_GL_CONTEXT_KHR
should be set to a GLXContext handle to an OpenGL context, and the
attribute CL_GLX_DISPLAY_KHR should be set to the Display handle of the
X Window System display used to create the OpenGL context.</p>
</li>
<li>
<p>When the WGL binding API is supported, the attribute CL_GL_CONTEXT_KHR
should be set to an HGLRC handle to an OpenGL context, and the attribute
CL_WGL_HDC_KHR should be set to the HDC handle of the display used to
create the OpenGL context.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Memory objects created in the context so specified may be shared with the
specified OpenGL or OpenGL ES context (as well as with any other OpenGL
contexts on the share list of that context, according to the description of
sharing in the GLX 1.4 and EGL 1.4 specifications, and the WGL documentation
for OpenGL implementations on Microsoft Windows), or with the explicitly
identified OpenGL share group for CGL.
If no OpenGL or OpenGL ES context or share group is specified in the
attribute list, then memory objects may not be shared, and calling any of
the commands described in <a href="#cl_khr_gl_sharing__memobjs">Creating OpenCL
Memory Objects from OpenGL Objects</a> will result in a
CL_INVALID_GL_SHAREGROUP_REFERENCE_KHR error.`"</p>
</div>
<div class="paragraph">
<p>OpenCL / OpenGL sharing does not support the CL_CONTEXT_INTEROP_USER_SYNC
property defined in <em>table 4.5</em>.
Specifying this property when creating a context with OpenCL / OpenGL
sharing will return an appropriate error.</p>
</div>
<div class="paragraph">
<p>Add to <em>table 4.5</em>:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 25. <em>OpenGL Sharing Context Creation Attributes</em></caption>
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><strong>Attribute Name</strong></th>
<th class="tableblock halign-left valign-top"><strong>Allowed Values</strong>

  <strong>(Default value is in bold)</strong></th>
<th class="tableblock halign-left valign-top"><strong>Description</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">CL_GL_CONTEXT_KHR</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>0</strong>, OpenGL context handle</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">OpenGL context to associated the OpenCL context with</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">CL_CGL_SHAREGROUP_KHR</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>0</strong>, CGL share group handle</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">CGL share group to associate the OpenCL context with</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">CL_EGL_DISPLAY_KHR</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>EGL_NO_DISPLAY</strong>, EGLDisplay handle</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">EGLDisplay an OpenGL context was created with respect to</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">CL_GLX_DISPLAY_KHR</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>None</strong>, X handle</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X Display an OpenGL context was created with respect to</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">CL_WGL_HDC_KHR</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>0</strong>, HDC handle</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">HDC an OpenGL context was created with respect to</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Replace the first error in the list for <strong>clCreateContext</strong> with:</p>
</div>
<div class="paragraph">
<p>"`<em>errcode_ret</em> returns CL_INVALID_GL_SHAREGROUP_REFERENCE_KHR if a context
was specified by any of the following means:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>A context was specified for an EGL-based OpenGL ES or OpenGL
implementation by setting the attributes CL_GL_CONTEXT_KHR and
CL_EGL_DISPLAY_KHR.</p>
</li>
<li>
<p>A context was specified for a GLX-based OpenGL implementation by setting
the attributes CL_GL_CONTEXT_KHR and CL_GLX_DISPLAY_KHR.</p>
</li>
<li>
<p>A context was specified for a WGL-based OpenGL implementation by setting
the attributes CL_GL_CONTEXT_KHR and CL_WGL_HDC_KHR</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>and any of the following conditions hold:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The specified display and context attributes do not identify a valid
OpenGL or OpenGL ES context.</p>
</li>
<li>
<p>The specified context does not support buffer and renderbuffer objects.</p>
</li>
<li>
<p>The specified context is not compatible with the OpenCL context being
created (for example, it exists in a physically distinct address space,
such as another hardware device; or it does not support sharing data
with OpenCL due to implementation restrictions).</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><em>errcode_ret</em> returns CL_INVALID_GL_SHAREGROUP_REFERENCE_KHR if a share
group was specified for a CGL-based OpenGL implementation by setting the
attribute CL_CGL_SHAREGROUP_KHR, and the specified share group does not
identify a valid CGL share group object.</p>
</div>
<div class="paragraph">
<p><em>errcode_ret</em> returns CL_INVALID_OPERATION if a context was specified as
described above and any of the following conditions hold:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>A context or share group object was specified for one of CGL, EGL, GLX,
or WGL and the OpenGL implementation does not support that window-system
binding API.</p>
</li>
<li>
<p>More than one of the attributes CL_CGL_SHAREGROUP_KHR,
CL_EGL_DISPLAY_KHR, CL_GLX_DISPLAY_KHR, and CL_WGL_HDC_KHR is set to a
non-default value.</p>
</li>
<li>
<p>Both of the attributes CL_CGL_SHAREGROUP_KHR and CL_GL_CONTEXT_KHR are
set to non-default values.</p>
</li>
<li>
<p>Any of the devices specified in the <em>devices</em> argument cannot support
OpenCL objects which share the data store of an OpenGL object.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><em>errcode_ret</em> returns CL_INVALID_PROPERTY if an attribute name other than
those specified in <em>table 4.5</em> or if CL_CONTEXT_INTEROP_USER_SYNC is
specified in <em>properties</em>.`"</p>
</div>
<div class="paragraph">
<p>Replace the description of <em>properties</em> under <strong>clCreateContextFromType</strong>
with:</p>
</div>
<div class="paragraph">
<p>&#8220;_properties_ points to an attribute list whose format and valid contents
are identical to the <strong>properties</strong> argument of <strong>clCreateContext</strong>.&#8221;</p>
</div>
<div class="paragraph">
<p>Replace the first error in the list for <strong>clCreateContextFromType</strong> with the
same two new errors described above for <strong>clCreateContext</strong>.</p>
</div>
</div>
<div class="sect2">
<h3 id="cl_khr_gl_sharing-additions-to-chapter-5"><a class="anchor" href="#cl_khr_gl_sharing-additions-to-chapter-5"></a>10.6. Additions to Chapter 5 of the OpenCL 2.2 Specification</h3>
<div class="paragraph">
<p>Add a new section to describe the new API for querying OpenCL devices that
support sharing with OpenGL:</p>
</div>
<div class="paragraph">
<p>"`OpenCL device(s) corresponding to an OpenGL context may be queried.
Such a device may not always exist (for example, if an OpenGL context is
specified on a GPU not supporting OpenCL command queues, but which does
support shared CL/GL objects), and if it does exist, may change over time.
When such a device does exist, acquiring and releasing shared CL/GL objects
may be faster on a command queue corresponding to this device than on
command queues corresponding to other devices available to an OpenCL
context.</p>
</div>
<div class="paragraph">
<p>To query the currently corresponding device, use the function
</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="opencl"><span class="kt">cl_int</span> <span class="n">clGetGLContextInfoKHR</span><span class="p">(</span><span class="k">const</span> <span class="kt">cl_context_properties</span> <span class="o">*</span><span class="n">properties</span><span class="p">,</span>
                             <span class="kt">cl_gl_context_info</span> <span class="n">param_name</span><span class="p">,</span>
                             <span class="kt">size_t</span> <span class="n">param_value_size</span><span class="p">,</span>
                             <span class="kt">void</span> <span class="o">*</span><span class="n">param_value</span><span class="p">,</span>
                             <span class="kt">size_t</span> <span class="o">*</span><span class="n">param_value_size_ret</span><span class="p">)</span></code></pre>
</div>
</div>
<div class="paragraph">
<p><em>properties</em> points to an attribute list whose format and valid contents are
identical to the <em>properties</em> argument of <strong>clCreateContext</strong>.
<em>properties</em> must identify a single valid GL context or GL share group
object.</p>
</div>
<div class="paragraph">
<p><em>param_name</em> is a constant that specifies the device types to query, and
must be one of the values shown in the table below.</p>
</div>
<div class="paragraph">
<p><em>param_value</em> is a pointer to memory where the result of the query is
returned as described in the table below.
If <em>param_value</em> is <code>NULL</code>, it is ignored.</p>
</div>
<div class="paragraph">
<p><em>param_value_size</em> specifies the size in bytes of memory pointed to by
<em>param_value</em>.
This size must be greater than or equal to the size of the return type
described in the table below.</p>
</div>
<div class="paragraph">
<p><em>param_value_size_ret</em> returns the actual size in bytes of data being
queried by <em>param_value</em>.
If <em>param_value_size_ret</em> is <code>NULL</code>, it is ignored.</p>
</div>
<table id="cl_khr_gl_sharing-clGetGLContextInfoKHR-table" class="tableblock frame-all grid-all stretch">
<caption class="title">Table 26. <em>Supported Device Types for</em> <strong>clGetGLContextInfoKHR</strong></caption>
<colgroup>
<col style="width: 40%;">
<col style="width: 20%;">
<col style="width: 40%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><strong>param_name</strong></th>
<th class="tableblock halign-left valign-top"><strong>Return Type</strong></th>
<th class="tableblock halign-left valign-top"><strong>Information returned in param_value</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">CL_CURRENT_DEVICE_FOR_GL_CONTEXT_KHR</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>cl_device_id</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Return the OpenCL device currently associated with the specified OpenGL
  context.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">CL_DEVICES_FOR_GL_CONTEXT_KHR</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>cl_device_id[]</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Return all OpenCL devices which may be associated with the specified
  OpenGL context.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><strong>clGetGLContextInfoKHR</strong> returns CL_SUCCESS if the function is executed
successfully.
If no device(s) exist corresponding to <em>param_name</em>, the call will not fail,
but the value of <em>param_value_size_ret</em> will be zero.</p>
</div>
<div class="paragraph">
<p><strong>clGetGLContextInfoKHR</strong> returns CL_INVALID_GL_SHAREGROUP_REFERENCE_KHR if a
context was specified by any of the following means:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>A context was specified for an EGL-based OpenGL ES or OpenGL
implementation by setting the attributes CL_GL_CONTEXT_KHR and
CL_EGL_DISPLAY_KHR.</p>
</li>
<li>
<p>A context was specified for a GLX-based OpenGL implementation by setting
the attributes CL_GL_CONTEXT_KHR and CL_GLX_DISPLAY_KHR.</p>
</li>
<li>
<p>A context was specified for a WGL-based OpenGL implementation by setting
the attributes CL_GL_CONTEXT_KHR and CL_WGL_HDC_KHR.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>and any of the following conditions hold:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The specified display and context attributes do not identify a valid
OpenGL or OpenGL ES context.</p>
</li>
<li>
<p>The specified context does not support buffer and renderbuffer objects.</p>
</li>
<li>
<p>The specified context is not compatible with the OpenCL context being
created (for example, it exists in a physically distinct address space,
such as another hardware device; or it does not support sharing data
with OpenCL due to implementation restrictions).</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>clGetGLContextInfoKHR</strong> returns CL_INVALID_GL_SHAREGROUP_REFERENCE_KHR if a
share group was specified for a CGL-based OpenGL implementation by setting
the attribute CL_CGL_SHAREGROUP_KHR, and the specified share group does not
identify a valid CGL share group object.</p>
</div>
<div class="paragraph">
<p><strong>clGetGLContextInfoKHR</strong> returns CL_INVALID_OPERATION if a context was
specified as described above and any of the following conditions hold:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>A context or share group object was specified for one of CGL, EGL, GLX,
or WGL and the OpenGL implementation does not support that window-system
binding API.</p>
</li>
<li>
<p>More than one of the attributes CL_CGL_SHAREGROUP_KHR,
CL_EGL_DISPLAY_KHR, CL_GLX_DISPLAY_KHR, and CL_WGL_HDC_KHR is set to a
non-default value.</p>
</li>
<li>
<p>Both of the attributes CL_CGL_SHAREGROUP_KHR and CL_GL_CONTEXT_KHR are
set to non-default values.</p>
</li>
<li>
<p>Any of the devices specified in the &lt;devices&gt; argument cannot support
OpenCL objects which share the data store of an OpenGL object.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>clGetGLContextInfoKHR</strong> returns CL_INVALID_VALUE if an attribute name other
than those specified in <em>table 4.5</em> is specified in <em>properties</em>.</p>
</div>
<div class="paragraph">
<p>Additionally, <strong>clGetGLContextInfoKHR</strong> returns CL_INVALID_VALUE if
<em>param_name</em> is not one of the values listed in the table
<a href="#cl_khr_gl_sharing-clGetGLContextInfoKHR-table"><em>GL context information that
can be queried with</em> <strong>clGetGLContextInfoKHR</strong></a>, or if the size in bytes
specified by <em>param_value_size</em> is less than the size of the return type
shown in the table and <em>param_value</em> is not a <code>NULL</code> value;
CL_OUT_OF_RESOURCES if there is a failure to allocate resources required by
the OpenCL implementation on the device; or CL_OUT_OF_HOST_MEMORY if there
is a failure to allocate resources required by the OpenCL implementation on
the host.`"</p>
</div>
</div>
<div class="sect2">
<h3 id="cl_khr_gl_sharing-issues"><a class="anchor" href="#cl_khr_gl_sharing-issues"></a>10.7. Issues</h3>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>How should the OpenGL context be identified when creating an associated
OpenCL context?</p>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>RESOLVED: by using a (display,context handle) attribute pair to identify an
arbitrary OpenGL or OpenGL ES context with respect to one of the
window-system binding layers EGL, GLX, or WGL, or a share group handle to
identify a CGL share group.
If a context is specified, it need not be current to the thread calling
clCreateContext*.</p>
</div>
<div class="paragraph">
<p>A previously suggested approach would use a single boolean attribute
CL_USE_GL_CONTEXT_KHR to allow creating a context associated with the
currently bound OpenGL context.
This may still be implemented as a separate extension, and might allow more
efficient acquire/release behavior in the special case where they are being
executed in the same thread as the bound GL context used to create the CL
context.</p>
</div>
</div>
</div>
</li>
<li>
<p>What should the format of an attribute list be?</p>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>After considerable discussion, we think we can live with a list of
&lt;attribute name,value&gt; pairs terminated by zero.
The list is passed as 'cl_context_properties *<em>properties'</em>, where
cl_context_properties is typedefed to be 'intptr_t' in cl.h.</p>
</div>
<div class="paragraph">
<p>This effectively allows encoding all scalar integer, pointer, and handle
values in the host API into the argument list and is analogous to the
structure and type of EGL attribute lists.
<code>NULL</code> attribute lists are also allowed.
Again as for EGL, any attributes not explicitly passed in the list will take
on a defined default value that does something reasonable.</p>
</div>
<div class="paragraph">
<p>Experience with EGL, GLX, and WGL has shown attribute lists to be a
sufficiently flexible and general mechanism to serve the needs of management
calls such as context creation.
It is not completely general (encoding floating-point and non-scalar
attribute values is not straightforward), and other approaches were
suggested such as opaque attribute lists with getter/setter methods, or
arrays of varadic structures.</p>
</div>
</div>
</div>
</li>
<li>
<p>What&#8217;s the behavior of an associated OpenGL or OpenCL context when using
resources defined by the other associated context, and that context is
destroyed?</p>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>RESOLVED: OpenCL objects place a reference on the data store underlying the
corresponding GL object when they&#8217;re created.
The GL name corresponding to that data store may be deleted, but the data
store itself remains so long as any CL object has a reference to it.
However, destroying all GL contexts in the share group corresponding to a CL
context results in implementation-dependent behavior when using a
corresponding CL object, up to and including program termination.</p>
</div>
</div>
</div>
</li>
<li>
<p>How about sharing with D3D?</p>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Sharing between D3D and OpenCL should use the same attribute list mechanism,
though obviously with different parameters, and be exposed as a similar
parallel OpenCL extension.
There may be an interaction between that extension and this one since it&#8217;s
not yet clear if it will be possible to create a CL context simultaneously
sharing GL and D3D objects.</p>
</div>
</div>
</div>
</li>
<li>
<p>Under what conditions will context creation fail due to sharing?</p>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>RESOLVED: Several cross-platform failure conditions are described (GL
context or CGL share group doesn&#8217;t exist, GL context doesn&#8217;t support types
of GL objects, GL context implementation doesn&#8217;t allow sharing), but
additional failures may result due to implementation-dependent reasons and
should be added to this extension as such failures are discovered.
Sharing between OpenCL and OpenGL requires integration at the driver
internals level.</p>
</div>
</div>
</div>
</li>
<li>
<p>What command queues can <strong>clEnqueueAcquire/ReleaseGLObjects</strong> be placed
on?</p>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>RESOLVED: All command queues.
This restriction is enforced at context creation time.
If any device passed to context creation cannot support shared CL/GL
objects, context creation will fail with a CL_INVALID_OPERATION error.</p>
</div>
</div>
</div>
</li>
<li>
<p>How can applications determine which command queue to place an
Acquire/Release on?</p>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>RESOLVED: The <strong>clGetGLContextInfoKHR</strong> returns either the CL device currently
corresponding to a specified GL context (typically the display it&#8217;s running
on), or a list of all the CL devices the specified context might run on
(potentially useful in multiheaded / &#8220;virtual screen&#8221; environments).
This command is not simply placed in <a href="#cl_khr_gl_sharing__memobjs">Creating
OpenCL Memory Objects from OpenGL Objects</a> because it relies on the same
property-list method of specifying a GL context introduced by this
extension.</p>
</div>
<div class="paragraph">
<p>If no devices are returned, it means that the GL context exists on an older
GPU not capable of running OpenCL, but still capable of sharing objects
between GL running on that GPU and CL running elsewhere.</p>
</div>
</div>
</div>
</li>
<li>
<p>What is the meaning of the CL_DEVICES_FOR_GL_CONTEXT_KHR query?</p>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>RESOLVED: The list of all CL devices that may ever be associated with a
specific GL context.
On platforms such as MacOS X, the &#8220;virtual screen&#8221; concept allows multiple
GPUs to back a single virtual display.
Similar functionality might be implemented on other windowing systems, such
as a transparent heterogenous multiheaded X server.
Therefore the exact meaning of this query is interpreted relative to the
binding layer API in use.</p>
</div>
</div>
</div>
</li>
</ol>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="cl_khr_gl_sharing__memobjs"><a class="anchor" href="#cl_khr_gl_sharing__memobjs"></a>11. Creating OpenCL Memory Objects from OpenGL Objects</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This section describes functionality in the <strong>cl_khr_gl_sharing</strong> extension
to use OpenGL buffer, texture, and renderbuffer objects as OpenCL memory objects.
OpenCL memory objects may be created from OpenGL objects if and only if the
OpenCL context is associated with an OpenGL context or share group object.
The section <a href="#cl_khr_gl_sharing">Creating an OpenCL Context from an OpenGL Context or Share Group</a>
describes how to create an OpenCL context associated with an OpenGL context or share group object.</p>
</div>
<div class="paragraph">
<p>An OpenCL image object may be created from an OpenGL texture or renderbuffer object.
An OpenCL buffer object may be created from an OpenGL buffer object.</p>
</div>
<div class="paragraph">
<p>Any supported OpenGL object defined within the associated OpenGL context
or share group object may be shared, with the exception of the default
OpenGL objects (i.e. objects named zero), which may not be shared.</p>
</div>
<div class="sect2">
<h3 id="_general_information_10"><a class="anchor" href="#_general_information_10"></a>11.1. General information</h3>
<div class="sect3">
<h4 id="_version_history_10"><a class="anchor" href="#_version_history_10"></a>11.1.1. Version history</h4>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 60%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><strong>Date</strong></th>
<th class="tableblock halign-left valign-top"><strong>Version</strong></th>
<th class="tableblock halign-left valign-top"><strong>Description</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">2020-04-21</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.0.0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">First assigned version.</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect2">
<h3 id="cl_khr_gl_sharing__memobjs-lifetime-of-shared-objects"><a class="anchor" href="#cl_khr_gl_sharing__memobjs-lifetime-of-shared-objects"></a>11.2. Lifetime of Shared Objects</h3>
<div class="paragraph">
<p>An OpenCL memory object created from an OpenGL object (hereinafter referred
to as a &#8220;shared CL/GL object&#8221;) remains valid as long as the corresponding
GL object has not been deleted.
If the GL object is deleted through the GL API (e.g. <strong>glDeleteBuffers</strong>,
<strong>glDeleteTextures,</strong> or <strong>glDeleteRenderbuffers</strong>), subsequent use of the CL
buffer or image object will result in undefined behavior, including but not
limited to possible CL errors and data corruption, but may not result in
program termination.</p>
</div>
<div class="paragraph">
<p>The CL context and corresponding command-queues are dependent on the
existence of the GL share group object, or the share group associated with
the GL context from which the CL context is created.
If the GL share group object or all GL contexts in the share group are
destroyed, any use of the CL context or command-queue(s) will result in
undefined behavior, which may include program termination.
Applications should destroy the CL command-queue(s) and CL context before
destroying the corresponding GL share group or contexts</p>
</div>
</div>
<div class="sect2">
<h3 id="cl_khr_gl_sharing__memobjs-cl-buffer-objects-from-gl-buffer-objects"><a class="anchor" href="#cl_khr_gl_sharing__memobjs-cl-buffer-objects-from-gl-buffer-objects"></a>11.3. OpenCL Buffer Objects from OpenGL Buffer Objects</h3>
<div class="paragraph">
<p>The function
</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="opencl"><span class="kt">cl_mem</span> <span class="n">clCreateFromGLBuffer</span><span class="p">(</span><span class="kt">cl_context</span> <span class="n">context</span><span class="p">,</span>
                            <span class="kt">cl_mem_flags</span> <span class="n">flags</span><span class="p">,</span>
                            <span class="n">GLuint</span> <span class="n">bufobj</span><span class="p">,</span>
                            <span class="kt">cl_int</span> <span class="o">*</span><span class="n">errcode_ret</span><span class="p">)</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>creates an OpenCL buffer object from an OpenGL buffer object.</p>
</div>
<div class="paragraph">
<p><em>context</em> is a valid OpenCL context created from an OpenGL context.</p>
</div>
<div class="paragraph">
<p><em>flags</em> is a bit-field that is used to specify usage information.
Refer to <em>table 5.3</em> for a description of <em>flags</em>.
Only CL_MEM_READ_ONLY, CL_MEM_WRITE_ONLY and CL_MEM_READ_WRITE values
specified in <em>table 5.3</em> can be used.</p>
</div>
<div class="paragraph">
<p><em>bufobj</em> is the name of a GL buffer object.
The data store of the GL buffer object must have have been previously
created by calling <strong>glBufferData</strong>, although its contents need not be
initialized.
The size of the data store will be used to determine the size of the CL
buffer object.</p>
</div>
<div class="paragraph">
<p><em>errcode_ret</em> will return an appropriate error code as described below.
If <em>errcode_ret</em> is <code>NULL</code>, no error code is returned.</p>
</div>
<div class="paragraph">
<p><strong>clCreateFromGLBuffer</strong> returns a valid non-zero OpenCL buffer object and
<em>errcode_ret</em> is set to CL_SUCCESS if the buffer object is created
successfully.
Otherwise, it returns a <code>NULL</code> value with one of the following error values
returned in <em>errcode_ret</em>:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>CL_INVALID_CONTEXT if <em>context</em> is not a valid context or was not
created from a GL context.</p>
</li>
<li>
<p>CL_INVALID_VALUE if values specified in <em>flags</em> are not valid.</p>
</li>
<li>
<p>CL_INVALID_GL_OBJECT if <em>bufobj</em> is not a GL buffer object or is a GL
buffer object but does not have an existing data store or the size of
the buffer is 0.</p>
</li>
<li>
<p>CL_OUT_OF_RESOURCES if there is a failure to allocate resources required
by the OpenCL implementation on the device.</p>
</li>
<li>
<p>CL_OUT_OF_HOST_MEMORY if there is a failure to allocate resources
required by the OpenCL implementation on the host.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The size of the GL buffer object data store at the time
<strong>clCreateFromGLBuffer</strong> is called will be used as the size of buffer object
returned by <strong>clCreateFromGLBuffer</strong>.
If the state of a GL buffer object is modified through the GL API (e.g.
<strong>glBufferData</strong>) while there exists a corresponding CL buffer object,
subsequent use of the CL buffer object will result in undefined behavior.</p>
</div>
<div class="paragraph">
<p>The <strong>clRetainMemObject</strong> and <strong>clReleaseMemObject</strong> functions can be used to
retain and release the buffer object.</p>
</div>
<div class="paragraph">
<p>The CL buffer object created using clCreateFromGLBuffer can also be used to
create a CL 1D image buffer object.</p>
</div>
</div>
<div class="sect2">
<h3 id="cl_khr_gl_sharing__memobjs-cl-image-objects-from-gl-textures"><a class="anchor" href="#cl_khr_gl_sharing__memobjs-cl-image-objects-from-gl-textures"></a>11.4. OpenCL Image Objects from OpenGL Textures</h3>
<div class="paragraph">
<p>The function
</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="opencl"><span class="kt">cl_mem</span> <span class="n">clCreateFromGLTexture</span><span class="p">(</span><span class="kt">cl_context</span> <span class="n">context</span><span class="p">,</span>
                             <span class="kt">cl_mem_flags</span> <span class="n">flags</span><span class="p">,</span>
                             <span class="n">GLenum</span> <span class="n">texture_target</span><span class="p">,</span>
                             <span class="n">GLint</span> <span class="n">miplevel</span><span class="p">,</span>
                             <span class="n">GLuint</span> <span class="n">texture</span><span class="p">,</span>
                             <span class="kt">cl_int</span> <span class="o">*</span><span class="n">errcode_ret</span><span class="p">)</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>creates the following:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>an OpenCL 2D image object from an OpenGL 2D texture object or a single
face of an OpenGL cubemap texture object,</p>
</li>
<li>
<p>an OpenCL 2D image array object from an OpenGL 2D texture array object,</p>
</li>
<li>
<p>an OpenCL 1D image object from an OpenGL 1D texture object,</p>
</li>
<li>
<p>an OpenCL 1D image buffer object from an OpenGL texture buffer object,</p>
</li>
<li>
<p>an OpenCL 1D image array object from an OpenGL 1D texture array object,</p>
</li>
<li>
<p>an OpenCL 3D image object from an OpenGL 3D texture object.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><em>context</em> is a valid OpenCL context created from an OpenGL context.</p>
</div>
<div class="paragraph">
<p><em>flags</em> is a bit-field that is used to specify usage information.
Refer to <em>table 5.3</em> for a description of <em>flags</em>.
Only CL_MEM_READ_ONLY, CL_MEM_WRITE_ONLY and CL_MEM_READ_WRITE values
specified in <em>table 5.3</em> may be used.</p>
</div>
<div class="paragraph">
<p><em>texture_target</em> must be one of GL_TEXTURE_1D, GL_TEXTURE_1D_ARRAY,
GL_TEXTURE_BUFFER, GL_TEXTURE_2D, GL_TEXTURE_2D_ARRAY, GL_TEXTURE_3D,
GL_TEXTURE_CUBE_MAP_POSITIVE_X, GL_TEXTURE_CUBE_MAP_POSITIVE_Y,
GL_TEXTURE_CUBE_MAP_POSITIVE_Z, GL_TEXTURE_CUBE_MAP_NEGATIVE_X,
GL_TEXTURE_CUBE_MAP_NEGATIVE_Y, GL_TEXTURE_CUBE_MAP_NEGATIVE_Z, or
GL_TEXTURE_RECTANGLE (Note: GL_TEXTURE_RECTANGLE requires OpenGL 3.1.
Alternatively, GL_TEXTURE_RECTANGLE_ARB may be specified if the OpenGL
extension <strong>GL_ARB_texture_rectangle</strong> is supported.).
<em>texture_target</em> is used only to define the image type of <em>texture</em>.
No reference to a bound GL texture object is made or implied by this
parameter.</p>
</div>
<div class="paragraph">
<p><em>miplevel</em> is the mipmap level to be used.
If <em>texture_target</em> is GL_TEXTURE_BUFFER, <em>miplevel</em> must be 0.
Note: Implementations may return CL_INVALID_OPERATION for miplevel
values &gt; 0.</p>
</div>
<div class="paragraph">
<p><em>texture</em> is the name of a GL 1D, 2D, 3D, 1D array, 2D array, cubemap,
rectangle or buffer texture object.
The texture object must be a complete texture as per OpenGL rules on texture
completeness.
The <em>texture</em> format and dimensions defined by OpenGL for the specified
<em>miplevel</em> of the texture will be used to create the OpenCL image memory
object.
Only GL texture objects with an internal format that maps to appropriate
image channel order and data type specified in <em>tables 5.5</em> and <em>5.6</em> may be
used to create the OpenCL image memory object.</p>
</div>
<div class="paragraph">
<p><em>errcode_ret</em> will return an appropriate error code as described below.
If <em>errcode_ret</em> is <code>NULL</code>, no error code is returned.</p>
</div>
<div class="paragraph">
<p><strong>clCreateFromGLTexture</strong> returns a valid non-zero OpenCL image object and
<em>errcode_ret</em> is set to CL_SUCCESS if the image object is created
successfully.
Otherwise, it returns a <code>NULL</code> value with one of the following error values
returned in <em>errcode_ret</em>:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>CL_INVALID_CONTEXT if <em>context</em> is not a valid context or was not
created from a GL context.</p>
</li>
<li>
<p>CL_INVALID_VALUE if values specified in <em>flags</em> are not valid or if
value specified in <em>texture_target</em> is not one of the values specified
in the description of <em>texture_target</em>.</p>
</li>
<li>
<p>CL_INVALID_MIP_LEVEL if <em>miplevel</em> is less than the value of
<em>level<sub>base</sub></em> (for OpenGL implementations) or zero (for OpenGL ES
implementations); or greater than the value of <em>q</em> (for both OpenGL and
OpenGL ES).
<em>level<sub>base</sub></em> and <em>q</em> are defined for the texture in <em>section 3.8.10</em>
(Texture Completeness) of the OpenGL 2.1 specification and <em>section
3.7.10</em> of the OpenGL ES 2.0.</p>
</li>
<li>
<p>CL_INVALID_MIP_LEVEL if <em>miplevel</em> is greather than zero and the OpenGL
implementation does not support creating from non-zero mipmap levels.</p>
</li>
<li>
<p>CL_INVALID_GL_OBJECT if <em>texture</em> is not a GL texture object whose type
matches <em>texture_target</em>, if the specified <em>miplevel</em> of <em>texture</em> is
not defined, or if the width or height of the specified <em>miplevel</em> is
zero or if the GL texture object is incomplete.</p>
</li>
<li>
<p>CL_INVALID_IMAGE_FORMAT_DESCRIPTOR if the OpenGL texture internal format
does not map to a supported OpenCL image format.</p>
</li>
<li>
<p>CL_INVALID_OPERATION if <em>texture</em> is a GL texture object created with a
border width value greater than zero.</p>
</li>
<li>
<p>CL_OUT_OF_RESOURCES if there is a failure to allocate resources required
by the OpenCL implementation on the device.</p>
</li>
<li>
<p>CL_OUT_OF_HOST_MEMORY if there is a failure to allocate resources
required by the OpenCL implementation on the host.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>If the state of a GL texture object is modified through the GL API (e.g.
<strong>glTexImage2D</strong>, <strong>glTexImage3D</strong> or the values of the texture parameters
GL_TEXTURE_BASE_LEVEL or GL_TEXTURE_MAX_LEVEL are modified) while there
exists a corresponding CL image object, subsequent use of the CL image
object will result in undefined behavior.</p>
</div>
<div class="paragraph">
<p>The <strong>clRetainMemObject</strong> and <strong>clReleaseMemObject</strong> functions can be used to
retain and release the image objects.</p>
</div>
<div class="sect3">
<h4 id="cl_khr_gl_sharing__memobjs-list-of-opengl-and-corresponding-opencl-image-formats"><a class="anchor" href="#cl_khr_gl_sharing__memobjs-list-of-opengl-and-corresponding-opencl-image-formats"></a>11.4.1. List of OpenGL and corresponding OpenCL Image Formats</h4>
<div class="paragraph">
<p>The table below describes the list of OpenGL texture internal formats and
the corresponding OpenCL image formats.
If a OpenGL texture object with an internal format from the table below is
successfully created by OpenGL, then there is guaranteed to be a mapping to
one of the corresponding OpenCL image format(s) in that table.
Texture objects created with other OpenGL internal formats may (but are not
guaranteed to) have a mapping to an OpenCL image format; if such mappings
exist, they are guaranteed to preserve all color components, data types, and
at least the number of bits/component actually allocated by OpenGL for that
format.</p>
</div>
<table id="cl_khr_gl_sharing__memobjs-mapping-of-image-formats" class="tableblock frame-all grid-all stretch">
<caption class="title">Table 27. <em>OpenGL internal formats and corresponding OpenCL internal formats</em></caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><strong>GL internal format</strong></th>
<th class="tableblock halign-left valign-top"><strong>CL image format</strong>

  <strong>(channel order, channel data type)</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">GL_RGBA8</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">CL_RGBA, CL_UNORM_INT8 or</p>
<p class="tableblock">CL_BGRA, CL_UNORM_INT8</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">GL_SRGB8_ALPHA8</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">CL_sRGBA, CL_UNORM_INT8</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">GL_RGBA, GL_UNSIGNED_INT_8_8_8_8_REV</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">CL_RGBA, CL_UNORM_INT8</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">GL_BGRA, GL_UNSIGNED_INT_8_8_8_8_REV</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">CL_BGRA, CL_UNORM_INT8</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">GL_RGBA8I, GL_RGBA8I_EXT</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">CL_RGBA, CL_SIGNED_INT8</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">GL_RGBA16I, GL_RGBA16I_EXT</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">CL_RGBA, CL_SIGNED_INT16</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">GL_RGBA32I, GL_RGBA32I_EXT</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">CL_RGBA, CL_SIGNED_INT32</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">GL_RGBA8UI, GL_RGBA8UI_EXT</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">CL_RGBA, CL_UNSIGNED_INT8</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">GL_RGBA16UI, GL_RGBA16UI_EXT</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">CL_RGBA, CL_UNSIGNED_INT16</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">GL_RGBA32UI, GL_RGBA32UI_EXT</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">CL_RGBA, CL_UNSIGNED_INT32</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">GL_RGBA8_SNORM</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">CL_RGBA, CL_SNORM_INT8</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">GL_RGBA16</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">CL_RGBA, CL_UNORM_INT16</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">GL_RGBA16_SNORM</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">CL_RGBA, CL_SNORM_INT16</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">GL_RGBA16F, GL_RGBA16F_ARB</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">CL_RGBA, CL_HALF_FLOAT</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">GL_RGBA32F, GL_RGBA32F_ARB</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">CL_RGBA, CL_FLOAT</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">GL_R8</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">CL_R, CL_UNORM_INT8</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">GL_R8_SNORM</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">CL_R, CL_SNORM_INT8</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">GL_R16</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">CL_R, CL_UNORM_INT16</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">GL_R16_SNORM</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">CL_R, CL_SNORM_INT16</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">GL_R16F</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">CL_R, CL_HALF_FLOAT</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">GL_R32F</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">CL_R, CL_FLOAT</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">GL_R8I</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">CL_R, CL_SIGNED_INT8</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">GL_R16I</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">CL_R, CL_SIGNED_INT16</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">GL_R32I</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">CL_R, CL_SIGNED_INT32</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">GL_R8UI</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">CL_R, CL_UNSIGNED_INT8</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">GL_R16UI</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">CL_R, CL_UNSIGNED_INT16</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">GL_R32UI</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">CL_R, CL_UNSIGNED_INT32</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">GL_RG8</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">CL_RG, CL_UNORM_INT8</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">GL_RG8_SNORM</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">CL_RG, CL_SNORM_INT8</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">GL_RG16</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">CL_RG, CL_UNORM_INT16</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">GL_RG16_SNORM</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">CL_RG, CL_SNORM_INT16</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">GL_RG16F</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">CL_RG, CL_HALF_FLOAT</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">GL_RG32F</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">CL_RG, CL_FLOAT</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">GL_RG8I</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">CL_RG, CL_SIGNED_INT8</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">GL_RG16I</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">CL_RG, CL_SIGNED_INT16</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">GL_RG32I</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">CL_RG, CL_SIGNED_INT32</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">GL_RG8UI</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">CL_RG, CL_UNSIGNED_INT8</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">GL_RG16UI</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">CL_RG, CL_UNSIGNED_INT16</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">GL_RG32UI</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">CL_RG, CL_UNSIGNED_INT32</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect2">
<h3 id="cl_khr_gl_sharing__memobjs-cl-image-objects-from-gl-renderbuffers"><a class="anchor" href="#cl_khr_gl_sharing__memobjs-cl-image-objects-from-gl-renderbuffers"></a>11.5. OpenCL Image Objects from OpenGL Renderbuffers</h3>
<div class="paragraph">
<p>The function
</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="opencl"><span class="kt">cl_mem</span> <span class="n">clCreateFromGLRenderbuffer</span><span class="p">(</span><span class="kt">cl_context</span> <span class="n">context</span><span class="p">,</span>
                                  <span class="kt">cl_mem_flags</span> <span class="n">flags</span><span class="p">,</span>
                                  <span class="n">GLuint</span> <span class="n">renderbuffer</span><span class="p">,</span>
                                  <span class="kt">cl_int</span> <span class="o">*</span><span class="n">errcode_ret</span><span class="p">)</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>creates an OpenCL 2D image object from an OpenGL renderbuffer object.</p>
</div>
<div class="paragraph">
<p><em>context</em> is a valid OpenCL context created from an OpenGL context.</p>
</div>
<div class="paragraph">
<p><em>flags</em> is a bit-field that is used to specify usage information.
Refer to <em>table 5.3</em> for a description of <em>flags</em>.
Only CL_MEM_READ_ONLY, CL_MEM_WRITE_ONLY and CL_MEM_READ_WRITE values
specified in <em>table 5.3</em> can be used.</p>
</div>
<div class="paragraph">
<p><em>renderbuffer</em> is the name of a GL renderbuffer object.
The renderbuffer storage must be specified before the image object can be
created.
The <em>renderbuffer</em> format and dimensions defined by OpenGL will be used to
create the 2D image object.
Only GL renderbuffers with internal formats that maps to appropriate image
channel order and data type specified in <em>tables 5.5</em> and <em>5.6</em> can be used
to create the 2D image object.</p>
</div>
<div class="paragraph">
<p><em>errcode_ret</em> will return an appropriate error code as described below.
If <em>errcode_ret</em> is <code>NULL</code>, no error code is returned.</p>
</div>
<div class="paragraph">
<p><strong>clCreateFromGLRenderbuffer</strong> returns a valid non-zero OpenCL image object
and <em>errcode_ret</em> is set to CL_SUCCESS if the image object is created
successfully.
Otherwise, it returns a <code>NULL</code> value with one of the following error values
returned in <em>errcode_ret</em>:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>CL_INVALID_CONTEXT if <em>context</em> is not a valid context or was not
created from a GL context.</p>
</li>
<li>
<p>CL_INVALID_VALUE if values specified in <em>flags</em> are not valid.</p>
</li>
<li>
<p>CL_INVALID_GL_OBJECT if <em>renderbuffer</em> is not a GL renderbuffer object
or if the width or height of <em>renderbuffer</em> is zero.</p>
</li>
<li>
<p>CL_INVALID_IMAGE_FORMAT_DESCRIPTOR if the OpenGL renderbuffer internal
format does not map to a supported OpenCL image format.</p>
</li>
<li>
<p>CL_INVALID_OPERATION if <em>renderbuffer</em> is a multi-sample GL renderbuffer
object.</p>
</li>
<li>
<p>CL_OUT_OF_RESOURCES if there is a failure to allocate resources required
by the OpenCL implementation on the device.</p>
</li>
<li>
<p>CL_OUT_OF_HOST_MEMORY if there is a failure to allocate resources
required by the OpenCL implementation on the host.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>If the state of a GL renderbuffer object is modified through the GL API
(i.e. changes to the dimensions or format used to represent pixels of the GL
renderbuffer using appropriate GL API calls such as <strong>glRenderbufferStorage</strong>)
while there exists a corresponding CL image object, subsequent use of the CL
image object will result in undefined behavior.</p>
</div>
<div class="paragraph">
<p>The <strong>clRetainMemObject</strong> and <strong>clReleaseMemObject</strong> functions can be used to
retain and release the image objects.</p>
</div>
<div class="paragraph">
<p>The table <a href="#cl_khr_gl_sharing__memobjs-mapping-of-image-formats"><em>OpenGL
internal formats and corresponding OpenCL internal formats</em></a> describes the
list of OpenGL renderbuffer internal formats and the corresponding OpenCL
image formats.
If an OpenGL renderbuffer object with an internal format from the table is
successfully created by OpenGL, then there is guaranteed to be a mapping to
one of the corresponding OpenCL image format(s) in that table.
Renderbuffer objects created with other OpenGL internal formats may (but are
not guaranteed to) have a mapping to an OpenCL image format; if such
mappings exist, they are guaranteed to preserve all color components, data
types, and at least the number of bits/component actually allocated by
OpenGL for that format.</p>
</div>
</div>
<div class="sect2">
<h3 id="cl_khr_gl_sharing__memobjs-querying-gl-object-information-from-a-cl-memory-object"><a class="anchor" href="#cl_khr_gl_sharing__memobjs-querying-gl-object-information-from-a-cl-memory-object"></a>11.6. Querying OpenGL object information from an OpenCL memory object</h3>
<div class="paragraph">
<p>The OpenGL object used to create the OpenCL memory object and information
about the object type i.e. whether it is a texture, renderbuffer or buffer
object can be queried using the following function.
</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="opencl"><span class="kt">cl_int</span> <span class="n">clGetGLObjectInfo</span><span class="p">(</span><span class="kt">cl_mem</span> <span class="n">memobj</span><span class="p">,</span>
                         <span class="kt">cl_gl_object_type</span> <span class="o">*</span><span class="n">gl_object_type</span><span class="p">,</span>
                         <span class="n">GLuint</span> <span class="o">*</span><span class="n">gl_object_name</span><span class="p">)</span></code></pre>
</div>
</div>
<div class="paragraph">
<p><em>gl_object_type</em> returns the type of GL object attached to <em>memobj</em> and can
be CL_GL_OBJECT_BUFFER, CL_GL_OBJECT_TEXTURE2D, CL_GL_OBJECT_TEXTURE3D,
CL_GL_OBJECT_TEXTURE2D_ARRAY, CL_GL_OBJECT_TEXTURE1D,
CL_GL_OBJECT_TEXTURE1D_ARRAY, CL_GL_OBJECT_TEXTURE_BUFFER, or
CL_GL_OBJECT_RENDERBUFFER.
If <em>gl_object_type</em> is <code>NULL</code>, it is ignored</p>
</div>
<div class="paragraph">
<p><em>gl_object_name</em> returns the GL object name used to create <em>memobj</em>.
If <em>gl_object_name</em> is <code>NULL</code>, it is ignored.</p>
</div>
<div class="paragraph">
<p><strong>clGetGLObjectInfo</strong> returns CL_SUCCESS if the call was executed
successfully.
Otherwise, it returns one of the following errors:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>CL_INVALID_MEM_OBJECT if <em>memobj</em> is not a valid OpenCL memory object.</p>
</li>
<li>
<p>CL_INVALID_GL_OBJECT if there is no GL object associated with <em>memobj</em>.</p>
</li>
<li>
<p>CL_OUT_OF_RESOURCES if there is a failure to allocate resources required
by the OpenCL implementation on the device.</p>
</li>
<li>
<p>CL_OUT_OF_HOST_MEMORY if there is a failure to allocate resources
required by the OpenCL implementation on the host.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The function
</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="opencl"><span class="kt">cl_int</span> <span class="n">clGetGLTextureInfo</span><span class="p">(</span><span class="kt">cl_mem</span> <span class="n">memobj</span><span class="p">,</span>
                          <span class="kt">cl_gl_texture_info</span> <span class="n">param_name</span><span class="p">,</span>
                          <span class="kt">size_t</span> <span class="n">param_value_size</span><span class="p">,</span>
                          <span class="kt">void</span> <span class="o">*</span><span class="n">param_value</span><span class="p">,</span>
                          <span class="kt">size_t</span> <span class="o">*</span><span class="n">param_value_size_ret</span><span class="p">)</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>returns additional information about the GL texture object associated with
<em>memobj</em>.</p>
</div>
<div class="paragraph">
<p><em>param_name</em> specifies what additional information about the GL texture
object associated with <em>memobj</em> to query.
The list of supported <em>param_name</em> types and the information returned in
<em>param_value</em> by <strong>clGetGLTextureInfo</strong> is described in the table below.</p>
</div>
<div class="paragraph">
<p><em>param_value</em> is a pointer to memory where the result being queried is
returned.
If <em>param_value</em> is <code>NULL</code>, it is ignored.</p>
</div>
<div class="paragraph">
<p><em>param_value_size</em> is used to specify the size in bytes of memory pointed to
by <em>param_value</em>.
This size must be &gt;= size of return type as described in the table below.</p>
</div>
<div class="paragraph">
<p><em>param_value_size_ret</em> returns the actual size in bytes of data copied to
<em>param_value</em>.
If <em>param_value_size_ret</em> is <code>NULL</code>, it is ignored.</p>
</div>
<table id="cl_khr_gl_sharing__memobjs-clGetGLTextureInfo-queries" class="tableblock frame-all grid-all stretch">
<caption class="title">Table 28. <em>OpenGL texture info that may be queried with</em> <strong>clGetGLTextureInfo</strong></caption>
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><strong>cl_gl_texture_info</strong></th>
<th class="tableblock halign-left valign-top"><strong>Return Type</strong></th>
<th class="tableblock halign-left valign-top"><strong>Info. returned in <em>param_value</em></strong></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>CL_GL_TEXTURE_TARGET</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">GLenum</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The <em>texture_target</em> argument specified in <strong>clCreateFromGLTexture</strong>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>CL_GL_MIPMAP_LEVEL</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">GLint</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The <em>miplevel</em> argument specified in <strong>clCreateFromGLTexture</strong>.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><strong>clGetGLTextureInfo</strong> returns CL_SUCCESS if the function is executed
successfully.
Otherwise, it returns one of the following errors:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>CL_INVALID_MEM_OBJECT if <em>memobj</em> is not a valid OpenCL memory object.</p>
</li>
<li>
<p>CL_INVALID_GL_OBJECT if there is no GL texture object associated with
<em>memobj</em>.</p>
</li>
<li>
<p>CL_INVALID_VALUE if <em>param_name</em> is not valid, or if size in bytes
specified by <em>param_value_size</em> is less than the size of the return type
as described in the table above and <em>param_value</em> is not <code>NULL</code>, or if
<em>param_value</em> and <em>param_value_size_ret</em> are <code>NULL</code>.</p>
</li>
<li>
<p>CL_OUT_OF_RESOURCES if there is a failure to allocate resources required
by the OpenCL implementation on the device.</p>
</li>
<li>
<p>CL_OUT_OF_HOST_MEMORY if there is a failure to allocate resources
required by the OpenCL implementation on the host.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="cl_khr_gl_sharing__memobjs-sharing-memory-objects-that-map-to-gl-objects-between-gl-and-cl-contexts"><a class="anchor" href="#cl_khr_gl_sharing__memobjs-sharing-memory-objects-that-map-to-gl-objects-between-gl-and-cl-contexts"></a>11.7. Sharing memory objects that map to GL objects between GL and CL contexts</h3>
<div class="paragraph">
<p>The function
</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="opencl"><span class="kt">cl_int</span>  <span class="n">clEnqueueAcquireGLObjects</span><span class="p">(</span><span class="kt">cl_command_queue</span> <span class="n">command_queue</span><span class="p">,</span>
                                  <span class="kt">cl_uint</span> <span class="n">num_objects</span><span class="p">,</span>
                                  <span class="k">const</span> <span class="kt">cl_mem</span> <span class="o">*</span><span class="n">mem_objects</span><span class="p">,</span>
                                  <span class="kt">cl_uint</span> <span class="n">num_events_in_wait_list</span><span class="p">,</span>
                                  <span class="k">const</span> <span class="kt">cl_event</span> <span class="o">*</span><span class="n">event_wait_list</span><span class="p">,</span>
                                  <span class="kt">cl_event</span> <span class="o">*</span><span class="n">event</span><span class="p">)</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>is used to acquire OpenCL memory objects that have been created from OpenGL
objects.
These objects need to be acquired before they can be used by any OpenCL
commands queued to a command-queue or the behaviour is undefined.
The OpenGL objects are acquired by the OpenCL context associated with
<em>command_queue</em> and can therefore be used by all command-queues associated
with the OpenCL context.</p>
</div>
<div class="paragraph">
<p><em>command_queue</em> is a valid command-queue.
All devices used to create the OpenCL context associated with
<em>command_queue</em> must support acquiring shared CL/GL objects.
This constraint is enforced at context creation time.</p>
</div>
<div class="paragraph">
<p><em>num_objects</em> is the number of memory objects to be acquired in
<em>mem_objects</em>.</p>
</div>
<div class="paragraph">
<p><em>mem_objects</em> is a pointer to a list of CL memory objects that correspond to
GL objects.</p>
</div>
<div class="paragraph">
<p><em>event_wait_list</em> and <em>num_events_in_wait_list</em> specify events that need to
complete before this particular command can be executed.
If <em>event_wait_list</em> is <code>NULL</code>, then this particular command does not wait
on any event to complete.
If <em>event_wait_list</em> is <code>NULL</code>, <em>num_events_in_wait_list</em> must be 0.
If <em>event_wait_list</em> is not <code>NULL</code>, the list of events pointed to by
<em>event_wait_list</em> must be valid and <em>num_events_in_wait_list</em> must be
greater than 0.
The events specified in</p>
</div>
<div class="paragraph">
<p><em>event_wait_list</em> act as synchronization points.</p>
</div>
<div class="paragraph">
<p><em>event</em> returns an event object that identifies this command
and can be used to query wait for this command to complete.
If <em>event</em> is <code>NULL</code> or the enqueue is unsuccessful, no event will be
created and therefore it will not be possible to query the status of this
command or to wait for this command to complete.
If <em>event_wait_list</em> and <em>event</em> are not <code>NULL</code>, <em>event</em> must not refer
to an element of the <em>event_wait_list</em> array.</p>
</div>
<div class="paragraph">
<p><strong>clEnqueueAcquireGLObjects</strong> returns CL_SUCCESS if the function is executed
successfully.
If <em>num_objects</em> is 0 and <em>mem_objects</em> is <code>NULL</code> the function does nothing
and returns CL_SUCCESS.
Otherwise, it returns one of the following errors:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>CL_INVALID_VALUE if <em>num_objects</em> is zero and <em>mem_objects</em> is not a
<code>NULL</code> value or if <em>num_objects</em> &gt; 0 and <em>mem_objects</em> is <code>NULL</code>.</p>
</li>
<li>
<p>CL_INVALID_MEM_OBJECT if memory objects in <em>mem_objects</em> are not valid
OpenCL memory objects.</p>
</li>
<li>
<p>CL_INVALID_COMMAND_QUEUE if <em>command_queue</em> is not a valid
command-queue.</p>
</li>
<li>
<p>CL_INVALID_CONTEXT if context associated with <em>command_queue</em> was not
created from an OpenGL context</p>
</li>
<li>
<p>CL_INVALID_GL_OBJECT if memory objects in <em>mem_objects</em> have not been
created from a GL object(s).</p>
</li>
<li>
<p>CL_INVALID_EVENT_WAIT_LIST if <em>event_wait_list</em> is <code>NULL</code> and
<em>num_events_in_wait_list</em> &gt; 0, or <em>event_wait_list</em> is not <code>NULL</code> and
<em>num_events_in_wait_list</em> is 0, or if event objects in <em>event_wait_list</em>
are not valid events.</p>
</li>
<li>
<p>CL_OUT_OF_RESOURCES if there is a failure to allocate resources required
by the OpenCL implementation on the device.</p>
</li>
<li>
<p>CL_OUT_OF_HOST_MEMORY if there is a failure to allocate resources
required by the OpenCL implementation on the host.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The function
</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="opencl"><span class="kt">cl_int</span> <span class="n">clEnqueueReleaseGLObjects</span><span class="p">(</span><span class="kt">cl_command_queue</span> <span class="n">command_queue</span><span class="p">,</span>
                                 <span class="kt">cl_uint</span> <span class="n">num_objects</span><span class="p">,</span>
                                 <span class="k">const</span> <span class="kt">cl_mem</span> <span class="o">*</span><span class="n">mem_objects</span><span class="p">,</span>
                                 <span class="kt">cl_uint</span> <span class="n">num_events_in_wait_list</span><span class="p">,</span>
                                 <span class="k">const</span> <span class="kt">cl_event</span> <span class="o">*</span><span class="n">event_wait_list</span><span class="p">,</span>
                                 <span class="kt">cl_event</span> <span class="o">*</span><span class="n">event</span><span class="p">)</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>is used to release OpenCL memory objects that have been created from OpenGL
objects.
These objects need to be released before they can be used by OpenGL.
The OpenGL objects are released by the OpenCL context associated with
<em>command_queue</em>.</p>
</div>
<div class="paragraph">
<p><em>num_objects</em> is the number of memory objects to be released in
<em>mem_objects</em>.</p>
</div>
<div class="paragraph">
<p><em>mem_objects</em> is a pointer to a list of CL memory objects that correspond to
GL objects.</p>
</div>
<div class="paragraph">
<p><em>event_wait_list</em> and <em>num_events_in_wait_list</em> specify events that need to
complete before this command can be executed.
If <em>event_wait_list</em> is <code>NULL</code>, then this particular command does not wait
on any event to complete.
If <em>event_wait_list</em> is <code>NULL</code>, <em>num_events_in_wait_list</em> must be 0.
If <em>event_wait_list</em> is not <code>NULL</code>, the list of events pointed to by
<em>event_wait_list</em> must be valid and <em>num_events_in_wait_list</em> must be
greater than 0.
The events specified in <em>event_wait_list</em> act as synchronization points.</p>
</div>
<div class="paragraph">
<p><em>event</em> returns an event object that identifies this command
and can be used to query or wait for this command to complete.
If <em>event</em> is <code>NULL</code> or the enqueue is unsuccessful, no event will be
created and therefore it will not be possible to query the status of this
command or to wait for this command to complete.
If <em>event_wait_list</em> and <em>event</em> are not <code>NULL</code>, <em>event</em> must not refer
to an element of the <em>event_wait_list</em> array.</p>
</div>
<div class="paragraph">
<p><strong>clEnqueueReleaseGLObjects</strong> returns CL_SUCCESS if the function is executed
successfully.
If <em>num_objects</em> is 0 and <em>mem_objects</em> is <code>NULL</code> the function does nothing
and returns CL_SUCCESS.
Otherwise, it returns one of the following errors:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>CL_INVALID_VALUE if <em>num_objects</em> is zero and <em>mem_objects</em> is not a
<code>NULL</code> value or if <em>num_objects</em> &gt; 0 and <em>mem_objects</em> is <code>NULL</code>.</p>
</li>
<li>
<p>CL_INVALID_MEM_OBJECT if memory objects in <em>mem_objects</em> are not valid
OpenCL memory objects.</p>
</li>
<li>
<p>CL_INVALID_COMMAND_QUEUE if <em>command_queue</em> is not a valid
command-queue.</p>
</li>
<li>
<p>CL_INVALID_CONTEXT if context associated with <em>command_queue</em> was not
created from an OpenGL context</p>
</li>
<li>
<p>CL_INVALID_GL_OBJECT if memory objects in <em>mem_objects</em> have not been
created from a GL object(s).</p>
</li>
<li>
<p>CL_INVALID_EVENT_WAIT_LIST if <em>event_wait_list</em> is <code>NULL</code> and
<em>num_events_in_wait_list</em> &gt; 0, or <em>event_wait_list</em> is not <code>NULL</code> and
<em>num_events_in_wait_list</em> is 0, or if event objects in <em>event_wait_list</em>
are not valid events.</p>
</li>
<li>
<p>CL_OUT_OF_RESOURCES if there is a failure to allocate resources required
by the OpenCL implementation on the device.</p>
</li>
<li>
<p>CL_OUT_OF_HOST_MEMORY if there is a failure to allocate resources
required by the OpenCL implementation on the host.</p>
</li>
</ul>
</div>
<div class="sect3">
<h4 id="cl_khr_gl_sharing__memobjs-synchronizing-opencl-and-opengl-access-to-shared-objects"><a class="anchor" href="#cl_khr_gl_sharing__memobjs-synchronizing-opencl-and-opengl-access-to-shared-objects"></a>11.7.1. Synchronizing OpenCL and OpenGL Access to Shared Objects</h4>
<div class="paragraph">
<p>In order to ensure data integrity, the application is responsible for
synchronizing access to shared CL/GL objects by their respective APIs.
Failure to provide such synchronization may result in race conditions and
other undefined behavior including non-portability between implementations.</p>
</div>
<div class="paragraph">
<p>Prior to calling <strong>clEnqueueAcquireGLObjects</strong>, the application must ensure
that any pending GL operations which access the objects specified in
<em>mem_objects</em> have completed.
This may be accomplished portably by issuing and waiting for completion of a
<strong>glFinish</strong> command on all GL contexts with pending references to these
objects.
Implementations may offer more efficient synchronization methods; for
example on some platforms calling <strong>glFlush</strong> may be sufficient, or
synchronization may be implicit within a thread, or there may be
vendor-specific extensions that enable placing a fence in the GL command
stream and waiting for completion of that fence in the CL command queue.
Note that no synchronization methods other than <strong>glFinish</strong> are portable
between OpenGL implementations at this time.</p>
</div>
<div class="paragraph">
<p>Similarly, after calling <strong>clEnqueueReleaseGLObjects</strong>, the application is
responsible for ensuring that any pending OpenCL operations which access the
objects specified in <em>mem_objects</em> have completed prior to executing
subsequent GL commands which reference these objects.
This may be accomplished portably by calling <strong>clWaitForEvents</strong> with the
event object returned by <strong>clEnqueueReleaseGLObjects,</strong> or by calling
<strong>clFinish</strong>.
As above, some implementations may offer more efficient methods.</p>
</div>
<div class="paragraph">
<p>The application is responsible for maintaining the proper order of
operations if the CL and GL contexts are in separate threads.</p>
</div>
<div class="paragraph">
<p>If a GL context is bound to a thread other than the one in which
<strong>clEnqueueReleaseGLObjects</strong> is called, changes to any of the objects in
<em>mem_objects</em> may not be visible to that context without additional steps
being taken by the application.
For an OpenGL 3.1 (or later) context, the requirements are described in
Appendix D (&#8220;Shared Objects and Multiple Contexts&#8221;) of the OpenGL 3.1
Specification.
For prior versions of OpenGL, the requirements are implementation-dependent.</p>
</div>
<div class="paragraph">
<p>Attempting to access the data store of an OpenGL object after it has been
acquired by OpenCL and before it has been released will result in undefined
behavior.
Similarly, attempting to access a shared CL/GL object from OpenCL before it
has been acquired by the OpenCL command queue, or after it has been
released, will result in undefined behavior.</p>
</div>
</div>
<div class="sect3">
<h4 id="cl_khr_gl_sharing__memobjs-event-command-types"><a class="anchor" href="#cl_khr_gl_sharing__memobjs-event-command-types"></a>11.7.2. Event Command Types for Sharing memory objects that map to GL objects</h4>
<div class="paragraph">
<p>The following table describes the event command types for the OpenCL commands
to acquire and release OpenCL memory objects that have been created from
OpenGL objects:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 29. List of supported event command types</caption>
<colgroup>
<col style="width: 40%;">
<col style="width: 60%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><strong>Events Created By</strong></th>
<th class="tableblock halign-left valign-top"><strong>Event Command Type</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>clEnqueueAcquireGLObjects</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CL_COMMAND_<wbr>ACQUIRE_<wbr>GL_<wbr>OBJECTS</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>clEnqueueReleaseGLObjects</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CL_COMMAND_<wbr>RELEASE_<wbr>GL_<wbr>OBJECTS</code></p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="cl_khr_gl_event"><a class="anchor" href="#cl_khr_gl_event"></a>12. Creating OpenCL Event Objects from OpenGL Sync Objects</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="cl_khr_gl_event-overview"><a class="anchor" href="#cl_khr_gl_event-overview"></a>12.1. Overview</h3>
<div class="paragraph">
<p>This section describes the <strong>cl_khr_gl_event</strong> extension.
This extension allows creating OpenCL event objects linked to OpenGL fence
sync objects, potentially improving efficiency of sharing images and buffers
between the two APIs.
The companion <strong>GL_ARB_cl_event</strong> extension provides the complementary
functionality of creating an OpenGL sync object from an OpenCL event object.</p>
</div>
<div class="paragraph">
<p>In addition, this extension modifies the behavior of
<strong>clEnqueueAcquireGLObjects</strong> and <strong>clEnqueueReleaseGLObjects</strong> to implicitly
guarantee synchronization with an OpenGL context bound in the same thread as
the OpenCL context.</p>
</div>
</div>
<div class="sect2">
<h3 id="_general_information_11"><a class="anchor" href="#_general_information_11"></a>12.2. General information</h3>
<div class="sect3">
<h4 id="_version_history_11"><a class="anchor" href="#_version_history_11"></a>12.2.1. Version history</h4>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 60%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><strong>Date</strong></th>
<th class="tableblock halign-left valign-top"><strong>Version</strong></th>
<th class="tableblock halign-left valign-top"><strong>Description</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">2020-04-21</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.0.0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">First assigned version.</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect2">
<h3 id="cl_khr_gl_event-new-procedures-and-functions"><a class="anchor" href="#cl_khr_gl_event-new-procedures-and-functions"></a>12.3. New Procedures and Functions</h3>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="opencl"><span class="kt">cl_event</span> <span class="nf">clCreateEventFromGLsyncKHR</span><span class="p">(</span><span class="kt">cl_context</span> <span class="n">context</span><span class="p">,</span>
                                    <span class="n">GLsync</span> <span class="n">sync</span><span class="p">,</span>
                                    <span class="kt">cl_int</span> <span class="o">*</span><span class="n">errcode_ret</span><span class="p">);</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="cl_khr_gl_event-new-tokens"><a class="anchor" href="#cl_khr_gl_event-new-tokens"></a>12.4. New Tokens</h3>
<div class="paragraph">
<p>Returned by <strong>clGetEventInfo</strong> when <em>param_name</em> is CL_EVENT_COMMAND_TYPE:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="opencl"><span class="n">CL_COMMAND_GL_FENCE_SYNC_OBJECT_KHR</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="cl_khr_gl_event-additions-to-chapter-5"><a class="anchor" href="#cl_khr_gl_event-additions-to-chapter-5"></a>12.5. Additions to Chapter 5 of the OpenCL 2.2 Specification</h3>
<div class="paragraph">
<p>Add following to the fourth paragraph of <em>section 5.11</em> (prior to the
description of <strong>clWaitForEvents</strong>):</p>
</div>
<div class="paragraph">
<p>&#8220;Event objects can also be used to reflect the status of an OpenGL sync
object.
The sync object in turn refers to a fence command executing in an OpenGL
command stream.
This provides another method of coordinating sharing of buffers and images
between OpenGL and OpenCL.&#8221;</p>
</div>
<div class="paragraph">
<p>Add CL_COMMAND_GL_FENCE_SYNC_OBJECT_KHR to the valid <em>param_value</em> values
returned by <strong>clGetEventInfo</strong> for <em>param_name</em> CL_EVENT_COMMAND_TYPE (in the
third row and third column of <em>table 5.22</em>).</p>
</div>
<div class="paragraph">
<p>Add new <em>subsection 5.11.1</em>:</p>
</div>
<div class="paragraph">
<p>"`<strong>5.11.1 Linking Event Objects to OpenGL Synchronization Objects</strong></p>
</div>
<div class="paragraph">
<p>An event object may be created by linking to an OpenGL <strong>sync object</strong>.
Completion of such an event object is equivalent to waiting for completion
of the fence command associated with the linked GL sync object.</p>
</div>
<div class="paragraph">
<p>The function
</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="opencl"><span class="kt">cl_event</span> <span class="n">clCreateEventFromGLsyncKHR</span><span class="p">(</span><span class="kt">cl_context</span> <span class="n">context</span><span class="p">,</span>
                                    <span class="n">GLsync</span> <span class="n">sync</span><span class="p">,</span>
                                    <span class="kt">cl_int</span> <span class="o">*</span><span class="n">errcode_ret</span><span class="p">)</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>creates a linked event object.</p>
</div>
<div class="paragraph">
<p><em>context</em> is a valid OpenCL context created from an OpenGL context or share
group, using the <strong>cl_khr_gl_sharing</strong> extension.</p>
</div>
<div class="paragraph">
<p><em>sync</em> is the name of a sync object in the GL share group associated with
<em>context</em>.</p>
</div>
<div class="paragraph">
<p><strong>clCreateEventFromGLsyncKHR</strong> returns a valid OpenCL event object and
<em>errcode_ret</em> is set to CL_SUCCESS if the event object is created
successfully.
Otherwise, it returns a <code>NULL</code> value with one of the following error values
returned in <em>errcode_ret</em>:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>CL_INVALID_CONTEXT if <em>context</em> is not a valid context, or was not
created from a GL context.</p>
</li>
<li>
<p>CL_INVALID_GL_OBJECT if <em>sync</em> is not the name of a sync object in the
GL share group associated with <em>context</em>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The parameters of an event object linked to a GL sync object will return the
following values when queried with <strong>clGetEventInfo</strong>:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The CL_EVENT_COMMAND_QUEUE of a linked event is <code>NULL</code>, because the
event is not associated with any OpenCL command queue.</p>
</li>
<li>
<p>The CL_EVENT_COMMAND_TYPE of a linked event is
CL_COMMAND_GL_FENCE_SYNC_OBJECT_KHR, indicating that the event is
associated with a GL sync object, rather than an OpenCL command.</p>
</li>
<li>
<p>The CL_EVENT_COMMAND_EXECUTION_STATUS of a linked event is either
CL_SUBMITTED, indicating that the fence command associated with the sync
object has not yet completed, or CL_COMPLETE, indicating that the fence
command has completed.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>clCreateEventFromGLsyncKHR</strong> performs an implicit <strong>clRetainEvent</strong> on the
returned event object.
Creating a linked event object also places a reference on the linked GL sync
object.
When the event object is deleted, the reference will be removed from the GL
sync object.</p>
</div>
<div class="paragraph">
<p>Events returned from <strong>clCreateEventFromGLsyncKHR</strong> can be used in the
<em>event_wait_list</em> argument to <strong>clEnqueueAcquireGLObjects</strong> and CL APIs that
take a cl_event as an argument but do not enqueue commands.
Passing such events to any other CL API that enqueues commands will generate
a CL_INVALID_EVENT error.`"</p>
</div>
</div>
<div class="sect2">
<h3 id="cl_khr_gl_event-additions-to-extension-specification"><a class="anchor" href="#cl_khr_gl_event-additions-to-extension-specification"></a>12.6. Additions to the OpenCL Extension Specification</h3>
<div class="paragraph">
<p>Add following the paragraph describing parameter <em>event</em> to
<strong>clEnqueueAcquireGLObjects</strong>:</p>
</div>
<div class="paragraph">
<p>"`If an OpenGL context is bound to the current thread, then any OpenGL
commands which</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>affect or access the contents of a memory object listed in the
<em>mem_objects</em> list, and</p>
</li>
<li>
<p>were issued on that OpenGL context prior to the call to
<strong>clEnqueueAcquireGLObjects</strong></p>
</li>
</ol>
</div>
<div class="paragraph">
<p>will complete before execution of any OpenCL commands following the
<strong>clEnqueueAcquireGLObjects</strong> which affect or access any of those memory
objects.
If a non-<code>NULL</code> <em>event</em> object is returned, it will report completion only
after completion of such OpenGL commands.`"</p>
</div>
<div class="paragraph">
<p>Add following the paragraph describing parameter <em>event</em> to
<strong>clEnqueueReleaseGLObjects</strong>:</p>
</div>
<div class="paragraph">
<p>"`If an OpenGL context is bound to the current thread, then then any OpenGL
commands which</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>affect or access the contents of the memory objects listed in the
<em>mem_objects</em> list, and</p>
</li>
<li>
<p>are issued on that context after the call to <strong>clEnqueueReleaseGLObjects</strong></p>
</li>
</ol>
</div>
<div class="paragraph">
<p>will not execute until after execution of any OpenCL commands preceding the</p>
</div>
<div class="paragraph">
<p><strong>clEnqueueReleaseGLObjects</strong> which affect or access any of those memory
objects.
If a non-<code>NULL</code> <em>event</em> object is returned, it will report completion before
execution of such OpenGL commands.`"</p>
</div>
<div class="paragraph">
<p>Replace the second paragraph of
<a href="#cl_khr_gl_sharing__memobjs-synchronizing-opencl-and-opengl-access-to-shared-objects">Synchronizing OpenCL and OpenGL Access to Shared Objects</a> with:</p>
</div>
<div class="paragraph">
<p>"`Prior to calling <strong>clEnqueueAcquireGLObjects</strong>, the application must ensure
that any pending OpenGL operations which access the objects specified in
<em>mem_objects</em> have completed.</p>
</div>
<div class="paragraph">
<p>If the <strong>cl_khr_gl_event</strong> extension is supported, then the OpenCL
implementation will ensure that any such pending OpenGL operations are
complete for an OpenGL context bound to the same thread as the OpenCL
context.
This is referred to as <em>implicit synchronization</em>.</p>
</div>
<div class="paragraph">
<p>If the <strong>cl_khr_gl_event</strong> extension is supported and the OpenGL context in
question supports fence sync objects, completion of OpenGL commands may also
be determined by placing a GL fence command after those commands using
<strong>glFenceSync</strong>, creating an event from the resulting GL sync object using
<strong>clCreateEventFromGLsyncKHR</strong>, and determining completion of that event
object via <strong>clEnqueueAcquireGLObjects</strong>.
This method may be considerably more efficient than calling <strong>glFinish</strong>, and
is referred to as <em>explicit synchronization</em>.
Explicit synchronization is most useful when an OpenGL context bound to
another thread is accessing the memory objects.</p>
</div>
<div class="paragraph">
<p>If the <strong>cl_khr_gl_event</strong> extension is not supported, completion of OpenGL
commands may be determined by issuing and waiting for completion of a
<strong>glFinish</strong> command on all OpenGL contexts with pending references to these
objects.
Some implementations may offer other efficient synchronization methods.
If such methods exist they will be described in platform-specific
documentation.</p>
</div>
<div class="paragraph">
<p>Note that no synchronization method other than <strong>glFinish</strong> is portable
between all OpenGL implementations and all OpenCL implementations.
While this is the only way to ensure completion that is portable to all
platforms, <strong>glFinish</strong> is an expensive operation and its use should be
avoided if the <strong>cl_khr_gl_event</strong> extension is supported on a platform.`"</p>
</div>
</div>
<div class="sect2">
<h3 id="cl_khr_gl_event-issues"><a class="anchor" href="#cl_khr_gl_event-issues"></a>12.7. Issues</h3>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>How are references between CL events and GL syncs handled?</p>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>PROPOSED: The linked CL event places a single reference on the GL sync
object.
That reference is removed when the CL event is deleted.
A more expensive alternative would be to reflect changes in the CL event
reference count through to the GL sync.</p>
</div>
</div>
</div>
</li>
<li>
<p>How are linkages to synchronization primitives in other APIs handled?</p>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>UNRESOLVED.
We will at least want to have a way to link events to EGL sync objects.
There is probably no analogous DX concept.
There would be an entry point for each type of synchronization primitive to
be linked to, such as clCreateEventFromEGLSyncKHR.</p>
</div>
<div class="paragraph">
<p>An alternative is a generic clCreateEventFromExternalEvent taking an
attribute list.
The attribute list would include information defining the type of the
external primitive and additional information (GL sync object handle, EGL
display and sync object handle, etc.) specific to that type.
This allows a single entry point to be reused.</p>
</div>
<div class="paragraph">
<p>These will probably be separate extensions following the API proposed here.</p>
</div>
</div>
</div>
</li>
<li>
<p>Should the CL_EVENT_COMMAND_TYPE correspond to the type of command
(fence) or the type of the linked sync object?</p>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>PROPOSED: To the type of the linked sync object.</p>
</div>
</div>
</div>
</li>
<li>
<p>Should we support both explicit and implicit synchronization?</p>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>PROPOSED: Yes.
Implicit synchronization is suitable when GL and CL are executing in the
same application thread.
Explicit synchronization is suitable when they are executing in different
threads but the expense of glFinish is too high.</p>
</div>
</div>
</div>
</li>
<li>
<p>Should this be a platform or device extension?</p>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>PROPOSED: Platform extension.
This may result in considerable under-the-hood work to implement the
sync&#8594;event semantics using only the public GL API, however, when multiple
drivers and devices with different GL support levels coexist in the same
runtime.</p>
</div>
</div>
</div>
</li>
<li>
<p>Where can events generated from GL syncs be usable?</p>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>PROPOSED: Only with clEnqueueAcquireGLObjects, and attempting to use such an
event elsewhere will generate an error.
There is no apparent use case for using such events elsewhere, and possibly
some cost to supporting it, balanced by the cost of checking the source of
events in all other commands accepting them as parameters.</p>
</div>
</div>
</div>
</li>
</ol>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="cl_khr_d3d10_sharing"><a class="anchor" href="#cl_khr_d3d10_sharing"></a>13. Creating OpenCL Memory Objects from Direct3D 10 Buffers and Textures</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="cl_khr_d3d10_sharing-overview"><a class="anchor" href="#cl_khr_d3d10_sharing-overview"></a>13.1. Overview</h3>
<div class="paragraph">
<p>This section describes the <strong>cl_khr_d3d10_sharing</strong> extension.
The goal of this extension is to provide interoperability between OpenCL and
Direct3D 10.</p>
</div>
</div>
<div class="sect2">
<h3 id="_general_information_12"><a class="anchor" href="#_general_information_12"></a>13.2. General information</h3>
<div class="sect3">
<h4 id="_version_history_12"><a class="anchor" href="#_version_history_12"></a>13.2.1. Version history</h4>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 60%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><strong>Date</strong></th>
<th class="tableblock halign-left valign-top"><strong>Version</strong></th>
<th class="tableblock halign-left valign-top"><strong>Description</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">2020-04-21</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.0.0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">First assigned version.</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect2">
<h3 id="cl_khr_d3d10_sharing-new-procedures-and-functions"><a class="anchor" href="#cl_khr_d3d10_sharing-new-procedures-and-functions"></a>13.3. New Procedures and Functions</h3>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="opencl"><span class="kt">cl_int</span> <span class="nf">clGetDeviceIDsFromD3D10KHR</span><span class="p">(</span><span class="kt">cl_platform_id</span> <span class="n">platform</span><span class="p">,</span>
                                  <span class="kt">cl_d3d10_device_source_khr</span> <span class="n">d3d_device_source</span><span class="p">,</span>
                                  <span class="kt">void</span> <span class="o">*</span><span class="n">d3d_object</span><span class="p">,</span>
                                  <span class="kt">cl_d3d10_device_set_khr</span> <span class="n">d3d_device_set</span><span class="p">,</span>
                                  <span class="kt">cl_uint</span> <span class="n">num_entries</span><span class="p">,</span>
                                  <span class="kt">cl_device_id</span> <span class="o">*</span><span class="n">devices</span><span class="p">,</span>
                                  <span class="kt">cl_uint</span> <span class="o">*</span><span class="n">num_devices</span><span class="p">);</span>

<span class="kt">cl_mem</span> <span class="nf">clCreateFromD3D10BufferKHR</span><span class="p">(</span><span class="kt">cl_context</span> <span class="n">context</span><span class="p">,</span>
                                  <span class="kt">cl_mem_flags</span> <span class="n">flags</span><span class="p">,</span>
                                  <span class="n">ID3D10Buffer</span> <span class="o">*</span><span class="n">resource</span><span class="p">,</span>
                                  <span class="kt">cl_int</span> <span class="o">*</span><span class="n">errcode_ret</span><span class="p">);</span>

<span class="kt">cl_mem</span> <span class="nf">clCreateFromD3D10Texture2DKHR</span><span class="p">(</span><span class="kt">cl_context</span> <span class="n">context</span><span class="p">,</span>
                                     <span class="kt">cl_mem_flags</span> <span class="n">flags</span><span class="p">,</span>
                                     <span class="n">ID3D10Texture2D</span> <span class="o">*</span><span class="n">resource</span><span class="p">,</span>
                                     <span class="n">UINT</span> <span class="n">subresource</span><span class="p">,</span>
                                     <span class="kt">cl_int</span> <span class="o">*</span><span class="n">errcode_ret</span><span class="p">);</span>

<span class="kt">cl_mem</span> <span class="nf">clCreateFromD3D10Texture3DKHR</span><span class="p">(</span><span class="kt">cl_context</span> <span class="n">context</span><span class="p">,</span>
                                     <span class="kt">cl_mem_flags</span> <span class="n">flags</span><span class="p">,</span>
                                     <span class="n">ID3D10Texture3D</span> <span class="o">*</span><span class="n">resource</span><span class="p">,</span>
                                     <span class="n">UINT</span> <span class="n">subresource</span><span class="p">,</span>
                                     <span class="kt">cl_int</span> <span class="o">*</span><span class="n">errcode_ret</span><span class="p">);</span>

<span class="kt">cl_int</span> <span class="nf">clEnqueueAcquireD3D10ObjectsKHR</span><span class="p">(</span><span class="kt">cl_command_queue</span> <span class="n">command_queue</span><span class="p">,</span>
                                       <span class="kt">cl_uint</span> <span class="n">num_objects</span><span class="p">,</span>
                                       <span class="k">const</span> <span class="kt">cl_mem</span> <span class="o">*</span><span class="n">mem_objects</span><span class="p">,</span>
                                       <span class="kt">cl_uint</span> <span class="n">num_events_in_wait_list</span><span class="p">,</span>
                                       <span class="k">const</span> <span class="kt">cl_event</span> <span class="o">*</span><span class="n">event_wait_list</span><span class="p">,</span>
                                       <span class="kt">cl_event</span> <span class="o">*</span><span class="n">event</span><span class="p">);</span>

<span class="kt">cl_int</span> <span class="nf">clEnqueueReleaseD3D10ObjectsKHR</span><span class="p">(</span><span class="kt">cl_command_queue</span> <span class="n">command_queue</span><span class="p">,</span>
                                       <span class="kt">cl_uint</span> <span class="n">num_objects</span><span class="p">,</span>
                                       <span class="k">const</span> <span class="kt">cl_mem</span> <span class="o">*</span><span class="n">mem_objects</span><span class="p">,</span>
                                       <span class="kt">cl_uint</span> <span class="n">num_events_in_wait_list</span><span class="p">,</span>
                                       <span class="k">const</span> <span class="kt">cl_event</span> <span class="o">*</span><span class="n">event_wait_list</span><span class="p">,</span>
                                       <span class="kt">cl_event</span> <span class="o">*</span><span class="n">event</span><span class="p">);</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="cl_khr_d3d10_sharing-new-tokens"><a class="anchor" href="#cl_khr_d3d10_sharing-new-tokens"></a>13.4. New Tokens</h3>
<div class="paragraph">
<p>Accepted as a Direct3D 10 device source in the <em>d3d_device_source</em> parameter
of <strong>clGetDeviceIDsFromD3D10KHR</strong>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="opencl"><span class="n">CL_D3D10_DEVICE_KHR</span>
<span class="n">CL_D3D10_DXGI_ADAPTER_KHR</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Accepted as a set of Direct3D 10 devices in the <em>d3d_device_set</em> parameter
of <strong>clGetDeviceIDsFromD3D10KHR</strong>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="opencl"><span class="n">CL_PREFERRED_DEVICES_FOR_D3D10_KHR</span>
<span class="n">CL_ALL_DEVICES_FOR_D3D10_KHR</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Accepted as a property name in the <em>properties</em> parameter of
<strong>clCreateContext</strong> and <strong>clCreateContextFromType</strong>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="opencl"><span class="n">CL_CONTEXT_D3D10_DEVICE_KHR</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Accepted as a property name in the <em>param_name</em> parameter of
<strong>clGetContextInfo</strong>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="opencl"><span class="n">CL_CONTEXT_D3D10_PREFER_SHARED_RESOURCES_KHR</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Accepted as the property being queried in the <em>param_name</em> parameter of
<strong>clGetMemObjectInfo</strong>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="opencl"><span class="n">CL_MEM_D3D10_RESOURCE_KHR</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Accepted as the property being queried in the <em>param_name</em> parameter of
<strong>clGetImageInfo</strong>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="opencl"><span class="n">CL_IMAGE_D3D10_SUBRESOURCE_KHR</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Returned in the <em>param_value</em> parameter of <strong>clGetEventInfo</strong> when
<em>param_name</em> is <code>CL_EVENT_<wbr>COMMAND_<wbr>TYPE</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="opencl"><span class="n">CL_COMMAND_ACQUIRE_D3D10_OBJECTS_KHR</span>
<span class="n">CL_COMMAND_RELEASE_D3D10_OBJECTS_KHR</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Returned by <strong>clCreateContext</strong> and <strong>clCreateContextFromType</strong> if the Direct3D
10 device specified for interoperability is not compatible with the devices
against which the context is to be created:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="opencl"><span class="n">CL_INVALID_D3D10_DEVICE_KHR</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Returned by <strong>clCreateFromD3D10BufferKHR</strong> when <em>resource</em> is not a Direct3D
10 buffer object, and by <strong>clCreateFromD3D10Texture2DKHR</strong> and
<strong>clCreateFromD3D10Texture3DKHR</strong> when <em>resource</em> is not a Direct3D 10 texture
object:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="opencl"><span class="n">CL_INVALID_D3D10_RESOURCE_KHR</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Returned by <strong>clEnqueueAcquireD3D10ObjectsKHR</strong> when any of <em>mem_objects</em> are
currently acquired by OpenCL:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="opencl"><span class="n">CL_D3D10_RESOURCE_ALREADY_ACQUIRED_KHR</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Returned by <strong>clEnqueueReleaseD3D10ObjectsKHR</strong> when any of <em>mem_objects</em> are
not currently acquired by OpenCL:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="opencl"><span class="n">CL_D3D10_RESOURCE_NOT_ACQUIRED_KHR</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="cl_khr_d3d10_sharing-additions-to-chapter-4"><a class="anchor" href="#cl_khr_d3d10_sharing-additions-to-chapter-4"></a>13.5. Additions to Chapter 4 of the OpenCL 2.2 Specification</h3>
<div class="paragraph">
<p>In <em>section 4.4</em>, replace the description of <em>properties</em> under
<strong>clCreateContext</strong> with:</p>
</div>
<div class="paragraph">
<p>"<em>properties</em> specifies a list of context property names and their
corresponding values.
Each property is followed immediately by the corresponding desired value.
The list is terminated with zero.
If a property is not specified in <em>properties</em>, then its default value
(listed in <em>table 4.5</em>) is used (it is said to be specified implicitly).
If <em>properties</em> is <code>NULL</code> or empty (points to a list whose first value is
zero), all attributes take on their default values."</p>
</div>
<div class="paragraph">
<p>Add the following to <em>table 4.5</em>:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 40%;">
<col style="width: 20%;">
<col style="width: 40%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><strong>cl_context_properties enum</strong></th>
<th class="tableblock halign-left valign-top"><strong>Property value</strong></th>
<th class="tableblock halign-left valign-top"><strong>Description</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CL_CONTEXT_<wbr>D3D10_<wbr>DEVICE_<wbr>KHR</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ID3D10Device *</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Specifies the ID3D10Device * to use for Direct3D 10 interoperability.</p>
<p class="tableblock">  The default value is <code>NULL</code>.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Add to the list of errors for <strong>clCreateContext</strong>:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>CL_INVALID_<wbr>D3D10_<wbr>DEVICE_<wbr>KHR</code> if the value of the property
<code>CL_CONTEXT_<wbr>D3D10_<wbr>DEVICE_<wbr>KHR</code> is non-<code>NULL</code> and does not specify a valid
Direct3D 10 device with which the <em>cl_device_ids</em> against which this
context is to be created may interoperate.</p>
</li>
<li>
<p><code>CL_INVALID_<wbr>OPERATION</code> if Direct3D 10 interoperability is specified by
setting <code>CL_INVALID_<wbr>D3D10_<wbr>DEVICE_<wbr>KHR</code> to a non-<code>NULL</code> value, and
interoperability with another graphics API is also specified.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Add to the list of errors for <strong>clCreateContextFromType</strong> the same new errors
described above for <strong>clCreateContext</strong>.</p>
</div>
<div class="paragraph">
<p>Add the following row to <em>table 4.6</em>:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 40%;">
<col style="width: 20%;">
<col style="width: 40%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><strong>cl_context_info</strong></th>
<th class="tableblock halign-left valign-top"><strong>Return Type</strong></th>
<th class="tableblock halign-left valign-top"><strong>Information returned in param_value</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CL_CONTEXT_<wbr>D3D10_<wbr>PREFER_<wbr>SHARED_<wbr>RESOURCES_<wbr>KHR</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>cl_bool</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Returns <code>CL_TRUE</code> if Direct3D 10 resources created as shared by setting
  <em>MiscFlags</em> to include D3D10_RESOURCE_MISC_SHARED will perform faster when
  shared with OpenCL, compared with resources which have not set this flag.
  Otherwise returns <code>CL_FALSE</code>.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="cl_khr_d3d10_sharing-additions-to-chapter-5"><a class="anchor" href="#cl_khr_d3d10_sharing-additions-to-chapter-5"></a>13.6. Additions to Chapter 5 of the OpenCL 2.2 Specification</h3>
<div class="paragraph">
<p>Add to the list of errors for <strong>clGetMemObjectInfo</strong>:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>CL_INVALID_<wbr>D3D10_<wbr>RESOURCE_<wbr>KHR</code> if <em>param_name</em> is
<code>CL_MEM_<wbr>D3D10_<wbr>RESOURCE_<wbr>KHR</code> and <em>memobj</em> was not created by the function
<strong>clCreateFromD3D10BufferKHR</strong>, <strong>clCreateFromD3D10Texture2DKHR</strong>, or
<strong>clCreateFromD3D10Texture3DKHR</strong>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Extend <em>table 5.12</em> to include the following entry.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 40%;">
<col style="width: 20%;">
<col style="width: 40%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><strong>cl_mem_info</strong></th>
<th class="tableblock halign-left valign-top"><strong>Return type</strong></th>
<th class="tableblock halign-left valign-top"><strong>Info. returned in <em>param_value</em></strong></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CL_MEM_<wbr>D3D10_<wbr>RESOURCE_<wbr>KHR</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ID3D10Resource *</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">If <em>memobj</em> was created using <strong>clCreateFromD3D10BufferKHR</strong>,
  <strong>clCreateFromD3D10Texture2DKHR</strong>, or <strong>clCreateFromD3D10Texture3DKHR</strong>,
  returns the <em>resource</em> argument specified when <em>memobj</em> was created.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Add to the list of errors for <strong>clGetImageInfo</strong>:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>CL_INVALID_<wbr>D3D10_<wbr>RESOURCE_<wbr>KHR</code> if <em>param_name</em> is
<code>CL_IMAGE_<wbr>D3D10_<wbr>SUBRESOURCE_<wbr>KHR</code> and <em>image</em> was not created by the function
<strong>clCreateFromD3D10Texture2DKHR</strong>, or <strong>clCreateFromD3D10Texture3DKHR</strong>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Extend <em>table 5.9</em> to include the following entry.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 40%;">
<col style="width: 20%;">
<col style="width: 40%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><strong>cl_image_info</strong></th>
<th class="tableblock halign-left valign-top"><strong>Return type</strong></th>
<th class="tableblock halign-left valign-top"><strong>Info. returned in <em>param_value</em></strong></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CL_IMAGE_<wbr>D3D10_<wbr>SUBRESOURCE_<wbr>KHR</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">UINT</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">If <em>image</em> was created using <strong>clCreateFromD3D10Texture2DKHR</strong>, or
  <strong>clCreateFromD3D10Texture3DKHR</strong>, returns the <em>subresource</em> argument
  specified when <em>image</em> was created.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Add to <em>table 5.22</em> in the <strong>Info returned in &lt;param_value&gt;</strong> column for
<em>cl_event_info</em> = <code>CL_EVENT_<wbr>COMMAND_<wbr>TYPE</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="opencl"><span class="n">CL_COMMAND_ACQUIRE_D3D10_OBJECTS_KHR</span>
<span class="n">CL_COMMAND_RELEASE_D3D10_OBJECTS_KHR</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="cl_khr_d3d10_sharing-sharing-memory-objects-with-direct3d-10-resources"><a class="anchor" href="#cl_khr_d3d10_sharing-sharing-memory-objects-with-direct3d-10-resources"></a>13.7. Sharing Memory Objects with Direct3D 10 Resources</h3>
<div class="paragraph">
<p>This section discusses OpenCL functions that allow applications to use
Direct3D 10 resources as OpenCL memory objects.
This allows efficient sharing of data between OpenCL and Direct3D 10.
The OpenCL API may be used to execute kernels that read and/or write memory
objects that are also Direct3D 10 resources.
An OpenCL image object may be created from a Direct3D 10 texture resource.
An OpenCL buffer object may be created from a Direct3D 10 buffer resource.
OpenCL memory objects may be created from Direct3D 10 objects if and only if
the OpenCL context has been created from a Direct3D 10 device.</p>
</div>
<div class="sect3">
<h4 id="cl_khr_d3d10_sharing-querying-opencl-devices-corresponding-to-direct3d-10-devices"><a class="anchor" href="#cl_khr_d3d10_sharing-querying-opencl-devices-corresponding-to-direct3d-10-devices"></a>13.7.1. Querying OpenCL Devices Corresponding to Direct3D 10 Devices</h4>
<div class="paragraph">
<p>The OpenCL devices corresponding to a Direct3D 10 device may be queried.
The OpenCL devices corresponding to a DXGI adapter may also be queried.
The OpenCL devices corresponding to a Direct3D 10 device will be a subset of
the OpenCL devices corresponding to the DXGI adapter against which the
Direct3D 10 device was created.</p>
</div>
<div class="paragraph">
<p>The OpenCL devices corresponding to a Direct3D 10 device or a DXGI device
may be queried using the function</p>
</div>
<div id="clGetDeviceIDsFromD3D10KHR" class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="opencl"><span class="kt">cl_int</span> <span class="nf">clGetDeviceIDsFromD3D10KHR</span><span class="p">(</span>
    <span class="kt">cl_platform_id</span> <span class="n">platform</span><span class="p">,</span>
    <span class="kt">cl_d3d10_device_source_khr</span> <span class="n">d3d_device_source</span><span class="p">,</span>
    <span class="kt">void</span><span class="o">*</span> <span class="n">d3d_object</span><span class="p">,</span>
    <span class="kt">cl_d3d10_device_set_khr</span> <span class="n">d3d_device_set</span><span class="p">,</span>
    <span class="kt">cl_uint</span> <span class="n">num_entries</span><span class="p">,</span>
    <span class="kt">cl_device_id</span><span class="o">*</span> <span class="n">devices</span><span class="p">,</span>
    <span class="kt">cl_uint</span><span class="o">*</span> <span class="n">num_devices</span><span class="p">);</span></code></pre>
</div>
</div>
<div class="paragraph">
<p><em>platform</em> refers to the platform ID returned by <strong>clGetPlatformIDs</strong>.</p>
</div>
<div class="paragraph">
<p><em>d3d_device_source</em> specifies the type of <em>d3d_object</em>, and must be one of
the values shown in the table below.</p>
</div>
<div class="paragraph">
<p><em>d3d_object</em> specifies the object whose corresponding OpenCL devices are
being queried.
The type of <em>d3d_object</em> must be as specified in the table below.</p>
</div>
<div class="paragraph">
<p><em>d3d_device_set</em> specifies the set of devices to return, and must be one of
the values shown in the table below.</p>
</div>
<div class="paragraph">
<p><em>num_entries</em> is the number of <code>cl_device_<wbr>id</code> entries that can be added to
<em>devices</em>.
If <em>devices</em> is not <code>NULL</code> then <em>num_entries</em> must be greater than zero.</p>
</div>
<div class="paragraph">
<p><em>devices</em> returns a list of OpenCL devices found.
The <code>cl_device_<wbr>id</code> values returned in <em>devices</em> can be used to identify a
specific OpenCL device.
If <em>devices</em> is <code>NULL</code>, this argument is ignored.
The number of OpenCL devices returned is the minimum of the value specified
by <em>num_entries</em> and the number of OpenCL devices corresponding to
<em>d3d_object</em>.</p>
</div>
<div class="paragraph">
<p><em>num_devices</em> returns the number of OpenCL devices available that correspond
to <em>d3d_object</em>.
If <em>num_devices</em> is <code>NULL</code>, this argument is ignored.</p>
</div>
<div class="paragraph">
<p><strong>clGetDeviceIDsFromD3D10KHR</strong> returns <code>CL_SUCCESS</code> if the function is executed
successfully.
Otherwise it may return</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>CL_INVALID_<wbr>PLATFORM</code> if <em>platform</em> is not a valid platform.</p>
</li>
<li>
<p><code>CL_INVALID_<wbr>VALUE</code> if <em>d3d_device_source</em> is not a valid value,
<em>d3d_device_set</em> is not a valid value, <em>num_entries</em> is equal to zero
and <em>devices</em> is not <code>NULL</code>, or if both <em>num_devices</em> and <em>devices</em> are
<code>NULL</code>.</p>
</li>
<li>
<p><code>CL_DEVICE_<wbr>NOT_<wbr>FOUND</code> if no OpenCL devices that correspond to <em>d3d_object</em>
were found.</p>
</li>
</ul>
</div>
<table id="cl_khr_d3d10_sharing-clGetDeviceIDsFromD3D10KHR-object-type" class="tableblock frame-all grid-all stretch">
<caption class="title">Table 30. Direct3D 10 object types that may be used by <strong>clGetDeviceIDsFromD3D10KHR</strong></caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><code>cl_d3d10_<wbr>device_<wbr>source_<wbr>khr</code></th>
<th class="tableblock halign-left valign-top">Type of <em>d3d_object</em></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CL_D3D10_<wbr>DEVICE_<wbr>KHR</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ID3D10Device *</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CL_D3D10_<wbr>DXGI_<wbr>ADAPTER_<wbr>KHR</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">IDXGIAdapter *</p></td>
</tr>
</tbody>
</table>
<table id="cl_khr_d3d10_sharing-clGetDeviceIDsFromD3D10KHR-devices" class="tableblock frame-all grid-all stretch">
<caption class="title">Table 31. Sets of devices queriable using <strong>clGetDeviceIDsFromD3D10KHR</strong></caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><code>cl_d3d10_<wbr>device_<wbr>set_<wbr>khr</code></th>
<th class="tableblock halign-left valign-top">Devices returned in <em>devices</em></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CL_PREFERRED_<wbr>DEVICES_<wbr>FOR_<wbr>D3D10_<wbr>KHR</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The preferred OpenCL devices associated with the specified Direct3D
  object.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CL_ALL_<wbr>DEVICES_<wbr>FOR_<wbr>D3D10_<wbr>KHR</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">All OpenCL devices which may interoperate with the specified Direct3D
  object.
  Performance of sharing data on these devices may be considerably less than
  on the preferred devices.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="cl_khr_d3d10_sharing-lifetime-of-shared-objects"><a class="anchor" href="#cl_khr_d3d10_sharing-lifetime-of-shared-objects"></a>13.7.2. Lifetime of Shared Objects</h4>
<div class="paragraph">
<p>An OpenCL memory object created from a Direct3D 10 resource remains valid as
long as the corresponding Direct3D 10 resource has not been deleted.
If the Direct3D 10 resource is deleted through the Direct3D 10 API,
subsequent use of the OpenCL memory object will result in undefined
behavior, including but not limited to possible OpenCL errors, data
corruption, and program termination.</p>
</div>
<div class="paragraph">
<p>The successful creation of a <code>cl_context</code> against a Direct3D 10 device
specified via the context create parameter <code>CL_CONTEXT_<wbr>D3D10_<wbr>DEVICE_<wbr>KHR</code> will
increment the internal Direct3D reference count on the specified Direct3D 10
device.
The internal Direct3D reference count on that Direct3D 10 device will be
decremented when the OpenCL reference count on the returned OpenCL context
drops to zero.</p>
</div>
<div class="paragraph">
<p>The OpenCL context and corresponding command-queues are dependent on the
existence of the Direct3D 10 device from which the OpenCL context was
created.
If the Direct3D 10 device is deleted through the Direct3D 10 API, subsequent
use of the OpenCL context will result in undefined behavior, including but
not limited to possible OpenCL errors, data corruption, and program
termination.</p>
</div>
</div>
<div class="sect3">
<h4 id="cl_khr_d3d10_sharing-sharing-direct3d-10-buffer-resources-as-opencl-buffer-objects"><a class="anchor" href="#cl_khr_d3d10_sharing-sharing-direct3d-10-buffer-resources-as-opencl-buffer-objects"></a>13.7.3. Sharing Direct3D 10 Buffer Resources as OpenCL Buffer Objects</h4>
<div class="paragraph">
<p>The function</p>
</div>
<div id="clCreateFromD3D10BufferKHR" class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="opencl"><span class="kt">cl_mem</span> <span class="nf">clCreateFromD3D10BufferKHR</span><span class="p">(</span>
    <span class="kt">cl_context</span> <span class="n">context</span><span class="p">,</span>
    <span class="kt">cl_mem_flags</span> <span class="n">flags</span><span class="p">,</span>
    <span class="n">ID3D10Buffer</span><span class="o">*</span> <span class="n">resource</span><span class="p">,</span>
    <span class="kt">cl_int</span><span class="o">*</span> <span class="n">errcode_ret</span><span class="p">);</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>creates an OpenCL buffer object from a Direct3D 10 buffer.</p>
</div>
<div class="paragraph">
<p><em>context</em> is a valid OpenCL context created from a Direct3D 10 device.</p>
</div>
<div class="paragraph">
<p><em>flags</em> is a bit-field that is used to specify usage information.
Refer to <em>table 5.3</em> for a description of <em>flags</em>.
Only <code>CL_MEM_<wbr>READ_<wbr>ONLY</code>, <code>CL_MEM_<wbr>WRITE_<wbr>ONLY</code> and <code>CL_MEM_<wbr>READ_<wbr>WRITE</code> values
specified in <em>table 5.3</em> can be used.</p>
</div>
<div class="paragraph">
<p><em>resource</em> is a pointer to the Direct3D 10 buffer to share.</p>
</div>
<div class="paragraph">
<p><em>errcode_ret</em> will return an appropriate error code.
If <em>errcode_ret</em> is <code>NULL</code>, no error code is returned.</p>
</div>
<div class="paragraph">
<p><strong>clCreateFromD3D10BufferKHR</strong> returns a valid non-zero OpenCL buffer object
and <em>errcode_ret</em> is set to <code>CL_SUCCESS</code> if the buffer object is created
successfully.
Otherwise, it returns a <code>NULL</code> value with one of the following error values
returned in <em>errcode_ret</em>:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>CL_INVALID_<wbr>CONTEXT</code> if <em>context</em> is not a valid context.</p>
</li>
<li>
<p><code>CL_INVALID_<wbr>VALUE</code> if values specified in <em>flags</em> are not valid.</p>
</li>
<li>
<p><code>CL_INVALID_<wbr>D3D10_<wbr>RESOURCE_<wbr>KHR</code> if <em>resource</em> is not a Direct3D 10 buffer
resource, if <em>resource</em> was created with the D3D10_USAGE flag
D3D10_USAGE_IMMUTABLE, if a <code>cl_mem</code> from <em>resource</em> has already been
created using <strong>clCreateFromD3D10BufferKHR</strong>, or if <em>context</em> was not
created against the same Direct3D 10 device from which <em>resource</em> was
created.</p>
</li>
<li>
<p><code>CL_OUT_<wbr>OF_<wbr>HOST_<wbr>MEMORY</code> if there is a failure to allocate resources
required by the OpenCL implementation on the host.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The size of the returned OpenCL buffer object is the same as the size of
<em>resource</em>.
This call will increment the internal Direct3D reference count on
<em>resource</em>.
The internal Direct3D reference count on <em>resource</em> will be decremented when
the OpenCL reference count on the returned OpenCL memory object drops to
zero.</p>
</div>
</div>
<div class="sect3">
<h4 id="cl_khr_d3d10_sharing-sharing-direct3d-10-texture-and-resources-as-opencl-image-objects"><a class="anchor" href="#cl_khr_d3d10_sharing-sharing-direct3d-10-texture-and-resources-as-opencl-image-objects"></a>13.7.4. Sharing Direct3D 10 Texture and Resources as OpenCL Image Objects</h4>
<div class="paragraph">
<p>The function</p>
</div>
<div id="clCreateFromD3D10Texture2DKHR" class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="opencl"><span class="kt">cl_mem</span> <span class="nf">clCreateFromD3D10Texture2DKHR</span><span class="p">(</span>
    <span class="kt">cl_context</span> <span class="n">context</span><span class="p">,</span>
    <span class="kt">cl_mem_flags</span> <span class="n">flags</span><span class="p">,</span>
    <span class="n">ID3D10Texture2D</span><span class="o">*</span> <span class="n">resource</span><span class="p">,</span>
    <span class="n">UINT</span> <span class="n">subresource</span><span class="p">,</span>
    <span class="kt">cl_int</span><span class="o">*</span> <span class="n">errcode_ret</span><span class="p">);</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>creates an OpenCL 2D image object from a subresource of a Direct3D 10 2D
texture.</p>
</div>
<div class="paragraph">
<p><em>context</em> is a valid OpenCL context created from a Direct3D 10 device.</p>
</div>
<div class="paragraph">
<p><em>flags</em> is a bit-field that is used to specify usage information.
Refer to <em>table 5.3</em> for a description of <em>flags</em>.
Only <code>CL_MEM_<wbr>READ_<wbr>ONLY</code>, <code>CL_MEM_<wbr>WRITE_<wbr>ONLY</code> and <code>CL_MEM_<wbr>READ_<wbr>WRITE</code> values
specified in <em>table 5.3</em> can be used.</p>
</div>
<div class="paragraph">
<p><em>resource</em> is a pointer to the Direct3D 10 2D texture to share.</p>
</div>
<div class="paragraph">
<p><em>subresource</em> is the subresource of <em>resource</em> to share.</p>
</div>
<div class="paragraph">
<p><em>errcode_ret</em> will return an appropriate error code.
If <em>errcode_ret</em> is <code>NULL</code>, no error code is returned.</p>
</div>
<div class="paragraph">
<p><strong>clCreateFromD3D10Texture2DKHR</strong> returns a valid non-zero OpenCL image object
and <em>errcode_ret</em> is set to <code>CL_SUCCESS</code> if the image object is created
successfully.
Otherwise, it returns a <code>NULL</code> value with one of the following error values
returned in <em>errcode_ret</em>:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>CL_INVALID_<wbr>CONTEXT</code> if <em>context</em> is not a valid context.</p>
</li>
<li>
<p><code>CL_INVALID_<wbr>VALUE</code> if values specified in <em>flags</em> are not valid or if
<em>subresource</em> is not a valid subresource index for <em>resource</em>.</p>
</li>
<li>
<p><code>CL_INVALID_<wbr>D3D10_<wbr>RESOURCE_<wbr>KHR</code> if <em>resource</em> is not a Direct3D 10 texture
resource, if <em>resource</em> was created with the D3D10_USAGE flag
D3D10_USAGE_IMMUTABLE, if <em>resource</em> is a multisampled texture, if a
<code>cl_mem</code> from subresource <em>subresource</em> of <em>resource</em> has already been
created using <strong>clCreateFromD3D10Texture2DKHR</strong>, or if <em>context</em> was not
created against the same Direct3D 10 device from which <em>resource</em> was
created.</p>
</li>
<li>
<p><code>CL_INVALID_<wbr>IMAGE_<wbr>FORMAT_<wbr>DESCRIPTOR</code> if the Direct3D 10 texture format of
<em>resource</em> is not listed in the table
<a href="#cl_khr_d3d10_sharing-mapping-of-image-formats"><em>Direct3D 10 formats and
corresponding OpenCL image formats</em></a> or if the Direct3D 10 texture
format of <em>resource</em> does not map to a supported OpenCL image format.</p>
</li>
<li>
<p><code>CL_OUT_<wbr>OF_<wbr>HOST_<wbr>MEMORY</code> if there is a failure to allocate resources
required by the OpenCL implementation on the host.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The width and height of the returned OpenCL 2D image object are determined
by the width and height of subresource <em>subresource</em> of <em>resource</em>.
The channel type and order of the returned OpenCL 2D image object is
determined by the format of <em>resource</em> by the table
<a href="#cl_khr_d3d10_sharing-mapping-of-image-formats"><em>Direct3D 10 formats and
corresponding OpenCL image formats</em></a>.</p>
</div>
<div class="paragraph">
<p>This call will increment the internal Direct3D reference count on
<em>resource</em>.
The internal Direct3D reference count on <em>resource</em> will be decremented when
the OpenCL reference count on the returned OpenCL memory object drops to
zero.</p>
</div>
<div class="paragraph">
<p>The function</p>
</div>
<div id="clCreateFromD3D10Texture3DKHR" class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="opencl"><span class="kt">cl_mem</span> <span class="nf">clCreateFromD3D10Texture3DKHR</span><span class="p">(</span>
    <span class="kt">cl_context</span> <span class="n">context</span><span class="p">,</span>
    <span class="kt">cl_mem_flags</span> <span class="n">flags</span><span class="p">,</span>
    <span class="n">ID3D10Texture3D</span><span class="o">*</span> <span class="n">resource</span><span class="p">,</span>
    <span class="n">UINT</span> <span class="n">subresource</span><span class="p">,</span>
    <span class="kt">cl_int</span><span class="o">*</span> <span class="n">errcode_ret</span><span class="p">);</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>creates an OpenCL 3D image object from a subresource of a Direct3D 10 3D
texture.</p>
</div>
<div class="paragraph">
<p><em>context</em> is a valid OpenCL context created from a Direct3D 10 device.</p>
</div>
<div class="paragraph">
<p><em>flags</em> is a bit-field that is used to specify usage information.
Refer to table 5.3 for a description of <em>flags</em>.
Only <code>CL_MEM_<wbr>READ_<wbr>ONLY</code>, <code>CL_MEM_<wbr>WRITE_<wbr>ONLY</code> and <code>CL_MEM_<wbr>READ_<wbr>WRITE</code> values
specified in <em>table 5.3</em> can be used.</p>
</div>
<div class="paragraph">
<p><em>resource</em> is a pointer to the Direct3D 10 3D texture to share.</p>
</div>
<div class="paragraph">
<p><em>subresource</em> is the subresource of <em>resource</em> to share.</p>
</div>
<div class="paragraph">
<p><em>errcode_ret</em> will return an appropriate error code.
If <em>errcode_ret</em> is <code>NULL</code>, no error code is returned.</p>
</div>
<div class="paragraph">
<p><strong>clCreateFromD3D10Texture3DKHR</strong> returns a valid non-zero OpenCL image object
and <em>errcode_ret</em> is set to <code>CL_SUCCESS</code> if the image object is created
successfully.
Otherwise, it returns a <code>NULL</code> value with one of the following error values
returned in <em>errcode_ret</em>:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>CL_INVALID_<wbr>CONTEXT</code> if <em>context</em> is not a valid context.</p>
</li>
<li>
<p><code>CL_INVALID_<wbr>VALUE</code> if values specified in <em>flags</em> are not valid or if
<em>subresource</em> is not a valid subresource index for <em>resource</em>.</p>
</li>
<li>
<p><code>CL_INVALID_<wbr>D3D10_<wbr>RESOURCE_<wbr>KHR</code> if <em>resource</em> is not a Direct3D 10 texture
resource, if <em>resource</em> was created with the D3D10_USAGE flag
D3D10_USAGE_IMMUTABLE, if <em>resource</em> is a multisampled texture, if a
<code>cl_mem</code> from subresource <em>subresource</em> of <em>resource</em> has already been
created using <strong>clCreateFromD3D10Texture3DKHR</strong>, or if <em>context</em> was not
created against the same Direct3D 10 device from which <em>resource</em> was
created.</p>
</li>
<li>
<p><code>CL_INVALID_<wbr>IMAGE_<wbr>FORMAT_<wbr>DESCRIPTOR</code> if the Direct3D 10 texture format of
<em>resource</em> is not listed in the table
<a href="#cl_khr_d3d10_sharing-mapping-of-image-formats"><em>Direct3D 10 formats and
corresponding OpenCL image formats</em></a> or if the Direct3D 10 texture
format of <em>resource</em> does not map to a supported OpenCL image format.</p>
</li>
<li>
<p><code>CL_OUT_<wbr>OF_<wbr>HOST_<wbr>MEMORY</code> if there is a failure to allocate resources
required by the OpenCL implementation on the host.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The width, height and depth of the returned OpenCL 3D image object are
determined by the width, height and depth of subresource <em>subresource</em> of
<em>resource</em>.
The channel type and order of the returned OpenCL 3D image object is
determined by the format of <em>resource</em> by the table
<a href="#cl_khr_d3d10_sharing-mapping-of-image-formats"><em>Direct3D 10 formats and
corresponding OpenCL image formats</em></a>.</p>
</div>
<div class="paragraph">
<p>This call will increment the internal Direct3D reference count on
<em>resource</em>.
The internal Direct3D reference count on <em>resource</em> will be decremented when
the OpenCL reference count on the returned OpenCL memory object drops to
zero.</p>
</div>
<table id="cl_khr_d3d10_sharing-mapping-of-image-formats" class="tableblock frame-all grid-all stretch">
<caption class="title">Table 32. <em>Direct3D 10 formats and corresponding OpenCL image formats</em></caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><strong>DXGI format</strong></th>
<th class="tableblock halign-left valign-top"><strong>CL image format</strong>

<strong>(channel order, channel data type)</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">DXGI_FORMAT_R32G32B32A32_FLOAT</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CL_RGBA</code>, <code>CL_FLOAT</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">DXGI_FORMAT_R32G32B32A32_UINT</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CL_RGBA</code>, <code>CL_UNSIGNED_INT32</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">DXGI_FORMAT_R32G32B32A32_SINT</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CL_RGBA</code>, <code>CL_SIGNED_INT32</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">DXGI_FORMAT_R16G16B16A16_FLOAT</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CL_RGBA</code>, <code>CL_HALF_FLOAT</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">DXGI_FORMAT_R16G16B16A16_UNORM</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CL_RGBA</code>, <code>CL_UNORM_INT16</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">DXGI_FORMAT_R16G16B16A16_UINT</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CL_RGBA</code>, <code>CL_UNSIGNED_INT16</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">DXGI_FORMAT_R16G16B16A16_SNORM</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CL_RGBA</code>, <code>CL_SNORM_INT16</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">DXGI_FORMAT_R16G16B16A16_SINT</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CL_RGBA</code>, <code>CL_SIGNED_INT16</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">DXGI_FORMAT_B8G8R8A8_UNORM</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CL_BGRA</code>, <code>CL_UNORM_INT8</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">DXGI_FORMAT_R8G8B8A8_UNORM</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CL_RGBA</code>, <code>CL_UNORM_INT8</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">DXGI_FORMAT_R8G8B8A8_UINT</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CL_RGBA</code>, <code>CL_UNSIGNED_INT8</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">DXGI_FORMAT_R8G8B8A8_SNORM</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CL_RGBA</code>, <code>CL_SNORM_INT8</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">DXGI_FORMAT_R8G8B8A8_SINT</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CL_RGBA</code>, <code>CL_SIGNED_INT8</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">DXGI_FORMAT_R32G32_FLOAT</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CL_RG</code>, <code>CL_FLOAT</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">DXGI_FORMAT_R32G32_UINT</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CL_RG</code>, <code>CL_UNSIGNED_INT32</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">DXGI_FORMAT_R32G32_SINT</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CL_RG</code>, <code>CL_SIGNED_INT32</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">DXGI_FORMAT_R16G16_FLOAT</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CL_RG</code>, <code>CL_HALF_FLOAT</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">DXGI_FORMAT_R16G16_UNORM</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CL_RG</code>, <code>CL_UNORM_INT16</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">DXGI_FORMAT_R16G16_UINT</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CL_RG</code>, <code>CL_UNSIGNED_INT16</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">DXGI_FORMAT_R16G16_SNORM</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CL_RG</code>, <code>CL_SNORM_INT16</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">DXGI_FORMAT_R16G16_SINT</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CL_RG</code>, <code>CL_SIGNED_INT16</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">DXGI_FORMAT_R8G8_UNORM</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CL_RG</code>, <code>CL_UNORM_INT8</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">DXGI_FORMAT_R8G8_UINT</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CL_RG</code>, <code>CL_UNSIGNED_INT8</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">DXGI_FORMAT_R8G8_SNORM</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CL_RG</code>, <code>CL_SNORM_INT8</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">DXGI_FORMAT_R8G8_SINT</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CL_RG</code>, <code>CL_SIGNED_INT8</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">DXGI_FORMAT_R32_FLOAT</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CL_R</code>, <code>CL_FLOAT</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">DXGI_FORMAT_R32_UINT</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CL_R</code>, <code>CL_UNSIGNED_INT32</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">DXGI_FORMAT_R32_SINT</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CL_R</code>, <code>CL_SIGNED_INT32</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">DXGI_FORMAT_R16_FLOAT</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CL_R</code>, <code>CL_HALF_FLOAT</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">DXGI_FORMAT_R16_UNORM</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CL_R</code>, <code>CL_UNORM_INT16</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">DXGI_FORMAT_R16_UINT</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CL_R</code>, <code>CL_UNSIGNED_INT16</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">DXGI_FORMAT_R16_SNORM</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CL_R</code>, <code>CL_SNORM_INT16</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">DXGI_FORMAT_R16_SINT</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CL_R</code>, <code>CL_SIGNED_INT16</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">DXGI_FORMAT_R8_UNORM</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CL_R</code>, <code>CL_UNORM_INT8</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">DXGI_FORMAT_R8_UINT</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CL_R</code>, <code>CL_UNSIGNED_INT8</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">DXGI_FORMAT_R8_SNORM</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CL_R</code>, <code>CL_SNORM_INT8</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">DXGI_FORMAT_R8_SINT</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CL_R</code>, <code>CL_SIGNED_INT8</code></p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="cl_khr_d3d10_sharing-querying-direct3d-properties-of-memory-objects-created-from-direct3d-10-resources"><a class="anchor" href="#cl_khr_d3d10_sharing-querying-direct3d-properties-of-memory-objects-created-from-direct3d-10-resources"></a>13.7.5. Querying Direct3D properties of memory objects created from Direct3D 10 resources</h4>
<div class="paragraph">
<p>Properties of Direct3D 10 objects may be queried using <strong>clGetMemObjectInfo</strong>
and <strong>clGetImageInfo</strong> with <em>param_name</em> <code>CL_MEM_<wbr>D3D10_<wbr>RESOURCE_<wbr>KHR</code> and
<code>CL_IMAGE_<wbr>D3D10_<wbr>SUBRESOURCE_<wbr>KHR</code> respectively as described in <em>sections 5.4.3</em>
and <em>5.3.6</em>.</p>
</div>
</div>
<div class="sect3">
<h4 id="cl_khr_d3d10_sharing-sharing-memory-objects-created-from-direct3d-10-resources-between-direct3d-10-and-opencl-contexts"><a class="anchor" href="#cl_khr_d3d10_sharing-sharing-memory-objects-created-from-direct3d-10-resources-between-direct3d-10-and-opencl-contexts"></a>13.7.6. Sharing memory objects created from Direct3D 10 resources between Direct3D 10 and OpenCL contexts</h4>
<div class="paragraph">
<p>The function</p>
</div>
<div id="clEnqueueAcquireD3D10ObjectsKHR" class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="opencl"><span class="kt">cl_int</span> <span class="nf">clEnqueueAcquireD3D10ObjectsKHR</span><span class="p">(</span>
    <span class="kt">cl_command_queue</span> <span class="n">command_queue</span><span class="p">,</span>
    <span class="kt">cl_uint</span> <span class="n">num_objects</span><span class="p">,</span>
    <span class="k">const</span> <span class="kt">cl_mem</span><span class="o">*</span> <span class="n">mem_objects</span><span class="p">,</span>
    <span class="kt">cl_uint</span> <span class="n">num_events_in_wait_list</span><span class="p">,</span>
    <span class="k">const</span> <span class="kt">cl_event</span><span class="o">*</span> <span class="n">event_wait_list</span><span class="p">,</span>
    <span class="kt">cl_event</span><span class="o">*</span> <span class="n">event</span><span class="p">);</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>is used to acquire OpenCL memory objects that have been created from
Direct3D 10 resources.
The Direct3D 10 objects are acquired by the OpenCL context associated with
<em>command_queue</em> and can therefore be used by all command-queues associated
with the OpenCL context.</p>
</div>
<div class="paragraph">
<p>OpenCL memory objects created from Direct3D 10 resources must be acquired
before they can be used by any OpenCL commands queued to a command-queue.
If an OpenCL memory object created from a Direct3D 10 resource is used while
it is not currently acquired by OpenCL, the behavior is undefined.
Implementations may fail the execution of commands attempting to use that
OpenCL memory object and set their associated event&#8217;s execution status to
<code>CL_D3D10_<wbr>RESOURCE_<wbr>NOT_<wbr>ACQUIRED_<wbr>KHR</code>.</p>
</div>
<div class="paragraph">
<p>If <code>CL_CONTEXT_<wbr>INTEROP_<wbr>USER_<wbr>SYNC</code> is not specified as <code>CL_TRUE</code> during context
creation, <strong>clEnqueueAcquireD3D10ObjectsKHR</strong> provides the synchronization
guarantee that any Direct3D 10 calls involving the interop device(s) used in
the OpenCL context made before <strong>clEnqueueAcquireD3D10ObjectsKHR</strong> is called
will complete executing before <em>event</em> reports completion and before the
execution of any subsequent OpenCL work issued in <em>command_queue</em> begins.
If the context was created with properties specifying
<code>CL_CONTEXT_<wbr>INTEROP_<wbr>USER_<wbr>SYNC</code> as <code>CL_TRUE</code>, the user is responsible for
guaranteeing that any Direct3D 10 calls involving the interop device(s) used
in the OpenCL context made before <strong>clEnqueueAcquireD3D10ObjectsKHR</strong> is
called have completed before calling <strong>clEnqueueAcquireD3D10ObjectsKHR</strong>.</p>
</div>
<div class="paragraph">
<p><em>command_queue</em> is a valid command-queue.</p>
</div>
<div class="paragraph">
<p><em>num_objects</em> is the number of memory objects to be acquired in
<em>mem_objects</em>.</p>
</div>
<div class="paragraph">
<p><em>mem_objects</em> is a pointer to a list of OpenCL memory objects that were
created from Direct3D 10 resources.</p>
</div>
<div class="paragraph">
<p><em>event_wait_list</em> and <em>num_events_in_wait_list</em> specify events that need to
complete before this particular command can be executed.
If <em>event_wait_list</em> is <code>NULL</code>, then this particular command does not wait
on any event to complete.
If <em>event_wait_list</em> is <code>NULL</code>, <em>num_events_in_wait_list</em> must be 0.
If <em>event_wait_list</em> is not <code>NULL</code>, the list of events pointed to by
<em>event_wait_list</em> must be valid and <em>num_events_in_wait_list</em> must be
greater than 0.
The events specified in <em>event_wait_list</em> act as synchronization points.</p>
</div>
<div class="paragraph">
<p><em>event</em> returns an event object that identifies this command and
can be used to query or wait for this command to complete.
If <em>event</em> is <code>NULL</code> or the enqueue is unsuccessful, no event will be
created and therefore it will not be possible to query the status of this
command or to wait for this command to complete.
If <em>event_wait_list</em> and <em>event</em> are not <code>NULL</code>, <em>event</em> must not refer
to an element of the <em>event_wait_list</em> array.</p>
</div>
<div class="paragraph">
<p><strong>clEnqueueAcquireD3D10ObjectsKHR</strong> returns <code>CL_SUCCESS</code> if the function is
executed successfully.
If <em>num_objects</em> is 0 and <em>mem_objects</em> is <code>NULL</code> then the function does
nothing and returns <code>CL_SUCCESS</code>.
Otherwise it returns one of the following errors:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>CL_INVALID_<wbr>VALUE</code> if <em>num_objects</em> is zero and <em>mem_objects</em> is not a
<code>NULL</code> value or if <em>num_objects</em> &gt; 0 and <em>mem_objects</em> is <code>NULL</code>.</p>
</li>
<li>
<p><code>CL_INVALID_<wbr>MEM_<wbr>OBJECT</code> if memory objects in <em>mem_objects</em> are not valid
OpenCL memory objects or if memory objects in <em>mem_objects</em> have not
been created from Direct3D 10 resources.</p>
</li>
<li>
<p><code>CL_INVALID_<wbr>COMMAND_<wbr>QUEUE</code> if <em>command_queue</em> is not a valid
command-queue.</p>
</li>
<li>
<p><code>CL_INVALID_<wbr>CONTEXT</code> if context associated with <em>command_queue</em> was not
created from an Direct3D 10 context.</p>
</li>
<li>
<p><code>CL_D3D10_<wbr>RESOURCE_<wbr>ALREADY_<wbr>ACQUIRED_<wbr>KHR</code> if memory objects in
<em>mem_objects</em> have previously been acquired using
<strong>clEnqueueAcquireD3D10ObjectsKHR</strong> but have not been released using
<strong>clEnqueueReleaseD3D10ObjectsKHR</strong>.</p>
</li>
<li>
<p><code>CL_INVALID_<wbr>EVENT_<wbr>WAIT_<wbr>LIST</code> if <em>event_wait_list</em> is <code>NULL</code> and
<em>num_events_in_wait_list</em> &gt; 0, or <em>event_wait_list</em> is not <code>NULL</code> and
<em>num_events_in_wait_list</em> is 0, or if event objects in <em>event_wait_list</em>
are not valid events.</p>
</li>
<li>
<p><code>CL_OUT_<wbr>OF_<wbr>HOST_<wbr>MEMORY</code> if there is a failure to allocate resources
required by the OpenCL implementation on the host.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The function</p>
</div>
<div id="clEnqueueReleaseD3D10ObjectsKHR" class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="opencl"><span class="kt">cl_int</span> <span class="nf">clEnqueueReleaseD3D10ObjectsKHR</span><span class="p">(</span>
    <span class="kt">cl_command_queue</span> <span class="n">command_queue</span><span class="p">,</span>
    <span class="kt">cl_uint</span> <span class="n">num_objects</span><span class="p">,</span>
    <span class="k">const</span> <span class="kt">cl_mem</span><span class="o">*</span> <span class="n">mem_objects</span><span class="p">,</span>
    <span class="kt">cl_uint</span> <span class="n">num_events_in_wait_list</span><span class="p">,</span>
    <span class="k">const</span> <span class="kt">cl_event</span><span class="o">*</span> <span class="n">event_wait_list</span><span class="p">,</span>
    <span class="kt">cl_event</span><span class="o">*</span> <span class="n">event</span><span class="p">);</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>is used to release OpenCL memory objects that have been created from
Direct3D 10 resources.
The Direct3D 10 objects are released by the OpenCL context associated with
<em>command_queue</em>.</p>
</div>
<div class="paragraph">
<p>OpenCL memory objects created from Direct3D 10 resources which have been
acquired by OpenCL must be released by OpenCL before they may be accessed by
Direct3D 10.
Accessing a Direct3D 10 resource while its corresponding OpenCL memory
object is acquired is in error and will result in undefined behavior,
including but not limited to possible OpenCL errors, data corruption, and
program termination.</p>
</div>
<div class="paragraph">
<p>If <code>CL_CONTEXT_<wbr>INTEROP_<wbr>USER_<wbr>SYNC</code> is not specified as <code>CL_TRUE</code> during context
creation, <strong>clEnqueueReleaseD3D10ObjectsKHR</strong> provides the synchronization
guarantee that any calls to Direct3D 10 calls involving the interop
device(s) used in the OpenCL context made after the call to
<strong>clEnqueueReleaseD3D10ObjectsKHR</strong> will not start executing until after all
events in <em>event_wait_list</em> are complete and all work already submitted to
<em>command_queue</em> completes execution.
If the context was created with properties specifying
<code>CL_CONTEXT_<wbr>INTEROP_<wbr>USER_<wbr>SYNC</code> as <code>CL_TRUE</code>, the user is responsible for
guaranteeing that any Direct3D 10 calls involving the interop device(s) used
in the OpenCL context made after <strong>clEnqueueReleaseD3D10ObjectsKHR</strong> will not
start executing until after event returned by
<strong>clEnqueueReleaseD3D10ObjectsKHR</strong> reports completion.</p>
</div>
<div class="paragraph">
<p><em>num_objects</em> is the number of memory objects to be released in
<em>mem_objects</em>.</p>
</div>
<div class="paragraph">
<p><em>mem_objects</em> is a pointer to a list of OpenCL memory objects that were
created from Direct3D 10 resources.</p>
</div>
<div class="paragraph">
<p><em>event_wait_list</em> and <em>num_events_in_wait_list</em> specify events that need to
complete before this particular command can be executed.
If <em>event_wait_list</em> is <code>NULL</code>, then this particular command does not wait
on any event to complete.
If <em>event_wait_list</em> is <code>NULL</code>, <em>num_events_in_wait_list</em> must be 0.
If <em>event_wait_list</em> is not <code>NULL</code>, the list of events pointed to by
<em>event_wait_list</em> must be valid and <em>num_events_in_wait_list</em> must be
greater than 0.</p>
</div>
<div class="paragraph">
<p><em>event</em> returns an event object that identifies this command and
can be used to query or wait for this command to complete.
If <em>event</em> is <code>NULL</code> or the enqueue is unsuccessful, no event will be
created and therefore it will not be possible to query the status of this
command or to wait for this command to complete.
If <em>event_wait_list</em> and <em>event</em> are not <code>NULL</code>, <em>event</em> must not refer
to an element of the <em>event_wait_list</em> array.</p>
</div>
<div class="paragraph">
<p><strong>clEnqueueReleaseD3D10ObjectsKHR</strong> returns <code>CL_SUCCESS</code> if the function is
executed successfully.
If <em>num_objects</em> is 0 and <em>mem_objects</em> is <code>NULL</code> the function does nothing
and returns <code>CL_SUCCESS</code>.
Otherwise it returns one of the following errors:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>CL_INVALID_<wbr>VALUE</code> if <em>num_objects</em> is zero and <em>mem_objects</em> is not a
<code>NULL</code> value or if <em>num_objects</em> &gt; 0 and <em>mem_objects</em> is <code>NULL</code>.</p>
</li>
<li>
<p><code>CL_INVALID_<wbr>MEM_<wbr>OBJECT</code> if memory objects in <em>mem_objects</em> are not valid
OpenCL memory objects or if memory objects in <em>mem_objects</em> have not
been created from Direct3D 10 resources.</p>
</li>
<li>
<p><code>CL_INVALID_<wbr>COMMAND_<wbr>QUEUE</code> if <em>command_queue</em> is not a valid
command-queue.</p>
</li>
<li>
<p><code>CL_INVALID_<wbr>CONTEXT</code> if context associated with <em>command_queue</em> was not
created from a Direct3D 10 device.</p>
</li>
<li>
<p><code>CL_D3D10_<wbr>RESOURCE_<wbr>NOT_<wbr>ACQUIRED_<wbr>KHR</code> if memory objects in <em>mem_objects</em>
have not previously been acquired using
<strong>clEnqueueAcquireD3D10ObjectsKHR</strong>, or have been released using
<strong>clEnqueueReleaseD3D10ObjectsKHR</strong> since the last time that they were
acquired.</p>
</li>
<li>
<p><code>CL_INVALID_<wbr>EVENT_<wbr>WAIT_<wbr>LIST</code> if <em>event_wait_list</em> is <code>NULL</code> and
<em>num_events_in_wait_list</em> &gt; 0, or <em>event_wait_list</em> is not <code>NULL</code> and
<em>num_events_in_wait_list</em>&gt; is 0, or if event objects in
<em>event_wait_list</em> are not valid events.</p>
</li>
<li>
<p><code>CL_OUT_<wbr>OF_<wbr>HOST_<wbr>MEMORY</code> if there is a failure to allocate resources
required by the OpenCL implementation on the host.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="cl_khr_d3d10_sharing-event-command-types"><a class="anchor" href="#cl_khr_d3d10_sharing-event-command-types"></a>13.7.7. Event Command Types for Sharing memory objects that map to Direct3D 10 objects</h4>
<div class="paragraph">
<p>The following table describes the event command types for the OpenCL commands
to acquire and release OpenCL memory objects that have been created from
Direct3D 10 objects:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 33. List of supported event command types</caption>
<colgroup>
<col style="width: 40%;">
<col style="width: 60%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><strong>Events Created By</strong></th>
<th class="tableblock halign-left valign-top"><strong>Event Command Type</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>clEnqueueAcquireD3D10ObjectsKHR</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CL_COMMAND_<wbr>ACQUIRE_<wbr>D3D10_<wbr>OBJECTS_<wbr>KHR</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>clEnqueueReleaseD3D10ObjectsKHR</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CL_COMMAND_<wbr>RELEASE_<wbr>D3D10_<wbr>OBJECTS_<wbr>KHR</code></p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect2">
<h3 id="cl_khr_d3d10_sharing-issues"><a class="anchor" href="#cl_khr_d3d10_sharing-issues"></a>13.8. Issues</h3>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Should this extension be KHR or EXT?</p>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>PROPOSED: KHR.
If this extension is to be approved by Khronos then it should be KHR,
otherwise EXT.
Not all platforms can support this extension, but that is also true of
OpenGL interop.</p>
</div>
<div class="paragraph">
<p>RESOLVED: KHR.</p>
</div>
</div>
</div>
</li>
<li>
<p>Requiring SharedHandle on ID3D10Resource</p>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Requiring this can largely simplify things at the DDI level and make some
implementations faster.
However, the DirectX spec only defines the shared handle for a subset of the
resources we would like to support:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="opencl"><span class="n">D3D10_RESOURCE_MISC_SHARED</span> <span class="o">-</span> <span class="n">Enables</span> <span class="n">the</span> <span class="n">sharing</span> <span class="n">of</span> <span class="n">resource</span> <span class="n">data</span> <span class="n">between</span>
<span class="n">two</span> <span class="n">or</span> <span class="n">more</span> <span class="n">Direct3D</span> <span class="n">devices</span><span class="p">.</span>
<span class="n">The</span> <span class="n">only</span> <span class="n">resources</span> <span class="n">that</span> <span class="n">can</span> <span class="n">be</span> <span class="n">shared</span> <span class="n">are</span> <span class="mi">2</span><span class="n">D</span> <span class="n">non</span><span class="o">-</span><span class="n">mipmapped</span> <span class="n">textures</span><span class="p">.</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>PROPOSED A: Add wording to the spec about some implementations needing the
resource setup as shared:</p>
</div>
<div class="paragraph">
<p>&#8220;Some implementations may require the resource to be shared on the D3D10
side of the API&#8221;</p>
</div>
<div class="paragraph">
<p>If we do that, do we need another enum to describe this failure case?</p>
</div>
<div class="paragraph">
<p>PROPOSED B: Require that all implementations support both shared and
non-shared resources.
The restrictions prohibiting multisample textures and the flag
D3D10_USAGE_IMMUTABLE guarantee software access to all shareable resources.</p>
</div>
<div class="paragraph">
<p>RESOLVED: Require that implementations support both
D3D10_RESOURCE_MISC_SHARED being set and not set.
Add the query for <code>CL_CONTEXT_<wbr>D3D10_<wbr>PREFER_<wbr>SHARED_<wbr>RESOURCES_<wbr>KHR</code> to determine
on a per-context basis which method will be faster.</p>
</div>
</div>
</div>
</li>
<li>
<p>Texture1D support</p>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>There is not a matching CL type, so do we want to support this and map to
buffer or Texture2D?</p>
</div>
<div class="paragraph">
<p>RESOLVED: We will not add support for ID3D10Texture1D objects unless a
corresponding OpenCL 1D Image type is created.</p>
</div>
</div>
</div>
</li>
<li>
<p>CL/D3D10 queries</p>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The GL interop has <strong>clGetGLObjectInfo</strong> and <strong>clGetGLTextureInfo</strong>.
It is unclear if these are needed on the D3D10 interop side since the D3D10
spec makes these queries trivial on the D3D10 object itself.
Also, not all of the semantics of the GL call map across.</p>
</div>
<div class="paragraph">
<p>PROPOSED: Add the <strong>clGetMemObjectInfo</strong> and <strong>clGetImageInfo</strong> parameter names
<code>CL_MEM_<wbr>D3D10_<wbr>RESOURCE_<wbr>KHR</code> and <code>CL_IMAGE_<wbr>D3D10_<wbr>SUBRESOURCE_<wbr>KHR</code> to query the
D3D10 resource from which a <code>cl_mem</code> was created.
From this data, any D3D10 side information may be queried using the D3D10
API.</p>
</div>
<div class="paragraph">
<p>RESOLVED: We will use <strong>clGetMemObjectInfo</strong> and <strong>clGetImageInfo</strong> to access
this information.</p>
</div>
</div>
</div>
</li>
</ol>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="cl_khr_d3d11_sharing"><a class="anchor" href="#cl_khr_d3d11_sharing"></a>14. Creating OpenCL Memory Objects from Direct3D 11 Buffers and Textures</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="cl_khr_d3d11_sharing-overview"><a class="anchor" href="#cl_khr_d3d11_sharing-overview"></a>14.1. Overview</h3>
<div class="paragraph">
<p>This section describes the <strong>cl_khr_d3d11_sharing</strong> extension.
The goal of this extension is to provide interoperability between OpenCL and
Direct3D 11.</p>
</div>
</div>
<div class="sect2">
<h3 id="_general_information_13"><a class="anchor" href="#_general_information_13"></a>14.2. General information</h3>
<div class="sect3">
<h4 id="_version_history_13"><a class="anchor" href="#_version_history_13"></a>14.2.1. Version history</h4>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 60%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><strong>Date</strong></th>
<th class="tableblock halign-left valign-top"><strong>Version</strong></th>
<th class="tableblock halign-left valign-top"><strong>Description</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">2020-04-21</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.0.0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">First assigned version.</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect2">
<h3 id="cl_khr_d3d11_sharing-new-procedures-and-functions"><a class="anchor" href="#cl_khr_d3d11_sharing-new-procedures-and-functions"></a>14.3. New Procedures and Functions</h3>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="opencl"><span class="kt">cl_int</span> <span class="nf">clGetDeviceIDsFromD3D11KHR</span><span class="p">(</span><span class="kt">cl_platform_id</span> <span class="n">platform</span><span class="p">,</span>
                                  <span class="kt">cl_d3d11_device_source_khr</span> <span class="n">d3d_device_source</span><span class="p">,</span>
                                  <span class="kt">void</span> <span class="o">*</span><span class="n">d3d_object</span><span class="p">,</span>
                                  <span class="kt">cl_d3d11_device_set_khr</span> <span class="n">d3d_device_set</span><span class="p">,</span>
                                  <span class="kt">cl_uint</span> <span class="n">num_entries</span><span class="p">,</span>
                                  <span class="kt">cl_device_id</span> <span class="o">*</span><span class="n">devices</span><span class="p">,</span>
                                  <span class="kt">cl_uint</span> <span class="o">*</span><span class="n">num_devices</span><span class="p">);</span>

<span class="kt">cl_mem</span> <span class="nf">clCreateFromD3D11BufferKHR</span><span class="p">(</span><span class="kt">cl_context</span> <span class="n">context</span><span class="p">,</span>
                                  <span class="kt">cl_mem_flags</span> <span class="n">flags</span><span class="p">,</span>
                                  <span class="n">ID3D11Buffer</span> <span class="o">*</span><span class="n">resource</span><span class="p">,</span>
                                  <span class="kt">cl_int</span> <span class="o">*</span><span class="n">errcode_ret</span><span class="p">);</span>

<span class="kt">cl_mem</span> <span class="nf">clCreateFromD3D11Texture2DKHR</span><span class="p">(</span><span class="kt">cl_context</span> <span class="n">context</span><span class="p">,</span>
                                     <span class="kt">cl_mem_flags</span> <span class="n">flags</span><span class="p">,</span>
                                     <span class="n">ID3D11Texture2D</span> <span class="o">*</span><span class="n">resource</span><span class="p">,</span>
                                     <span class="n">UINT</span> <span class="n">subresource</span><span class="p">,</span>
                                     <span class="kt">cl_int</span> <span class="o">*</span><span class="n">errcode_ret</span><span class="p">);</span>

<span class="kt">cl_mem</span> <span class="nf">clCreateFromD3D11Texture3DKHR</span><span class="p">(</span><span class="kt">cl_context</span> <span class="n">context</span><span class="p">,</span>
                                     <span class="kt">cl_mem_flags</span> <span class="n">flags</span><span class="p">,</span>
                                     <span class="n">ID3D11Texture3D</span> <span class="o">*</span><span class="n">resource</span><span class="p">,</span>
                                     <span class="n">UINT</span> <span class="n">subresource</span><span class="p">,</span>
                                     <span class="kt">cl_int</span> <span class="o">*</span><span class="n">errcode_ret</span><span class="p">);</span>

<span class="kt">cl_int</span> <span class="nf">clEnqueueAcquireD3D11ObjectsKHR</span><span class="p">(</span><span class="kt">cl_command_queue</span> <span class="n">command_queue</span><span class="p">,</span>
                                       <span class="kt">cl_uint</span> <span class="n">num_objects</span><span class="p">,</span>
                                       <span class="k">const</span> <span class="kt">cl_mem</span> <span class="o">*</span><span class="n">mem_objects</span><span class="p">,</span>
                                       <span class="kt">cl_uint</span> <span class="n">num_events_in_wait_list</span><span class="p">,</span>
                                       <span class="k">const</span> <span class="kt">cl_event</span> <span class="o">*</span><span class="n">event_wait_list</span><span class="p">,</span>
                                       <span class="kt">cl_event</span> <span class="o">*</span><span class="n">event</span><span class="p">);</span>

<span class="kt">cl_int</span> <span class="nf">clEnqueueReleaseD3D11ObjectsKHR</span><span class="p">(</span><span class="kt">cl_command_queue</span> <span class="n">command_queue</span><span class="p">,</span>
                                       <span class="kt">cl_uint</span> <span class="n">num_objects</span><span class="p">,</span>
                                       <span class="k">const</span> <span class="kt">cl_mem</span> <span class="o">*</span><span class="n">mem_objects</span><span class="p">,</span>
                                       <span class="kt">cl_uint</span> <span class="n">num_events_in_wait_list</span><span class="p">,</span>
                                       <span class="k">const</span> <span class="kt">cl_event</span> <span class="o">*</span><span class="n">event_wait_list</span><span class="p">,</span>
                                       <span class="kt">cl_event</span> <span class="o">*</span><span class="n">event</span><span class="p">);</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="cl_khr_d3d11_sharing-new-tokens"><a class="anchor" href="#cl_khr_d3d11_sharing-new-tokens"></a>14.4. New Tokens</h3>
<div class="paragraph">
<p>Accepted as a Direct3D 11 device source in the <em>d3d_device_source</em> parameter
of <strong>clGetDeviceIDsFromD3D11KHR</strong>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="opencl"><span class="n">CL_D3D11_DEVICE_KHR</span>
<span class="n">CL_D3D11_DXGI_ADAPTER_KHR</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Accepted as a set of Direct3D 11 devices in the _d3d_device_set_parameter of
<strong>clGetDeviceIDsFromD3D11KHR</strong>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="opencl"><span class="n">CL_PREFERRED_DEVICES_FOR_D3D11_KHR</span>
<span class="n">CL_ALL_DEVICES_FOR_D3D11_KHR</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Accepted as a property name in the <em>properties</em> parameter of
<strong>clCreateContext</strong> and <strong>clCreateContextFromType</strong>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="opencl"><span class="n">CL_CONTEXT_D3D11_DEVICE_KHR</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Accepted as a property name in the <em>param_name</em> parameter of
<strong>clGetContextInfo</strong>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="opencl"><span class="n">CL_CONTEXT_D3D11_PREFER_SHARED_RESOURCES_KHR</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Accepted as the property being queried in the <em>param_name</em> parameter of
<strong>clGetMemObjectInfo</strong>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="opencl"><span class="n">CL_MEM_D3D11_RESOURCE_KHR</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Accepted as the property being queried in the <em>param_name</em> parameter of
<strong>clGetImageInfo</strong>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="opencl"><span class="n">CL_IMAGE_D3D11_SUBRESOURCE_KHR</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Returned in the <em>param_value</em> parameter of <strong>clGetEventInfo</strong> when
<em>param_name</em> is <code>CL_EVENT_<wbr>COMMAND_<wbr>TYPE</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="opencl"><span class="n">CL_COMMAND_ACQUIRE_D3D11_OBJECTS_KHR</span>
<span class="n">CL_COMMAND_RELEASE_D3D11_OBJECTS_KHR</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Returned by <strong>clCreateContext</strong> and <strong>clCreateContextFromType</strong> if the Direct3D
11 device specified for interoperability is not compatible with the devices
against which the context is to be created:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="opencl"><span class="n">CL_INVALID_D3D11_DEVICE_KHR</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Returned by <strong>clCreateFromD3D11BufferKHR</strong> when <em>resource</em> is not a Direct3D
11 buffer object, and by <strong>clCreateFromD3D11Texture2DKHR</strong> and
<strong>clCreateFromD3D11Texture3DKHR</strong> when <em>resource</em> is not a Direct3D 11 texture
object.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="opencl"><span class="n">CL_INVALID_D3D11_RESOURCE_KHR</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Returned by <strong>clEnqueueAcquireD3D11ObjectsKHR</strong> when any of <em>mem_objects</em> are
currently acquired by OpenCL:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="opencl"><span class="n">CL_D3D11_RESOURCE_ALREADY_ACQUIRED_KHR</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Returned by <strong>clEnqueueReleaseD3D11ObjectsKHR</strong> when any of <em>mem_objects</em> are
not currently acquired by OpenCL:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="opencl"><span class="n">CL_D3D11_RESOURCE_NOT_ACQUIRED_KHR</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="cl_khr_d3d11_sharing-additions-to-chapter-4"><a class="anchor" href="#cl_khr_d3d11_sharing-additions-to-chapter-4"></a>14.5. Additions to Chapter 4 of the OpenCL 2.2 Specification</h3>
<div class="paragraph">
<p>In <em>section 4.4</em>, replace the description of <em>properties</em> under
<strong>clCreateContext</strong> with:</p>
</div>
<div class="paragraph">
<p>"<em>properties</em> specifies a list of context property names and their
corresponding values.
Each property is followed immediately by the corresponding desired value.
The list is terminated with zero.
If a property is not specified in <em>properties</em>, then its default value
(listed in <em>table 4.5</em>) is used (it is said to be specified implicitly).
If <em>properties</em> is <code>NULL</code> or empty (points to a list whose first value is
zero), all attributes take on their default values."</p>
</div>
<div class="paragraph">
<p>Add the following to <em>table 4.5</em>:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 40%;">
<col style="width: 20%;">
<col style="width: 40%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><strong>cl_context_properties enum</strong></th>
<th class="tableblock halign-left valign-top"><strong>Property value</strong></th>
<th class="tableblock halign-left valign-top"><strong>Description</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CL_CONTEXT_<wbr>D3D11_<wbr>DEVICE_<wbr>KHR</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ID3D11Device *</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Specifies the ID3D11Device * to use for Direct3D 11 interoperability.</p>
<p class="tableblock">  The default value is <code>NULL</code>.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Add to the list of errors for <strong>clCreateContext</strong>:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>CL_INVALID_<wbr>D3D11_<wbr>DEVICE_<wbr>KHR</code> if the value of the property
<code>CL_CONTEXT_<wbr>D3D11_<wbr>DEVICE_<wbr>KHR</code> is non-<code>NULL</code> and does not specify a valid
Direct3D 11 device with which the <em>cl_device_ids</em> against which this
context is to be created may interoperate.</p>
</li>
<li>
<p><code>CL_INVALID_<wbr>OPERATION</code> if Direct3D 11 interoperability is specified by
setting <code>CL_INVALID_<wbr>D3D11_<wbr>DEVICE_<wbr>KHR</code> to a non-<code>NULL</code> value, and
interoperability with another graphics API is also specified.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Add to the list of errors for <strong>clCreateContextFromType</strong> the same new errors
described above for <strong>clCreateContext</strong>.</p>
</div>
<div class="paragraph">
<p>Add the following row to <em>table 4.6</em>:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 40%;">
<col style="width: 20%;">
<col style="width: 40%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><strong>cl_context_info</strong></th>
<th class="tableblock halign-left valign-top"><strong>Return Type</strong></th>
<th class="tableblock halign-left valign-top"><strong>Information returned in param_value</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CL_CONTEXT_<wbr>D3D11_<wbr>PREFER_<wbr>SHARED_<wbr>RESOURCES_<wbr>KHR</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>cl_bool</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Returns <code>CL_TRUE</code> if Direct3D 11 resources created as shared by setting
  <em>MiscFlags</em> to include D3D11_RESOURCE_MISC_SHARED will perform faster when
  shared with OpenCL, compared with resources which have not set this flag.
  Otherwise returns <code>CL_FALSE</code>.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="cl_khr_d3d11_sharing-additions-to-chapter-5"><a class="anchor" href="#cl_khr_d3d11_sharing-additions-to-chapter-5"></a>14.6. Additions to Chapter 5 of the OpenCL 2.2 Specification</h3>
<div class="paragraph">
<p>Add to the list of errors for <strong>clGetMemObjectInfo</strong>:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>CL_INVALID_<wbr>D3D11_<wbr>RESOURCE_<wbr>KHR</code> if <em>param_name</em> is
<code>CL_MEM_<wbr>D3D11_<wbr>RESOURCE_<wbr>KHR</code> and <em>memobj</em> was not created by the function
<strong>clCreateFromD3D11BufferKHR</strong>, <strong>clCreateFromD3D11Texture2DKHR</strong>, or
<strong>clCreateFromD3D11Texture3DKHR</strong>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Extend <em>table 5.12</em> to include the following entry.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 40%;">
<col style="width: 20%;">
<col style="width: 40%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><strong>cl_mem_info</strong></th>
<th class="tableblock halign-left valign-top"><strong>Return type</strong></th>
<th class="tableblock halign-left valign-top"><strong>Info. returned in <em>param_value</em></strong></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CL_MEM_<wbr>D3D11_<wbr>RESOURCE_<wbr>KHR</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ID3D11Resource *</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">If <em>memobj</em> was created using <strong>clCreateFromD3D11BufferKHR</strong>,
  <strong>clCreateFromD3D11Texture2DKHR</strong>, or <strong>clCreateFromD3D11Texture3DKHR</strong>,
  returns the <em>resource</em> argument specified when <em>memobj</em> was created.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Add to the list of errors for <strong>clGetImageInfo</strong>:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>CL_INVALID_<wbr>D3D11_<wbr>RESOURCE_<wbr>KHR</code> if <em>param_name</em> is
<code>CL_IMAGE_<wbr>D3D11_<wbr>SUBRESOURCE_<wbr>KHR</code> and <em>image</em> was not created by the function
<strong>clCreateFromD3D11Texture2DKHR</strong>, or <strong>clCreateFromD3D11Texture3DKHR</strong>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Extend <em>table 5.9</em> to include the following entry.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 40%;">
<col style="width: 20%;">
<col style="width: 40%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><strong>cl_image_info</strong></th>
<th class="tableblock halign-left valign-top"><strong>Return type</strong></th>
<th class="tableblock halign-left valign-top"><strong>Info. returned in <em>param_value</em></strong></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CL_IMAGE_<wbr>D3D11_<wbr>SUBRESOURCE_<wbr>KHR</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">UINT</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">If <em>image</em> was created using <strong>clCreateFromD3D11Texture2DKHR</strong>, or
  <strong>clCreateFromD3D11Texture3DKHR</strong>, returns the <em>subresource</em> argument
  specified when <em>image</em> was created.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Add to <em>table 5.22</em> in the <strong>Info returned in param_value</strong> column for
<em>cl_event_info</em> = <code>CL_EVENT_<wbr>COMMAND_<wbr>TYPE</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="opencl"><span class="n">CL_COMMAND_ACQUIRE_D3D11_OBJECTS_KHR</span>
<span class="n">CL_COMMAND_RELEASE_D3D11_OBJECTS_KHR</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="cl_khr_d3d11_sharing-sharing-memory-objects-with-direct3d-11-resources"><a class="anchor" href="#cl_khr_d3d11_sharing-sharing-memory-objects-with-direct3d-11-resources"></a>14.7. Sharing Memory Objects with Direct3D 11 Resources</h3>
<div class="paragraph">
<p>This section discusses OpenCL functions that allow applications to use
Direct3D 11 resources as OpenCL memory objects.
This allows efficient sharing of data between OpenCL and Direct3D 11.
The OpenCL API may be used to execute kernels that read and/or write memory
objects that are also Direct3D 11 resources.
An OpenCL image object may be created from a Direct3D 11 texture resource.
An OpenCL buffer object may be created from a Direct3D 11 buffer resource.
OpenCL memory objects may be created from Direct3D 11 objects if and only if
the OpenCL context has been created from a Direct3D 11 device.</p>
</div>
<div class="sect3">
<h4 id="cl_khr_d3d11_sharing-querying-opencl-devices-corresponding-to-direct3d-11-devices"><a class="anchor" href="#cl_khr_d3d11_sharing-querying-opencl-devices-corresponding-to-direct3d-11-devices"></a>14.7.1. Querying OpenCL Devices Corresponding to Direct3D 11 Devices</h4>
<div class="paragraph">
<p>The OpenCL devices corresponding to a Direct3D 11 device may be queried.
The OpenCL devices corresponding to a DXGI adapter may also be queried.
The OpenCL devices corresponding to a Direct3D 11 device will be a subset of
the OpenCL devices corresponding to the DXGI adapter against which the
Direct3D 11 device was created.</p>
</div>
<div class="paragraph">
<p>The OpenCL devices corresponding to a Direct3D 11 device or a DXGI device
may be queried using the function</p>
</div>
<div id="clGetDeviceIDsFromD3D11KHR" class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="opencl"><span class="kt">cl_int</span> <span class="nf">clGetDeviceIDsFromD3D11KHR</span><span class="p">(</span>
    <span class="kt">cl_platform_id</span> <span class="n">platform</span><span class="p">,</span>
    <span class="kt">cl_d3d11_device_source_khr</span> <span class="n">d3d_device_source</span><span class="p">,</span>
    <span class="kt">void</span><span class="o">*</span> <span class="n">d3d_object</span><span class="p">,</span>
    <span class="kt">cl_d3d11_device_set_khr</span> <span class="n">d3d_device_set</span><span class="p">,</span>
    <span class="kt">cl_uint</span> <span class="n">num_entries</span><span class="p">,</span>
    <span class="kt">cl_device_id</span><span class="o">*</span> <span class="n">devices</span><span class="p">,</span>
    <span class="kt">cl_uint</span><span class="o">*</span> <span class="n">num_devices</span><span class="p">);</span></code></pre>
</div>
</div>
<div class="paragraph">
<p><em>platform</em> refers to the platform ID returned by <strong>clGetPlatformIDs</strong>.</p>
</div>
<div class="paragraph">
<p><em>d3d_device_source</em> specifies the type of <em>d3d_object</em>, and must be one of
the values shown in the table below.</p>
</div>
<div class="paragraph">
<p><em>d3d_object</em> specifies the object whose corresponding OpenCL devices are
being queried.
The type of <em>d3d_object</em> must be as specified in the table below.</p>
</div>
<div class="paragraph">
<p><em>d3d_device_set</em> specifies the set of devices to return, and must be one of
the values shown in the table below.</p>
</div>
<div class="paragraph">
<p><em>num_entries</em> is the number of <code>cl_device_<wbr>id</code> entries that can be added to
<em>devices</em>.
If <em>devices</em> is not <code>NULL</code> then <em>num_entries</em> must be greater than zero.</p>
</div>
<div class="paragraph">
<p><em>devices</em> returns a list of OpenCL devices found.
The <code>cl_device_<wbr>id</code> values returned in <em>devices</em> can be used to identify a
specific OpenCL device.
If <em>devices</em> is <code>NULL</code>, this argument is ignored.
The number of OpenCL devices returned is the minimum of the value specified
by <em>num_entries</em> and the number of OpenCL devices corresponding to
<em>d3d_object</em>.</p>
</div>
<div class="paragraph">
<p><em>num_devices</em> returns the number of OpenCL devices available that correspond
to <em>d3d_object</em>.
If <em>num_devices</em> is <code>NULL</code>, this argument is ignored.</p>
</div>
<div class="paragraph">
<p><strong>clGetDeviceIDsFromD3D11KHR</strong> returns <code>CL_SUCCESS</code> if the function is executed
successfully.
Otherwise it may return</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>CL_INVALID_<wbr>PLATFORM</code> if <em>platform</em> is not a valid platform.</p>
</li>
<li>
<p><code>CL_INVALID_<wbr>VALUE</code> if <em>d3d_device_source</em> is not a valid value,
<em>d3d_device_set</em> is not a valid value, <em>num_entries</em> is equal to zero
and <em>devices</em> is not <code>NULL</code>, or if both <em>num_devices</em> and <em>devices</em> are
<code>NULL</code>.</p>
</li>
<li>
<p><code>CL_DEVICE_<wbr>NOT_<wbr>FOUND</code> if no OpenCL devices that correspond to <em>d3d_object</em>
were found.</p>
</li>
</ul>
</div>
<table id="cl_khr_d3d11_sharing-clGetDeviceIDsFromD3D11KHR-object-type" class="tableblock frame-all grid-all stretch">
<caption class="title">Table 34. <em>Direct3D 11 object types that may be used by</em> <strong>clGetDeviceIDsFromD3D11KHR</strong></caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><code>cl_d3d11_<wbr>device_<wbr>source_<wbr>khr</code></th>
<th class="tableblock halign-left valign-top">Type of <em>d3d_object</em></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CL_D3D11_<wbr>DEVICE_<wbr>KHR</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ID3D11Device *</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CL_D3D11_<wbr>DXGI_<wbr>ADAPTER_<wbr>KHR</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">IDXGIAdapter *</p></td>
</tr>
</tbody>
</table>
<table id="cl_khr_d3d11_sharing-clGetDeviceIDsFromD3D11KHR-devices" class="tableblock frame-all grid-all stretch">
<caption class="title">Table 35. <em>Sets of devices queriable using</em> <strong>clGetDeviceIDsFromD3D11KHR</strong></caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><code>cl_d3d11_<wbr>device_<wbr>set_<wbr>khr</code></th>
<th class="tableblock halign-left valign-top">Devices returned in <em>devices</em></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CL_PREFERRED_<wbr>DEVICES_<wbr>FOR_<wbr>D3D11_<wbr>KHR</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The preferred OpenCL devices associated with the specified Direct3D
  object.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CL_ALL_<wbr>DEVICES_<wbr>FOR_<wbr>D3D11_<wbr>KHR</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">All OpenCL devices which may interoperate with the specified Direct3D
  object.
  Performance of sharing data on these devices may be considerably less than
  on the preferred devices.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="cl_khr_d3d11_sharing-lifetime-of-shared-objects"><a class="anchor" href="#cl_khr_d3d11_sharing-lifetime-of-shared-objects"></a>14.7.2. Lifetime of Shared Objects</h4>
<div class="paragraph">
<p>An OpenCL memory object created from a Direct3D 11 resource remains valid as
long as the corresponding Direct3D 11 resource has not been deleted.
If the Direct3D 11 resource is deleted through the Direct3D 11 API,
subsequent use of the OpenCL memory object will result in undefined
behavior, including but not limited to possible OpenCL errors, data
corruption, and program termination.</p>
</div>
<div class="paragraph">
<p>The successful creation of a <code>cl_context</code> against a Direct3D 11 device
specified via the context create parameter <code>CL_CONTEXT_<wbr>D3D11_<wbr>DEVICE_<wbr>KHR</code> will
increment the internal Direct3D reference count on the specified Direct3D 11
device.
The internal Direct3D reference count on that Direct3D 11 device will be
decremented when the OpenCL reference count on the returned OpenCL context
drops to zero.</p>
</div>
<div class="paragraph">
<p>The OpenCL context and corresponding command-queues are dependent on the
existence of the Direct3D 11 device from which the OpenCL context was
created.
If the Direct3D 11 device is deleted through the Direct3D 11 API, subsequent
use of the OpenCL context will result in undefined behavior, including but
not limited to possible OpenCL errors, data corruption, and program
termination.</p>
</div>
</div>
<div class="sect3">
<h4 id="cl_khr_d3d11_sharing-sharing-direct3d-11-buffer-resources-as-opencl-buffer-objects"><a class="anchor" href="#cl_khr_d3d11_sharing-sharing-direct3d-11-buffer-resources-as-opencl-buffer-objects"></a>14.7.3. Sharing Direct3D 11 Buffer Resources as OpenCL Buffer Objects</h4>
<div class="paragraph">
<p>The function</p>
</div>
<div id="clCreateFromD3D11BufferKHR" class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="opencl"><span class="kt">cl_mem</span> <span class="nf">clCreateFromD3D11BufferKHR</span><span class="p">(</span>
    <span class="kt">cl_context</span> <span class="n">context</span><span class="p">,</span>
    <span class="kt">cl_mem_flags</span> <span class="n">flags</span><span class="p">,</span>
    <span class="n">ID3D11Buffer</span><span class="o">*</span> <span class="n">resource</span><span class="p">,</span>
    <span class="kt">cl_int</span><span class="o">*</span> <span class="n">errcode_ret</span><span class="p">);</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>creates an OpenCL buffer object from a Direct3D 11 buffer.</p>
</div>
<div class="paragraph">
<p><em>context</em> is a valid OpenCL context created from a Direct3D 11 device.</p>
</div>
<div class="paragraph">
<p><em>flags</em> is a bit-field that is used to specify usage information.
Refer to table 5.3 for a description of <em>flags</em>.
Only <code>CL_MEM_<wbr>READ_<wbr>ONLY</code>, <code>CL_MEM_<wbr>WRITE_<wbr>ONLY</code> and <code>CL_MEM_<wbr>READ_<wbr>WRITE</code> values
specified in <em>table 5.3</em> can be used.</p>
</div>
<div class="paragraph">
<p><em>resource</em> is a pointer to the Direct3D 11 buffer to share.</p>
</div>
<div class="paragraph">
<p><em>errcode_ret</em> will return an appropriate error code.
If <em>errcode_ret</em> is <code>NULL</code>, no error code is returned.</p>
</div>
<div class="paragraph">
<p><strong>clCreateFromD3D11BufferKHR</strong> returns a valid non-zero OpenCL buffer object
and <em>errcode_ret</em> is set to <code>CL_SUCCESS</code> if the buffer object is created
successfully.
Otherwise, it returns a <code>NULL</code> value with one of the following error values
returned in <em>errcode_ret</em>:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>CL_INVALID_<wbr>CONTEXT</code> if <em>context</em> is not a valid context.</p>
</li>
<li>
<p><code>CL_INVALID_<wbr>VALUE</code> if values specified in <em>flags</em> are not valid.</p>
</li>
<li>
<p><code>CL_INVALID_<wbr>D3D11_<wbr>RESOURCE_<wbr>KHR</code> if <em>resource</em> is not a Direct3D 11 buffer
resource, if <em>resource</em> was created with the D3D11_USAGE flag
D3D11_USAGE_IMMUTABLE, if a <code>cl_mem</code> from <em>resource</em> has already been
created using <strong>clCreateFromD3D11BufferKHR</strong>, or if <em>context</em> was not
created against the same Direct3D 11 device from which <em>resource</em> was
created.</p>
</li>
<li>
<p><code>CL_OUT_<wbr>OF_<wbr>HOST_<wbr>MEMORY</code> if there is a failure to allocate resources
required by the OpenCL implementation on the host.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The size of the returned OpenCL buffer object is the same as the size of
<em>resource</em>.
This call will increment the internal Direct3D reference count on
<em>resource</em>.
The internal Direct3D reference count on <em>resource</em> will be decremented when
the OpenCL reference count on the returned OpenCL memory object drops to
zero.</p>
</div>
</div>
<div class="sect3">
<h4 id="cl_khr_d3d11_sharing-sharing-direct3d-11-texture-and-resources-as-opencl-image-objects"><a class="anchor" href="#cl_khr_d3d11_sharing-sharing-direct3d-11-texture-and-resources-as-opencl-image-objects"></a>14.7.4. Sharing Direct3D 11 Texture and Resources as OpenCL Image Objects</h4>
<div class="paragraph">
<p>The function</p>
</div>
<div id="clCreateFromD3D11Texture2DKHR" class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="opencl"><span class="kt">cl_mem</span> <span class="nf">clCreateFromD3D11Texture2DKHR</span><span class="p">(</span>
    <span class="kt">cl_context</span> <span class="n">context</span><span class="p">,</span>
    <span class="kt">cl_mem_flags</span> <span class="n">flags</span><span class="p">,</span>
    <span class="n">ID3D11Texture2D</span><span class="o">*</span> <span class="n">resource</span><span class="p">,</span>
    <span class="n">UINT</span> <span class="n">subresource</span><span class="p">,</span>
    <span class="kt">cl_int</span><span class="o">*</span> <span class="n">errcode_ret</span><span class="p">);</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>creates an OpenCL 2D image object from a subresource of a Direct3D 11 2D
texture.</p>
</div>
<div class="paragraph">
<p><em>context</em> is a valid OpenCL context created from a Direct3D 11 device.</p>
</div>
<div class="paragraph">
<p><em>flags</em> is a bit-field that is used to specify usage information.
Refer to <em>table 5.3</em> for a description of <em>flags</em>.
Only <code>CL_MEM_<wbr>READ_<wbr>ONLY</code>, <code>CL_MEM_<wbr>WRITE_<wbr>ONLY</code> and <code>CL_MEM_<wbr>READ_<wbr>WRITE</code> values
specified in <em>table 5.3</em> can be used.</p>
</div>
<div class="paragraph">
<p><em>resource</em> is a pointer to the Direct3D 11 2D texture to share.</p>
</div>
<div class="paragraph">
<p><em>subresource</em> is the subresource of <em>resource</em> to share.</p>
</div>
<div class="paragraph">
<p><em>errcode_ret</em> will return an appropriate error code.
If <em>errcode_ret</em> is <code>NULL</code>, no error code is returned.</p>
</div>
<div class="paragraph">
<p><strong>clCreateFromD3D11Texture2DKHR</strong> returns a valid non-zero OpenCL image object
and <em>errcode_ret</em> is set to <code>CL_SUCCESS</code> if the image object is created
successfully.
Otherwise, it returns a <code>NULL</code> value with one of the following error values
returned in <em>errcode_ret</em>:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>CL_INVALID_<wbr>CONTEXT</code> if <em>context</em> is not a valid context.</p>
</li>
<li>
<p><code>CL_INVALID_<wbr>VALUE</code> if values specified in <em>flags</em> are not valid or if
<em>subresource</em> is not a valid subresource index for <em>resource</em>.</p>
</li>
<li>
<p><code>CL_INVALID_<wbr>D3D11_<wbr>RESOURCE_<wbr>KHR</code> if <em>resource</em> is not a Direct3D 11 texture
resource, if <em>resource</em> was created with the D3D11_USAGE flag
D3D11_USAGE_IMMUTABLE, if <em>resource</em> is a multisampled texture, if a
<code>cl_mem</code> from subresource <em>subresource</em> of <em>resource</em> has already been
created using <strong>clCreateFromD3D11Texture2DKHR</strong>, or if <em>context</em> was not
created against the same Direct3D 11 device from which <em>resource</em> was
created.</p>
</li>
<li>
<p><code>CL_INVALID_<wbr>IMAGE_<wbr>FORMAT_<wbr>DESCRIPTOR</code> if the Direct3D 11 texture format of
<em>resource</em> is not listed in the table
<a href="#cl_khr_d3d11_sharing-mapping-of-image-formats"><em>Direct3D 11 formats and
corresponding OpenCL image formats</em></a> or if the Direct3D 11 texture
format of <em>resource</em> does not map to a supported OpenCL image format.</p>
</li>
<li>
<p><code>CL_OUT_<wbr>OF_<wbr>HOST_<wbr>MEMORY</code> if there is a failure to allocate resources
required by the OpenCL implementation on the host.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The width and height of the returned OpenCL 2D image object are determined
by the width and height of subresource <em>subresource</em> of <em>resource</em>.
The channel type and order of the returned OpenCL 2D image object is
determined by the format of <em>resource</em> by the table
<a href="#cl_khr_d3d11_sharing-mapping-of-image-formats"><em>Direct3D 11 formats and
corresponding OpenCL image formats</em></a>.</p>
</div>
<div class="paragraph">
<p>This call will increment the internal Direct3D reference count on
<em>resource</em>.
The internal Direct3D reference count on <em>resource</em> will be decremented when
the OpenCL reference count on the returned OpenCL memory object drops to
zero.</p>
</div>
<div class="paragraph">
<p>The function</p>
</div>
<div id="clCreateFromD3D11Texture3DKHR" class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="opencl"><span class="kt">cl_mem</span> <span class="nf">clCreateFromD3D11Texture3DKHR</span><span class="p">(</span>
    <span class="kt">cl_context</span> <span class="n">context</span><span class="p">,</span>
    <span class="kt">cl_mem_flags</span> <span class="n">flags</span><span class="p">,</span>
    <span class="n">ID3D11Texture3D</span><span class="o">*</span> <span class="n">resource</span><span class="p">,</span>
    <span class="n">UINT</span> <span class="n">subresource</span><span class="p">,</span>
    <span class="kt">cl_int</span><span class="o">*</span> <span class="n">errcode_ret</span><span class="p">);</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>creates an OpenCL 3D image object from a subresource of a Direct3D 11 3D
texture.</p>
</div>
<div class="paragraph">
<p><em>context</em> is a valid OpenCL context created from a Direct3D 11 device.</p>
</div>
<div class="paragraph">
<p><em>flags</em> is a bit-field that is used to specify usage information.
Refer to <em>table 5.3</em> for a description of <em>flags</em>.
Only <code>CL_MEM_<wbr>READ_<wbr>ONLY</code>, <code>CL_MEM_<wbr>WRITE_<wbr>ONLY</code> and <code>CL_MEM_<wbr>READ_<wbr>WRITE</code> values
specified in <em>table 5.3</em> can be used.</p>
</div>
<div class="paragraph">
<p><em>resource</em> is a pointer to the Direct3D 11 3D texture to share.</p>
</div>
<div class="paragraph">
<p><em>subresource</em> is the subresource of <em>resource</em> to share.</p>
</div>
<div class="paragraph">
<p><em>errcode_ret</em> will return an appropriate error code.
If <em>errcode_ret</em> is <code>NULL</code>, no error code is returned.</p>
</div>
<div class="paragraph">
<p><strong>clCreateFromD3D11Texture3DKHR</strong> returns a valid non-zero OpenCL image object
and <em>errcode_ret</em> is set to <code>CL_SUCCESS</code> if the image object is created
successfully.
Otherwise, it returns a <code>NULL</code> value with one of the following error values
returned in <em>errcode_ret</em>:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>CL_INVALID_<wbr>CONTEXT</code> if <em>context</em> is not a valid context.</p>
</li>
<li>
<p><code>CL_INVALID_<wbr>VALUE</code> if values specified in <em>flags</em> are not valid or if
<em>subresource</em> is not a valid subresource index for <em>resource</em>.</p>
</li>
<li>
<p><code>CL_INVALID_<wbr>D3D11_<wbr>RESOURCE_<wbr>KHR</code> if <em>resource</em> is not a Direct3D 11 texture
resource, if <em>resource</em> was created with the D3D11_USAGE flag
D3D11_USAGE_IMMUTABLE, if <em>resource</em> is a multisampled texture, if a
<code>cl_mem</code> from subresource <em>subresource</em> of <em>resource</em> has already been
created using <strong>clCreateFromD3D11Texture3DKHR</strong>, or if <em>context</em> was not
created against the same Direct3D 11 device from which <em>resource</em> was
created.</p>
</li>
<li>
<p><code>CL_INVALID_<wbr>IMAGE_<wbr>FORMAT_<wbr>DESCRIPTOR</code> if the Direct3D 11 texture format of
<em>resource</em> is not listed in the table
<a href="#cl_khr_d3d11_sharing-mapping-of-image-formats"><em>Direct3D 11 formats and
corresponding OpenCL image formats</em></a> or if the Direct3D 11 texture
format of <em>resource</em> does not map to a supported OpenCL image format.</p>
</li>
<li>
<p><code>CL_OUT_<wbr>OF_<wbr>HOST_<wbr>MEMORY</code> if there is a failure to allocate resources
required by the OpenCL implementation on the host.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The width, height and depth of the returned OpenCL 3D image object are
determined by the width, height and depth of subresource <em>subresource</em> of
<em>resource</em>.
The channel type and order of the returned OpenCL 3D image object is
determined by the format of <em>resource</em> by the table
<a href="#cl_khr_d3d11_sharing-mapping-of-image-formats"><em>Direct3D 11 formats and
corresponding OpenCL image formats</em></a>.</p>
</div>
<div class="paragraph">
<p>This call will increment the internal Direct3D reference count on
<em>resource</em>.
The internal Direct3D reference count on <em>resource</em> will be decremented when
the OpenCL reference count on the returned OpenCL memory object drops to
zero.</p>
</div>
<table id="cl_khr_d3d11_sharing-mapping-of-image-formats" class="tableblock frame-all grid-all stretch">
<caption class="title">Table 36. <em>Direct3D 11 formats and corresponding OpenCL image formats</em></caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><strong>DXGI format</strong></th>
<th class="tableblock halign-left valign-top"><strong>CL image format</strong>

<strong>(channel order, channel data type)</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">DXGI_FORMAT_R32G32B32A32_FLOAT</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CL_RGBA</code>, <code>CL_FLOAT</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">DXGI_FORMAT_R32G32B32A32_UINT</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CL_RGBA</code>, <code>CL_UNSIGNED_INT32</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">DXGI_FORMAT_R32G32B32A32_SINT</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CL_RGBA</code>, <code>CL_SIGNED_INT32</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">DXGI_FORMAT_R16G16B16A16_FLOAT</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CL_RGBA</code>, <code>CL_HALF_FLOAT</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">DXGI_FORMAT_R16G16B16A16_UNORM</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CL_RGBA</code>, <code>CL_UNORM_INT16</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">DXGI_FORMAT_R16G16B16A16_UINT</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CL_RGBA</code>, <code>CL_UNSIGNED_INT16</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">DXGI_FORMAT_R16G16B16A16_SNORM</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CL_RGBA</code>, <code>CL_SNORM_INT16</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">DXGI_FORMAT_R16G16B16A16_SINT</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CL_RGBA</code>, <code>CL_SIGNED_INT16</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">DXGI_FORMAT_B8G8R8A8_UNORM</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CL_BGRA</code>, <code>CL_UNORM_INT8</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">DXGI_FORMAT_R8G8B8A8_UNORM</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CL_RGBA</code>, <code>CL_UNORM_INT8</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">DXGI_FORMAT_R8G8B8A8_UINT</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CL_RGBA</code>, <code>CL_UNSIGNED_INT8</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">DXGI_FORMAT_R8G8B8A8_SNORM</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CL_RGBA</code>, <code>CL_SNORM_INT8</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">DXGI_FORMAT_R8G8B8A8_SINT</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CL_RGBA</code>, <code>CL_SIGNED_INT8</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">DXGI_FORMAT_R32G32_FLOAT</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CL_RG</code>, <code>CL_FLOAT</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">DXGI_FORMAT_R32G32_UINT</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CL_RG</code>, <code>CL_UNSIGNED_INT32</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">DXGI_FORMAT_R32G32_SINT</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CL_RG</code>, <code>CL_SIGNED_INT32</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">DXGI_FORMAT_R16G16_FLOAT</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CL_RG</code>, <code>CL_HALF_FLOAT</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">DXGI_FORMAT_R16G16_UNORM</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CL_RG</code>, <code>CL_UNORM_INT16</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">DXGI_FORMAT_R16G16_UINT</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CL_RG</code>, <code>CL_UNSIGNED_INT16</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">DXGI_FORMAT_R16G16_SNORM</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CL_RG</code>, <code>CL_SNORM_INT16</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">DXGI_FORMAT_R16G16_SINT</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CL_RG</code>, <code>CL_SIGNED_INT16</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">DXGI_FORMAT_R8G8_UNORM</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CL_RG</code>, <code>CL_UNORM_INT8</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">DXGI_FORMAT_R8G8_UINT</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CL_RG</code>, <code>CL_UNSIGNED_INT8</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">DXGI_FORMAT_R8G8_SNORM</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CL_RG</code>, <code>CL_SNORM_INT8</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">DXGI_FORMAT_R8G8_SINT</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CL_RG</code>, <code>CL_SIGNED_INT8</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">DXGI_FORMAT_R32_FLOAT</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CL_R</code>, <code>CL_FLOAT</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">DXGI_FORMAT_R32_UINT</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CL_R</code>, <code>CL_UNSIGNED_INT32</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">DXGI_FORMAT_R32_SINT</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CL_R</code>, <code>CL_SIGNED_INT32</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">DXGI_FORMAT_R16_FLOAT</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CL_R</code>, <code>CL_HALF_FLOAT</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">DXGI_FORMAT_R16_UNORM</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CL_R</code>, <code>CL_UNORM_INT16</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">DXGI_FORMAT_R16_UINT</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CL_R</code>, <code>CL_UNSIGNED_INT16</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">DXGI_FORMAT_R16_SNORM</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CL_R</code>, <code>CL_SNORM_INT16</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">DXGI_FORMAT_R16_SINT</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CL_R</code>, <code>CL_SIGNED_INT16</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">DXGI_FORMAT_R8_UNORM</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CL_R</code>, <code>CL_UNORM_INT8</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">DXGI_FORMAT_R8_UINT</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CL_R</code>, <code>CL_UNSIGNED_INT8</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">DXGI_FORMAT_R8_SNORM</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CL_R</code>, <code>CL_SNORM_INT8</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">DXGI_FORMAT_R8_SINT</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CL_R</code>, <code>CL_SIGNED_INT8</code></p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="cl_khr_d3d11_sharing-querying-direct3d-properties-of-memory-objects-created-from-direct3d-11-resources"><a class="anchor" href="#cl_khr_d3d11_sharing-querying-direct3d-properties-of-memory-objects-created-from-direct3d-11-resources"></a>14.7.5. Querying Direct3D properties of memory objects created from Direct3D 11 resources</h4>
<div class="paragraph">
<p>Properties of Direct3D 11 objects may be queried using <strong>clGetMemObjectInfo</strong>
and <strong>clGetImageInfo</strong> with <em>param_name</em> <code>CL_MEM_<wbr>D3D11_<wbr>RESOURCE_<wbr>KHR</code> and
<code>CL_IMAGE_<wbr>D3D11_<wbr>SUBRESOURCE_<wbr>KHR</code> respectively as described in <em>sections 5.4.3</em>
and <em>5.3.6</em>.</p>
</div>
</div>
<div class="sect3">
<h4 id="cl_khr_d3d11_sharing-sharing-memory-objects-created-from-direct3d-11-resources-between-direct3d-11-and-opencl-contexts"><a class="anchor" href="#cl_khr_d3d11_sharing-sharing-memory-objects-created-from-direct3d-11-resources-between-direct3d-11-and-opencl-contexts"></a>14.7.6. Sharing memory objects created from Direct3D 11 resources between Direct3D 11 and OpenCL contexts</h4>
<div class="paragraph">
<p>The function</p>
</div>
<div id="clEnqueueAcquireD3D11ObjectsKHR" class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="opencl"><span class="kt">cl_int</span> <span class="nf">clEnqueueAcquireD3D11ObjectsKHR</span><span class="p">(</span>
    <span class="kt">cl_command_queue</span> <span class="n">command_queue</span><span class="p">,</span>
    <span class="kt">cl_uint</span> <span class="n">num_objects</span><span class="p">,</span>
    <span class="k">const</span> <span class="kt">cl_mem</span><span class="o">*</span> <span class="n">mem_objects</span><span class="p">,</span>
    <span class="kt">cl_uint</span> <span class="n">num_events_in_wait_list</span><span class="p">,</span>
    <span class="k">const</span> <span class="kt">cl_event</span><span class="o">*</span> <span class="n">event_wait_list</span><span class="p">,</span>
    <span class="kt">cl_event</span><span class="o">*</span> <span class="n">event</span><span class="p">);</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>is used to acquire OpenCL memory objects that have been created from
Direct3D 11 resources.
The Direct3D 11 objects are acquired by the OpenCL context associated with
<em>command_queue</em> and can therefore be used by all command-queues associated
with the OpenCL context.</p>
</div>
<div class="paragraph">
<p>OpenCL memory objects created from Direct3D 11 resources must be acquired
before they can be used by any OpenCL commands queued to a command-queue.
If an OpenCL memory object created from a Direct3D 11 resource is used while
it is not currently acquired by OpenCL, the behavior is undefined.
Implementations may fail the execution of commands attempting to use that
OpenCL memory object and set their associated event&#8217;s execution status to
<code>CL_D3D11_<wbr>RESOURCE_<wbr>NOT_<wbr>ACQUIRED_<wbr>KHR</code>.</p>
</div>
<div class="paragraph">
<p>If <code>CL_CONTEXT_<wbr>INTEROP_<wbr>USER_<wbr>SYNC</code> is not specified as <code>CL_TRUE</code> during context
creation, <strong>clEnqueueAcquireD3D11ObjectsKHR</strong> provides the synchronization
guarantee that any Direct3D 11 calls involving the interop device(s) used in
the OpenCL context made before <strong>clEnqueueAcquireD3D11ObjectsKHR</strong> is called
will complete executing before <em>event</em> reports completion and before the
execution of any subsequent OpenCL work issued in <em>command_queue</em> begins.
If the context was created with properties specifying
<code>CL_CONTEXT_<wbr>INTEROP_<wbr>USER_<wbr>SYNC</code> as <code>CL_TRUE</code>, the user is responsible for
guaranteeing that any Direct3D 11 calls involving the interop device(s) used
in the OpenCL context made before <strong>clEnqueueAcquireD3D11ObjectsKHR</strong> is
called have completed before calling <strong>clEnqueueAcquireD3D11ObjectsKHR</strong>.</p>
</div>
<div class="paragraph">
<p><em>command_queue</em> is a valid command-queue.</p>
</div>
<div class="paragraph">
<p><em>num_objects</em> is the number of memory objects to be acquired in
<em>mem_objects</em>.</p>
</div>
<div class="paragraph">
<p><em>mem_objects</em> is a pointer to a list of OpenCL memory objects that were
created from Direct3D 11 resources.</p>
</div>
<div class="paragraph">
<p><em>event_wait_list</em> and <em>num_events_in_wait_list</em> specify events that need to
complete before this particular command can be executed.
If <em>event_wait_list</em> is <code>NULL</code>, then this particular command does not wait
on any event to complete.
If <em>event_wait_list</em> is <code>NULL</code>, <em>num_events_in_wait_list</em> must be 0.
If <em>event_wait_list</em> is not <code>NULL</code>, the list of events pointed to by
<em>event_wait_list</em> must be valid and <em>num_events_in_wait_list</em> must be
greater than 0.
The events specified in <em>event_wait_list</em> act as synchronization points.</p>
</div>
<div class="paragraph">
<p><em>event</em> returns an event object that identifies this command and
can be used to query or wait for this command to complete.
If <em>event</em> is <code>NULL</code> or the enqueue is unsuccessful, no event will be
created and therefore it will not be possible to query the status of this
command or to wait for this command to complete.
If <em>event_wait_list</em> and <em>event</em> are not <code>NULL</code>, <em>event</em> must not refer
to an element of the <em>event_wait_list</em> array.</p>
</div>
<div class="paragraph">
<p><strong>clEnqueueAcquireD3D11ObjectsKHR</strong> returns <code>CL_SUCCESS</code> if the function is
executed successfully.
If <em>num_objects</em> is 0 and <em>mem_objects</em> is <code>NULL</code> then the function does
nothing and returns <code>CL_SUCCESS</code>.
Otherwise it returns one of the following errors:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>CL_INVALID_<wbr>VALUE</code> if <em>num_objects</em> is zero and <em>mem_objects</em> is not a
<code>NULL</code> value or if <em>num_objects</em> &gt; 0 and <em>mem_objects</em> is <code>NULL</code>.</p>
</li>
<li>
<p><code>CL_INVALID_<wbr>MEM_<wbr>OBJECT</code> if memory objects in <em>mem_objects</em> are not valid
OpenCL memory objects or if memory objects in <em>mem_objects</em> have not
been created from Direct3D 11 resources.</p>
</li>
<li>
<p><code>CL_INVALID_<wbr>COMMAND_<wbr>QUEUE</code> if <em>command_queue</em> is not a valid
command-queue.</p>
</li>
<li>
<p><code>CL_INVALID_<wbr>CONTEXT</code> if context associated with <em>command_queue</em> was not
created from an Direct3D 11 context.</p>
</li>
<li>
<p><code>CL_D3D11_<wbr>RESOURCE_<wbr>ALREADY_<wbr>ACQUIRED_<wbr>KHR</code> if memory objects in
<em>mem_objects</em> have previously been acquired using
<strong>clEnqueueAcquireD3D11ObjectsKHR</strong> but have not been released using
<strong>clEnqueueReleaseD3D11ObjectsKHR</strong>.</p>
</li>
<li>
<p><code>CL_INVALID_<wbr>EVENT_<wbr>WAIT_<wbr>LIST</code> if <em>event_wait_list</em> is <code>NULL</code> and
<em>num_events_in_wait_list</em> &gt; 0, or <em>event_wait_list</em> is not <code>NULL</code> and
<em>num_events_in_wait_list</em> is 0, or if event objects in <em>event_wait_list</em>
are not valid events.</p>
</li>
<li>
<p><code>CL_OUT_<wbr>OF_<wbr>HOST_<wbr>MEMORY</code> if there is a failure to allocate resources
required by the OpenCL implementation on the host.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The function</p>
</div>
<div id="clEnqueueReleaseD3D11ObjectsKHR" class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="opencl"><span class="kt">cl_int</span> <span class="nf">clEnqueueReleaseD3D11ObjectsKHR</span><span class="p">(</span>
    <span class="kt">cl_command_queue</span> <span class="n">command_queue</span><span class="p">,</span>
    <span class="kt">cl_uint</span> <span class="n">num_objects</span><span class="p">,</span>
    <span class="k">const</span> <span class="kt">cl_mem</span><span class="o">*</span> <span class="n">mem_objects</span><span class="p">,</span>
    <span class="kt">cl_uint</span> <span class="n">num_events_in_wait_list</span><span class="p">,</span>
    <span class="k">const</span> <span class="kt">cl_event</span><span class="o">*</span> <span class="n">event_wait_list</span><span class="p">,</span>
    <span class="kt">cl_event</span><span class="o">*</span> <span class="n">event</span><span class="p">);</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>is used to release OpenCL memory objects that have been created from
Direct3D 11 resources.
The Direct3D 11 objects are released by the OpenCL context associated with
<em>command_queue</em>.</p>
</div>
<div class="paragraph">
<p>OpenCL memory objects created from Direct3D 11 resources which have been
acquired by OpenCL must be released by OpenCL before they may be accessed by
Direct3D 11.
Accessing a Direct3D 11 resource while its corresponding OpenCL memory
object is acquired is in error and will result in undefined behavior,
including but not limited to possible OpenCL errors, data corruption, and
program termination.</p>
</div>
<div class="paragraph">
<p>If <code>CL_CONTEXT_<wbr>INTEROP_<wbr>USER_<wbr>SYNC</code> is not specified as <code>CL_TRUE</code> during context
creation, <strong>clEnqueueReleaseD3D11ObjectsKHR</strong> provides the synchronization
guarantee that any calls to Direct3D 11 calls involving the interop
device(s) used in the OpenCL context made after the call to
<strong>clEnqueueReleaseD3D11ObjectsKHR</strong> will not start executing until after all
events in <em>event_wait_list</em> are complete and all work already submitted to
<em>command_queue</em> completes execution.
If the context was created with properties specifying
<code>CL_CONTEXT_<wbr>INTEROP_<wbr>USER_<wbr>SYNC</code> as <code>CL_TRUE</code>, the user is responsible for
guaranteeing that any Direct3D 11 calls involving the interop device(s) used
in the OpenCL context made after <strong>clEnqueueReleaseD3D11ObjectsKHR</strong> will not
start executing until after event returned by
<strong>clEnqueueReleaseD3D11ObjectsKHR</strong> reports completion.</p>
</div>
<div class="paragraph">
<p><em>num_objects</em> is the number of memory objects to be released in
<em>mem_objects</em>.</p>
</div>
<div class="paragraph">
<p><em>mem_objects</em> is a pointer to a list of OpenCL memory objects that were
created from Direct3D 11 resources.</p>
</div>
<div class="paragraph">
<p><em>event_wait_list</em> and <em>num_events_in_wait_list</em> specify events that need to
complete before this particular command can be executed.
If <em>event_wait_list</em> is <code>NULL</code>, then this particular command does not wait
on any event to complete.
If <em>event_wait_list</em> is <code>NULL</code>, <em>num_events_in_wait_list</em> must be 0.
If <em>event_wait_list</em> is not <code>NULL</code>, the list of events pointed to by
<em>event_wait_list</em> must be valid and <em>num_events_in_wait_list</em> must be
greater than 0.</p>
</div>
<div class="paragraph">
<p><em>event</em> returns an event object that identifies this command and
can be used to query or wait for this command to complete.
If <em>event</em> is <code>NULL</code> or the enqueue is unsuccessful, no event will be
created and therefore it will not be possible to query the status of this
command or to wait for this command to complete.
If <em>event_wait_list</em> and <em>event</em> are not <code>NULL</code>, <em>event</em> must not refer
to an element of the <em>event_wait_list</em> array.</p>
</div>
<div class="paragraph">
<p><strong>clEnqueueReleaseD3D11ObjectsKHR</strong> returns <code>CL_SUCCESS</code> if the function is
executed successfully.
If <em>num_objects</em> is 0 and <em>mem_objects</em> is <code>NULL</code> the function does nothing
and returns <code>CL_SUCCESS</code>.
Otherwise it returns one of the following errors:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>CL_INVALID_<wbr>VALUE</code> if <em>num_objects</em> is zero and <em>mem_objects</em> is not a
<code>NULL</code> value or if <em>num_objects</em> &gt; 0 and <em>mem_objects</em> is <code>NULL</code>.</p>
</li>
<li>
<p><code>CL_INVALID_<wbr>MEM_<wbr>OBJECT</code> if memory objects in <em>mem_objects</em> are not valid
OpenCL memory objects or if memory objects in <em>mem_objects</em> have not
been created from Direct3D 11 resources.</p>
</li>
<li>
<p><code>CL_INVALID_<wbr>COMMAND_<wbr>QUEUE</code> if <em>command_queue</em> is not a valid
command-queue.</p>
</li>
<li>
<p><code>CL_INVALID_<wbr>CONTEXT</code> if context associated with <em>command_queue</em> was not
created from a Direct3D 11 device.</p>
</li>
<li>
<p><code>CL_D3D11_<wbr>RESOURCE_<wbr>NOT_<wbr>ACQUIRED_<wbr>KHR</code> if memory objects in <em>mem_objects</em>
have not previously been acquired using
<strong>clEnqueueAcquireD3D11ObjectsKHR</strong>, or have been released using
<strong>clEnqueueReleaseD3D11ObjectsKHR</strong> since the last time that they were
acquired.</p>
</li>
<li>
<p><code>CL_INVALID_<wbr>EVENT_<wbr>WAIT_<wbr>LIST</code> if <em>event_wait_list</em> is <code>NULL</code> and
<em>num_events_in_wait_list</em> &gt; 0, or <em>event_wait_list</em> is not <code>NULL</code> and
<em>num_events_in_wait_list</em>&gt; is 0, or if event objects in
<em>event_wait_list</em> are not valid events.</p>
</li>
<li>
<p><code>CL_OUT_<wbr>OF_<wbr>HOST_<wbr>MEMORY</code> if there is a failure to allocate resources
required by the OpenCL implementation on the host.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="cl_khr_d3d11_sharing-event-command-types"><a class="anchor" href="#cl_khr_d3d11_sharing-event-command-types"></a>14.7.7. Event Command Types for Sharing memory objects that map to Direct3D 11 objects</h4>
<div class="paragraph">
<p>The following table describes the event command types for the OpenCL commands
to acquire and release OpenCL memory objects that have been created from
Direct3D 11 objects:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 37. List of supported event command types</caption>
<colgroup>
<col style="width: 40%;">
<col style="width: 60%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><strong>Events Created By</strong></th>
<th class="tableblock halign-left valign-top"><strong>Event Command Type</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>clEnqueueAcquireD3D11ObjectsKHR</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CL_COMMAND_<wbr>ACQUIRE_<wbr>D3D11_<wbr>OBJECTS_<wbr>KHR</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>clEnqueueReleaseD3D11ObjectsKHR</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CL_COMMAND_<wbr>RELEASE_<wbr>D3D11_<wbr>OBJECTS_<wbr>KHR</code></p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="cl_khr_dx9_media_sharing"><a class="anchor" href="#cl_khr_dx9_media_sharing"></a>15. Creating OpenCL Memory Objects from DirectX 9 Media Surfaces</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="cl_khr_dx9_media_sharing-overview"><a class="anchor" href="#cl_khr_dx9_media_sharing-overview"></a>15.1. Overview</h3>
<div class="paragraph">
<p>This section describes the <strong>cl_khr_dx9_media_sharing</strong> extension.
The goal of this extension is to allow applications to use media surfaces as
OpenCL memory objects.
This allows efficient sharing of data between OpenCL and selected adapter
APIs (only DX9 for now).
If this extension is supported, an OpenCL image object can be created from a
media surface and the OpenCL API can be used to execute kernels that read
and/or write memory objects that are media surfaces.
Note that OpenCL memory objects may be created from the adapter media
surface if and only if the OpenCL context has been created from that
adapter.</p>
</div>
</div>
<div class="sect2">
<h3 id="_general_information_14"><a class="anchor" href="#_general_information_14"></a>15.2. General information</h3>
<div class="sect3">
<h4 id="_version_history_14"><a class="anchor" href="#_version_history_14"></a>15.2.1. Version history</h4>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 60%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><strong>Date</strong></th>
<th class="tableblock halign-left valign-top"><strong>Version</strong></th>
<th class="tableblock halign-left valign-top"><strong>Description</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">2020-04-21</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.0.0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">First assigned version.</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect2">
<h3 id="cl_khr_dx9_media_sharing-new-procedures-and-functions"><a class="anchor" href="#cl_khr_dx9_media_sharing-new-procedures-and-functions"></a>15.3. New Procedures and Functions</h3>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="opencl"><span class="kt">cl_int</span> <span class="nf">clGetDeviceIDsFromDX9MediaAdapterKHR</span><span class="p">(</span>
                                    <span class="kt">cl_platform_id</span> <span class="n">platform</span><span class="p">,</span>
                                    <span class="kt">cl_uint</span> <span class="n">num_media_adapters</span><span class="p">,</span>
                                    <span class="kt">cl_dx9_media_adapter_type_khr</span> <span class="o">*</span><span class="n">media_adapters_type</span><span class="p">,</span>
                                    <span class="kt">void</span> <span class="o">*</span><span class="n">media_adapters</span><span class="p">,</span>
                                    <span class="kt">cl_dx9_media_adapter_set_khr</span> <span class="n">media_adapter_set</span><span class="p">,</span>
                                    <span class="kt">cl_uint</span> <span class="n">num_entries</span><span class="p">,</span>
                                    <span class="kt">cl_device_id</span> <span class="o">*</span><span class="n">devices</span><span class="p">,</span>
                                    <span class="kt">cl_int</span> <span class="o">*</span><span class="n">num_devices</span><span class="p">);</span>

<span class="kt">cl_mem</span> <span class="nf">clCreateFromDX9MediaSurfaceKHR</span><span class="p">(</span><span class="kt">cl_context</span> <span class="n">context</span><span class="p">,</span>
                                      <span class="kt">cl_mem_flags</span> <span class="n">flags</span><span class="p">,</span>
                                      <span class="kt">cl_dx9_media_adapter_type_khr</span> <span class="n">adapter_type</span><span class="p">,</span>
                                      <span class="kt">void</span> <span class="o">*</span><span class="n">surface_info</span><span class="p">,</span>
                                      <span class="kt">cl_uint</span> <span class="n">plane</span><span class="p">,</span>
                                      <span class="kt">cl_int</span> <span class="o">*</span><span class="n">errcode_ret</span><span class="p">);</span>

<span class="kt">cl_int</span> <span class="nf">clEnqueueAcquireDX9MediaSurfacesKHR</span><span class="p">(</span><span class="kt">cl_command_queue</span> <span class="n">command_queue</span><span class="p">,</span>
                                           <span class="kt">cl_uint</span> <span class="n">num_objects</span><span class="p">,</span>
                                           <span class="k">const</span> <span class="kt">cl_mem</span> <span class="o">*</span><span class="n">mem_objects</span><span class="p">,</span>
                                           <span class="kt">cl_uint</span> <span class="n">num_events_in_wait_list</span><span class="p">,</span>
                                           <span class="k">const</span> <span class="kt">cl_event</span> <span class="o">*</span><span class="n">event_wait_list</span><span class="p">,</span>
                                           <span class="kt">cl_event</span> <span class="o">*</span><span class="n">event</span><span class="p">);</span>

<span class="kt">cl_int</span> <span class="nf">clEnqueueReleaseDX9MediaSurfacesKHR</span><span class="p">(</span><span class="kt">cl_command_queue</span> <span class="n">command_queue</span><span class="p">,</span>
                                           <span class="kt">cl_uint</span> <span class="n">num_objects</span><span class="p">,</span>
                                           <span class="k">const</span> <span class="kt">cl_mem</span> <span class="o">*</span><span class="n">mem_objects</span><span class="p">,</span>
                                           <span class="kt">cl_uint</span> <span class="n">num_events_in_wait_list</span><span class="p">,</span>
                                           <span class="k">const</span> <span class="kt">cl_event</span> <span class="o">*</span><span class="n">event_wait_list</span><span class="p">,</span>
                                           <span class="kt">cl_event</span> <span class="o">*</span><span class="n">event</span><span class="p">);</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="cl_khr_dx9_media_sharing-new-tokens"><a class="anchor" href="#cl_khr_dx9_media_sharing-new-tokens"></a>15.4. New Tokens</h3>
<div class="paragraph">
<p>Accepted by the <em>media_adapter_type</em> parameter of
<strong>clGetDeviceIDsFromDX9MediaAdapterKHR</strong>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="opencl"><span class="n">CL_ADAPTER_D3D9_KHR</span>
<span class="n">CL_ADAPTER_D3D9EX_KHR</span>
<span class="n">CL_ADAPTER_DXVA_KHR</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Accepted by the <em>media_adapter_set</em> parameter of
<strong>clGetDeviceIDsFromDX9MediaAdapterKHR</strong>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="opencl"><span class="n">CL_PREFERRED_DEVICES_FOR_DX9_MEDIA_ADAPTER_KHR</span>
<span class="n">CL_ALL_DEVICES_FOR_DX9_MEDIA_ADAPTER_KHR</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Accepted as a property name in the <em>properties</em> parameter of
<strong>clCreateContext</strong> and <strong>clCreateContextFromType</strong>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="opencl"><span class="n">CL_CONTEXT_ADAPTER_D3D9_KHR</span>
<span class="n">CL_CONTEXT_ADAPTER_D3D9EX_KHR</span>
<span class="n">CL_CONTEXT_ADAPTER_DXVA_KHR</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Accepted as the property being queried in the <em>param_name</em> parameter of
<strong>clGetMemObjectInfo</strong>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="opencl"><span class="n">CL_MEM_DX9_MEDIA_ADAPTER_TYPE_KHR</span>
<span class="n">CL_MEM_DX9_MEDIA_SURFACE_INFO_KHR</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Accepted as the property being queried in the <em>param_name</em> parameter of
<strong>clGetImageInfo</strong>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="opencl"><span class="n">CL_IMAGE_DX9_MEDIA_PLANE_KHR</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Returned in the <em>param_value</em> parameter of <strong>clGetEventInfo</strong> when
<em>param_name</em> is <code>CL_EVENT_<wbr>COMMAND_<wbr>TYPE</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="opencl"><span class="n">CL_COMMAND_ACQUIRE_DX9_MEDIA_SURFACES_KHR</span>
<span class="n">CL_COMMAND_RELEASE_DX9_MEDIA_SURFACES_KHR</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Returned by <strong>clCreateContext</strong> and <strong>clCreateContextFromType</strong> if the media
adapter specified for interoperability is not compatible with the devices
against which the context is to be created:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="opencl"><span class="n">CL_INVALID_DX9_MEDIA_ADAPTER_KHR</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Returned by <strong>clCreateFromDX9MediaSurfaceKHR</strong> when <em>adapter_type</em> is set to a
media adapter and the <em>surface_info</em> does not reference a media surface of
the required type, or if <em>adapter_type</em> is set to a media adapter type and
<em>surface_info</em> does not contain a valid reference to a media surface on that
adapter, by <strong>clGetMemObjectInfo</strong> when <em>param_name</em> is a surface or handle
when the image was not created from an appropriate media surface, and from
<strong>clGetImageInfo</strong> when <em>param_name</em> is CL IMAGE_DX9_MEDIA_PLANE KHR and image
was not created from an appropriate media surface.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="opencl"><span class="n">CL_INVALID_DX9_MEDIA_SURFACE_KHR</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Returned by <strong>clEnqueueAcquireDX9MediaSurfacesKHR</strong> when any of <em>mem_objects</em>
are currently acquired by OpenCL:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="opencl"><span class="n">CL_DX9_MEDIA_SURFACE_ALREADY_ACQUIRED_KHR</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Returned by <strong>clEnqueueReleaseDX9MediaSurfacesKHR</strong> when any of <em>mem_objects</em>
are not currently acquired by OpenCL:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="opencl"><span class="n">CL_DX9_MEDIA_SURFACE_NOT_ACQUIRED_KHR</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="cl_khr_dx9_media_sharing-additions-to-chapter-4"><a class="anchor" href="#cl_khr_dx9_media_sharing-additions-to-chapter-4"></a>15.5. Additions to Chapter 4 of the OpenCL 2.2 Specification</h3>
<div class="paragraph">
<p>In <em>section 4.4</em>, replace the description of <em>properties</em> under
<strong>clCreateContext</strong> with:</p>
</div>
<div class="paragraph">
<p>&#8220;_properties_ specifies a list of context property names and their
corresponding values.
Each property is followed immediately by the corresponding desired value.
The list is terminated with zero.
If a property is not specified in <em>properties</em>, then its default value
(listed in <em>table 4.5</em>) is used (it is said to be specified implicitly).
If <em>properties</em> is <code>NULL</code> or empty (points to a list whose first value is
zero), all attributes take on their default values.&#8221;</p>
</div>
<div class="paragraph">
<p>Add the following to <em>table 4.5</em>:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><strong>cl_context_properties enum</strong></th>
<th class="tableblock halign-left valign-top"><strong>Property value</strong></th>
<th class="tableblock halign-left valign-top"><strong>Description</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CL_CONTEXT_<wbr>ADAPTER_<wbr>D3D9_<wbr>KHR</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">IDirect3DDevice9 *</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Specifies an IDirect3DDevice9 to use for D3D9 interop.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CL_CONTEXT_<wbr>ADAPTER_<wbr>D3D9EX_<wbr>KHR</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">IDirect3DDeviceEx*</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Specifies an IDirect3DDevice9Ex to use for D3D9 interop.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CL_CONTEXT_<wbr>ADAPTER_<wbr>DXVA_<wbr>KHR</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">IDXVAHD_Device *</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Specifies an IDXVAHD_Device to use for DXVA interop.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Add to the list of errors for <strong>clCreateContext</strong>:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>CL_INVALID_<wbr>DX9_<wbr>MEDIA_<wbr>ADAPTER_<wbr>KHR</code> if any of the values of the properties
<code>CL_CONTEXT_<wbr>ADAPTER_<wbr>D3D9_<wbr>KHR</code>, <code>CL_CONTEXT_<wbr>ADAPTER_<wbr>D3D9EX_<wbr>KHR</code> or
<code>CL_CONTEXT_<wbr>ADAPTER_<wbr>DXVA_<wbr>KHR</code> is non-<code>NULL</code> and does not specify a valid
media adapter with which the <em>cl_device_ids</em> against which this context
is to be created may interoperate.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Add to the list of errors for <strong>clCreateContextFromType</strong> the same new errors
described above for <strong>clCreateContext</strong>.</p>
</div>
</div>
<div class="sect2">
<h3 id="cl_khr_dx9_media_sharing-additions-to-chapter-5"><a class="anchor" href="#cl_khr_dx9_media_sharing-additions-to-chapter-5"></a>15.6. Additions to Chapter 5 of the OpenCL 2.2 Specification</h3>
<div class="paragraph">
<p>Add to the list of errors for <strong>clGetMemObjectInfo</strong>:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>CL_INVALID_<wbr>DX9_<wbr>MEDIA_<wbr>SURFACE_<wbr>KHR</code> if <em>param_name</em> is
<code>CL_MEM_<wbr>DX9_<wbr>MEDIA_<wbr>SURFACE_<wbr>INFO_<wbr>KHR</code> and <em>memobj</em> was not created by the
function <strong>clCreateFromDX9MediaSurfaceKHR</strong> from a Direct3D9 surface.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Extend <em>table 5.12</em> to include the following entry:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><strong>cl_mem_info</strong></th>
<th class="tableblock halign-left valign-top"><strong>Return type</strong></th>
<th class="tableblock halign-left valign-top"><strong>Info. returned in <em>param_value</em></strong></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CL_MEM_<wbr>DX9_<wbr>MEDIA_<wbr>ADAPTER_<wbr>TYPE_<wbr>KHR</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>cl_dx9_<wbr>media_<wbr>adapter_<wbr>type_<wbr>khr</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Returns the <code>cl_dx9_<wbr>media_<wbr>adapter_<wbr>type_<wbr>khr</code> argument value specified when
  <em>memobj</em> is created using <strong>clCreateFromDX9MediaSurfaceKHR</strong>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CL_MEM_<wbr>DX9_<wbr>MEDIA_<wbr>SURFACE_<wbr>INFO_<wbr>KHR</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>cl_dx9_<wbr>surface_<wbr>info_<wbr>khr</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Returns the <code>cl_dx9_<wbr>surface_<wbr>info_<wbr>khr</code> argument value specified when
  <em>memobj</em> is created using <strong>clCreateFromDX9MediaSurfaceKHR</strong>.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Add to the list of errors for <strong>clGetImageInfo</strong>:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>CL_INVALID_<wbr>DX9_<wbr>MEDIA_<wbr>SURFACE_<wbr>KHR</code> if <em>param_name</em> is
<code>CL_IMAGE_<wbr>DX9_<wbr>MEDIA_<wbr>PLANE_<wbr>KHR</code> and <em>image</em> was not created by the function
<strong>clCreateFromDX9MediaSurfaceKHR</strong>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Extend <em>table 5.9</em> to include the following entry.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><strong>cl_image_info</strong></th>
<th class="tableblock halign-left valign-top"><strong>Return type</strong></th>
<th class="tableblock halign-left valign-top"><strong>Info. returned in <em>param_value</em></strong></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CL_IMAGE_<wbr>DX9_<wbr>MEDIA_<wbr>PLANE_<wbr>KHR</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>cl_uint</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Returns the <em>plane</em> argument value specified when <em>memobj</em> is created
  using <strong>clCreateFromDX9MediaSurfaceKHR</strong>.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Add to <em>table 5.22</em> in the <strong>Info returned in param_value</strong> column for
<em>cl_event_info</em> = <code>CL_EVENT_<wbr>COMMAND_<wbr>TYPE</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="opencl"><span class="n">CL_COMMAND_ACQUIRE_DX9_MEDIA_SURFACES_KHR</span>
<span class="n">CL_COMMAND_RELEASE_DX9_MEDIA_SURFACES_KHR</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="cl_khr_dx9_media_sharing-sharing-media-surfaces-with-opencl"><a class="anchor" href="#cl_khr_dx9_media_sharing-sharing-media-surfaces-with-opencl"></a>15.7. Sharing Media Surfaces with OpenCL</h3>
<div class="paragraph">
<p>This section discusses OpenCL functions that allow applications to use media
surfaces as OpenCL memory objects.
This allows efficient sharing of data between OpenCL and media surface APIs.
The OpenCL API may be used to execute kernels that read and/or write memory
objects that are also media surfaces.
An OpenCL image object may be created from a media surface.
OpenCL memory objects may be created from media surfaces if and only if the
OpenCL context has been created from a media adapter.</p>
</div>
<div class="sect3">
<h4 id="cl_khr_dx9_media_sharing-querying-opencl-devices-corresponding-to-media-adapters"><a class="anchor" href="#cl_khr_dx9_media_sharing-querying-opencl-devices-corresponding-to-media-adapters"></a>15.7.1. Querying OpenCL Devices corresponding to Media Adapters</h4>
<div class="paragraph">
<p>Media adapters are an abstraction associated with devices that provide media
capabilities.</p>
</div>
<div class="paragraph">
<p>The function</p>
</div>
<div id="clGetDeviceIDsFromDX9MediaAdapterKHR" class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="opencl"><span class="kt">cl_int</span> <span class="nf">clGetDeviceIDsFromDX9MediaAdapterKHR</span><span class="p">(</span>
    <span class="kt">cl_platform_id</span> <span class="n">platform</span><span class="p">,</span>
    <span class="kt">cl_uint</span> <span class="n">num_media_adapters</span><span class="p">,</span>
    <span class="kt">cl_dx9_media_adapter_type_khr</span><span class="o">*</span> <span class="n">media_adapter_type</span><span class="p">,</span>
    <span class="kt">void</span><span class="o">*</span> <span class="n">media_adapters</span><span class="p">,</span>
    <span class="kt">cl_dx9_media_adapter_set_khr</span> <span class="n">media_adapter_set</span><span class="p">,</span>
    <span class="kt">cl_uint</span> <span class="n">num_entries</span><span class="p">,</span>
    <span class="kt">cl_device_id</span><span class="o">*</span> <span class="n">devices</span><span class="p">,</span>
    <span class="kt">cl_uint</span><span class="o">*</span> <span class="n">num_devices</span><span class="p">);</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>queries a media adapter for any associated OpenCL devices.
Adapters with associated OpenCL devices can enable media surface sharing
between the two.</p>
</div>
<div class="paragraph">
<p><em>platform</em> refers to the platform ID returned by <strong>clGetPlatformIDs</strong>.</p>
</div>
<div class="paragraph">
<p><em>num_media_adapters</em> specifies the number of media adapters.</p>
</div>
<div class="paragraph">
<p><em>media_adapters_type</em> is an array of <em>num_media_adapters</em> entries.
Each entry specifies the type of media adapter and must be one of the values
described in the table below.</p>
</div>
<table id="cl_khr_dx9_media_sharing-media-adapter-types" class="tableblock frame-all grid-all stretch">
<caption class="title">Table 38. DirectX 9 object types that may be used by <strong>clGetDeviceIDsFromDX9MediaAdapterKHR</strong></caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><code>cl_dx9_<wbr>media_<wbr>adapter_<wbr>type_<wbr>khr</code></th>
<th class="tableblock halign-left valign-top">Type of media adapter</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CL_ADAPTER_<wbr>D3D9_<wbr>KHR</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">IDirect3DDevice9 *</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CL_ADAPTER_<wbr>D3D9EX_<wbr>KHR</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">IDirect3DDevice9Ex *</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CL_ADAPTER_<wbr>DXVA_<wbr>KHR</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">IDXVAHD_Device *</p></td>
</tr>
</tbody>
</table>
<table id="cl_khr_dx9_media_sharing-media-adapter-sets" class="tableblock frame-all grid-all stretch">
<caption class="title">Table 39. Sets of devices queriable using <strong>clGetDeviceIDsFromDX9MediaAdapterKHR</strong></caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><code>cl_dx9_<wbr>media_<wbr>adapter_<wbr>set_<wbr>khr</code></th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CL_PREFERRED_<wbr>DEVICES_<wbr>FOR_<wbr>DX9_<wbr>MEDIA_<wbr>ADAPTER_<wbr>KHR</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The preferred OpenCL devices associated with the media adapter.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CL_ALL_<wbr>DEVICES_<wbr>FOR_<wbr>DX9_<wbr>MEDIA_<wbr>ADAPTER_<wbr>KHR</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">All OpenCL devices that may interoperate with the media adapter</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><em>media_adapters</em> is an array of <em>num_media_adapters</em> entries.
Each entry specifies the actual adapter whose type is specified by
<em>media_adapter_type</em>.
The <em>media_adapters</em> must be one of the types described in the table
<a href="#cl_khr_dx9_media_sharing-media-adapter-types"><em>cl_dx9_media_adapter_type_khr
values</em></a>.
<em>media_adapter_set</em> specifies the set of adapters to return and must be one
of the values described in the table
&lt;&lt;[[cl_khr_dx9_media_sharing-media-adapter-sets,<em>cl_dx9_media_adapter_set_khr
values</em>&gt;&gt;.</p>
</div>
<div class="paragraph">
<p><em>num_entries</em> is the number of <code>cl_device_<wbr>id</code> entries that can be added to
<em>devices</em>.
If <em>devices</em> is not <code>NULL</code>, the <em>num_entries</em> must be greater than zero.</p>
</div>
<div class="paragraph">
<p><em>devices</em> returns a list of OpenCL devices found that support the list of
media adapters specified.
The <code>cl_device_<wbr>id</code> values returned in <em>devices</em> can be used to identify a
specific OpenCL device.
If <em>devices</em> argument is <code>NULL</code>, this argument is ignored.
The number of OpenCL devices returned is the minimum of the value specified
by <em>num_entries</em> or the number of OpenCL devices whose type matches
<em>device_type</em>.</p>
</div>
<div class="paragraph">
<p><em>num_devices</em> returns the number of OpenCL devices.
If <em>num_devices</em> is <code>NULL</code>, this argument is ignored.</p>
</div>
<div class="paragraph">
<p><strong>clGetDeviceIDsFromDX9MediaAdapterKHR</strong> returns <code>CL_SUCCESS</code> if the function is
executed successfully.
Otherwise, it returns one of the following errors:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>CL_INVALID_<wbr>PLATFORM</code> if <em>platform</em> is not a valid platform.</p>
</li>
<li>
<p><code>CL_INVALID_<wbr>VALUE</code> if <em>num_media_adapters</em> is zero or if
<em>media_adapters_type</em> is <code>NULL</code> or if <em>media_adapters</em> is <code>NULL</code>.</p>
</li>
<li>
<p><code>CL_INVALID_<wbr>VALUE</code> if any of the entries in <em>media_adapters_type</em> or
<em>media_adapters</em> is not a valid value.</p>
</li>
<li>
<p><code>CL_INVALID_<wbr>VALUE</code> if <em>media_adapter_set</em> is not a valid value.</p>
</li>
<li>
<p><code>CL_INVALID_<wbr>VALUE</code> if <em>num_entries</em> is equal to zero and <em>devices</em> is not
<code>NULL</code> or if both <em>num_devices</em> and <em>devices</em> are <code>NULL</code>.</p>
</li>
<li>
<p><code>CL_DEVICE_<wbr>NOT_<wbr>FOUND</code> if no OpenCL devices that correspond to adapters
specified in <em>media_adapters</em> and <em>media_adapters_type</em> were found.</p>
</li>
<li>
<p><code>CL_OUT_<wbr>OF_<wbr>RESOURCES</code> if there is a failure to allocate resources required
by the OpenCL implementation on the device.</p>
</li>
<li>
<p><code>CL_OUT_<wbr>OF_<wbr>HOST_<wbr>MEMORY</code> if there is a failure to allocate resources
required by the OpenCL implementation on the host.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="cl_khr_dx9_media_sharing-creating-media-resources-as-opencl-image-objects"><a class="anchor" href="#cl_khr_dx9_media_sharing-creating-media-resources-as-opencl-image-objects"></a>15.7.2. Creating Media Resources as OpenCL Image Objects</h4>
<div class="paragraph">
<p>The function</p>
</div>
<div id="clCreateFromDX9MediaSurfaceKHR" class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="opencl"><span class="kt">cl_mem</span> <span class="nf">clCreateFromDX9MediaSurfaceKHR</span><span class="p">(</span>
    <span class="kt">cl_context</span> <span class="n">context</span><span class="p">,</span>
    <span class="kt">cl_mem_flags</span> <span class="n">flags</span><span class="p">,</span>
    <span class="kt">cl_dx9_media_adapter_type_khr</span> <span class="n">adapter_type</span><span class="p">,</span>
    <span class="kt">void</span><span class="o">*</span> <span class="n">surface_info</span><span class="p">,</span>
    <span class="kt">cl_uint</span> <span class="n">plane</span><span class="p">,</span>
    <span class="kt">cl_int</span><span class="o">*</span> <span class="n">errcode_ret</span><span class="p">);</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>creates an OpenCL image object from a media surface.</p>
</div>
<div class="paragraph">
<p><em>context</em> is a valid OpenCL context created from a media adapter.</p>
</div>
<div class="paragraph">
<p>flags is a bit-field that is used to specify usage information.
Refer to <em>table 5.3</em> for a description of flags.
Only <code>CL_MEM_<wbr>READ_<wbr>ONLY</code>, <code>CL_MEM_<wbr>WRITE_<wbr>ONLY</code> and <code>CL_MEM_<wbr>READ_<wbr>WRITE</code> values
specified in <em>table 5.3</em> can be used.</p>
</div>
<div class="paragraph">
<p><em>adapter_type</em> is a value from enumeration of supported adapters described
in the table
<a href="#cl_khr_dx9_media_sharing-media-adapter-types"><em>cl_dx9_media_adapter_type_khr
values</em></a>.
The type of <em>surface_info</em> is determined by the adapter type.
The implementation does not need to support all adapter types.
This approach provides flexibility to support additional adapter types in
the future.
Supported adapter types are <code>CL_ADAPTER_<wbr>D3D9_<wbr>KHR</code>, <code>CL_ADAPTER_<wbr>D3D9EX_<wbr>KHR</code> and
<code>CL_ADAPTER_<wbr>DXVA_<wbr>KHR</code>.</p>
</div>
<div class="paragraph">
<p>If <em>adapter_type</em> is <code>CL_ADAPTER_<wbr>D3D9_<wbr>KHR</code>, <code>CL_ADAPTER_<wbr>D3D9EX_<wbr>KHR</code> and
<code>CL_ADAPTER_<wbr>DXVA_<wbr>KHR</code>, the <em>surface_info</em> points to the following structure:</p>
</div>
<div id="cl_dx9_surface_info_khr" class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="opencl"><span class="k">typedef</span> <span class="k">struct</span> <span class="nc">cl_dx9_surface_info_khr</span> <span class="p">{</span>
    <span class="n">IDirect3DSurface9</span><span class="o">*</span>    <span class="n">resource</span><span class="p">;</span>
    <span class="n">HANDLE</span>                <span class="n">shared_handle</span><span class="p">;</span>
<span class="p">}</span> <span class="kt">cl_dx9_surface_info_khr</span><span class="p">;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>For DX9 surfaces, we need both the handle to the resource and the resource
itself to have a sufficient amount of information to eliminate a copy of the
surface for sharing in cases where this is possible.
Elimination of the copy is driver dependent.
<em>shared_handle</em> may be <code>NULL</code> and this may result in sub-optimal
performance.</p>
</div>
<div class="paragraph">
<p><em>surface_info</em> is a pointer to one of the structures defined in the
<em>adapter_type</em> description above passed in as a void *.</p>
</div>
<div class="paragraph">
<p><em>plane</em> is the plane of resource to share for planar surface formats.
For planar formats, we use the plane parameter to obtain a handle to thie
specific plane (Y, U or V for example).
For non-planar formats used by media, <em>plane</em> must be 0.</p>
</div>
<div class="paragraph">
<p><em>errcode_ret</em> will return an appropriate error code.
If <em>errcode_ret</em> is <code>NULL</code>, no error code is returned.</p>
</div>
<div class="paragraph">
<p><strong>clCreateFromDX9MediaSurfaceKHR</strong> returns a valid non-zero 2D image object
and <em>errcode_ret</em> is set to <code>CL_SUCCESS</code> if the 2D image object is created
successfully.
Otherwise it returns a <code>NULL</code> value with one of the following error values
returned in <em>errcode_ret</em>:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>CL_INVALID_<wbr>CONTEXT</code> if <em>context</em> is not a valid context.</p>
</li>
<li>
<p><code>CL_INVALID_<wbr>VALUE</code> if values specified in <em>flags</em> are not valid or if
<em>plane</em> is not a valid plane of <em>resource</em> specified in <em>surface_info</em>.</p>
</li>
<li>
<p><code>CL_INVALID_<wbr>DX9_<wbr>MEDIA_<wbr>SURFACE_<wbr>KHR</code> if <em>resource</em> specified in
<em>surface_info</em> is not a valid resource or is not associated with
<em>adapter_type</em> (e.g., <em>adapter_type</em> is set to <code>CL_ADAPTER_<wbr>D3D9_<wbr>KHR</code> and
<em>resource</em> is not a Direct3D 9 surface created in D3DPOOL_DEFAULT).</p>
</li>
<li>
<p><code>CL_INVALID_<wbr>DX9_<wbr>MEDIA_<wbr>SURFACE_<wbr>KHR</code> if <em>shared_handle</em> specified in
<em>surface_info</em> is not <code>NULL</code> or a valid handle value.</p>
</li>
<li>
<p><code>CL_INVALID_<wbr>IMAGE_<wbr>FORMAT_<wbr>DESCRIPTOR</code> if the texture format of <em>resource</em>
is not listed in <a href="#cl_khr_dx9_media_sharing-fourcc-image-formats"><em>YUV
FourCC codes and corresponding OpenCL image format</em></a> or
<a href="#cl_khr_dx9_media_sharing-d3d-image-formats"><em>Direct3D formats and
corresponding OpenCL image formats</em></a>.</p>
</li>
<li>
<p><code>CL_INVALID_<wbr>OPERATION</code> if there are no devices in <em>context</em> that support
<em>adapter_type</em>.</p>
</li>
<li>
<p><code>CL_OUT_<wbr>OF_<wbr>RESOURCES</code> if there is a failure to allocate resources required
by the OpenCL implementation on the device.</p>
</li>
<li>
<p><code>CL_OUT_<wbr>OF_<wbr>HOST_<wbr>MEMORY</code> if there is a failure to allocate resources
required by the OpenCL implementation on the host.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The width and height of the returned OpenCL 2D image object are determined
by the width and height of the plane of resource.
The channel type and order of the returned image object is determined by the
format and plane of resource and are described in the table
<a href="#cl_khr_dx9_media_sharing-fourcc-image-formats"><em>YUV FourCC codes and
corresponding OpenCL image format</em></a> or
<a href="#cl_khr_dx9_media_sharing-d3d-image-formats"><em>Direct3D formats and
corresponding OpenCL image formats</em></a>.</p>
</div>
<div class="paragraph">
<p>This call will increment the internal media surface count on <em>resource</em>.
The internal media surface reference count on <em>resource</em> will be decremented
when the OpenCL reference count on the returned OpenCL memory object drops
to zero.</p>
</div>
</div>
<div class="sect3">
<h4 id="cl_khr_dx9_media_sharing-querying-media-surface-properties-of-memory-objects-created-from-media-surfaces"><a class="anchor" href="#cl_khr_dx9_media_sharing-querying-media-surface-properties-of-memory-objects-created-from-media-surfaces"></a>15.7.3. Querying Media Surface Properties of Memory Objects created from Media Surfaces</h4>
<div class="paragraph">
<p>Properties of media surface objects may be queried using
<strong>clGetMemObjectInfo</strong> and <strong>clGetImageInfo</strong> with <em>param_name</em>
<code>CL_MEM_<wbr>DX9_<wbr>MEDIA_<wbr>ADAPTER_<wbr>TYPE_<wbr>KHR</code>, <code>CL_MEM_<wbr>DX9_<wbr>MEDIA_<wbr>SURFACE_<wbr>INFO_<wbr>KHR</code> and
<code>CL_IMAGE_<wbr>DX9_<wbr>MEDIA_<wbr>PLANE_<wbr>KHR</code> as described in <em>sections 5.4.3</em> and <em>5.3.6</em>.</p>
</div>
</div>
<div class="sect3">
<h4 id="cl_khr_dx9_media_sharing-sharing-memory-objects-created-from-media-surfaces-between-a-media-adapter-and-opencl"><a class="anchor" href="#cl_khr_dx9_media_sharing-sharing-memory-objects-created-from-media-surfaces-between-a-media-adapter-and-opencl"></a>15.7.4. Sharing Memory Objects created from Media Surfaces between a Media Adapter and OpenCL</h4>
<div class="paragraph">
<p>The function</p>
</div>
<div id="clEnqueueAcquireDX9MediaSurfacesKHR" class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="opencl"><span class="kt">cl_int</span> <span class="nf">clEnqueueAcquireDX9MediaSurfacesKHR</span><span class="p">(</span>
    <span class="kt">cl_command_queue</span> <span class="n">command_queue</span><span class="p">,</span>
    <span class="kt">cl_uint</span> <span class="n">num_objects</span><span class="p">,</span>
    <span class="k">const</span> <span class="kt">cl_mem</span><span class="o">*</span> <span class="n">mem_objects</span><span class="p">,</span>
    <span class="kt">cl_uint</span> <span class="n">num_events_in_wait_list</span><span class="p">,</span>
    <span class="k">const</span> <span class="kt">cl_event</span><span class="o">*</span> <span class="n">event_wait_list</span><span class="p">,</span>
    <span class="kt">cl_event</span><span class="o">*</span> <span class="n">event</span><span class="p">);</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>is used to acquire OpenCL memory objects that have been created from a media
surface.
The media surfaces are acquired by the OpenCL context associated with
<em>command_queue</em> and can therefore be used by all command-queues associated
with the OpenCL context.</p>
</div>
<div class="paragraph">
<p>OpenCL memory objects created from media surfaces must be acquired before
they can be used by any OpenCL commands queued to a command-queue.
If an OpenCL memory object created from a media surface is used while it is
not currently acquired by OpenCL, the call attempting to use that OpenCL
memory object will return <code>CL_DX9_<wbr>MEDIA_<wbr>SURFACE_<wbr>NOT_<wbr>ACQUIRED_<wbr>KHR</code>.</p>
</div>
<div class="paragraph">
<p>If <code>CL_CONTEXT_<wbr>INTEROP_<wbr>USER_<wbr>SYNC</code> is not specified as <code>CL_TRUE</code> during context
creation, <strong>clEnqueueAcquireDX9MediaSurfacesKHR</strong> provides the synchronization
guarantee that any media adapter API calls involving the interop device(s)
used in the OpenCL context made before <strong>clEnqueueAcquireDX9MediaSurfacesKHR</strong>
is called will complete executing before <em>event</em> reports completion and
before the execution of any subsequent OpenCL work issued in <em>command_queue</em>
begins.
If the context was created with properties specifying
<code>CL_CONTEXT_<wbr>INTEROP_<wbr>USER_<wbr>SYNC</code> as <code>CL_TRUE</code>, the user is responsible for
guaranteeing that any media adapter API calls involving the interop
device(s) used in the OpenCL context made before
<strong>clEnqueueAcquireDX9MediaSurfacesKHR</strong> is called have completed before
calling <strong>clEnqueueAcquireDX9MediaSurfacesKHR</strong> <strong>.</strong></p>
</div>
<div class="paragraph">
<p><em>command_queue</em> is a valid command-queue.</p>
</div>
<div class="paragraph">
<p><em>num_objects</em> is the number of memory objects to be acquired in
<em>mem_objects</em>.</p>
</div>
<div class="paragraph">
<p><em>mem_objects</em> is a pointer to a list of OpenCL memory objects that were
created from media surfaces.</p>
</div>
<div class="paragraph">
<p><em>event_wait_list</em> and <em>num_events_in_wait_list</em> specify events that need to
complete before this particular command can be executed.
If <em>event_wait_list</em> is <code>NULL</code>, then this particular command does not wait
on any event to complete.
If <em>event_wait_list</em> is <code>NULL</code>, <em>num_events_in_wait_list</em> must be 0.
If <em>event_wait_list</em> is not <code>NULL</code>, the list of events pointed to by
<em>event_wait_list</em> must be valid and <em>num_events_in_wait_list</em> must be
greater than 0.
The events specified in <em>event_wait_list</em> act as synchronization points.</p>
</div>
<div class="paragraph">
<p><em>event</em> returns an event object that identifies this command and
can be used to query or wait for this command to complete.
If <em>event</em> is <code>NULL</code> or the enqueue is unsuccessful, no event will be
created and therefore it will not be possible to query the status of this
command or to wait for this command to complete.
If <em>event_wait_list</em> and <em>event</em> are not <code>NULL</code>, <em>event</em> must not refer
to an element of the <em>event_wait_list</em> array.</p>
</div>
<div class="paragraph">
<p><strong>clEnqueueAcquireDX9MediaSurfacesKHR</strong> returns <code>CL_SUCCESS</code> if the function is
executed successfully.
If <em>num_objects</em> is 0 and <em>mem_objects</em> is <code>NULL</code> then the function does
nothing and returns <code>CL_SUCCESS</code>.
Otherwise it returns one of the following errors:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>CL_INVALID_<wbr>VALUE</code> if <em>num_objects</em> is zero and <em>mem_objects</em> is not a
<code>NULL</code> value or if <em>num_objects</em> &gt; 0 and <em>mem_objects</em> is <code>NULL</code>.</p>
</li>
<li>
<p><code>CL_INVALID_<wbr>MEM_<wbr>OBJECT</code> if memory objects in <em>mem_objects</em> are not valid
OpenCL memory objects or if memory objects in <em>mem_objects</em> have not
been created from media surfaces.</p>
</li>
<li>
<p><code>CL_INVALID_<wbr>COMMAND_<wbr>QUEUE</code> if <em>command_queue</em> is not a valid
command-queue.</p>
</li>
<li>
<p><code>CL_INVALID_<wbr>CONTEXT</code> if context associated with <em>command_queue</em> was not
created from a device that can share the media surface referenced by
<em>mem_objects</em>.</p>
</li>
<li>
<p><code>CL_DX9_<wbr>MEDIA_<wbr>SURFACE_<wbr>ALREADY_<wbr>ACQUIRED_<wbr>KHR</code> if memory objects in
<em>mem_objects</em> have previously been acquired using
<strong>clEnqueueAcquireDX9MediaSurfacesKHR</strong> but have not been released using
<strong>clEnqueueReleaseDX9MediaSurfacesKHR</strong>.</p>
</li>
<li>
<p><code>CL_INVALID_<wbr>EVENT_<wbr>WAIT_<wbr>LIST</code> if <em>event_wait_list</em> is <code>NULL</code> and
<em>num_events_in_wait_list</em> &gt; 0, or <em>event_wait_list</em> is not <code>NULL</code> and
<em>num_events_in_wait_list</em> is 0, or if event objects in <em>event_wait_list</em>
are not valid events.</p>
</li>
<li>
<p><code>CL_OUT_<wbr>OF_<wbr>HOST_<wbr>MEMORY</code> if there is a failure to allocate resources
required by the OpenCL implementation on the host.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The function</p>
</div>
<div id="clEnqueueReleaseDX9MediaSurfacesKHR" class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="opencl"><span class="kt">cl_int</span> <span class="nf">clEnqueueReleaseDX9MediaSurfacesKHR</span><span class="p">(</span>
    <span class="kt">cl_command_queue</span> <span class="n">command_queue</span><span class="p">,</span>
    <span class="kt">cl_uint</span> <span class="n">num_objects</span><span class="p">,</span>
    <span class="k">const</span> <span class="kt">cl_mem</span><span class="o">*</span> <span class="n">mem_objects</span><span class="p">,</span>
    <span class="kt">cl_uint</span> <span class="n">num_events_in_wait_list</span><span class="p">,</span>
    <span class="k">const</span> <span class="kt">cl_event</span><span class="o">*</span> <span class="n">event_wait_list</span><span class="p">,</span>
    <span class="kt">cl_event</span><span class="o">*</span> <span class="n">event</span><span class="p">);</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>is used to release OpenCL memory objects that have been created from media
surfaces.
The media surfaces are released by the OpenCL context associated with
<em>command_queue</em>.</p>
</div>
<div class="paragraph">
<p>OpenCL memory objects created from media surfaces which have been acquired
by OpenCL must be released by OpenCL before they may be accessed by the
media adapter API.
Accessing a media surface while its corresponding OpenCL memory object is
acquired is in error and will result in undefined behavior, including but
not limited to possible OpenCL errors, data corruption, and program
termination.</p>
</div>
<div class="paragraph">
<p>If <code>CL_CONTEXT_<wbr>INTEROP_<wbr>USER_<wbr>SYNC</code> is not specified as <code>CL_TRUE</code> during context
creation, <strong>clEnqueueReleaseDX9MediaSurfacesKHR</strong> provides the synchronization
guarantee that any calls to media adapter APIs involving the interop
device(s) used in the OpenCL context made after the call to
<strong>clEnqueueReleaseDX9MediaSurfacesKHR</strong> will not start executing until after
all events in <em>event_wait_list</em> are complete and all work already submitted
to <em>command_queue</em> completes execution.
If the context was created with properties specifying
<code>CL_CONTEXT_<wbr>INTEROP_<wbr>USER_<wbr>SYNC</code> as <code>CL_TRUE</code>, the user is responsible for
guaranteeing that any media adapter API calls involving the interop
device(s) used in the OpenCL context made after
<strong>clEnqueueReleaseDX9MediaSurfacesKHR</strong> will not start executing until after
event returned by <strong>clEnqueueReleaseDX9MediaSurfacesKHR</strong> reports completion.</p>
</div>
<div class="paragraph">
<p><em>num_objects</em> is the number of memory objects to be released in
<em>mem_objects</em>.</p>
</div>
<div class="paragraph">
<p><em>mem_objects</em> is a pointer to a list of OpenCL memory objects that were
created from media surfaces.</p>
</div>
<div class="paragraph">
<p><em>event_wait_list</em> and <em>num_events_in_wait_list</em> specify events that need to
complete before this particular command can be executed.
If <em>event_wait_list</em> is <code>NULL</code>, then this particular command does not wait
on any event to complete.
If <em>event_wait_list</em> is <code>NULL</code>, <em>num_events_in_wait_list</em> must be 0.
If <em>event_wait_list</em> is not <code>NULL</code>, the list of events pointed to by
<em>event_wait_list</em> must be valid and <em>num_events_in_wait_list</em> must be
greater than 0.</p>
</div>
<div class="paragraph">
<p><em>event</em> returns an event object that identifies this command and
can be used to query or wait for this command to complete.
If <em>event</em> is <code>NULL</code> or the enqueue is unsuccessful, no event will be
created and therefore it will not be possible to query the status of this
command or to wait for this command to complete.
If <em>event_wait_list</em> and <em>event</em> are not <code>NULL</code>, <em>event</em> must not refer
to an element of the <em>event_wait_list</em> array.</p>
</div>
<div class="paragraph">
<p><strong>clEnqueueReleaseDX9MediaSurfacesKHR</strong> returns <code>CL_SUCCESS</code> if the function is
executed successfully.
If <em>num_objects</em> is 0 and &lt;<em>mem_objects</em>&gt; is <code>NULL</code> the function does
nothing and returns <code>CL_SUCCESS</code>.
Otherwise it returns one of the following errors:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>CL_INVALID_<wbr>VALUE</code> if <em>num_objects</em> is zero and <em>mem_objects</em> is not a
<code>NULL</code> value or if <em>num_objects</em> &gt; 0 and <em>mem_objects</em> is <code>NULL</code>.</p>
</li>
<li>
<p><code>CL_INVALID_<wbr>MEM_<wbr>OBJECT</code> if memory objects in <em>mem_objects</em> are not valid
OpenCL memory objects or if memory objects in <em>mem_objects</em> have not
been created from valid media surfaces.</p>
</li>
<li>
<p><code>CL_INVALID_<wbr>COMMAND_<wbr>QUEUE</code> if <em>command_queue</em> is not a valid
command-queue.</p>
</li>
<li>
<p><code>CL_INVALID_<wbr>CONTEXT</code> if context associated with <em>command_queue</em> was not
created from a media object.</p>
</li>
<li>
<p><code>CL_DX9_<wbr>MEDIA_<wbr>SURFACE_<wbr>NOT_<wbr>ACQUIRED_<wbr>KHR</code> if memory objects in <em>mem_objects</em>
have not previously been acquired using
<strong>clEnqueueAcquireDX9MediaSurfacesKHR</strong>, or have been released using
<strong>clEnqueueReleaseDX9MediaSurfacesKHR</strong> since the last time that they were
acquired.</p>
</li>
<li>
<p><code>CL_INVALID_<wbr>EVENT_<wbr>WAIT_<wbr>LIST</code> if <em>event_wait_list</em> is <code>NULL</code> and
<em>num_events_in_wait_list</em> &gt; 0, or <em>event_wait_list</em> is not <code>NULL</code> and
<em>num_events_in_wait_list</em>&gt; is 0, or if event objects in
<em>event_wait_list</em> are not valid events.</p>
</li>
<li>
<p><code>CL_OUT_<wbr>OF_<wbr>HOST_<wbr>MEMORY</code> if there is a failure to allocate resources
required by the OpenCL implementation on the host.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="cl_khr_dx9_media_sharing-event-command-types"><a class="anchor" href="#cl_khr_dx9_media_sharing-event-command-types"></a>15.7.5. Event Command Types for Sharing Memory Objects created from Media Surfaces</h4>
<div class="paragraph">
<p>The following table describes the event command types for the OpenCL commands
to acquire and release OpenCL memory objects that have been created from
media surfaces:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 40. List of supported event command types</caption>
<colgroup>
<col style="width: 40%;">
<col style="width: 60%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><strong>Events Created By</strong></th>
<th class="tableblock halign-left valign-top"><strong>Event Command Type</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>clEnqueueAcquireDX9MediaSurfacesKHR</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CL_COMMAND_<wbr>ACQUIRE_<wbr>DX9_<wbr>MEDIA_<wbr>SURFACES_<wbr>KHR</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>clEnqueueReleaseDX9MediaSurfacesKHR</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CL_COMMAND_<wbr>RELEASE_<wbr>DX9_<wbr>MEDIA_<wbr>SURFACES_<wbr>KHR</code></p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="cl_khr_dx9_media_sharing-surface-formats-for-media-surface-sharing"><a class="anchor" href="#cl_khr_dx9_media_sharing-surface-formats-for-media-surface-sharing"></a>15.7.6. Surface formats for Media Surface Sharing</h4>
<div class="paragraph">
<p>This section includes the D3D surface formats that are supported when the
adapter type is one of the Direct 3D lineage .
Using a D3D surface format not listed here is an error.
To extend the use of this extension to support media adapters beyond
DirectX 9 tables similar to the ones in this section will need to be defined
for the surface formats supported by the new media adapter.
All implementations that support this extension are required to support the
NV12 surface format, the other surface formats supported are the same
surface formats that the adapter you are sharing with supports as long as
they are listed in the table
<a href="#cl_khr_dx9_media_sharing-fourcc-image-formats"><em>YUV FourCC codes and
corresponding OpenCL image format</em></a> or in the table
<a href="#cl_khr_dx9_media_sharing-d3d-image-formats"><em>Direct3D formats and
corresponding OpenCL image formats</em></a>.</p>
</div>
<table id="cl_khr_dx9_media_sharing-fourcc-image-formats" class="tableblock frame-all grid-all stretch">
<caption class="title">Table 41. <em>YUV FourCC codes and corresponding OpenCL image format</em></caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><strong>FOUR CC code</strong></th>
<th class="tableblock halign-left valign-top"><strong>CL image format</strong>

<strong>(channel order, channel data type)</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">FOURCC('N','V','1','2'), Plane 0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CL_R</code>, <code>CL_UNORM_INT8</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">FOURCC('N','V','1','2'), Plane 1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CL_RG</code>, <code>CL_UNORM_INT8</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">FOURCC('Y','V','1','2'), Plane 0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CL_R</code>, <code>CL_UNORM_INT8</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">FOURCC('Y','V','1','2'), Plane 1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CL_R</code>, <code>CL_UNORM_INT8</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">FOURCC('Y','V','1','2'), Plane 2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CL_R</code>, <code>CL_UNORM_INT8</code></p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>In the table <a href="#cl_khr_dx9_media_sharing-fourcc-image-formats"><em>YUV FourCC
codes and corresponding OpenCL image format</em></a> above, NV12 Plane 0
corresponds to the luminance (Y) channel and Plane 1 corresponds to the UV
channels.
The YV12 Plane 0 corresponds to the Y channel, Plane 1 corresponds to the V
channel and Plane 2 corresponds to the U channel.
Note that the YUV formats map to <code>CL_R</code> and <code>CL_RG</code> but do not perform any YUV
to RGB conversion and vice-versa.</p>
</div>
<table id="cl_khr_dx9_media_sharing-d3d-image-formats" class="tableblock frame-all grid-all stretch">
<caption class="title">Table 42. <em>Direct3D formats and corresponding OpenCL image formats</em></caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><strong>D3D format</strong></th>
<th class="tableblock halign-left valign-top"><strong>CL image format</strong><br>
<strong>(channel order, channel data type)</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">D3DFMT_R32F</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CL_R</code>, <code>CL_FLOAT</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">D3DFMT_R16F</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CL_R</code>, <code>CL_HALF_FLOAT</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">D3DFMT_L16</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CL_R</code>, <code>CL_UNORM_INT16</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">D3DFMT_A8</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CL_A</code>, <code>CL_UNORM_INT8</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">D3DFMT_L8</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CL_R</code>, <code>CL_UNORM_INT8</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">D3DFMT_G32R32F</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CL_RG</code>, <code>CL_FLOAT</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">D3DFMT_G16R16F</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CL_RG</code>, <code>CL_HALF_FLOAT</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">D3DFMT_G16R16</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CL_RG</code>, <code>CL_UNORM_INT16</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">D3DFMT_A8L8</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CL_RG</code>, <code>CL_UNORM_INT8</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">D3DFMT_A32B32G32R32F</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CL_RGBA</code>, <code>CL_FLOAT</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">D3DFMT_A16B16G16R16F</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CL_RGBA</code>, <code>CL_HALF_FLOAT</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">D3DFMT_A16B16G16R16</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CL_RGBA</code>, <code>CL_UNORM_INT16</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">D3DFMT_A8B8G8R8</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CL_RGBA</code>, <code>CL_UNORM_INT8</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">D3DFMT_X8B8G8R8</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CL_RGBA</code>, <code>CL_UNORM_INT8</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">D3DFMT_A8R8G8B8</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CL_BGRA</code>, <code>CL_UNORM_INT8</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">D3DFMT_X8R8G8B8</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CL_BGRA</code>, <code>CL_UNORM_INT8</code></p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Note: The D3D9 format names in the table above seem to imply that the
order of the color channels are switched relative to OpenCL but this is
not the case.
For example, the layout of channels for each pixel for D3DFMT_A32FB32FG32FR32F
is the same as <code>CL_RGBA</code>, <code>CL_FLOAT</code>.</p>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="cl_khr_depth_images"><a class="anchor" href="#cl_khr_depth_images"></a>16. Depth Images</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This section describes the <strong>cl_khr_depth_images</strong> extension.</p>
</div>
<div class="paragraph">
<p>This extension adds support for depth images.</p>
</div>
<div class="paragraph">
<p>This extension became a core feature in OpenCL 2.0.</p>
</div>
<div class="sect2">
<h3 id="_general_information_15"><a class="anchor" href="#_general_information_15"></a>16.1. General information</h3>
<div class="sect3">
<h4 id="_version_history_15"><a class="anchor" href="#_version_history_15"></a>16.1.1. Version history</h4>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 60%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><strong>Date</strong></th>
<th class="tableblock halign-left valign-top"><strong>Version</strong></th>
<th class="tableblock halign-left valign-top"><strong>Description</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">2020-04-21</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.0.0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">First assigned version.</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect2">
<h3 id="cl_khr_depth_images-additions-to-chapter-5"><a class="anchor" href="#cl_khr_depth_images-additions-to-chapter-5"></a>16.2. Additions to Chapter 5 of the OpenCL 1.2 Specification</h3>
<div class="paragraph">
<p>This extension adds the following new image formats for depth images to <em>tables 5.6 and 5.7</em> of the OpenCL 1.2 specification.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 100%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><strong>Enum values that can be specified in channel_order</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CL_DEPTH</code>. This format can only be used if channel data type = <code>CL_UNORM_<wbr>INT16</code> or <code>CL_FLOAT</code>.</p></td>
</tr>
</tbody>
</table>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 40%;">
<col style="width: 60%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><strong>Image Channel Data Type</strong></th>
<th class="tableblock halign-left valign-top"><strong>Description</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CL_UNORM_<wbr>INT16</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Each channel component is a normalized unsigned 16-bit integer value</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CL_FLOAT</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Each channel component is a single precision floating-point value</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>This extension adds the following new image format to the minimum list of supported image formats described in <em>table 5.8</em>:</p>
</div>
<table id="cl_khr_depth_images-required-image-formats" class="tableblock frame-all grid-all stretch">
<caption class="title">Table 43. <em>Required Image Formats for</em> <strong>cl_khr_depth_images</strong></caption>
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><strong>num_channels</strong></th>
<th class="tableblock halign-left valign-top"><strong>channel_order</strong></th>
<th class="tableblock halign-left valign-top"><strong>channel_data_type</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CL_DEPTH</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CL_UNORM_<wbr>INT16</code><br>
<code>CL_FLOAT</code></p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>NOTE:</p>
</div>
<div class="paragraph">
<p>Depth image objects can be initialized, read and written using the appropriate CL APIs i.e. <strong>clEnqueueReadImage</strong>, <strong>clEnqueueWriteImage</strong>, <strong>clEnqueueCopyImage</strong>, <strong>clEnqueueCopyImageToBuffer</strong>, <strong>clEnqueueCopyBufferToImage</strong>, <strong>clEnqueueMapImage</strong> and <strong>clEnqueueFillImage</strong>.</p>
</div>
<div class="paragraph">
<p>For <strong>clEnqueueFillImage</strong>, the fill color is a 4-component value where the R component refers to the depth value if the image format is <code>CL_DEPTH</code>.  The fill color will be converted to the appropriate image channel format and order associated with image.</p>
</div>
<div class="paragraph">
<p>Update text that describes arg value argument to <strong>clSetKernelArg</strong> with the following:</p>
</div>
<div class="paragraph">
<p>If the kernel argument is declared to be of type image2d_depth_t or image2d_array_depth t, the arg_value entry will be a pointer to a depth image or depth image array object.</p>
</div>
<div class="paragraph">
<p>Add the following error condition for <strong>clSetKernelArg</strong>:</p>
</div>
<div class="paragraph">
<p><code>CL_INVALID_<wbr>MEM_<wbr>OBJECT</code> for an argument declared to be a depth image or a depth image
array and the argument value specified in arg_value does not follow the rules described above
for a depth memory object or memory array object argument.</p>
</div>
</div>
<div class="sect2">
<h3 id="cl_khr_depth_images-additions-to-chapter-6"><a class="anchor" href="#cl_khr_depth_images-additions-to-chapter-6"></a>16.3. Additions to Chapter 6 of the OpenCL 1.2 Specification</h3>
<div class="paragraph">
<p>Add the following new data types to <em>table 6.3</em> in <em>section 6.1.3</em> of the OpenCL 1.2 specification:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 40%;">
<col style="width: 60%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><strong>Type</strong></th>
<th class="tableblock halign-left valign-top"><strong>Description</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>image2d_depth_t</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A 2D depth image. Refer to <em>section 6.12.14</em> for a detailed
description of the built-in functions that use this type.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>image2d_array_depth_t</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A 2D depth image array. Refer to <em>section 6.12.14</em> for a
detailed description of the built-in functions that use this
type.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Add the following to the bulleted list in section 6.12.14.1.1 - Determining the border color:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>If the image channel order is <code>CL_DEPTH</code>, the border value is <code>0.0f</code>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Add the following built-in functions to section 6.12.14.2 - Built-in Image Read Functions:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 40%;">
<col style="width: 60%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><strong>Function</strong></th>
<th class="tableblock halign-left valign-top"><strong>Description</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">float <strong>read_imagef</strong>(read_only image2d_depth_t <em>image</em>,
  sampler_t <em>sampler</em>, int2 <em>coord</em>)<br>
  float <strong>read_imagef</strong>(read_only image2d_depth_t <em>image</em>,
  sampler_t <em>sampler</em>, float2 <em>coord</em>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Use the coordinate (<em>coord.x</em>, <em>coord.y</em>) to do an element lookup in
      the 2D depth image object specified by <em>image</em>.</p>
<p class="tableblock">      <strong>read_imagef</strong> returns a floating-point value in the range [0.0, 1.0]
      for depth image objects created with <em>image_channel_data_type</em> set to
      <code>CL_UNORM_<wbr>INT16</code> or <code>CL_UNORM_<wbr>INT24</code>.</p>
<p class="tableblock">      <strong>read_imagef</strong> returns a floating-point value for depth image objects
      created with <em>image_channel_data_type</em> set to <code>CL_FLOAT</code>.</p>
<p class="tableblock">      The <strong>read_imagef</strong> calls that take integer coordinates must use a
      sampler with filter mode set to <code>CLK_FILTER_NEAREST</code>, normalized
      coordinates set to <code>CLK_NORMALIZED_COORDS_FALSE</code> and addressing mode
      set to <code>CLK_ADDRESS_CLAMP_TO_EDGE</code>, <code>CLK_ADDRESS_CLAMP</code> or
      <code>CLK_ADDRESS_NONE</code>; otherwise the values returned are undefined.</p>
<p class="tableblock">      Values returned by <strong>read_imagef</strong> for depth image objects with
      <em>image_channel_data_type</em> values not specified in the description
      above are undefined.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">float <strong>read_imagef</strong>(read_only image2d_array_depth_t <em>image</em>,
  sampler_t <em>sampler</em>, int4 <em>coord</em>)<br>
  float <strong>read_imagef</strong>(read_only image2d_array_depth_t <em>image</em>,
  sampler_t <em>sampler</em>, float4 <em>coord</em>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Use <em>coord.xy</em> to do an element lookup in the 2D image identified by
      <em>coord.z</em> in the 2D depth image array specified by <em>image</em>.</p>
<p class="tableblock">      <strong>read_imagef</strong> returns a floating-point value in the range [0.0, 1.0]
      for depth image objects created with <em>image_channel_data_type</em> set to
      <code>CL_UNORM_<wbr>INT16</code> or <code>CL_UNORM_<wbr>INT24</code>.</p>
<p class="tableblock">      <strong>read_imagef</strong> returns a floating-point value for depth image objects
      created with <em>image_channel_data_type</em> set to <code>CL_FLOAT</code>.</p>
<p class="tableblock">      The <strong>read_imagef</strong> calls that take integer coordinates must use a
      sampler with filter mode set to <code>CLK_FILTER_NEAREST</code>, normalized
      coordinates set to <code>CLK_NORMALIZED_COORDS_FALSE</code> and addressing mode
      set to <code>CLK_ADDRESS_CLAMP_TO_EDGE</code>, <code>CLK_ADDRESS_CLAMP</code> or
      <code>CLK_ADDRESS_NONE</code>; otherwise the values returned are undefined.</p>
<p class="tableblock">      Values returned by <strong>read_imagef</strong> for image objects with
      <em>image_channel_data_type</em> values not specified in the description
      above are undefined.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Add the following built-in functions to section 6.12.14.3 - Built-in Image Sampler-less Read Functions:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 40%;">
<col style="width: 60%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><strong>Function</strong></th>
<th class="tableblock halign-left valign-top"><strong>Description</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">float <strong>read_imagef</strong>(image2d_depth_t <em>image</em>, int2 <em>coord</em>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Use the coordinate (<em>coord.x</em>, <em>coord.y</em>) to do an element lookup in
      the 2D depth image object specified by <em>image</em>.</p>
<p class="tableblock">      <strong>read_imagef</strong> returns a floating-point value in the range [0.0, 1.0]
      for depth image objects created with <em>image_channel_data_type</em> set to
      <code>CL_UNORM_<wbr>INT16</code> or <code>CL_UNORM_<wbr>INT24</code>.</p>
<p class="tableblock">      <strong>read_imagef</strong> returns a floating-point value for depth image objects
      created with <em>image_channel_data_type</em> set to <code>CL_FLOAT</code>.</p>
<p class="tableblock">      Values returned by <strong>read_imagef</strong> for image objects with
      <em>image_channel_data_type</em> values not specified in the description
      above are undefined.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">float <strong>read_imagef</strong>(image2d_array_depth_t <em>image</em>, int4 <em>coord</em>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Use <em>coord.xy</em> to do an element lookup in the 2D image identified by
      <em>coord.z</em> in the 2D depth image array specified by <em>image</em>.</p>
<p class="tableblock">      <strong>read_imagef</strong> returns a floating-point value in the range [0.0, 1.0]
      for depth image objects created with <em>image_channel_data_type</em> set to
      <code>CL_UNORM_<wbr>INT16</code> or <code>CL_UNORM_<wbr>INT24</code>.</p>
<p class="tableblock">      <strong>read_imagef</strong> returns a floating-point value for depth image objects
      created with <em>image_channel_data_type</em> set to <code>CL_FLOAT</code>.</p>
<p class="tableblock">      Values returned by <strong>read_imagef</strong> for image objects with
      <em>image_channel_data_type</em> values not specified in the description
      above are undefined.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Add the following built-in functions to section 6.12.14.4  Built-in Image Write Functions:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 40%;">
<col style="width: 60%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><strong>Function</strong></th>
<th class="tableblock halign-left valign-top"><strong>Description</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">void <strong>write_imagef</strong>(image2d_depth_t <em>image</em>, int2 <em>coord</em>,
  float <em>depth</em>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Write <em>depth</em> value to location specified by <em>coord.xy</em> in the 2D
      depth image object specified by <em>image</em>.
      Appropriate data format conversion to the specified image format is
      done before writing the depth value.
      <em>coord.x</em> and <em>coord.y</em> are considered to be unnormalized coordinates,
      and must be in the range [0, image width-1], and [0, image height-1],
      respectively.</p>
<p class="tableblock">      <strong>write_imagef</strong> can only be used with image objects created with
      <em>image_channel_data_type</em> set to <code>CL_UNORM_<wbr>INT16</code>, <code>CL_UNORM_<wbr>INT24</code> or
      <code>CL_FLOAT</code>.
      Appropriate data format conversion will be done to convert depth value
      from a floating-point value to actual data format associated with the
      image.</p>
<p class="tableblock">      The behavior of <strong>write_imagef</strong>, <strong>write_imagei</strong> and <strong>write_imageui</strong> for
      image objects created with <em>image_channel_data_type</em> values not
      specified in the description above or with (<em>x</em>, <em>y</em>) coordinate
      values that are not in the range [0, image width-1] and [0, image
      height-1], respectively, is undefined.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">void <strong>write_imagef</strong>(image2d_array_depth_t <em>image</em>, int4 <em>coord</em>,
  float <em>depth</em>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Write <em>depth</em> value to location specified by <em>coord.xy</em> in the 2D
      image identified by <em>coord.z</em> in the 2D depth image array specified by
      <em>image</em>.
      Appropriate data format conversion to the specified image format is
      done before writing the depth value.
      <em>coord.x</em>, <em>coord.y</em> and <em>coord.z</em> are considered to be unnormalized
      coordinates, and must be in the range [0, image width-1], [0, image
      height-1], and [0, image number of layers-1], respectively.</p>
<p class="tableblock">      <strong>write_imagef</strong> can only be used with image objects created with
      <em>image_channel_data_type</em> set to <code>CL_UNORM_<wbr>INT16</code>, <code>CL_UNORM_<wbr>INT24</code> or
      <code>CL_FLOAT</code>.
      Appropriate data format conversion will be done to convert depth valye
      from a floating-point value to actual data format associated with the
      image.</p>
<p class="tableblock">      The behavior of <strong>write_imagef</strong>, <strong>write_imagei</strong> and <strong>write_imageui</strong> for
      image objects created with <em>image_channel_data_type</em> values not
      specified in the description above or with (<em>x</em>, <em>y</em>, <em>z</em>) coordinate
      values that are not in the range [0, image width-1], [0, image
      height-1], [0, image number of layers-1], respectively, is undefined.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Add the following built-in functions to section 6.12.14.5  Built-in Image Query Functions:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 40%;">
<col style="width: 60%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Function</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Description</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">int <strong>get_image_width</strong>(image2d_depth_t <em>image</em>)<br>
  int <strong>get_image_width</strong>(image2d_array_depth_t <em>image</em>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Return the image width in pixels.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">int <strong>get_image_height</strong>(image2d_depth_t <em>image</em>)<br>
  int <strong>get_image_height</strong>(image2d_array_depth_t <em>image</em>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Return the image height in pixels.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">int <strong>get_image_channel_data_type</strong>(image2d_depth_t <em>image</em>)<br>
  int <strong>get_image_channel_data_type</strong>(image2d_array_depth_t <em>image</em>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Return the channel data type. Valid values are:</p>
<p class="tableblock">      <code>CLK_UNORM_INT16</code><br>
      <code>CLK_FLOAT</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">int <strong>get_image_channel_order</strong>(image2d_depth_t <em>image</em>)<br>
  int <strong>get_image_channel_order</strong>(image2d_array_depth_t <em>image</em>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Return the image channel order. Valid values are:</p>
<p class="tableblock">      <code>CLK_DEPTH</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">int2 <strong>get_image_dim</strong>(image2d_depth_t <em>image</em>)<br>
  int2 <strong>get_image_dim</strong>(image2d_array_depth_t <em>image</em>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Return the 2D image width and height as an int2 type.
      The width is returned in the <em>x</em> component, and the height in the <em>y</em>
      component.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">size_t <strong>get_image_array_size</strong>(image2d_array_depth_t <em>image</em>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Return the number of images in the 2D image array.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Add the following text below the table in section 6.12.14.6 - Mapping image channels to color values returned by read_image
and color values passed to write_image to image channels:</p>
</div>
<div class="paragraph">
<p>For <code>CL_DEPTH</code> images, a scalar value is returned by <strong>read_imagef</strong> or
supplied to <strong>write_imagef</strong>.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="cl_khr_gl_depth_images"><a class="anchor" href="#cl_khr_gl_depth_images"></a>17. Sharing OpenGL and OpenGL ES Depth and Depth-Stencil Images</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This section describes the <strong>cl_khr_gl_depth_images</strong> extension.
The <strong>cl_khr_gl_depth_images</strong> extends OpenCL / OpenGL sharing (the
cl_khr_gl_sharing_extension) defined in
<a href="#cl_khr_gl_sharing__memobjs">Creating OpenCL Memory Objects from OpenGL
Objects</a> to allow an OpenCL image to be created from an OpenGL depth or
depth-stencil texture.</p>
</div>
<div class="sect2">
<h3 id="_general_information_16"><a class="anchor" href="#_general_information_16"></a>17.1. General information</h3>
<div class="sect3">
<h4 id="_version_history_16"><a class="anchor" href="#_version_history_16"></a>17.1.1. Version history</h4>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 60%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><strong>Date</strong></th>
<th class="tableblock halign-left valign-top"><strong>Version</strong></th>
<th class="tableblock halign-left valign-top"><strong>Description</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">2020-04-21</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.0.0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">First assigned version.</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect2">
<h3 id="cl_khr_gl_depth_images-additions-to-chapter-5"><a class="anchor" href="#cl_khr_gl_depth_images-additions-to-chapter-5"></a>17.2. Additions to Chapter 5 of the OpenCL 2.2 Specification</h3>
<div class="paragraph">
<p>The <strong>cl_khr_gl_depth_images</strong> extension extends OpenCL / OpenGL sharing by
allowing an OpenCL depth image to be created from an OpenGL depth or
depth-stencil texture.
Depth images with an image channel order of CL_DEPTH_STENCIL can only be
created using the <strong>clCreateFromGLTexture</strong> API.</p>
</div>
<div class="paragraph">
<p>This extension adds the following new image format for depth-stencil images
to <em>table 5.6 and 5.7</em> of the OpenCL 2.2 specification.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 100%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><strong>Enum values that can be specified in channel_order</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>CL_DEPTH_STENCIL</strong>.
  This format can only be used if channel data type = CL_UNORM_INT24 or
  CL_FLOAT.</p></td>
</tr>
</tbody>
</table>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><strong>Image Channel Data Type</strong></th>
<th class="tableblock halign-left valign-top"><strong>Description</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>CL_UNORM_INT24</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Each channel component is a normalized unsigned 24-bit integer value</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>CL_FLOAT</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Each channel component is a single precision floating-point value</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>This extension adds the following new image format to the minimum list of
supported image formats described in <em>tables 5.8.a</em> and <em>5.8.b</em>.</p>
</div>
<table id="cl_khr_gl_depth_images-required-image-formats" class="tableblock frame-all grid-all stretch">
<caption class="title">Table 44. <em>Required Image Formats for</em> <strong>cl_khr_gl_depth_images</strong></caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>num_channels</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>channel_order</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>channel_data_type</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>read / write</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">CL_DEPTH_STENCIL</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">CL_UNORM_INT24<br>
  CL_FLOAT</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">read only</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>For the image format given by channel order of CL_DEPTH_STENCIL and channel
data type of CL_UNORM_INT24, the depth is stored as an unsigned normalized
24-bit value.</p>
</div>
<div class="paragraph">
<p>For the image format given by channel order of CL DEPTH_STENCIL and channel
data type of CL_FLOAT, each pixel is two 32-bit values.
The depth is stored as a single precision floating-point value followed by
the stencil which is stored as a 8-bit integer value.</p>
</div>
<div class="paragraph">
<p>The stencil value cannot be read or written using the <strong>read_imagef</strong> and
<strong>write_imagef</strong> built-in functions in an OpenCL kernel.</p>
</div>
<div class="paragraph">
<p>Depth image objects with an image channel order equal to CL_DEPTH_STENCIL
cannot be used as arguments to clEnqueueReadImage, clEnqueueWriteImage,
clEnqueueCopyImage, clEnqueueCopyImageToBuffer, clEnqueueCopyBufferToImage,
clEnqueueMapImage and clEnqueueFillImage and will return a
CL_INVALID_OPERATION error.</p>
</div>
</div>
<div class="sect2">
<h3 id="cl_khr_gl_depth_images-additions-to-extension-specification"><a class="anchor" href="#cl_khr_gl_depth_images-additions-to-extension-specification"></a>17.3. Additions to the OpenCL Extension Specification</h3>
<div class="paragraph">
<p>The following new image formats are added to the table of
<a href="#cl_khr_gl_sharing__memobjs-mapping-of-image-formats">OpenGL internal
formats and corresponding OpenCL internal formats</a> in the OpenCL extension
specification.
If an OpenGL texture object with an internal format in this table is
successfully created by OpenGL, then there is guaranteed to be a mapping to
one of the corresponding OpenCL image format(s) in that table.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><strong>GL internal format</strong></th>
<th class="tableblock halign-left valign-top"><strong>CL image format</strong>

  <strong>(channel order, channel data type)</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">GL_DEPTH_COMPONENT32F</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">CL_DEPTH, CL_FLOAT</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">GL_DEPTH_COMPONENT16</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">CL_DEPTH, CL_UNORM_INT16</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">GL_DEPTH24_STENCIL8</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">CL_DEPTH_STENCIL, CL_UNORM_INT24</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">GL_DEPTH32F_STENCIL8</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">CL_DEPTH_STENCIL, CL_FLOAT</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="cl_khr_gl_msaa_sharing"><a class="anchor" href="#cl_khr_gl_msaa_sharing"></a>18. Creating OpenCL Memory Objects from OpenGL MSAA Textures</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This extension extends the OpenCL / OpenGL sharing (the
cl_khr_gl_sharing_extension) defined in
<a href="#cl_khr_gl_sharing__memobjs">Creating OpenCL Memory Objects from OpenGL
Objects</a> to allow an OpenCL image to be created from an OpenGL
multi-sampled (a.k.a.
MSAA) texture (color or depth).</p>
</div>
<div class="paragraph">
<p>This extension name is <strong>cl_khr_gl_msaa_sharing</strong>.
This extension requires <strong>cl_khr_gl_depth_images</strong>.</p>
</div>
<div class="sect2">
<h3 id="_general_information_17"><a class="anchor" href="#_general_information_17"></a>18.1. General information</h3>
<div class="sect3">
<h4 id="_version_history_17"><a class="anchor" href="#_version_history_17"></a>18.1.1. Version history</h4>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 60%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><strong>Date</strong></th>
<th class="tableblock halign-left valign-top"><strong>Version</strong></th>
<th class="tableblock halign-left valign-top"><strong>Description</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">2020-04-21</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.0.0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">First assigned version.</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect2">
<h3 id="cl_khr_gl_msaa_sharing-additions-to-extension-specification"><a class="anchor" href="#cl_khr_gl_msaa_sharing-additions-to-extension-specification"></a>18.2. Additions to the OpenCL Extension Specification</h3>
<div class="paragraph">
<p>Allow <em>texture_target</em> argument to <strong>clCreateFromGLTexture</strong> to be
GL_TEXTURE_2D_MULTISAMPLE or GL_TEXTURE_2D_MULTISAMPLE_ARRAY.</p>
</div>
<div class="paragraph">
<p>If <em>texture_target</em> is GL_TEXTURE_2D_MULTISAMPLE, <strong>clCreateFromGLTexture</strong>
creates an OpenCL 2D multi-sample image object from an OpenGL 2D
multi-sample texture.</p>
</div>
<div class="paragraph">
<p>If <em>texture_target</em> is GL_TEXTURE_2D_MULTISAMPLE_ARRAY,
<strong>clCreateFromGLTexture</strong> creates an OpenCL 2D multi-sample array image object
from an OpenGL 2D multi-sample texture.</p>
</div>
<div class="paragraph">
<p>Multi-sample OpenCL image objects can only be read from a kernel.
Multi-sample OpenCL image objects cannot be used as arguments to
clEnqueueReadImage , clEnqueueWriteImage, clEnqueueCopyImage,
clEnqueueCopyImageToBuffer, clEnqueueCopyBufferToImage, clEnqueueMapImage
and clEnqueueFillImage and will return a CL_INVALID_OPERATION error.</p>
</div>
<div class="paragraph">
<p><strong>Add the following entry to the table describing
<a href="#cl_khr_gl_sharing__memobjs-clGetGLTextureInfo-queries">OpenGL texture info
that may be queried with clGetGLTextureInfo</a>:</strong></p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><strong>cl_gl_texture_info</strong></th>
<th class="tableblock halign-left valign-top"><strong>Return Type</strong></th>
<th class="tableblock halign-left valign-top"><strong>Info. returned in <em>param_value</em></strong></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>CL_GL_NUM_SAMPLES</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">GLsizei</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The <em>samples</em> argument passed to <strong>glTexImage2DMultisample</strong> or
  <strong>glTexImage3DMultisample</strong>.</p>
<p class="tableblock">  If <em>image</em> is not a MSAA texture, 1 is returned.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="cl_khr_gl_msaa_sharing-additions-to-chapter-5"><a class="anchor" href="#cl_khr_gl_msaa_sharing-additions-to-chapter-5"></a>18.3. Additions to Chapter 5 of the OpenCL 2.2 Specification</h3>
<div class="paragraph">
<p>The formats described in tables 5.8.a and 5.8.b of the OpenCL 2.2
specification and the additional formats described in
<a href="#cl_khr_gl_depth_images-required-image-formats">required image formats for
cl_khr_gl_depth_images</a> also support OpenCL images created from a OpenGL
multi-sampled color or depth texture.</p>
</div>
<div class="paragraph">
<p><strong>Update text that describes arg value argument to clSetKernelArg with the
following:</strong></p>
</div>
<div class="paragraph">
<p>&#8220;If the argument is a multi-sample 2D image, the <em>arg_value</em> entry must be
a pointer to a multi-sample image object.
If the argument is a multi-sample 2D depth image, the <em>arg_value</em> entry must
be a pointer to a multisample depth image object.
If the argument is a multi-sample 2D image array, the <em>arg_value</em> entry must
be a pointer to a multi-sample image array object.
If the argument is a multi-sample 2D depth image array, the <em>arg_value</em>
entry must be a pointer to a multi-sample depth image array object.&#8221;</p>
</div>
<div class="paragraph">
<p><strong>Updated error code text for clSetKernelArg is:</strong></p>
</div>
<div class="paragraph">
<p><strong>Add the following text:</strong></p>
</div>
<div class="paragraph">
<p>&#8220;CL_INVALID_MEM_OBJECT for an argument declared to be a multi-sample image,
multi-sample image array, multi-sample depth image or a multi-sample depth
image array and the argument value specified in <em>arg_value</em> does not follow
the rules described above for a depth memory object or memory array object
argument.&#8221;</p>
</div>
</div>
<div class="sect2">
<h3 id="cl_khr_gl_msaa_sharing-additions-to-chapter-6"><a class="anchor" href="#cl_khr_gl_msaa_sharing-additions-to-chapter-6"></a>18.4. Additions to Chapter 6 of the OpenCL 2.2 Specification</h3>
<div class="paragraph">
<p><strong>Add the following new data types to <em>table 6.3</em> in <em>section 6.1.3</em> of the
OpenCL 2.2 specification:</strong></p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><strong>Type</strong></th>
<th class="tableblock halign-left valign-top"><strong>Description</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>image2d_msaa_t</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A 2D multi-sample color image.
  Refer to <em>section 6.13.14</em> for a detailed description of the built-in
  functions that use this type.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>image2d_array_msaa_t</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A 2D multi-sample color image array.
  Refer to <em>section 6.13.14</em> for a detailed description of the built-in
  functions that use this type.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>image2d_msaa_depth_t</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A 2D multi-sample depth image.
  Refer to <em>section 6.13.14</em> for a detailed description of the built-in
  functions that use this type.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>image2d_array_msaa_depth_t</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A 2D multi-sample depth image array.
  Refer to <em>section 6.13.14</em> for a detailed description of the built-in
  functions that use this type.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><strong>Add the following built-in functions to section 6.13.14.3&#8201;&#8212;&#8201;Built-in Image
Sampler-less Read Functions:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="opencl_c"><span class="kt">float4</span> <span class="fm">read_imagef</span><span class="p">(</span>
    <span class="n">image2d_msaa_t</span> <span class="n">image</span><span class="p">,</span>
    <span class="kt">int2</span> <span class="n">coord</span><span class="p">,</span>
    <span class="kt">int</span> <span class="n">sample</span><span class="p">)</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Use the coordinate <em>(coord.x, coord.y)</em> and <em>sample</em> to do an element lookup
in the 2D image object specified by <em>image</em>.</p>
</div>
<div class="paragraph">
<p><strong>read_imagef</strong> returns floating-point values in the range [0.0 &#8230;&#8203; 1.0] for
image objects created with <em>image_channel_data_type</em> set to one of the
pre-defined packed formats or CL_UNORM_INT8, or CL_UNORM_INT16.</p>
</div>
<div class="paragraph">
<p><strong>read_imagef</strong> returns floating-point values in the range [-1.0 &#8230;&#8203; 1.0] for
image objects created with <em>image_channel_data_type</em> set to CL_SNORM_INT8,
or CL_SNORM_INT16.</p>
</div>
<div class="paragraph">
<p><strong>read_imagef</strong> returns floating-point values for image objects created with
<em>image_channel_data_type</em> set to CL_HALF_FLOAT or CL_FLOAT.</p>
</div>
<div class="paragraph">
<p>Values returned by <strong>read_imagef</strong> for image objects with
<em>image_channel_data_type</em> values not specified in the description above are
undefined.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="opencl_c"><span class="kt">int4</span> <span class="fm">read_imagei</span><span class="p">(</span><span class="n">image2d_msaa_t</span> <span class="n">image</span><span class="p">,</span>
                 <span class="kt">int2</span> <span class="n">coord</span><span class="p">,</span>
                 <span class="kt">int</span> <span class="n">sample</span><span class="p">)</span>

<span class="kt">uint4</span> <span class="fm">read_imageui</span><span class="p">(</span><span class="n">image2d_msaa_t</span> <span class="n">image</span><span class="p">,</span>
                   <span class="kt">int2</span> <span class="n">coord</span><span class="p">,</span>
                   <span class="kt">int</span> <span class="n">sample</span><span class="p">)</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Use the coordinate <em>(coord.x, coord.y)</em> and <em>sample</em> to do an element lookup
in the 2D image object specified by <em>image</em>.</p>
</div>
<div class="paragraph">
<p><strong>read_imagei</strong> and <strong>read_imageui</strong> return unnormalized signed integer and
unsigned integer values respectively.
Each channel will be stored in a 32-bit integer.</p>
</div>
<div class="paragraph">
<p><strong>read_imagei</strong> can only be used with image objects created with
<em>image_channel_data_type</em> set to one of the following values:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>CL_SIGNED_INT8,</p>
</li>
<li>
<p>CL_SIGNED_INT16, and</p>
</li>
<li>
<p>CL_SIGNED_INT32.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>If the <em>image_channel_data_type</em> is not one of the above values, the values
returned by <strong>read_imagei</strong> are undefined.</p>
</div>
<div class="paragraph">
<p><strong>read_imageui</strong> can only be used with image objects created with
<em>image_channel_data_type</em> set to one of the following values:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>CL_UNSIGNED_INT8,</p>
</li>
<li>
<p>CL_UNSIGNED_INT16, and</p>
</li>
<li>
<p>CL_UNSIGNED_INT32.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>If the <em>image_channel_data_type</em> is not one of the above values, the values
returned by <strong>read_imageui</strong> are undefined.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="opencl_c"><span class="kt">float4</span> <span class="fm">read_imagef</span><span class="p">(</span><span class="n">image2d_array_msaa_t</span> <span class="n">image</span><span class="p">,</span>
                   <span class="kt">int4</span> <span class="n">coord</span><span class="p">,</span>
                   <span class="kt">int</span> <span class="n">sample</span><span class="p">)</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Use <em>coord.xy</em> and <em>sample</em> to do an element lookup in the 2D image
identified by <em>coord.z</em> in the 2D image array specified by <em>image</em>.</p>
</div>
<div class="paragraph">
<p><strong>read_imagef</strong> returns floating-point values in the range [0.0 &#8230;&#8203; 1.0] for
image objects created with <em>image_channel_data_type</em> set to one of the
pre-defined packed formats or CL_UNORM_INT8, or CL_UNORM_INT16.</p>
</div>
<div class="paragraph">
<p><strong>read_imagef</strong> returns floating-point values in the range [-1.0 &#8230;&#8203; 1.0] for
image objects created with <em>image_channel_data_type</em> set to CL_SNORM_INT8,
or CL_SNORM_INT16.</p>
</div>
<div class="paragraph">
<p><strong>read_imagef</strong> returns floating-point values for image objects created with
<em>image_channel_data_type</em> set to CL_HALF_FLOAT or CL_FLOAT.</p>
</div>
<div class="paragraph">
<p>Values returned by <strong>read_imagef</strong> for image objects with
<em>image_channel_data_type</em> values not specified in the description above are
undefined.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="opencl_c"><span class="kt">int4</span> <span class="fm">read_imagei</span><span class="p">(</span><span class="n">image2d_array_msaa_t</span> <span class="n">image</span><span class="p">,</span>
                 <span class="kt">int4</span> <span class="n">coord</span><span class="p">,</span>
                 <span class="kt">int</span> <span class="n">sample</span><span class="p">)</span>

<span class="kt">uint4</span> <span class="fm">read_imageui</span><span class="p">(</span><span class="n">image2d_array_msaa_t</span> <span class="n">image</span><span class="p">,</span>
                   <span class="kt">int4</span> <span class="n">coord</span><span class="p">,</span>
                   <span class="kt">int</span> <span class="n">sample</span><span class="p">)</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Use <em>coord.xy</em> and <em>sample</em> to do an element lookup in the 2D image
identified by <em>coord.z</em> in the 2D image array specified by <em>image</em>.</p>
</div>
<div class="paragraph">
<p><strong>read_imagei</strong> and <strong>read_imageui</strong> return unnormalized signed integer and
unsigned integer values respectively.
Each channel will be stored in a 32-bit integer.</p>
</div>
<div class="paragraph">
<p><strong>read_imagei</strong> can only be used with image objects created with
<em>image_channel_data_type</em> set to one of the following values:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>CL_SIGNED_INT8,</p>
</li>
<li>
<p>CL_SIGNED_INT16, and</p>
</li>
<li>
<p>CL_SIGNED_INT32.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>If the <em>image_channel_data_type</em> is not one of the above values, the values
returned by <strong>read_imagei</strong> are undefined.</p>
</div>
<div class="paragraph">
<p><strong>read_imageui</strong> can only be used with image objects created with
<em>image_channel_data_type</em> set to one of the following values:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>CL_UNSIGNED_INT8,</p>
</li>
<li>
<p>CL_UNSIGNED_INT16, and</p>
</li>
<li>
<p>CL_UNSIGNED_INT32.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>If the <em>image_channel_data_type</em> is not one of the above values, the values
returned by <strong>read_imageui</strong> are undefined.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="opencl_c"><span class="kt">float</span> <span class="fm">read_imagef</span><span class="p">(</span><span class="n">image2d_msaa_depth_t</span> <span class="n">image</span><span class="p">,</span>
                  <span class="kt">int2</span> <span class="n">coord</span><span class="p">,</span>
                  <span class="kt">int</span> <span class="n">sample</span><span class="p">)</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Use the coordinate <em>(coord.x, coord.y)</em> and <em>sample</em> to do an element lookup
in the 2D depth image object specified by <em>image</em>.</p>
</div>
<div class="paragraph">
<p><strong>read_imagef</strong> returns a floating-point value in the range [0.0 &#8230;&#8203; 1.0] for
depth image objects created with <em>image_channel_data_type</em> set to
CL_UNORM_INT16 or CL_UNORM_INT24.</p>
</div>
<div class="paragraph">
<p><strong>read_imagef</strong> returns a floating-point value for depth image objects created
with <em>image_channel_data_type</em> set to CL_FLOAT.</p>
</div>
<div class="paragraph">
<p>Values returned by <strong>read_imagef</strong> for image objects with
<em>image_channel_data_type</em> values not specified in the description above are
undefined.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="opencl_c"><span class="kt">float</span> <span class="fm">read_imagef</span><span class="p">(</span><span class="n">image2d_array_msaaa_depth_t</span> <span class="n">image</span><span class="p">,</span>
                  <span class="kt">int4</span> <span class="n">coord</span><span class="p">,</span>
                  <span class="kt">int</span> <span class="n">sample</span><span class="p">)</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Use <em>coord.xy</em> and <em>sample</em> to do an element lookup in the 2D image
identified by <em>coord.z</em> in the 2D depth image array specified by <em>image</em>.</p>
</div>
<div class="paragraph">
<p><strong>read_imagef</strong> returns a floating-point value in the range [0.0 &#8230;&#8203; 1.0] for
depth image objects created with <em>image_channel_data_type</em> set to
CL_UNORM_INT16 or CL_UNORM_INT24.</p>
</div>
<div class="paragraph">
<p><strong>read_imagef</strong> returns a floating-point value for depth image objects created
with <em>image_channel_data_type</em> set to CL_FLOAT.</p>
</div>
<div class="paragraph">
<p>Values returned by <strong>read_imagef</strong> for image objects with
<em>image_channel_data_type</em> values not specified in the description above are
undefined.</p>
</div>
<div class="paragraph">
<p>Note: When a multisample image is accessed in a kernel, the access takes one
vector of integers describing which pixel to fetch and an integer
corresponding to the sample numbers describing which sample within the pixel
to fetch.
sample identifies the sample position in the multi-sample image.</p>
</div>
<div class="paragraph">
<p><strong>For best performance, we recommend that <em>sample</em> be a literal value so it
is known at compile time and the OpenCL compiler can perform appropriate
optimizations for multi-sample reads on the device</strong>.</p>
</div>
<div class="paragraph">
<p>No standard sampling instructions are allowed on the multisample image.
Accessing a coordinate outside the image and/or a sample that is outside the
number of samples associated with each pixel in the image is undefined</p>
</div>
<div class="paragraph">
<p><strong>Add the following built-in functions to section 6.13.14.5&#8201;&#8212;&#8201;Built-in Image
Query Functions:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="opencl_c"><span class="kt">int</span> <span class="n">get_image_width</span><span class="p">(</span><span class="n">image2d_msaa_t</span> <span class="n">image</span><span class="p">)</span>

<span class="kt">int</span> <span class="n">get_image_width</span><span class="p">(</span><span class="n">image2d_array_msaa_t</span> <span class="n">image</span><span class="p">)</span>

<span class="kt">int</span> <span class="n">get_image_width</span><span class="p">(</span><span class="n">image2d_msaa_depth_t</span> <span class="n">image</span><span class="p">)</span>

<span class="kt">int</span> <span class="n">get_image_width</span><span class="p">(</span><span class="n">image2d_array_msaa_depth_t</span> <span class="n">image</span><span class="p">)</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Return the image width in pixels.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="opencl_c"><span class="kt">int</span> <span class="n">get_image_height</span><span class="p">(</span><span class="n">image2d_msaa_t</span> <span class="n">image</span><span class="p">)</span>

<span class="kt">int</span> <span class="n">get_image_height</span><span class="p">(</span><span class="n">image2d_array_msaa_t</span> <span class="n">image</span><span class="p">)</span>

<span class="kt">int</span> <span class="n">get_image_height</span><span class="p">(</span><span class="n">image2d_msaa_depth_t</span> <span class="n">image</span><span class="p">)</span>

<span class="kt">int</span> <span class="n">get_image_height</span><span class="p">(</span><span class="n">image2d_array_msaa_depth_t</span> <span class="n">image</span><span class="p">)</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Return the image height in pixels.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="opencl_c"><span class="kt">int</span> <span class="n">get_image_channel_data_type</span><span class="p">(</span><span class="n">image2d_msaa_t</span> <span class="n">image</span><span class="p">)</span>

<span class="kt">int</span> <span class="n">get_image_channel_data_type</span><span class="p">(</span><span class="n">image2d_array_msaa_t</span> <span class="n">image</span><span class="p">)</span>

<span class="kt">int</span> <span class="n">get_image_channel_data_type</span><span class="p">(</span><span class="n">image2d_msaa_depth_t</span> <span class="n">image</span><span class="p">)</span>

<span class="kt">int</span> <span class="n">get_image_channel_data_type</span><span class="p">(</span><span class="n">image2d_array_msaa_depth_t</span> <span class="n">image</span><span class="p">)</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Return the channel data type.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="opencl_c"><span class="kt">int</span> <span class="n">get_image_channel_order</span><span class="p">(</span><span class="n">image2d_msaa_t</span> <span class="n">image</span><span class="p">)</span>

<span class="kt">int</span> <span class="n">get_image_channel_order</span><span class="p">(</span><span class="n">image2d_array_msaa_t</span> <span class="n">image</span><span class="p">)</span>

<span class="kt">int</span> <span class="n">get_image_channel_order</span><span class="p">(</span><span class="n">image2d_msaa_depth_t</span> <span class="n">image</span><span class="p">)</span>

<span class="kt">int</span> <span class="n">get_image_channel_order</span><span class="p">(</span><span class="n">image2d_array_msaa_depth_t</span> <span class="n">image</span><span class="p">)</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Return the image channel order.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="opencl_c"><span class="kt">int2</span> <span class="n">get_image_dim</span><span class="p">(</span><span class="n">image2d_msaa_t</span> <span class="n">image</span><span class="p">)</span>

<span class="kt">int2</span> <span class="n">get_image_dim</span><span class="p">(</span><span class="n">image2d_array_msaa_t</span> <span class="n">image</span><span class="p">)</span>

<span class="kt">int2</span> <span class="n">get_image_dim</span><span class="p">(</span><span class="n">image2d_msaa_depth_t</span> <span class="n">image</span><span class="p">)</span>

<span class="kt">int2</span> <span class="n">get_image_dim</span><span class="p">(</span><span class="n">image2d_array_msaa_depth_t</span> <span class="n">image</span><span class="p">)</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Return the 2D image width and height as an int2 type.
The width is returned in the <em>x</em> component, and the height in the <em>y</em>
component.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="opencl_c"><span class="kt">size_t</span> <span class="n">get_image_array_size</span><span class="p">(</span><span class="n">image2d_array_msaa_depth_t</span> <span class="n">image</span><span class="p">)</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Return the number of images in the 2D image array.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="opencl_c"><span class="kt">int</span> <span class="n">get_image_num_samples</span><span class="p">(</span><span class="n">image2d_msaa_t</span> <span class="n">image</span><span class="p">)</span>

<span class="kt">int</span> <span class="n">get_image_num_samples</span><span class="p">(</span><span class="n">image2d_array_msaa_t</span> <span class="n">image</span><span class="p">)</span>

<span class="kt">int</span> <span class="n">get_image_num_samples</span><span class="p">(</span><span class="n">image2d_msaa_depth_t</span> <span class="n">image</span><span class="p">)</span>

<span class="kt">int</span> <span class="n">get_image_num_samples</span><span class="p">(</span><span class="n">image2d_array_msaa_depth_t</span> <span class="n">image</span><span class="p">)</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Return the number of samples in the 2D MSAA image</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="cl_khr_egl_event"><a class="anchor" href="#cl_khr_egl_event"></a>19. Creating OpenCL Event Objects from EGL Sync Objects</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="cl_khr_egl_event-overview"><a class="anchor" href="#cl_khr_egl_event-overview"></a>19.1. Overview</h3>
<div class="paragraph">
<p>This section describes the <strong>cl_khr_egl_event</strong> extension.
This extension allows creating OpenCL event objects linked to EGL fence sync
objects, potentially improving efficiency of sharing images and buffers
between the two APIs.
The companion <strong>EGL_KHR_cl_event</strong> extension provides the complementary
functionality of creating an EGL sync object from an OpenCL event object.</p>
</div>
</div>
<div class="sect2">
<h3 id="_general_information_18"><a class="anchor" href="#_general_information_18"></a>19.2. General information</h3>
<div class="sect3">
<h4 id="_version_history_18"><a class="anchor" href="#_version_history_18"></a>19.2.1. Version history</h4>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 60%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><strong>Date</strong></th>
<th class="tableblock halign-left valign-top"><strong>Version</strong></th>
<th class="tableblock halign-left valign-top"><strong>Description</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">2020-04-21</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.0.0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">First assigned version.</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect2">
<h3 id="cl_khr_egl_event-new-procedures-and-functions"><a class="anchor" href="#cl_khr_egl_event-new-procedures-and-functions"></a>19.3. New Procedures and Functions</h3>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="opencl"><span class="kt">cl_event</span> <span class="nf">clCreateEventFromEGLSyncKHR</span><span class="p">(</span><span class="kt">cl_context</span> <span class="n">context</span><span class="p">,</span>
                                     <span class="kt">CLeglSyncKHR</span> <span class="n">sync</span><span class="p">,</span>
                                     <span class="kt">CLeglDisplayKHR</span> <span class="n">display</span><span class="p">,</span>
                                     <span class="kt">cl_int</span> <span class="o">*</span><span class="n">errcode_ret</span><span class="p">);</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="cl_khr_egl_event-new-tokens"><a class="anchor" href="#cl_khr_egl_event-new-tokens"></a>19.4. New Tokens</h3>
<div class="paragraph">
<p>Returned by clCreateEventFromEGLSyncKHR if <em>sync</em> is not a valid EGLSyncKHR
handle created with respect to EGLDisplay <em>display</em>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="opencl"><span class="n">CL_INVALID_EGL_OBJECT_KHR</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Returned by <strong>clGetEventInfo</strong> when <em>param_name</em> is CL_EVENT_COMMAND_TYPE:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="opencl"><span class="n">CL_COMMAND_EGL_FENCE_SYNC_OBJECT_KHR</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="cl_khr_egl_event-additions-to-chapter-5"><a class="anchor" href="#cl_khr_egl_event-additions-to-chapter-5"></a>19.5. Additions to Chapter 5 of the OpenCL 2.2 Specification</h3>
<div class="paragraph">
<p>Add following to the fourth paragraph of <em>section 5.11</em> (prior to the
description of <strong>clWaitForEvents</strong>):</p>
</div>
<div class="paragraph">
<p>&#8220;Event objects can also be used to reflect the status of an EGL fence sync
object.
The sync object in turn refers to a fence command executing in an EGL client
API command stream.
This provides another method of coordinating sharing of EGL / EGL client API
objects with OpenCL.
Completion of EGL / EGL client API commands may be determined by placing an
EGL fence command after commands using eglCreateSyncKHR, creating an event
from the resulting EGL sync object using clCreateEventFromEGLSyncKHR and
then specifying it in the <em>event_wait_list</em> of a clEnqueueAcquire***
command.
This method may be considerably more efficient than calling operations like
glFinish, and is referred to as <em>explicit synchronization</em>.
The application is responsible for ensuring the command stream associated
with the EGL fence is flushed to ensure the CL queue is submitted to the
device.
Explicit synchronization is most useful when an EGL client API context bound
to another thread is accessing the memory objects.&#8221;</p>
</div>
<div class="paragraph">
<p>Add CL_COMMAND_EGL_FENCE_SYNC_OBJECT_KHR to the valid <em>param_value</em> values
returned by <strong>clGetEventInfo</strong> for <em>param_name</em> CL_EVENT_COMMAND_TYPE (in the
third row and third column of <em>table 5.22</em>).</p>
</div>
<div class="paragraph">
<p>Add new <em>subsection 5.11.2</em>:</p>
</div>
<div class="paragraph">
<p>"`<strong>5.11.2 Linking Event Objects to EGL Synchronization Objects</strong></p>
</div>
<div class="paragraph">
<p>An event object may be created by linking to an EGL <strong>sync object</strong>.
Completion of such an event object is equivalent to waiting for completion
of the fence command associated with the linked EGL sync object.</p>
</div>
<div class="paragraph">
<p>The function
</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="opencl"><span class="kt">cl_event</span> <span class="n">clCreateEventFromEGLSyncKHR</span><span class="p">(</span><span class="kt">cl_context</span> <span class="n">context</span><span class="p">,</span>
                                     <span class="kt">CLeglSyncKHR</span> <span class="n">sync</span><span class="p">,</span>
                                     <span class="kt">CLeglDisplayKHR</span> <span class="n">display</span><span class="p">,</span>
                                     <span class="kt">cl_int</span> <span class="o">*</span><span class="n">errcode_ret</span><span class="p">)</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>creates a linked event object.</p>
</div>
<div class="paragraph">
<p><em>context</em> is a valid OpenCL context created from an OpenGL context or share
group, using the <strong>cl_khr_gl_sharing</strong> extension.</p>
</div>
<div class="paragraph">
<p><em>sync</em> is the name of a sync object of type EGL_SYNC_FENCE_KHR created with
respect to EGLDisplay <em>display</em>.</p>
</div>
<div class="paragraph">
<p><strong>clCreateEventFromEGLSyncKHR</strong> returns a valid OpenCL event object and
<em>errcode_ret</em> is set to CL_SUCCESS if the event object is created
successfully.
Otherwise, it returns a <code>NULL</code> value with one of the following error values
returned in <em>errcode_ret</em>:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>CL_INVALID_CONTEXT if <em>context</em> is not a valid context, or was not
created from a GL context.</p>
</li>
<li>
<p>CL_INVALID_EGL_OBJECT_KHR if <em>sync</em> is not a valid EGLSyncKHR object of
type EGL_SYNC_FENCE_KHR created with respect to EGLDisplay <em>display</em>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The parameters of an event object linked to an EGL sync object will return
the following values when queried with <strong>clGetEventInfo</strong>:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The CL_EVENT_COMMAND_QUEUE of a linked event is <code>NULL</code>, because the
event is not associated with any OpenCL command queue.</p>
</li>
<li>
<p>The CL_EVENT_COMMAND_TYPE of a linked event is
CL_COMMAND_EGL_FENCE_SYNC_OBJECT_KHR, indicating that the event is
associated with a EGL sync object, rather than an OpenCL command.</p>
</li>
<li>
<p>The CL_EVENT_COMMAND_EXECUTION_STATUS of a linked event is either
CL_SUBMITTED, indicating that the fence command associated with the sync
object has not yet completed, or CL_COMPLETE, indicating that the fence
command has completed.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>clCreateEventFromEGLSyncKHR</strong> performs an implicit <strong>clRetainEvent</strong> on the
returned event object.
Creating a linked event object also places a reference on the linked EGL
sync object.
When the event object is deleted, the reference will be removed from the EGL
sync object.</p>
</div>
<div class="paragraph">
<p>Events returned from <strong>clCreateEventFromEGLSyncKHR</strong> may only be consumed by
<strong>clEnqueueAcquire</strong>*** commands.
Passing such events to any other CL API that enqueues commands will generate
a CL_INVALID_EVENT error.`"</p>
</div>
</div>
<div class="sect2">
<h3 id="cl_khr_egl_event-additions-to-extension-specification"><a class="anchor" href="#cl_khr_egl_event-additions-to-extension-specification"></a>19.6. Additions to the OpenCL Extension Specification</h3>
<div class="paragraph">
<p>Replace the second paragraph of
<a href="#cl_khr_gl_sharing__memobjs-synchronizing-opencl-and-opengl-access-to-shared-objects">Synchronizing OpenCL and OpenGL Access to Shared Objects</a> with:</p>
</div>
<div class="paragraph">
<p>"`Prior to calling <strong>clEnqueueAcquireGLObjects</strong>, the application must ensure
that any pending EGL or EGL client API operations which access the objects
specified in <em>mem_objects</em> have completed.</p>
</div>
<div class="paragraph">
<p>If the <strong>cl_khr_egl_event</strong> extension is supported and the EGL context in
question supports fence sync objects, <em>explicit synchronization</em> can be
achieved as set out in <em>section 5.7.1</em>.</p>
</div>
<div class="paragraph">
<p>If the <strong>cl_khr_egl_event</strong> extension is not supported, completion of EGL
client API commands may be determined by issuing and waiting for completion
of commands such as glFinish or vgFinish on all client API contexts with
pending references to these objects.
Some implementations may offer other efficient synchronization methods.
If such methods exist they will be described in platform-specific
documentation.</p>
</div>
<div class="paragraph">
<p>Note that no synchronization methods other than glFinish and vgFinish are
portable between all EGL client API implementations and all OpenCL
implementations.
While this is the only way to ensure completion that is portable to all
platforms, these are expensive operation and their use should be avoided if
the cl_khr_egl_event extension is supported on a platform.`"</p>
</div>
</div>
<div class="sect2">
<h3 id="cl_khr_egl_event-issues"><a class="anchor" href="#cl_khr_egl_event-issues"></a>19.7. Issues</h3>
<div class="paragraph">
<p>Most issues are shared with <strong>cl_khr_gl_event</strong> and are resolved as described
in that extension.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Should we support implicit synchronization?</p>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>RESOLVED: No, as this may be very difficult since the synchronization would
not be with EGL, it would be with currently bound EGL client APIs.
It would be necessary to know which client APIs might be bound, to validate
that they&#8217;re associated with the EGLDisplay associated with the OpenCL
context, and to reach into each such context.</p>
</div>
</div>
</div>
</li>
<li>
<p>Do we need to have typedefs to use EGL handles in OpenCL?</p>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>RESOLVED Using typedefs for EGL handles.</p>
</div>
</div>
</div>
</li>
<li>
<p>Should we restrict which CL APIs can be used with this cl_event?</p>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>RESOLVED Use is limited to clEnqueueAcquire*** calls only.</p>
</div>
</div>
</div>
</li>
<li>
<p>What is the desired behaviour for this extension when EGLSyncKHR is of a
type other than EGL_SYNC_FENCE_KHR?</p>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>RESOLVED This extension only requires support for EGL_SYNC_FENCE_KHR.
Support of other types is an implementation choice, and will result in
CL_INVALID_EGL_OBJECT_KHR if unsupported.</p>
</div>
</div>
</div>
</li>
</ol>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="cl_khr_egl_image"><a class="anchor" href="#cl_khr_egl_image"></a>20. Creating OpenCL Memory Objects from EGL Images</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="cl_khr_egl_image-overview"><a class="anchor" href="#cl_khr_egl_image-overview"></a>20.1. Overview</h3>
<div class="paragraph">
<p>This section describes the <strong>cl_khr_egl_image</strong> extension.
This extension provides a mechanism to creating OpenCL memory objects from
from EGLImages.</p>
</div>
</div>
<div class="sect2">
<h3 id="_general_information_19"><a class="anchor" href="#_general_information_19"></a>20.2. General information</h3>
<div class="sect3">
<h4 id="_version_history_19"><a class="anchor" href="#_version_history_19"></a>20.2.1. Version history</h4>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 60%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><strong>Date</strong></th>
<th class="tableblock halign-left valign-top"><strong>Version</strong></th>
<th class="tableblock halign-left valign-top"><strong>Description</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">2020-04-21</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.0.0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">First assigned version.</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect2">
<h3 id="cl_khr_egl_image-new-procedures-and-functions"><a class="anchor" href="#cl_khr_egl_image-new-procedures-and-functions"></a>20.3. New Procedures and Functions</h3>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="opencl"><span class="kt">cl_mem</span> <span class="nf">clCreateFromEGLImageKHR</span><span class="p">(</span><span class="kt">cl_context</span> <span class="n">context</span><span class="p">,</span>
                               <span class="kt">CLeglDisplayKHR</span> <span class="n">display</span><span class="p">,</span>
                               <span class="kt">CLeglImageKHR</span> <span class="n">image</span><span class="p">,</span>
                               <span class="kt">cl_mem_flags</span> <span class="n">flags</span><span class="p">,</span>
                               <span class="k">const</span> <span class="kt">cl_egl_image_properties_khr</span> <span class="o">*</span><span class="n">properties</span><span class="p">,</span>
                               <span class="kt">cl_int</span> <span class="o">*</span><span class="n">errcode_ret</span><span class="p">);</span>

<span class="kt">cl_int</span> <span class="n">clEnqueueAcquireEGLObjectsKHR</span><span class="p">(</span><span class="kt">cl_command_queue</span> <span class="n">command_queue</span><span class="p">,</span>
                                     <span class="kt">cl_uint</span> <span class="n">num_objects</span><span class="p">,</span>
                                     <span class="k">const</span> <span class="kt">cl_mem</span> <span class="o">*</span><span class="n">mem_objects</span><span class="p">,</span>
                                     <span class="kt">cl_uint</span> <span class="n">num_events_in_wait_list</span><span class="p">,</span>
                                     <span class="k">const</span> <span class="kt">cl_event</span> <span class="o">*</span><span class="n">event_wait_list</span><span class="p">,</span>
                                     <span class="kt">cl_event</span> <span class="o">*</span><span class="n">event</span><span class="p">)</span>

<span class="kt">cl_int</span> <span class="n">clEnqueueReleaseEGLObjectsKHR</span><span class="p">(</span><span class="kt">cl_command_queue</span> <span class="n">command_queue</span><span class="p">,</span>
                                     <span class="kt">cl_uint</span> <span class="n">num_objects</span><span class="p">,</span>
                                     <span class="k">const</span> <span class="kt">cl_mem</span> <span class="o">*</span><span class="n">mem_objects</span><span class="p">,</span>
                                     <span class="kt">cl_uint</span> <span class="n">num_events_in_wait_list</span><span class="p">,</span>
                                     <span class="k">const</span> <span class="kt">cl_event</span> <span class="o">*</span><span class="n">event_wait_list</span><span class="p">,</span>
                                     <span class="kt">cl_event</span> <span class="o">*</span><span class="n">event</span><span class="p">)</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="cl_khr_egl_image-new-tokens"><a class="anchor" href="#cl_khr_egl_image-new-tokens"></a>20.4. New Tokens</h3>
<div class="paragraph">
<p>New error codes:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="opencl"><span class="n">CL_EGL_RESOURCE_NOT_ACQUIRED_KHR</span>
<span class="n">CL_INVALID_EGL_OBJECT_KHR</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>New command types:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="opencl"><span class="n">CL_COMMAND_ACQUIRE_EGL_OBJECTS_KHR</span>
<span class="n">CL_COMMAND_RELEASE_EGL_OBJECTS_KHR</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="cl_khr_egl_image-additions-to-chapter-5"><a class="anchor" href="#cl_khr_egl_image-additions-to-chapter-5"></a>20.5. Additions to Chapter 5 of the OpenCL 2.2 Specification</h3>
<div class="paragraph">
<p>In section 5.2.4, add the following text after the paragraph defining
clCreateImage:</p>
</div>
<div class="paragraph">
<p>"`The function
</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="opencl"><span class="kt">cl_mem</span> <span class="nf">clCreateFromEGLImageKHR</span><span class="p">(</span><span class="kt">cl_context</span> <span class="n">context</span><span class="p">,</span>
                               <span class="kt">CLeglDisplayKHR</span> <span class="n">display</span><span class="p">,</span>
                               <span class="kt">CLeglImageKHR</span> <span class="n">image</span><span class="p">,</span>
                               <span class="kt">cl_mem_flags</span> <span class="n">flags</span><span class="p">,</span>
                               <span class="k">const</span> <span class="kt">cl_egl_image_properties_khr</span> <span class="o">*</span><span class="n">properties</span><span class="p">,</span>
                               <span class="kt">cl_int</span> <span class="o">*</span><span class="n">errcode_ret</span><span class="p">);</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>creates an EGLImage target of type cl_mem from the EGLImage source provided
as <em>image</em>.</p>
</div>
<div class="paragraph">
<p><em>display</em> should be of type EGLDisplay, cast into the type CLeglDisplayKHR.</p>
</div>
<div class="paragraph">
<p><em>image</em> should be of type EGLImageKHR, cast into the type CLeglImageKHR.
Assuming no errors are generated in this function, the resulting image
object will be an EGLImage target of the specified EGLImage <em>image</em>.
The resulting cl_mem is an image object which may be used normally by all
OpenCL operations.
This maps to an image2d_t type in OpenCL kernel code.</p>
</div>
<div class="paragraph">
<p><em>flags</em> is a bit-field that is used to specify usage information about the
memory object being created.</p>
</div>
<div class="paragraph">
<p>The possible values for <em>flags</em> are: CL_MEM_READ_ONLY, CL_MEM_WRITE_ONLY and
CL_MEM _READ_WRITE.</p>
</div>
<div class="paragraph">
<p>For OpenCL 1.2 <em>flags</em> also accepts: CL_MEM_HOST_WRITE_ONLY,
CL_MEM_HOST_READ_ONLY or CL_MEM_HOST_NO_ACCESS.</p>
</div>
<div class="paragraph">
<p>This extension only requires support for CL_MEM _READ_ONLY, and for OpenCL
1.2 CL_MEM_HOST_NO_ACCESS.
For OpenCL 1.1, a CL_INVALID_OPERATION will be returned for images which do
not support host mapping.</p>
</div>
<div class="paragraph">
<p>If the value passed in <em>flags</em> is not supported by the OpenCL implementation
it will return CL_INVALID_VALUE.
The accepted <em>flags</em> may be dependent upon the texture format used.</p>
</div>
<div class="paragraph">
<p><em>properties</em> specifies a list of property names and their corresponding
values.
Each property name is immediately followed by the corresponding desired
value.
The list is terminated with 0.
No properties are currently supported with this version of the extension.
<em>properties</em> can be <code>NULL</code>.</p>
</div>
<div class="paragraph">
<p><strong>clCreateFromEGLImageKHR</strong> returns a valid non-zero OpenCL image object and
<em>errcode_ret</em> is set to CL_SUCCESS if the image object is created
successfully.
Otherwise, it returns a <code>NULL</code> value with one of the following error values
returned in <em>errcode_ret</em>:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>CL_INVALID_CONTEXT if <em>context</em> is not a valid OpenCL context.</p>
</li>
<li>
<p>CL_INVALID_VALUE if <em>properties</em> contains invalid values, if <em>display</em>
is not a valid display object or if <em>flags</em> are not in the set defined
above.</p>
</li>
<li>
<p>CL_INVALID_EGL_OBJECT_KHR if <em>image</em> is not a valid EGLImage object.</p>
</li>
<li>
<p>CL_IMAGE_FORMAT_NOT_SUPPORTED if the OpenCL implementation is not able
to create a cl_mem compatible with the provided CLeglImageKHR for an
implementation-dependent reason (this could be caused by, but not
limited to, reasons such as unsupported texture formats, etc).</p>
</li>
<li>
<p>CL_OUT_OF_HOST_MEMORY if there is a failure to allocate resources
required by the OpenCL implementation on the host.</p>
</li>
<li>
<p>CL_OUT_OF_RESOURCES if there is a failure to allocate resources required
by the OpenCL implementation on the device.</p>
</li>
<li>
<p>CL_INVALID_OPERATION if there are no devices in <em>context</em> that support
images (i.e. CL_DEVICE_IMAGE_SUPPORT specified in table 4.3 is CL_FALSE)
or if the flags passed are not supported for that image type.`"</p>
</li>
</ul>
</div>
<div class="sect3">
<h4 id="cl_khr_egl_image-lifetime-of-shared-objects"><a class="anchor" href="#cl_khr_egl_image-lifetime-of-shared-objects"></a>20.5.1. Lifetime of Shared Objects</h4>
<div class="paragraph">
<p>An OpenCL memory object created from an EGL image remains valid according to
the lifetime behavior as described in EGL_KHR_image_base.</p>
</div>
<div class="paragraph">
<p>&#8220;Any EGLImage siblings exist in any client API context&#8221;</p>
</div>
<div class="paragraph">
<p>For OpenCL this means that while the application retains a reference on the
cl_mem (the EGL sibling), the image remains valid.</p>
</div>
</div>
<div class="sect3">
<h4 id="cl_khr_egl_image-synchronizing-opengl-and-egl-access-to-shared-objects"><a class="anchor" href="#cl_khr_egl_image-synchronizing-opengl-and-egl-access-to-shared-objects"></a>20.5.2. Synchronizing OpenCL and EGL Access to Shared Objects</h4>
<div class="paragraph">
<p>In order to ensure data integrity, the application is responsible for
synchronizing access to shared CL/EGL objects by their respective APIs.
Failure to provide such synchronization may result in race conditions and
other undefined behavior including non-portability between implementations.</p>
</div>
<div class="paragraph">
<p>Prior to calling clEnqueueAcquireEGLObjectsKHR, the application must ensure
that any pending operations which access the objects specified in
mem_objects have completed.
This may be accomplished in a portable way by ceasing all client operations
on the resource, and issuing and waiting for completion of a glFinish
command on all GL contexts with pending references to these objects.
Implementations may offer more efficient synchronization methods, such as
synchronization primitives or fence operations.</p>
</div>
<div class="paragraph">
<p>Similarly, after calling clEnqueueReleaseEGLImageObjects, the application is
responsible for ensuring that any pending OpenCL operations which access the
objects specified in mem_objects have completed prior to executing
subsequent commands in other APIs which reference these objects.
This may be accomplished in a portable way by calling clWaitForEvents with
the event object returned by clEnqueueReleaseGLObjects, or by calling
clFinish.
As above, some implementations may offer more efficient methods.</p>
</div>
<div class="paragraph">
<p>Attempting to access the data store of an EGLImage object after it has been
acquired by OpenCL and before it has been released will result in undefined
behavior.
Similarly, attempting to access a shared EGLImage object from OpenCL before
it has been acquired by the OpenCL command queue or after it has been
released, will result in undefined behavior.</p>
</div>
</div>
<div class="sect3">
<h4 id="cl_khr_egl_image-sharing-memory-objects-created-from-egl-resources-between-egldisplays-and-opencl-contexts"><a class="anchor" href="#cl_khr_egl_image-sharing-memory-objects-created-from-egl-resources-between-egldisplays-and-opencl-contexts"></a>20.5.3. Sharing memory objects created from EGL resources between EGLDisplays and OpenCL contexts</h4>
<div class="paragraph">
<p>The function
</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="opencl"><span class="kt">cl_int</span> <span class="n">clEnqueueAcquireEGLObjectsKHR</span><span class="p">(</span><span class="kt">cl_command_queue</span> <span class="n">command_queue</span><span class="p">,</span>
                                     <span class="kt">cl_uint</span> <span class="n">num_objects</span><span class="p">,</span>
                                     <span class="k">const</span> <span class="kt">cl_mem</span> <span class="o">*</span><span class="n">mem_objects</span><span class="p">,</span>
                                     <span class="kt">cl_uint</span> <span class="n">num_events_in_wait_list</span><span class="p">,</span>
                                     <span class="k">const</span> <span class="kt">cl_event</span> <span class="o">*</span><span class="n">event_wait_list</span><span class="p">,</span>
                                     <span class="kt">cl_event</span> <span class="o">*</span><span class="n">event</span><span class="p">)</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>is used to acquire OpenCL memory objects that have been created from EGL
resources.
The EGL objects are acquired by the OpenCL context associated with
<em>command_queue</em> and can therefore be used by all command-queues associated
with the OpenCL context.</p>
</div>
<div class="paragraph">
<p>OpenCL memory objects created from EGL resources must be acquired before
they can be used by any OpenCL commands queued to a command-queue. If an
OpenCL memory object created from a EGL resource is used while it is not
currently acquired by OpenCL, the behavior is undefined. Implementations
may fail the execution of commands attempting to use that OpenCL memory
object and set their associated event&#8217;s execution status to
<code>CL_EGL_<wbr>RESOURCE_<wbr>NOT_<wbr>ACQUIRED_<wbr>KHR</code>.</p>
</div>
<div class="paragraph">
<p><em>command_queue</em> is a valid command-queue.</p>
</div>
<div class="paragraph">
<p><em>num_objects</em> is the number of memory objects to be acquired in
<em>mem_objects</em>.</p>
</div>
<div class="paragraph">
<p><em>mem_objects</em> is a pointer to a list of OpenCL memory objects that were
created from EGL resources, within the context associate with command_queue.</p>
</div>
<div class="paragraph">
<p><em>event_wait_list</em> and <em>num_events_in_wait_list</em> specify events that need to
complete before this particular command can be executed.
If <em>event_wait_list</em> is <code>NULL</code>, then this particular command does not wait
on any event to complete.
If <em>event_wait_list</em> is <code>NULL</code>, <em>num_events_in_wait_list</em> must be 0.
If <em>event_wait_list</em> is not <code>NULL</code>, the list of events pointed to by
<em>event_wait_list</em> must be valid and <em>num_events_in_wait_list</em> must be
greater than 0.
The events specified in <em>event_wait_list</em> act as synchronization points.</p>
</div>
<div class="paragraph">
<p><em>event</em> returns an event object that identifies this command and
can be used to query or wait for this command to complete.
If <em>event</em> is <code>NULL</code> or the enqueue is unsuccessful, no event will be
created and therefore it will not be possible to query the status of this
command or to wait for this command to complete.
If <em>event_wait_list</em> and <em>event</em> are not <code>NULL</code>, <em>event</em> must not refer
to an element of the <em>event_wait_list</em> array.</p>
</div>
<div class="paragraph">
<p><strong>clEnqueueAcquireEGLObjectsKHR</strong> returns CL_SUCCESS if the function is
executed successfully.
If <em>num_objects</em> is 0 and <em>mem_objects</em> is <code>NULL</code> then the function does
nothing and returns CL_SUCCESS.
Otherwise it returns one of the following errors:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>CL_INVALID_VALUE if <em>num_objects</em> is zero and <em>mem_objects</em> is not a
<code>NULL</code> value or if num_objects &gt; 0 and mem_objects is <code>NULL</code>.</p>
</li>
<li>
<p>CL_INVALID_MEM_OBJECT if memory objects in <em>mem_objects</em> are not valid
OpenCL memory objects in the context associated with <em>command_queue</em>.</p>
</li>
<li>
<p>CL_INVALID_EGL_OBJECT_KHR if memory objects in <em>mem_objects</em> have not
been created from EGL resources.</p>
</li>
<li>
<p>CL_INVALID_COMMAND_QUEUE if <em>command_queue</em> is not a valid
command-queue.</p>
</li>
<li>
<p>CL_INVALID_EVENT_WAIT_LIST if <em>event_wait_list</em> is <code>NULL</code> and
<em>num_events_in_wait_list</em> &gt; 0, or <em>event_wait_list</em> is not <code>NULL</code> and
<em>num_events_in_wait_list</em> is 0, or if event objects in <em>event_wait_list</em>
are not valid events.</p>
</li>
<li>
<p>CL_OUT_OF_RESOURCES if there is a failure to allocate resources required
by the OpenCL implementation on the device.</p>
</li>
<li>
<p>CL_OUT_OF_HOST_MEMORY if there is a failure to allocate resources
required by the OpenCL implementation on the host.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The function
</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="opencl"><span class="kt">cl_int</span> <span class="n">clEnqueueReleaseEGLObjectsKHR</span><span class="p">(</span><span class="kt">cl_command_queue</span> <span class="n">command_queue</span><span class="p">,</span>
                                     <span class="kt">cl_uint</span> <span class="n">num_objects</span><span class="p">,</span>
                                     <span class="k">const</span> <span class="kt">cl_mem</span> <span class="o">*</span><span class="n">mem_objects</span><span class="p">,</span>
                                     <span class="kt">cl_uint</span> <span class="n">num_events_in_wait_list</span><span class="p">,</span>
                                     <span class="k">const</span> <span class="kt">cl_event</span> <span class="o">*</span><span class="n">event_wait_list</span><span class="p">,</span>
                                     <span class="kt">cl_event</span> <span class="o">*</span><span class="n">event</span><span class="p">)</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>is used to release OpenCL memory objects that have been created from EGL
resources.
The EGL objects are released by the OpenCL context associated with
&lt;command_queue&gt;.</p>
</div>
<div class="paragraph">
<p>OpenCL memory objects created from EGL resources which have been acquired by
OpenCL must be released by OpenCL before they may be accessed by EGL or by
EGL client APIs.
Accessing a EGL resource while its corresponding OpenCL memory object is
acquired is in error and will result in undefined behavior, including but
not limited to possible OpenCL errors, data corruption, and program
termination.</p>
</div>
<div class="paragraph">
<p><em>command_queue</em> is a valid command-queue.</p>
</div>
<div class="paragraph">
<p><em>num_objects</em> is the number of memory objects to be acquired in
<em>mem_objects</em>.</p>
</div>
<div class="paragraph">
<p><em>mem_objects</em> is a pointer to a list of OpenCL memory objects that were
created from EGL resources, within the context associate with command_queue.</p>
</div>
<div class="paragraph">
<p><em>event_wait_list</em> and <em>num_events_in_wait_list</em> specify events that need to
complete before this particular command can be executed.
If <em>event_wait_list</em> is <code>NULL</code>, then this particular command does not wait
on any event to complete.
If <em>event_wait_list</em> is <code>NULL</code>, <em>num_events_in_wait_list</em> must be 0.
If <em>event_wait_list</em> is not <code>NULL</code>, the list of events pointed to by
<em>event_wait_list</em> must be valid and <em>num_events_in_wait_list</em> must be
greater than 0.
The events specified in <em>event_wait_list</em> act as synchronization points.</p>
</div>
<div class="paragraph">
<p><em>event</em> returns an event object that identifies this command and
can be used to query or wait for this command to complete.
If <em>event</em> is <code>NULL</code> or the enqueue is unsuccessful, no event will be
created and therefore it will not be possible to query the status of this
command or to wait for this command to complete.
If <em>event_wait_list</em> and <em>event</em> are not <code>NULL</code>, <em>event</em> must not refer
to an element of the <em>event_wait_list</em> array.</p>
</div>
<div class="paragraph">
<p><strong>clEnqueueReleaseEGLObjectsKHR</strong> returns CL_SUCCESS if the function is
executed successfully.
If <em>num_objects</em> is 0 and <em>mem_objects</em> is <code>NULL</code> then the function does
nothing and returns CL_SUCCESS.
Otherwise it returns one of the following errors:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>CL_INVALID_VALUE if <em>num_objects</em> is zero and <em>mem_objects</em> is not a
<code>NULL</code> value or if num_objects &gt; 0 and mem_objects is <code>NULL</code>.</p>
</li>
<li>
<p>CL_INVALID_MEM_OBJECT if memory objects in <em>mem_objects</em> are not valid
OpenCL memory objects in the context associated with <em>command_queue</em>.</p>
</li>
<li>
<p>CL_INVALID_EGL_OBJECT_KHR if memory objects in <em>mem_objects</em> have not
been created from EGL resources.</p>
</li>
<li>
<p>CL_INVALID_COMMAND_QUEUE if <em>command_queue</em> is not a valid
command-queue.</p>
</li>
<li>
<p>CL_INVALID_EVENT_WAIT_LIST if <em>event_wait_list</em> is <code>NULL</code> and
<em>num_events_in_wait_list</em> &gt; 0, or <em>event_wait_list</em> is not <code>NULL</code> and
<em>num_events_in_wait_list</em> is 0, or if event objects in <em>event_wait_list</em>
are not valid events.</p>
</li>
<li>
<p>CL_OUT_OF_RESOURCES if there is a failure to allocate resources required
by the OpenCL implementation on the device.</p>
</li>
<li>
<p>CL_OUT_OF_HOST_MEMORY if there is a failure to allocate resources
required by the OpenCL implementation on the host.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="cl_khr_egl_image-event-command-types"><a class="anchor" href="#cl_khr_egl_image-event-command-types"></a>20.5.4. Event Command Types for Sharing memory objects created from EGL resources</h4>
<div class="paragraph">
<p>The following table describes the event command types for the OpenCL commands
to acquire and release OpenCL memory objects that have been created from
EGL resources:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 45. List of supported event command types</caption>
<colgroup>
<col style="width: 40%;">
<col style="width: 60%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><strong>Events Created By</strong></th>
<th class="tableblock halign-left valign-top"><strong>Event Command Type</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>clEnqueueAcquireEGLObjectsKHR</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CL_COMMAND_<wbr>ACQUIRE_<wbr>EGL_<wbr>OBJECTS_<wbr>KHR</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>clEnqueueReleaseEGLObjectsKHR</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CL_COMMAND_<wbr>RELEASE_<wbr>EGL_<wbr>OBJECTS_<wbr>KHR</code></p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect2">
<h3 id="cl_khr_egl_image-issues"><a class="anchor" href="#cl_khr_egl_image-issues"></a>20.6. Issues</h3>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>This extension does not support reference counting of the images, so the
onus is on the application to behave sensibly and not release the
underlying cl_mem object while the EGLImage is still being used.</p>
</li>
<li>
<p>In order to ensure data integrity, the application is responsible for
synchronizing access to shared CL/EGL image objects by their respective
APIs.
Failure to provide such synchronization may result in race conditions
and other undefined behavior.
This may be accomplished by calling clWaitForEvents with the event
objects returned by any OpenCL commands which use the shared image
object or by calling clFinish.</p>
</li>
<li>
<p>Currently CL_MEM_READ_ONLY is the only supported flag for <em>flags</em>.</p>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>RESOLVED: Implementation will now return an error if writing to a shared
object that is not supported rather than disallowing it entirely.</p>
</div>
</div>
</div>
</li>
<li>
<p>Currently restricted to 2D image objects.</p>
</li>
<li>
<p>What should happen for YUV color-space conversion, multi plane images,
and chroma-siting, and channel mapping?</p>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>RESOLVED: YUV is no longer explicitly described in this extension.
Before this removal the behavior was dependent on the platform.
This extension explicitly leaves the YUV layout to the platform and EGLImage
source extension (i.e. is implementation specific).
Colorspace conversion must be applied by the application using a color
conversion matrix.</p>
</div>
<div class="paragraph">
<p>The expected extension path if YUV color-space conversion is to be supported
is to introduce a YUV image type and provide overloaded versions of the
read_image built-in functions.</p>
</div>
<div class="paragraph">
<p>Getting image information for a YUV image should return the original image
size (non quantized size) when all of Y U and V are present in the image.
If the planes have been separated then the actual dimensionality of the
separated plane should be reported.
For example with YUV 4:2:0 (NV12) with a YUV image of 256x256, the Y only
image would return 256x256 whereas the UV only image would return 128x128.</p>
</div>
</div>
</div>
</li>
<li>
<p>Should an attribute list be used instead?</p>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>RESOLVED: function has been changed to use an attribute list.</p>
</div>
</div>
</div>
</li>
<li>
<p>What should happen for EGLImage extensions which introduce formats
without a mapping to an OpenCL image channel data type or channel order?</p>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>RESOLVED: This extension does not define those formats.
It is expected that as additional EGL extensions are added to create EGL
images from other sources, an extension to CL will be introduced where
needed to represent those image types.</p>
</div>
</div>
</div>
</li>
<li>
<p>What are the guarantees to synchronization behavior provided by the
implementation?</p>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The basic portable form of synchronization is to use a clFinish, as is the
case for GL interop.
In addition implementations which support the synchronization extensions
cl_khr_egl_event and EGL_KHR_cl_event can interoperate more efficiently as
described in those extensions.</p>
</div>
</div>
</div>
</li>
</ol>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="cl_khr_image2d_from_buffer"><a class="anchor" href="#cl_khr_image2d_from_buffer"></a>21. Creating a 2D Image From A Buffer</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This section describes the <strong>cl_khr_image2d_from_buffer</strong> extension.</p>
</div>
<div class="paragraph">
<p>This extension allows a 2D image to be created from an existing OpenCL buffer memory object.</p>
</div>
<div class="paragraph">
<p>This extension became a core feature in OpenCL 2.0.</p>
</div>
<div class="sect2">
<h3 id="_general_information_20"><a class="anchor" href="#_general_information_20"></a>21.1. General information</h3>
<div class="sect3">
<h4 id="_version_history_20"><a class="anchor" href="#_version_history_20"></a>21.1.1. Version history</h4>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 60%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><strong>Date</strong></th>
<th class="tableblock halign-left valign-top"><strong>Version</strong></th>
<th class="tableblock halign-left valign-top"><strong>Description</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">2020-04-21</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.0.0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">First assigned version.</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_additions_to_chapter_4_of_the_opencl_1_2_specification"><a class="anchor" href="#_additions_to_chapter_4_of_the_opencl_1_2_specification"></a>21.2. Additions to Chapter 4 of the OpenCL 1.2 Specification</h3>
<div class="paragraph">
<p>The following table entry describes the additions to <em>table 4.3,</em> which allows applications to query the configuration information using <strong>clGetDeviceInfo</strong> for an OpenCL device that supports creating a 2D image from a buffer.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 40%;">
<col style="width: 20%;">
<col style="width: 40%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Device Info</th>
<th class="tableblock halign-left valign-top">Return Type</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CL_DEVICE_<wbr>IMAGE_<wbr>PITCH_<wbr>ALIGNMENT_<wbr>KHR</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>cl_uint</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The row pitch alignment size in pixels for images created from a buffer.  The value returned must be a power of 2.<br>
<br>
If the device does not support images, this value should be 0.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CL_DEVICE_<wbr>IMAGE_<wbr>BASE_<wbr>ADDRESS_<wbr>ALIGNMENT_<wbr>KHR</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>cl_uint</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">This query should be used when an image is created from a buffer which was created using <code>CL_MEM_<wbr>USE_<wbr>HOST_<wbr>PTR</code>. The value returned must be a power of 2.<br>
<br>
This query specifies the minimum alignment in pixels of the <em>host_ptr</em> specified to <strong>clCreateBuffer</strong>.<br>
<br>
If the device does not support images, this value should be 0.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="_additions_to_chapter_5_of_the_opencl_1_2_specification"><a class="anchor" href="#_additions_to_chapter_5_of_the_opencl_1_2_specification"></a>21.3. Additions to Chapter 5 of the OpenCL 1.2 Specification</h3>
<div class="paragraph">
<p>Add to Section 5.3.1: Creating Image Objects:</p>
</div>
<div class="paragraph">
<p>A 2D image can be created from a buffer by specifying a <em>buffer</em> object in the <em>image_desc</em> passed to <strong>clCreateImage</strong> for an <em>image_type</em> equal to <code>CL_MEM_<wbr>OBJECT_<wbr>IMAGE2D</code>. When the 2D image from buffer is created, the client must specify the width, height and image format (i.e. channel order and channel data type). If these are not specified, <strong>clCreateImage</strong> returns a NULL value with <em>errcode_ret</em> set to <code>CL_INVALID_<wbr>IMAGE_<wbr>FORMAT_<wbr>DESCRIPTOR</code>.  The pitch can be optionally specified. If the pitch is not specified, the pitch is computed as width  bytes per pixel based on the image format.</p>
</div>
<div class="paragraph">
<p>The pitch specified (or computed if pitch specified is 0) must be a multiple of the maximum of the <code>CL_DEVICE_<wbr>IMAGE_<wbr>PITCH_<wbr>ALIGNMENT_<wbr>KHR</code> value for all devices in the context associated with the <em>buffer</em> that support images.  Otherwise, <strong>clCreateImage</strong> returns a NULL value with <em>errcode_ret</em> set to <code>CL_INVALID_<wbr>IMAGE_<wbr>FORMAT_<wbr>DESCRIPTOR</code>.</p>
</div>
<div class="paragraph">
<p>If the <em>buffer</em> was created with <code>CL_MEM_<wbr>USE_<wbr>HOST_<wbr>PTR</code>, the <em>host_ptr</em> specified to <strong>clCreateBuffer</strong> must be aligned to the maximum of the <code>CL_DEVICE_<wbr>IMAGE_<wbr>BASE_<wbr>ADDRESS_<wbr>ALIGNMENT_<wbr>KHR</code> value for all devices in the context associated with the <em>buffer</em> that support images.  Otherwise, <strong>clCreateImage</strong> returns a NULL value with <em>errcode_ret</em> set to <code>CL_INVALID_<wbr>IMAGE_<wbr>FORMAT_<wbr>DESCRIPTOR</code>.</p>
</div>
<div class="paragraph">
<p>The minimum list of supported image formats described in <em>table 5.8</em> of the OpenCL 1.2 specification must be supported for 2D images created from a buffer.</p>
</div>
<div class="paragraph">
<p>The OpenCL runtime APIs that operate on images (i.e. <strong>clEnqueueReadImage</strong>, <strong>clEnqueueWriteImage</strong>, <strong>clEnqueueFillImage</strong>, <strong>clEnqueueCopyImage</strong>, <strong>clEnqueueCopyImageToBuffer</strong>, <strong>clEnqueueCopyBufferToImage</strong> and <strong>clEnqueueMapImage</strong>) are supported for a 2D image created from a buffer.</p>
</div>
<div class="paragraph">
<p>When the contents of a buffer object data store are modified, those changes are reflected in the contents of the 2D image object and vice-versa at corresponding synchronization points. The <em>image_height</em>  <em>image_row_pitch</em> specified in <em>image_desc</em> must be less than or equal to the size of the buffer object data store.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Concurrent reading from, writing to, and copying between both a buffer object and the 2D image object associated with the buffer object is undefined. Only reading from both a buffer object and 2D image object associated with the buffer object is defined. A 2D image and a 2D image created from a buffer use the same image type in OpenCL C (<code>image2d_t</code>). The image built-ins functions described in <em>section 6.12.14.2</em>, <em>6.12.14.3</em>, <em>6.12.14.4</em> and <em>6.12.14.5</em> for <code>image2d_t</code> behave the same way for a 2D image and a 2D image from a buffer.
</td>
</tr>
</table>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="cl_khr_initialize_memory"><a class="anchor" href="#cl_khr_initialize_memory"></a>22. Local and Private Memory Initialization</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Memory is allocated in various forms in OpenCL both explicitly (global
memory) or implicitly (local, private memory).
This allocation so far does not provide a straightforward mechanism to
initialize the memory on allocation.
In other words what is lacking is the equivalent of calloc for the currently
supported malloc like capability.
This functionality is useful for a variety of reasons including ease of
debugging, application controlled limiting of visibility to previous
contents of memory and in some cases, optimization.</p>
</div>
<div class="paragraph">
<p>This extension adds support for initializing local and private memory before
a kernel begins execution.
This extension name is <strong>cl_khr_initialize_memory</strong>.</p>
</div>
<div class="sect2">
<h3 id="_general_information_21"><a class="anchor" href="#_general_information_21"></a>22.1. General information</h3>
<div class="sect3">
<h4 id="_version_history_21"><a class="anchor" href="#_version_history_21"></a>22.1.1. Version history</h4>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 60%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><strong>Date</strong></th>
<th class="tableblock halign-left valign-top"><strong>Version</strong></th>
<th class="tableblock halign-left valign-top"><strong>Description</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">2020-04-21</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.0.0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">First assigned version.</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect2">
<h3 id="cl_khr_initialize_memory-additions-to-chapter-4"><a class="anchor" href="#cl_khr_initialize_memory-additions-to-chapter-4"></a>22.2. Additions to Chapter 4 of the OpenCL 2.2 Specification</h3>
<div class="paragraph">
<p>Add a new context property to <em>table 4.5</em> in <em>section 4.4</em>.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 46. List of supported context creation properties by <strong>clCreateContext</strong></caption>
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 22.2222%;">
<col style="width: 44.4445%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Context Property</th>
<th class="tableblock halign-left valign-top">Property value</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CL_CONTEXT_<wbr>MEMORY_<wbr>INITIALIZE_<wbr>KHR</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>cl_context_memory_initialize_khr</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Describes which memory types for the context must be initialized.
  This is a bit-field, where the following values are currently supported:</p>
<p class="tableblock">  <code>CL_CONTEXT_MEMORY_INITIALIZE_LOCAL_KHR</code>&#8201;&#8212;&#8201;Initialize local memory to
  zeros.</p>
<p class="tableblock">  <code>CL_CONTEXT_MEMORY_INITIALIZE_PRIVATE_KHR</code>&#8201;&#8212;&#8201;Initialize private memory to
  zeros.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="cl_khr_initialize_memory-additions-to-chapter-6"><a class="anchor" href="#cl_khr_initialize_memory-additions-to-chapter-6"></a>22.3. Additions to Chapter 6 of the OpenCL 2.2 Specification</h3>
<div class="paragraph">
<p>Updates to <em>section 6.9</em>&#8201;&#8212;&#8201;Restrictions</p>
</div>
<div class="paragraph">
<p>If the context is created with CL CONTEXT MEMORY INITIALIZE KHR, appropriate
memory locations as specified by the bit-field is initialized with zeroes,
prior to the start of execution of any kernel.
The driver chooses when, prior to kernel execution, the initialization of
local and/or private memory is performed.
The only requirement is there should be no values set from outside the
context, which can be read during a kernel execution.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="cl_khr_terminate_context"><a class="anchor" href="#cl_khr_terminate_context"></a>23. Terminating OpenCL Contexts</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Today, OpenCL provides an API to release a context.
This operation is done only after all queues, memory object, programs and
kernels are released, which in turn might wait for all ongoing operations to
complete.
However, there are cases in which a fast release is required, or release
operation cannot be done, as commands are stuck in mid execution.
An example of the first case can be program termination due to exception, or
quick shutdown due to low power.
Examples of the second case are when a kernel is running too long, or gets
stuck, or it may result from user action which makes the results of the
computation unnecessary.</p>
</div>
<div class="paragraph">
<p>In many cases, the driver or the device is capable of speeding up the
closure of ongoing operations when the results are no longer required in a
much more expedient manner than waiting for all previously enqueued
operations to finish.</p>
</div>
<div class="paragraph">
<p>This extension implements a new query to check whether a device can
terminate an OpenCL context and adds an API to terminate a context.</p>
</div>
<div class="paragraph">
<p>The extension name is <strong>cl_khr_terminate_context</strong>.</p>
</div>
<div class="sect2">
<h3 id="_general_information_22"><a class="anchor" href="#_general_information_22"></a>23.1. General information</h3>
<div class="sect3">
<h4 id="_version_history_22"><a class="anchor" href="#_version_history_22"></a>23.1.1. Version history</h4>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 60%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><strong>Date</strong></th>
<th class="tableblock halign-left valign-top"><strong>Version</strong></th>
<th class="tableblock halign-left valign-top"><strong>Description</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">2020-04-21</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.0.0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">First assigned version.</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect2">
<h3 id="cl_khr_terminate_context-additions-to-chapter-4"><a class="anchor" href="#cl_khr_terminate_context-additions-to-chapter-4"></a>23.2. Additions to Chapter 4 of the OpenCL 2.2 Specification</h3>
<div class="paragraph">
<p>Add a new device property to <em>table 4.3</em> in <em>section 4.2</em>.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 47. List of supported param_names by <strong>clGetDeviceInfo</strong></caption>
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 22.2222%;">
<col style="width: 44.4445%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Device Info</th>
<th class="tableblock halign-left valign-top">Return Type</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CL_DEVICE_<wbr>TERMINATE_<wbr>CAPABILITY_<wbr>KHR</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>cl_device_<wbr>terminate_<wbr>capability_<wbr>khr</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Describes the termination capability of the OpenCL device.
  This is a bit-field, where the following values are currently supported:</p>
<p class="tableblock">  <code>CL_DEVICE_<wbr>TERMINATE_<wbr>CAPABILITY_<wbr>CONTEXT_<wbr>KHR</code> - Indicates that context
  termination is supported.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Add a new context property to <em>table 4.5</em> in <em>section 4.4</em>.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 48. List of supported context creation properties by <strong>clCreateContext</strong></caption>
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 22.2222%;">
<col style="width: 44.4445%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Context Property</th>
<th class="tableblock halign-left valign-top">Property value</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CL_CONTEXT_<wbr>TERMINATE_<wbr>KHR</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>cl_bool</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Specifies whether the context can be terminated.
  The default value is <code>CL_FALSE</code>.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><code>CL_CONTEXT_<wbr>TERMINATE_<wbr>KHR</code> can be specified in the context properties only if
all devices associated with the context support the ability to support
context termination (i.e. <code>CL_DEVICE_<wbr>TERMINATE_<wbr>CAPABILITY_<wbr>CONTEXT_<wbr>KHR</code> is set
for <code>CL_DEVICE_<wbr>TERMINATE_<wbr>CAPABILITY_<wbr>KHR</code>).
Otherwise, context creation fails with error code of <code>CL_INVALID_<wbr>PROPERTY</code>.</p>
</div>
<div class="paragraph">
<p>The new function</p>
</div>
<div id="clTerminateContextKHR" class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="opencl"><span class="kt">cl_int</span> <span class="nf">clTerminateContextKHR</span><span class="p">(</span>
    <span class="kt">cl_context</span> <span class="n">context</span><span class="p">);</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>terminates all pending work associated with the context and renders all data
owned by the context invalid.
It is the responsibility of the application to release all objects
associated with the context being terminated.</p>
</div>
<div class="paragraph">
<p>When a context is terminated:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The execution status of enqueued commands will be <code>CL_CONTEXT_<wbr>TERMINATED_<wbr>KHR</code>.
Event objects can be queried using <strong>clGetEventInfo</strong>.
Event callbacks can be registered and registered event callbacks will be
called with <em>event_command_status</em> set to <code>CL_CONTEXT_<wbr>TERMINATED_<wbr>KHR</code>.
<strong>clWaitForEvents</strong> will return as immediately for commands associated
with event objects specified in event_list.
The status of user events can be set.
Event objects can be retained and released.
<strong>clGetEventProfilingInfo</strong> returns <code>CL_PROFILING_<wbr>INFO_<wbr>NOT_<wbr>AVAILABLE</code>.</p>
</li>
<li>
<p>The context is considered to be terminated.
A callback function registered when the context was created will be
called.
Only queries, retain and release operations can be performed on the
context.
All other APIs that use a context as an argument will return
<code>CL_CONTEXT_<wbr>TERMINATED_<wbr>KHR</code>.</p>
</li>
<li>
<p>The contents of the memory regions of the memory objects is undefined.
Queries, registering a destructor callback, retain and release
operations can be performed on the memory objects.</p>
</li>
<li>
<p>Once a context has been terminated, all OpenCL API calls that create
objects or enqueue commands will return <code>CL_CONTEXT_<wbr>TERMINATED_<wbr>KHR</code>.
APIs that release OpenCL objects will continue to operate as though
<strong>clTerminateContextKHR</strong> was not called.</p>
</li>
<li>
<p>The behavior of callbacks will remain unchanged, and will report
appropriate error, if executing after termination of context.
This behavior is similar to enqueued commands, after the command queue
has become invalid.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>clTerminateContextKHR</strong> returns <code>CL_SUCCESS</code> if the function is executed
successfully.
Otherwise, it returns one of the following errors:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>CL_INVALID_<wbr>CONTEXT</code> if <em>context</em> is not a valid OpenCL context.</p>
</li>
<li>
<p><code>CL_CONTEXT_<wbr>TERMINATED_<wbr>KHR</code> if <em>context</em> has already been terminated.</p>
</li>
<li>
<p><code>CL_INVALID_<wbr>OPERATION</code> if <em>context</em> was not created with
<code>CL_CONTEXT_<wbr>TERMINATE_<wbr>KHR</code> set to <code>CL_TRUE</code>.</p>
</li>
<li>
<p><code>CL_OUT_<wbr>OF_<wbr>RESOURCES</code> if there is a failure to allocate resources required
by the OpenCL implementation on the device.</p>
</li>
<li>
<p><code>CL_OUT_<wbr>OF_<wbr>HOST_<wbr>MEMORY</code> if there is a failure to allocate resources
required by the OpenCL implementation on the host.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>An implementation that supports this extension must be able to terminate
commands currently executing on devices or queued across all command-queues
associated with the context that is being terminated.
The implementation cannot implement this extension by waiting for currently
executing (or queued) commands to finish execution on devices associated
with this context (i.e. doing a <strong>clFinish</strong>).</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="cl_khr_spir"><a class="anchor" href="#cl_khr_spir"></a>24. Standard Portable Intermediate Representation Binaries</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This extension adds the ability to create an OpenCL program object from a
Standard Portable Intermediate Representation (SPIR) instance.
A SPIR instance is a vendor-neutral non-source representation for OpenCL C
programs.</p>
</div>
<div class="paragraph">
<p>The extension name is <strong>cl_khr_spir</strong>.
This extension has been superseded by the SPIR-V intermediate
representation, which is supported by the <strong>cl_khr_il_program</strong> extension,
and is a core feature in OpenCL 2.1.</p>
</div>
<div class="sect2">
<h3 id="_general_information_23"><a class="anchor" href="#_general_information_23"></a>24.1. General information</h3>
<div class="sect3">
<h4 id="_version_history_23"><a class="anchor" href="#_version_history_23"></a>24.1.1. Version history</h4>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 60%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><strong>Date</strong></th>
<th class="tableblock halign-left valign-top"><strong>Version</strong></th>
<th class="tableblock halign-left valign-top"><strong>Description</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">2020-04-21</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.0.0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">First assigned version.</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect2">
<h3 id="cl_khr_spir-additions-to-chapter-4"><a class="anchor" href="#cl_khr_spir-additions-to-chapter-4"></a>24.2. Additions to Chapter 4 of the OpenCL 2.2 Specification</h3>
<div class="paragraph">
<p><strong>Add a new device property to <em>table 4.3</em> in <em>section 4.2</em>:</strong></p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 49. List of supported param_names by <strong>clGetDeviceInfo</strong></caption>
<colgroup>
<col style="width: 28.5714%;">
<col style="width: 14.2857%;">
<col style="width: 57.1429%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Device Info</th>
<th class="tableblock halign-left valign-top">Return Type</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CL_DEVICE_<wbr>SPIR_<wbr>VERSIONS</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>char</code>[]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A space separated list of SPIR versions supported by the device.</p>
<p class="tableblock">  For example, returning <code>"1.2"</code> in this query implies that SPIR version 1.2
  is supported by the implementation.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="cl_khr_spir-additions-to-chapter-5"><a class="anchor" href="#cl_khr_spir-additions-to-chapter-5"></a>24.3. Additions to Chapter 5 of the OpenCL 2.2 Specification</h3>
<div class="paragraph">
<p><strong>Additions to <em>section 5.8.1</em>&#8201;&#8212;&#8201;Creating Program Objects:</strong></p>
</div>
<div class="paragraph">
<p>"<strong>clCreateProgramWithBinary</strong> can be used to load a SPIR binary.
Once a program object has been created from a SPIR binary, <strong>clBuildProgram</strong>
can be called to build a program executable or <strong>clCompileProgram</strong> can be
called to compile the SPIR binary."</p>
</div>
<div class="paragraph">
<p>Modify the <code>CL_PROGRAM_<wbr>BINARY_<wbr>TYPE</code> entry in <em>table 5.14</em>
for <strong>clGetProgramBuildInfo</strong> to add a potential value
<code>CL_PROGRAM_<wbr>BINARY_<wbr>TYPE_<wbr>INTERMEDIATE</code>:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 50. List of supported param_names by <strong>clGetProgramBuildInfo</strong></caption>
<colgroup>
<col style="width: 28.5714%;">
<col style="width: 14.2857%;">
<col style="width: 57.1429%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Program Build Info</th>
<th class="tableblock halign-left valign-top">Return Type</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CL_PROGRAM_<wbr>BINARY_<wbr>TYPE</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>cl_program_<wbr>binary_<wbr>type</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CL_PROGRAM_<wbr>BINARY_<wbr>TYPE_<wbr>INTERMEDIATE</code>&#8201;&#8212;&#8201;An intermediate (non-source)
  representation for the program is loaded as a binary.
  The program must be further processed with <strong>clCompileProgram</strong> or
  <strong>clBuildProgram</strong>.</p>
<p class="tableblock">  If processed with <strong>clCompileProgram</strong>, the result will be a binary of type
  <code>CL_PROGRAM_<wbr>BINARY_<wbr>TYPE_<wbr>COMPILED_<wbr>OBJECT</code> or <code>CL_PROGRAM_<wbr>BINARY_<wbr>TYPE_<wbr>LIBRARY</code>.
  If processed with <strong>clBuildProgram</strong>, the result will be a binary of type
  <code>CL_PROGRAM_<wbr>BINARY_<wbr>TYPE_<wbr>EXECUTABLE</code>.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><strong>Additions to <em>section 5.8.4</em>&#8201;&#8212;&#8201;Compiler Options:</strong></p>
</div>
<div class="paragraph">
<p>"The compile option <code>-x spir</code> must be specified to indicate that the binary
is in SPIR format, and the compile option <code>-spir-std</code> must be used to
specify the version of the SPIR specification that describes the format and
meaning of the binary.
For example, if the binary is as described in SPIR version 1.2, then
<code>-spir-std=1.2</code> must be specified.
Failing to specify these compile options may result in implementation
defined behavior."</p>
</div>
<div class="paragraph">
<p><strong>Additions to <em>section 5.8.5</em>&#8201;&#8212;&#8201;Separate Compilation and Linking of Programs:</strong></p>
</div>
<div class="paragraph">
<p>Replace this error for <strong>clCompileProgram</strong>:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>CL_INVALID_<wbr>OPERATION</code> if <em>program</em> has no source or IL available, i.e. it
has not been created with <strong>clCreateProgramWithSource</strong> or
<strong>clCreateProgramWithIL</strong>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>with:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>CL_INVALID_<wbr>OPERATION</code> if <em>program</em> has no source or IL available, i.e. it
has not been created with <strong>clCreateProgramWithSource</strong> or
<strong>clCreateProgramWithIL</strong> or <strong>clCreateProgramWithBinary</strong> where <code>-x spir</code> is present in <em>options</em>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Additions to <em>section 5.9.3</em>&#8201;&#8212;&#8201;Kernel Object Queries:</strong></p>
</div>
<div class="paragraph">
<p>Modify following text in <strong>clGetKernelArgInfo</strong> from:</p>
</div>
<div class="paragraph">
<p>"Kernel argument information is only available if the program object
associated with <em>kernel</em> is created with <strong>clCreateProgramWithSource</strong> and the
program executable is built with the -cl-kernel-arg-info option specified in
<em>options</em> argument to <strong>clBuildProgram</strong> or <strong>clCompileProgram</strong>."</p>
</div>
<div class="paragraph">
<p>to:</p>
</div>
<div class="paragraph">
<p>"Kernel argument information is only available if the program object
associated with <em>kernel</em> is created with <strong>clCreateProgramWithSource</strong> and the
program executable is built with the <code>-cl-kernel-arg-info option</code> specified in
<em>options</em> argument to <strong>clBuildProgram</strong> or <strong>clCompileProgram</strong>, or if the
program object associated with <em>kernel</em> is created with
<strong>clCreateProgramWithBinary</strong> and the program executable is built with the
<code>-cl-kernel-arg-info</code> and <code>-x spir</code> options specified in <em>options</em> argument to
<strong>clBuildProgram</strong> or <strong>clCompileProgram</strong>."</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="cl_khr_il_program"><a class="anchor" href="#cl_khr_il_program"></a>25. Intermediate Language Programs</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This section describes the <strong>cl_khr_il_program</strong> extension.</p>
</div>
<div class="paragraph">
<p>This extension adds the ability to create programs with intermediate language (IL),
usually SPIR-V.  Further information about the format and contents of SPIR-V may be
found in the SPIR-V Specification.  Information about how SPIR-V modules behave in
the OpenCL environment may be found in the OpenCL SPIR-V Environment Specification.</p>
</div>
<div class="paragraph">
<p>This functionality described by this extension is a core feature in OpenCL 2.1.</p>
</div>
<div class="sect2">
<h3 id="_general_information_24"><a class="anchor" href="#_general_information_24"></a>25.1. General information</h3>
<div class="sect3">
<h4 id="_version_history_24"><a class="anchor" href="#_version_history_24"></a>25.1.1. Version history</h4>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 60%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><strong>Date</strong></th>
<th class="tableblock halign-left valign-top"><strong>Version</strong></th>
<th class="tableblock halign-left valign-top"><strong>Description</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">2020-04-21</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.0.0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">First assigned version.</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect2">
<h3 id="cl_khr_il_program-new-procedures-and-functions"><a class="anchor" href="#cl_khr_il_program-new-procedures-and-functions"></a>25.2. New Procedures and Functions</h3>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="opencl"><span class="kt">cl_program</span> <span class="nf">clCreateProgramWithILKHR</span><span class="p">(</span><span class="kt">cl_context</span> <span class="n">context</span><span class="p">,</span>
                                    <span class="k">const</span> <span class="kt">void</span> <span class="o">*</span><span class="n">il</span><span class="p">,</span>
                                    <span class="kt">size_t</span> <span class="n">length</span><span class="p">,</span>
                                    <span class="kt">cl_int</span> <span class="o">*</span><span class="n">errcode_ret</span><span class="p">);</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="cl_khr_il_program-new-tokens"><a class="anchor" href="#cl_khr_il_program-new-tokens"></a>25.3. New Tokens</h3>
<div class="paragraph">
<p>Accepted as a new <em>param_name</em> argument to <strong>clGetDeviceInfo</strong>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="opencl"><span class="n">CL_DEVICE_IL_VERSION_KHR</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Accepted as a new <em>param_name</em> argument to <strong>clGetProgramInfo</strong>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="opencl"><span class="n">CL_PROGRAM_IL_KHR</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="cl_khr_il_program-additions-to-chapter-3"><a class="anchor" href="#cl_khr_il_program-additions-to-chapter-3"></a>25.4. Additions to Chapter 3 of the OpenCL 2.0 Specification</h3>
<div class="paragraph">
<p>In section 3.1, replace the fourth paragraph with:</p>
</div>
<div class="paragraph">
<p>"Programmers provide programs in the form of intermediate language binaries (usually SPIR-V), OpenCL C source strings, or implementation-defined binary objects. The OpenCL platform provides a compiler to translate programs represented as intermediate language binaries or OpenCL C source strings into device program executables. The compiler may be <em>online</em> or <em>offline</em>. An <em>online compiler</em> is available during host program execution using standard APIs. An <em>offline compiler</em> is invoked outside of host program control, using platform-specific methods. The OpenCL runtime allows developers to get a previously compiled device program executable and to load and execute a previously compiled device program executable."</p>
</div>
</div>
<div class="sect2">
<h3 id="cl_khr_il_program-additions-to-chapter-4"><a class="anchor" href="#cl_khr_il_program-additions-to-chapter-4"></a>25.5. Additions to Chapter 4 of the OpenCL 2.0 Specification</h3>
<div class="paragraph">
<p>Add to Table 4.3 - OpenCL Device Queries:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 4.3 List of supported param_names by <strong>clGetDeviceInfo</strong></caption>
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 16.6666%;">
<col style="width: 50.0001%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Device Info</th>
<th class="tableblock halign-left valign-top">Return Type</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CL_DEVICE_<wbr>IL_<wbr>VERSION_<wbr>KHR</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">char[]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The intermediate languages that are be supported by <strong>clCreateProgramWithILKHR</strong> for this device.<br>
<br>
Returns a space separated list of IL version strings of the form:<br>
<br>
&lt;IL_Prefix&gt;_&lt;Major_version&gt;.&lt;Minor_version&gt;<br>
<br>
A device that supports the <strong>cl_khr_il_program</strong> extension must support the SPIR-V IL prefix.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="cl_khr_il_program-additions-to-chapter-5"><a class="anchor" href="#cl_khr_il_program-additions-to-chapter-5"></a>25.6. Additions to Chapter 5 of the OpenCL 2.0 Specification</h3>
<div class="paragraph">
<p>Add to Section 5.8.1: Creating Program Objects:</p>
</div>
<div class="paragraph">
<p>"The function</p>
</div>
<div id="clCreateProgramWithILKHR" class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="opencl"><span class="kt">cl_program</span> <span class="nf">clCreateProgramWithILKHR</span><span class="p">(</span>
    <span class="kt">cl_context</span> <span class="n">context</span><span class="p">,</span>
    <span class="k">const</span> <span class="kt">void</span><span class="o">*</span> <span class="n">il</span><span class="p">,</span>
    <span class="kt">size_t</span> <span class="n">length</span><span class="p">,</span>
    <span class="kt">cl_int</span><span class="o">*</span> <span class="n">errcode_ret</span><span class="p">);</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>creates a new program object for <em>context</em> using the <em>length</em> bytes of intermediate language pointed to by <em>il</em>.</p>
</div>
<div class="paragraph">
<p><em>context</em> must be a valid OpenCL context.</p>
</div>
<div class="paragraph">
<p><em>il</em> is a pointer to a <em>length</em>-byte block of memory containing intermediate langage.</p>
</div>
<div class="paragraph">
<p><em>length</em> is the length of the block of memory pointed to by <em>il</em>.</p>
</div>
<div class="paragraph">
<p><em>errcode_ret</em> will return an appropriate error code. If <em>errcode_ret</em> is NULL, no error code is returned.</p>
</div>
<div class="paragraph">
<p><strong>clCreateProgramWithILKHR</strong> returns a valid non-zero program object and <em>errcode_ret</em> is set to <code>CL_SUCCESS</code> if the program object is created successfully. Otherwise, it returns a NULL value with one of the following error values returned in <em>errcode_ret</em>:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>CL_INVALID_<wbr>CONTEXT</code> if <em>context</em> is not a valid context</p>
</li>
<li>
<p><code>CL_INVALID_<wbr>VALUE</code> if <em>il</em> is NULL or if <em>length</em> is zero.</p>
</li>
<li>
<p><code>CL_INVALID_<wbr>VALUE</code> if the <em>length</em>-byte block of memory pointed to by <em>il</em> does not contain well-formed intermediate language.</p>
</li>
<li>
<p><code>CL_OUT_<wbr>OF_<wbr>RESOURCES</code> if there is a failure to allocate resources required by the OpenCL implementation on the device.</p>
</li>
<li>
<p><code>CL_OUT_<wbr>OF_<wbr>HOST_<wbr>MEMORY</code> if there is a failure to allocate resources required by the OpenCL implementation on the host."</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Add to Section 5.8.2: Building Program Executables:</p>
</div>
<div class="paragraph">
<p>Add the following to the description of the <em>options</em> parameter to <strong>clBuildProgram</strong>:</p>
</div>
<div class="paragraph">
<p>"Certain options are ignored when <em>program</em> is created with IL."</p>
</div>
<div class="paragraph">
<p>Additionally, replace the error:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>CL_INVALID_<wbr>OPERATION</code> if <em>program</em> was not created with <strong>clCreateProgramWithSource</strong> or <strong>clCreateProgramWithBinary</strong>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>with:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>CL_INVALID_<wbr>OPERATION</code> if <em>program</em> was not created with <strong>clCreateProgramWithSource</strong>, <strong>clCreateProgramWithILKHR</strong> or <strong>clCreateProgramWithBinary</strong>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Add to Section 5.8.3: Separate Compilation and Linking of Programs:</p>
</div>
<div class="paragraph">
<p>Add the following to the description of the <em>options</em> parameter to <strong>clCompileProgram</strong>:</p>
</div>
<div class="paragraph">
<p>"Certain options are ignored when <em>program</em> is created with IL."</p>
</div>
<div class="paragraph">
<p>Additionally, replace the error:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>CL_INVALID_<wbr>OPERATION</code> if <em>program</em> has no source i.e. it has not been created with <strong>clCreateProgramWithSource</strong>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>with:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>CL_INVALID_<wbr>OPERATION</code> if <em>program</em> was not created with <strong>clCreateProgramWithSource</strong> or <strong>clCreateProgramWithILKHR</strong>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Add to Section 5.8.4.1: Preprocessor Options,<br>
Add to Section 5.8.4.2: Math Intrinsic Options (for -cl-single-precision-constant-only),<br>
Add to Section 5.8.4.3: Optimization Options,<br>
Add to Section 5.8.4.4: Options to Request or Suppress Warnings, and<br>
Add to Section 5.8.4.5: Options Controlling the OpenCL C Version:</p>
</div>
<div class="paragraph">
<p>"These options are ignored for programs created with IL."</p>
</div>
<div class="paragraph">
<p>Change one entry and add one new entry to Table 5.17 <strong>clGetProgramInfo</strong> parameter queries:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 5.17 List of supported param_names by <strong>clGetProgramInfo</strong></caption>
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 16.6666%;">
<col style="width: 50.0001%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Program Info</th>
<th class="tableblock halign-left valign-top">Return Type</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CL_PROGRAM_<wbr>SOURCE</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>char</code>[]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Return the program source code specified by <strong>clCreateProgramWithSource</strong>. The source string returned is a concatenation of all source strings
specified to <strong>clCreateProgramWithSource</strong> with a null terminator. The concatenation strips any nulls in the original source strings.<br>
<br>
If program is created using <strong>clCreateProgramWithBinary</strong>, <strong>clCreateProgramWithBuiltInKernels</strong>, or <strong>clCreateProgramWithILKHR</strong> a null string or the appropriate program source code is returned depending on whether or not the program source code is stored in the binary.<br>
<br>
The actual number of characters that represents the program source code including the null terminator is returned in <em>param_value_size_ret</em>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CL_PROGRAM_<wbr>IL_<wbr>KHR</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>unsigned char</code>[]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Returns the program IL for programs created with <strong>clCreateProgramWithILKHR</strong>.<br>
<br>
If program is created with <strong>clCreateProgramWithSource</strong>, <strong>clCreateProgramWithBinary</strong>, or <strong>clCreateProgramWithBuiltInKernels</strong>, the memory pointed to by <em>param_value</em> will be unchanged and <em>param_value_size_ret</em> will be set to zero.</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="cl_khr_create_command_queue"><a class="anchor" href="#cl_khr_create_command_queue"></a>26. Creating Command Queues with Properties</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_overview"><a class="anchor" href="#_overview"></a>26.1. Overview</h3>
<div class="paragraph">
<p>The section describes the <strong>cl_khr_create_command_queue</strong> extension.</p>
</div>
<div class="paragraph">
<p>This extension allows OpenCL 1.x devices to support an equivalent of the
<strong>clCreateCommandQueueWithProperties</strong> API that was added in OpenCL 2.0.
This allows OpenCL 1.x devices to support other optional extensions or
features that use the <strong>clCreateCommandQueueWithProperties</strong> API to specify
additional command queue properties that cannot be specified using the
OpenCL 1.x <strong>clCreateCommandQueue</strong> API.</p>
</div>
<div class="paragraph">
<p>No new command queue properties are required by this extension.
Applications may use the existing <code>CL_DEVICE_<wbr>QUEUE_<wbr>PROPERTIES</code> query to
determine command queue properties that are supported by the device.</p>
</div>
<div class="paragraph">
<p>OpenCL 2.x devices may support this extension for compatibility.  In
this scenario, the function added by this extension will have the same
capabilities as the core <strong>clCreateCommandQueueWithProperties</strong> API.
Applications that only target OpenCL 2.x devices should use the core
OpenCL 2.x <strong>clCreateCommandQueueWithProperties</strong> API instead of this
extension API.</p>
</div>
</div>
<div class="sect2">
<h3 id="_general_information_25"><a class="anchor" href="#_general_information_25"></a>26.2. General information</h3>
<div class="sect3">
<h4 id="_version_history_25"><a class="anchor" href="#_version_history_25"></a>26.2.1. Version history</h4>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 60%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><strong>Date</strong></th>
<th class="tableblock halign-left valign-top"><strong>Version</strong></th>
<th class="tableblock halign-left valign-top"><strong>Description</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">2020-04-21</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.0.0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">First assigned version.</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_new_api_functions"><a class="anchor" href="#_new_api_functions"></a>26.3. New API Functions</h3>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="opencl"><span class="kt">cl_command_queue</span> <span class="nf">clCreateCommandQueueWithPropertiesKHR</span><span class="p">(</span>
    <span class="kt">cl_context</span> <span class="n">context</span><span class="p">,</span>
    <span class="kt">cl_device_id</span> <span class="n">device</span><span class="p">,</span>
    <span class="k">const</span> <span class="kt">cl_queue_properties_khr</span> <span class="o">*</span><span class="n">properties</span><span class="p">,</span>
    <span class="kt">cl_int</span> <span class="o">*</span><span class="n">errcode_ret</span><span class="p">);</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_new_api_types"><a class="anchor" href="#_new_api_types"></a>26.4. New API Types</h3>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="opencl"><span class="k">typedef</span> <span class="kt">cl_properties</span> <span class="kt">cl_queue_properties_khr</span><span class="p">;</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_modifications_to_the_opencl_1_2_specification"><a class="anchor" href="#_modifications_to_the_opencl_1_2_specification"></a>26.5. Modifications to the OpenCL 1.2 Specification</h3>
<div class="dlist">
<dl>
<dt class="hdlist1">(Add to Table 5.2 for <code>CL_QUEUE_<wbr>PROPERTIES</code> in Section 5.1) </dt>
<dd>
<div class="openblock">
<div class="content">
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 5.2 List of supported param_names by <strong>clGetCommandQueueInfo</strong></caption>
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 16.6666%;">
<col style="width: 50.0001%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Queue Info</th>
<th class="tableblock halign-left valign-top">Return Type</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CL_QUEUE_<wbr>PROPERTIES</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>cl_command_<wbr>queue_<wbr>properties</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Returns the currently specified properties for the command-queue.
These properties are specified by the <em>properties</em> argument in
<strong>clCreateCommandQueue</strong>, or by the <code>CL_QUEUE_<wbr>PROPERTIES</code> property value in
<strong>clCreateCommandQueueWithPropertiesKHR</strong>.</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</dd>
<dt class="hdlist1">(Add a new Section 5.1.1, <strong>Creating Command Queues With Properties</strong>) </dt>
<dd>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The function</p>
</div>
<div id="clCreateCommandQueueWithPropertiesKHR" class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="opencl"><span class="kt">cl_command_queue</span> <span class="nf">clCreateCommandQueueWithPropertiesKHR</span><span class="p">(</span>
    <span class="kt">cl_context</span> <span class="n">context</span><span class="p">,</span>
    <span class="kt">cl_device_id</span> <span class="n">device</span><span class="p">,</span>
    <span class="k">const</span> <span class="kt">cl_queue_properties_khr</span><span class="o">*</span> <span class="n">properties</span><span class="p">,</span>
    <span class="kt">cl_int</span><span class="o">*</span> <span class="n">errcode_ret</span><span class="p">);</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>allows creation of a command-queue from an array of properties
for the specified device.</p>
</div>
<div class="paragraph">
<p><em>context</em> must be a valid OpenCL context.</p>
</div>
<div class="paragraph">
<p><em>device</em> must be a device or sub-device associated with <em>context</em>. It
can either be in the list of devices and sub-devices specified when
<em>context</em> is created using <strong>clCreateContext</strong> or
be a root device with the same device type as specified when <em>context</em>
is created using <strong>clCreateContextFromType</strong>.</p>
</div>
<div class="paragraph">
<p><em>properties</em> specifies a list of properties for the command-queue and
their corresponding values. Each property name is immediately followed
by the corresponding desired value. The list is terminated with 0. The
list of supported properties is described in the table below. If a
supported property and its value is not specified in <em>properties</em>, its
default value will be used. <em>properties</em> can be NULL in which case the
default values for supported command-queue properties will be used.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table X.Y List of supported param_names by <a href="#clCreateCommandQueueWithPropertiesKHR">clCreateCommandQueueWithPropertiesKHR</a></caption>
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><strong>Queue Properties</strong></th>
<th class="tableblock halign-left valign-top"><strong>Property Value</strong></th>
<th class="tableblock halign-left valign-top"><strong>Description</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CL_QUEUE_<wbr>PROPERTIES</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>cl_bitfield</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">This is a bitfield and can be set to a combination of the following
values:<br>
<br>
<code>CL_QUEUE_<wbr>OUT_<wbr>OF_<wbr>ORDER_<wbr>EXEC_<wbr>MODE_<wbr>ENABLE</code> - Determines whether the
commands queued in the command-queue are executed in-order or out-of-order. If
set, the commands in the command-queue are executed out-of-order. Otherwise,
commands are executed in-order.<br>
<br>
<code>CL_QUEUE_<wbr>PROFILING_<wbr>ENABLE</code> - Enable or disable profiling of commands in
the command-queue. If set, the profiling of commands is enabled. Otherwise,
profiling of commands is disabled.<br>
<br>
If <code>CL_QUEUE_<wbr>PROPERTIES</code> is not specified an in-order command queue that
does not support profiling of commands is created for the specified device.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><em>errcode_ret</em> will return an appropriate error code. If <em>errcode_ret</em>
is NULL, no error code is returned.</p>
</div>
<div class="paragraph">
<p><strong>clCreateCommandQueueWithPropertiesKHR</strong> returns a valid non-zero
command-queue and <em>errcode_ret</em> is set to <code>CL_SUCCESS</code> if the
command-queue is created successfully. Otherwise, it returns a NULL
value with one of the following error values returned in <em>errcode_ret</em>:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>CL_INVALID_<wbr>CONTEXT</code> if <em>context</em> is not a valid context.</p>
</li>
<li>
<p><code>CL_INVALID_<wbr>DEVICE</code> if <em>device</em> is not a valid device or is not associated
with <em>context</em>.</p>
</li>
<li>
<p><code>CL_INVALID_<wbr>VALUE</code> if values specified in <em>properties</em> are not valid.</p>
</li>
<li>
<p><code>CL_INVALID_<wbr>QUEUE_<wbr>PROPERTIES</code> if values specified in <em>properties</em> are
valid but are not supported by the device.</p>
</li>
<li>
<p><code>CL_OUT_<wbr>OF_<wbr>RESOURCES</code> if there is a failure to allocate resources required
by the OpenCL implementation on the device.</p>
</li>
<li>
<p><code>CL_OUT_<wbr>OF_<wbr>HOST_<wbr>MEMORY</code> if there is a failure to allocate resources required
by the OpenCL implementation on the host.</p>
</li>
</ul>
</div>
</div>
</div>
</dd>
</dl>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="cl_khr_device_enqueue_local_arg_types"><a class="anchor" href="#cl_khr_device_enqueue_local_arg_types"></a>27. Device Enqueue Local Argument Types</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This extension allows arguments to blocks that are passed to the <strong>enqueue_kernel</strong> built-in
function to be pointers to any type (built-in or user-defined) in local memory, instead of
requiring arguments to blocks to be pointers to void in local memory.</p>
</div>
<div class="paragraph">
<p>The name of this extension is <strong>cl_khr_device_enqueue_local_arg_types</strong>.</p>
</div>
<div class="sect2">
<h3 id="_general_information_26"><a class="anchor" href="#_general_information_26"></a>27.1. General information</h3>
<div class="sect3">
<h4 id="_version_history_26"><a class="anchor" href="#_version_history_26"></a>27.1.1. Version history</h4>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 60%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><strong>Date</strong></th>
<th class="tableblock halign-left valign-top"><strong>Version</strong></th>
<th class="tableblock halign-left valign-top"><strong>Description</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">2020-04-21</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.0.0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">First assigned version.</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect2">
<h3 id="cl_khr_device_enqueue_local_arg_types-additions-to-chapter-6-of-the-opencl-2.0-specification"><a class="anchor" href="#cl_khr_device_enqueue_local_arg_types-additions-to-chapter-6-of-the-opencl-2.0-specification"></a>27.2. Additions to Chapter 6 of the OpenCL 2.0 C Specification</h3>
<div class="paragraph">
<p>Modify the second paragraph of Section 6.13.17: Enqueuing Kernels:</p>
</div>
<div class="paragraph">
<p>"The following table describes the list of built-in functions that can be used to enqueue a
kernel. We use the generic type name gentype to indicate the built-in OpenCL C scalar or
vector integer or floating-point data types, or any user defined type built from these scalar and
vector data types, which can be used as the type of the pointee of the arguments of the kernel
enqueue functions listed in table 6.31."</p>
</div>
<div class="paragraph">
<p>Then, replace all occurrences of local void * in table 6.31 with local gentype *.  For example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="opencl_c"><span class="kt">int</span> <span class="fm">enqueue_kernel</span><span class="p">(</span><span class="kt">queue_t</span> <span class="n">queue</span><span class="p">,</span>
                   <span class="n">kernel_enqueue_flags_t</span> <span class="n">flags</span><span class="p">,</span>
                   <span class="k">const</span> <span class="kt">ndrange_t</span> <span class="n">ndrange</span><span class="p">,</span>
                   <span class="kt">void</span> <span class="p">(</span><span class="o">^</span><span class="n">block</span><span class="p">)(</span><span class="nx">local</span> <span class="kp">gentype</span> <span class="o">*</span><span class="p">,</span> <span class="p">...),</span>
                   <span class="kt">uint</span> <span class="n">size0</span><span class="p">,</span> <span class="p">...</span> <span class="p">)</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Additionally, replace all occurrences of local void* in table 6.33 with local gentype *.  For example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="opencl_c"><span class="kt">uint</span> <span class="n">get_kernel_work_group_size</span><span class="p">(</span>
                    <span class="kt">void</span> <span class="p">(</span><span class="o">^</span><span class="n">block</span><span class="p">)(</span><span class="nx">local</span> <span class="kp">gentype</span> <span class="o">*</span><span class="p">,</span> <span class="p">...))</span></code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="cl_khr_subgroups"><a class="anchor" href="#cl_khr_subgroups"></a>28. Subgroups</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This section describes the <strong>cl_khr_subgroups</strong> extension.</p>
</div>
<div class="paragraph">
<p>This extension adds support for implementation-controlled groups of work items, known as subgroups.
Subgroups behave similarly to work groups and have their own sets of built-ins and synchronization primitives.
Subgroups within a work group are independent, may make forward progress with respect to each other, and may map to optimized hardware structures where that makes sense.</p>
</div>
<div class="paragraph">
<p>Subgroups were promoted to a core feature in OpenCL 2.1, however note that:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The subgroup OpenCL C built-in functions described by this extension must still be accessed as an OpenCL C extension in OpenCL 2.1.</p>
</li>
<li>
<p>Subgroup independent forward progress is an optional device property in OpenCL 2.1, see <code>CL_DEVICE_<wbr>SUB_<wbr>GROUP_<wbr>INDEPENDENT_<wbr>FORWARD_<wbr>PROGRESS</code>.</p>
</li>
</ul>
</div>
<div class="sect2">
<h3 id="_general_information_27"><a class="anchor" href="#_general_information_27"></a>28.1. General information</h3>
<div class="sect3">
<h4 id="_version_history_27"><a class="anchor" href="#_version_history_27"></a>28.1.1. Version history</h4>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 60%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><strong>Date</strong></th>
<th class="tableblock halign-left valign-top"><strong>Version</strong></th>
<th class="tableblock halign-left valign-top"><strong>Description</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">2020-04-21</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.0.0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">First assigned version.</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect2">
<h3 id="cl_khr_subgroups-additions-to-chapter-3-of-the-opencl-2.0-specification"><a class="anchor" href="#cl_khr_subgroups-additions-to-chapter-3-of-the-opencl-2.0-specification"></a>28.2. Additions to Chapter 3 of the OpenCL 2.0 Specification</h3>

</div>
<div class="sect2">
<h3 id="cl_khr_subgroups-additions-to-section-3.2-execution-model"><a class="anchor" href="#cl_khr_subgroups-additions-to-section-3.2-execution-model"></a>28.3. Additions to section 3.2&#8201;&#8212;&#8201;Execution Model</h3>
<div class="paragraph">
<p>Within a work-group work-items may be divided into sub-groups.
The mapping of work-items to sub-groups is implementation-defined and may be queried at runtime.
While sub-groups may be used in multi-dimensional work-groups, each subgroup is 1-dimensional and any given work-item may query which sub-group it is a member of.</p>
</div>
<div class="paragraph">
<p>Work items are mapped into subgroups through a combination of compile-time decisions and the parameters of the dispatch.
The mapping to subgroups is invariant for the duration of a kernels execution, across dispatches of a given kernel with the same launch parameters, and from one work-group to another within the dispatch (excluding the trailing edge work-groups in the presence of non-uniform work-group sizes).
In addition, all sub-groups within a work-group will be the same size, apart from the sub-group with the maximum index which may be smaller if the size of the work-group is not evenly divisible by the size of the sub-group.</p>
</div>
<div class="paragraph">
<p>Sub-groups execute concurrently within a given work-group and make independent forward progress with respect to each other even in the absence of work-group barrier operations.
Subgroups are able to internally synchronize using barrier operations without synchronizing with each other.</p>
</div>
<div class="paragraph">
<p>In the degenerate case, with the extension enabled, a single sub-group must be supported for each work-group.
In this situation all sub-group scope functions alias their work-group level equivalents.</p>
</div>
</div>
<div class="sect2">
<h3 id="cl_khr_subgroups-additions-to-chapter-5-of-the-opencl-2.0-specification"><a class="anchor" href="#cl_khr_subgroups-additions-to-chapter-5-of-the-opencl-2.0-specification"></a>28.4. Additions to Chapter 5 of the OpenCL 2.0 Specification</h3>
<div class="paragraph">
<p>The function</p>
</div>
<div id="clGetKernelSubGroupInfoKHR" class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="opencl"><span class="kt">cl_int</span> <span class="nf">clGetKernelSubGroupInfoKHR</span><span class="p">(</span>
    <span class="kt">cl_kernel</span> <span class="n">in_kernel</span><span class="p">,</span>
    <span class="kt">cl_device_id</span> <span class="n">in_device</span><span class="p">,</span>
    <span class="kt">cl_kernel_sub_group_info</span> <span class="n">param_name</span><span class="p">,</span>
    <span class="kt">size_t</span> <span class="n">input_value_size</span><span class="p">,</span>
    <span class="k">const</span> <span class="kt">void</span><span class="o">*</span> <span class="n">input_value</span><span class="p">,</span>
    <span class="kt">size_t</span> <span class="n">param_value_size</span><span class="p">,</span>
    <span class="kt">void</span><span class="o">*</span> <span class="n">param_value</span><span class="p">,</span>
    <span class="kt">size_t</span><span class="o">*</span> <span class="n">param_value_size_ret</span><span class="p">);</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>returns information about the kernel object.</p>
</div>
<div class="paragraph">
<p><em>kernel</em> specifies the kernel object being queried.</p>
</div>
<div class="paragraph">
<p><em>device</em> identifies a specific device in the list of devices associated with
<em>kernel</em>.
The list of devices is the list of devices in the OpenCL context that is
associated with <em>kernel</em>.
If the list of devices associated with <em>kernel</em> is a single device, <em>device</em>
can be a <code>NULL</code> value.</p>
</div>
<div class="paragraph">
<p><em>param_name</em> specifies the information to query.
The list of supported <em>param_name</em> types and the information returned in
<em>param_value</em> by <strong>clGetKernelSubGroupInfoKHR</strong> is described in the
<a href="#cl_khr_subgroups-kernel-subgroup-info-table">Kernel Object Subgroup Queries</a> table.</p>
</div>
<div class="paragraph">
<p><em>input_value_size</em> is used to specify the size in bytes of memory pointed to
by <em>input_value</em>.
This size must be == size of input type as described in the table below.</p>
</div>
<div class="paragraph">
<p><em>input_value</em> is a pointer to memory where the appropriate parameterization
of the query is passed from.
If <em>input_value</em> is <code>NULL</code>, it is ignored.</p>
</div>
<div class="paragraph">
<p><em>param_value</em> is a pointer to memory where the appropriate result being
queried is returned.
If <em>param_value</em> is <code>NULL</code>, it is ignored.</p>
</div>
<div class="paragraph">
<p><em>param_value_size</em> is used to specify the size in bytes of memory pointed to
by <em>param_value</em>.
This size must be  size of return type as described in the
<a href="#kernel-subgroup-info-table">Kernel Object Subgroup Queries</a> table.</p>
</div>
<div class="paragraph">
<p><em>param_value_size_ret</em> returns the actual size in bytes of data being
queried by <em>param_name</em>.
If <em>param_value_size_ret</em> is <code>NULL</code>, it is ignored.</p>
</div>
<table id="cl_khr_subgroups-kernel-subgroup-info-table" class="tableblock frame-all grid-all stretch">
<caption class="title">Table 51. List of supported param_names by <a href="#clGetKernelSubGroupInfoKHR">clGetKernelSubGroupInfoKHR</a></caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Kernel Subgroup Info</th>
<th class="tableblock halign-left valign-top">Input Type</th>
<th class="tableblock halign-left valign-top">Return Type</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CL_KERNEL_<wbr>MAX_<wbr>SUB_<wbr>GROUP_<wbr>SIZE_<wbr>FOR_<wbr>NDRANGE_<wbr>KHR</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>size_t</code>*</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>size_t</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Returns the maximum sub-group size for this kernel.
            All sub-groups must be the same size, while the last subgroup in
            any work-group (i.e. the subgroup with the maximum index) could
            be the same or smaller size.</p>
<p class="tableblock">            The <em>input_value</em> must be an array of size_t values
            corresponding to the local work size parameter of the intended
            dispatch.
            The number of dimensions in the ND-range will be inferred from
            the value specified for <em>input_value_size</em>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CL_KERNEL_<wbr>SUB_<wbr>GROUP_<wbr>COUNT_<wbr>FOR_<wbr>NDRANGE_<wbr>KHR</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>size_t</code>*</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>size_t</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Returns the number of sub-groups that will be present in each
            work-group for a given local work size.
            All workgroups, apart from the last work-group in each dimension
            in the presence of non-uniform work-group sizes, will have the
            same number of sub-groups.</p>
<p class="tableblock">            The <em>input_value</em> must be an array of size_t values
            corresponding to the local work size parameter of the intended
            dispatch.
            The number of dimensions in the ND-range will be inferred from
            the value specified for <em>input_value_size</em>.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><strong>clGetKernelSubGroupInfoKHR</strong> returns <code>CL_SUCCESS</code> if the function is executed
successfully.
Otherwise, it returns one of the following errors:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>CL_INVALID_<wbr>DEVICE</code> if <em>device</em> is not in the list of devices associated
with <em>kernel</em> or if <em>device</em> is <code>NULL</code> but there is more than one device
associated with <em>kernel</em>.</p>
</li>
<li>
<p><code>CL_INVALID_<wbr>VALUE</code> if <em>param_name</em> is not valid, or if size in bytes
specified by <em>param_value_size</em> is &lt; size of return type as described in
the <a href="#kernel-subgroup-info-table">Kernel Object Subgroup Queries</a> table
and <em>param_value</em> is not <code>NULL</code>.</p>
</li>
<li>
<p><code>CL_INVALID_<wbr>VALUE</code> if <em>param_name</em> is
<code>CL_KERNEL_<wbr>MAX_<wbr>SUB_<wbr>GROUP_<wbr>SIZE_<wbr>FOR_<wbr>NDRANGE_<wbr>KHR</code> and the size in bytes specified by
<em>input_value_size</em> is not valid or if <em>input_value</em> is <code>NULL</code>.</p>
</li>
<li>
<p><code>CL_INVALID_<wbr>KERNEL</code> if <em>kernel</em> is a not a valid kernel object.</p>
</li>
<li>
<p><code>CL_OUT_<wbr>OF_<wbr>RESOURCES</code> if there is a failure to allocate resources required
by the OpenCL implementation on the device.</p>
</li>
<li>
<p><code>CL_OUT_<wbr>OF_<wbr>HOST_<wbr>MEMORY</code> if there is a failure to allocate resources
required by the OpenCL implementation on the host.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="cl_khr_subgroups-additions-to-chapter-6-of-the-opencl-2.0-specification"><a class="anchor" href="#cl_khr_subgroups-additions-to-chapter-6-of-the-opencl-2.0-specification"></a>28.5. Additions to Chapter 6 of the OpenCL 2.0 C Specification</h3>
<div class="sect3">
<h4 id="cl_khr_subgroups-additions-to-section-6.13.1-work-item-functions"><a class="anchor" href="#cl_khr_subgroups-additions-to-section-6.13.1-work-item-functions"></a>28.5.1. Additions to section 6.13.1&#8201;&#8212;&#8201;Work Item Functions</h4>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><strong>Function</strong></th>
<th class="tableblock halign-left valign-top"><strong>Description</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>uint <strong>get_sub_group_size</strong> ()</p>
</div></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Returns the number of work items in the subgroup.
  This value is no more than the maximum subgroup size and is
  implementation-defined based on a combination of the compiled kernel and
  the dispatch dimensions.
  This will be a constant value for the lifetime of the subgroup.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>uint <strong>get_max_sub_group_size</strong> ()</p>
</div></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Returns the maximum size of a subgroup within the dispatch.
  This value will be invariant for a given set of dispatch dimensions and a
  kernel object compiled for a given device.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>uint <strong>get_num_sub_groups</strong> ()</p>
</div></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Returns the number of subgroups that the current work group is divided
  into.</p>
<p class="tableblock">  This number will be constant for the duration of a work group&#8217;s execution.
  If the kernel is executed with a non-uniform work group size
  (i.e. the global_work_size values specified to <strong>clEnqueueNDRangeKernel</strong>
  are not evenly divisible by the local_work_size values for any dimension,
  calls to this built-in from some work groups may return different values
  than calls to this built-in from other work groups.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>uint <strong>get_enqueued_num_sub_groups</strong> ()</p>
</div></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Returns the same value as that returned by <strong>get_num_sub_groups</strong> if the
  kernel is executed with a uniform work group size.</p>
<p class="tableblock">  If the kernel is executed with a non-uniform work group size, returns the
  number of subgroups in each of the work groups that make up the uniform
  region of the global range.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>uint <strong>get_sub_group_id</strong> ()</p>
</div></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>get_sub_group_id</strong> returns the subgroup ID which is a number from 0 ..
  <strong>get_num_sub_groups</strong>() - 1.</p>
<p class="tableblock">  For <strong>clEnqueueTask</strong>, this returns 0.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>uint <strong>get_sub_group_local_id</strong> ()</p>
</div></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Returns the unique work item ID within the current subgroup.
  The mapping from <strong>get_local_id</strong>(<em>dimindx</em>) to <strong>get_sub_group_local_id</strong>
  will be invariant for the lifetime of the work group.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="cl_khr_subgroups-additions-to-section-6.13.8-synchronization-functions"><a class="anchor" href="#cl_khr_subgroups-additions-to-section-6.13.8-synchronization-functions"></a>28.5.2. Additions to section 6.13.8&#8201;&#8212;&#8201;Synchronization Functions</h4>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 30%;">
<col style="width: 70%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><strong>Function</strong></th>
<th class="tableblock halign-left valign-top"><strong>Description</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">void <strong>sub_group_barrier</strong> (<br>
  cl_mem_fence_flags <em>flags</em>)</p>
<p class="tableblock">  void <strong>sub_group_barrier</strong> (<br>
  cl_mem_fence_flags <em>flags</em>, memory_scope <em>scope</em>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">All work items in a subgroup executing the kernel on a processor must
  execute this function before any are allowed to continue execution beyond
  the subgroup barrier.
  This function must be encountered by all work items in a subgroup
  executing the kernel.
  These rules apply to ND-ranges implemented with uniform and non-uniform
  work groups.</p>
<p class="tableblock">  If <strong>sub_group_barrier</strong> is inside a conditional statement, then all work
  items within the subgroup must enter the conditional if any work item in
  the subgroup enters the conditional statement and executes the
  sub_group_barrier.</p>
<p class="tableblock">  If <strong>sub_group_barrier</strong> is inside a loop, all work items within the subgroup
  must execute the sub_group_barrier for each iteration of the loop before
  any are allowed to continue execution beyond the sub_group_barrier.</p>
<p class="tableblock">  The <strong>sub_group_barrier</strong> function also queues a memory fence (reads and
  writes) to ensure correct ordering of memory operations to local or global
  memory.</p>
<p class="tableblock">  The flags argument specifies the memory address space and can be set to a
  combination of the following values:</p>
<p class="tableblock">  CLK_LOCAL_MEM_FENCE - The <strong>sub_group_barrier</strong> function will either flush
  any variables stored in local memory or queue a memory fence to ensure
  correct ordering of memory operations to local memory.</p>
<p class="tableblock">  CLK_GLOBAL_MEM_FENCE&#8201;&#8212;&#8201;The <strong>sub_group_barrier</strong> function will queue a
  memory fence to ensure correct ordering of memory operations to global
  memory.
  This can be useful when work items, for example, write to buffer objects
  and then want to read the updated data from these buffer objects.</p>
<p class="tableblock">  CLK_IMAGE_MEM_FENCE&#8201;&#8212;&#8201;The <strong>sub_group_barrier</strong> function will queue a memory
  fence to ensure correct ordering of memory operations to image objects.
  This can be useful when work items, for example, write to image objects
  and then want to read the updated data from these image objects.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="cl_khr_subgroups-additions-to-section-6.13.11-atomic-functions"><a class="anchor" href="#cl_khr_subgroups-additions-to-section-6.13.11-atomic-functions"></a>28.5.3. Additions to section 6.13.11&#8201;&#8212;&#8201;Atomic Functions</h4>
<div class="paragraph">
<p>Add the following new value to the enumerated type <code>memory_scope</code> defined in
<em>section 6.13.11.4</em>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="opencl"><span class="n">memory_scope_sub_group</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>memory_scope_sub_group</code> specifies that the memory ordering constraints
given by <code>memory_order</code> apply to work items in a subgroup.
This memory scope can be used when performing atomic operations to global or
local memory.</p>
</div>
</div>
<div class="sect3">
<h4 id="cl_khr_subgroups-add-a-new-section-6.13.X-sub-group-functions"><a class="anchor" href="#cl_khr_subgroups-add-a-new-section-6.13.X-sub-group-functions"></a>28.5.4. Add a new section 6.13.X&#8201;&#8212;&#8201;Sub-Group Functions</h4>
<div class="paragraph">
<p>The table below describes OpenCL C programming language built-in functions that operate on a subgroup level.
These built-in functions must be encountered by all work items in the subgroup executing the kernel.
For the functions below, the generic type name <code>gentype</code> may be the one of the supported built-in scalar data types <code>int</code>, <code>uint</code>, <code>long</code>, <code>ulong</code>, <code>float</code>, <code>double</code> (if double precision is supported), or <code>half</code> (if half precision is supported).</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><strong>Function</strong></th>
<th class="tableblock halign-left valign-top"><strong>Description</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">int <strong>sub_group_all</strong> (int <em>predicate</em>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Evaluates <em>predicate</em> for all work items in the subgroup and returns a
  non-zero value if <em>predicate</em> evaluates to non-zero for all work items in
  the subgroup.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">int <strong>sub_group_any</strong> (int <em>predicate</em>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Evaluates <em>predicate</em> for all work items in the subgroup and returns a
  non-zero value if <em>predicate</em> evaluates to non-zero for any work items in
  the subgroup.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">gentype <strong>sub_group_broadcast</strong> (<br>
  gentype <em>x</em>, uint <em>sub_group_local_id</em>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Broadcast the value of <em>x</em> for work item identified by
  <em>sub_group_local_id</em> (value returned by <strong>get_sub_group_local_id</strong>) to all
  work items in the subgroup.</p>
<p class="tableblock">  <em>sub_group_local_id</em> must be the same value for all work items in the
  subgroup.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">gentype <strong>sub_group_reduce_&lt;op&gt;</strong> (<br>
  gentype <em>x</em>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Return result of reduction operation specified by <strong>&lt;op&gt;</strong> for all values of
  <em>x</em> specified by work items in a subgroup.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">gentype <strong>sub_group_scan_exclusive_&lt;op&gt;</strong> (<br>
  gentype <em>x</em>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Do an exclusive scan operation specified by <strong>&lt;op&gt;</strong> of all values specified
  by work items in a subgroup.
  The scan results are returned for each work item.</p>
<p class="tableblock">  The scan order is defined by increasing subgroup local ID within the
  subgroup.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">gentype <strong>sub_group_scan_inclusive_&lt;op&gt;</strong> (<br>
  gentype <em>x</em>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Do an inclusive scan operation specified by <strong>&lt;op&gt;</strong> of all values specified
  by work items in a subgroup.
  The scan results are returned for each work item.</p>
<p class="tableblock">  The scan order is defined by increasing subgroup local ID within the
  subgroup.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>The <strong>&lt;op&gt;</strong> in <strong>sub_group_reduce_&lt;op&gt;</strong>, <strong>sub_group_scan_inclusive_&lt;op&gt;</strong> and <strong>sub_group_scan_exclusive_&lt;op&gt;</strong> defines the operator and can be <strong>add</strong>, <strong>min</strong> or <strong>max</strong>.</p>
</div>
<div class="paragraph">
<p>The exclusive scan operation takes a binary operator <strong>op</strong> with an identity I and <em>n</em> (where <em>n</em> is the size of the sub-group) elements [a<sub>0</sub>, a<sub>1</sub>, &#8230;&#8203; a<sub>n-1</sub>] and returns [I, a<sub>0</sub>, (a<sub>0</sub> <strong>op</strong> a<sub>1</sub>), &#8230;&#8203; (a<sub>0</sub> <strong>op</strong> a<sub>1</sub> <strong>op</strong> &#8230;&#8203; <strong>op</strong> a<sub>n-2</sub>)].</p>
</div>
<div class="paragraph">
<p>The inclusive scan operation takes a binary operator <strong>op</strong> with <em>n</em> (where <em>n</em> is the size of the sub-group) elements [a<sub>0</sub>, a<sub>1</sub>, &#8230;&#8203; a<sub>n-1</sub>] and returns [a<sub>0</sub>, (a<sub>0</sub> <strong>op</strong> a<sub>1</sub>), &#8230;&#8203; (a<sub>0</sub> <strong>op</strong> a<sub>1</sub> <strong>op</strong> &#8230;&#8203; <strong>op</strong> a<sub>n-1</sub>)].</p>
</div>
<div class="paragraph">
<p>If <strong>op</strong> = <strong>add</strong>, the identity I is 0.
If <strong>op</strong> = <strong>min</strong>, the identity I is <code>INT_MAX</code>, <code>UINT_MAX</code>, <code>LONG_MAX</code>, <code>ULONG_MAX</code>, for <code>int</code>, <code>uint</code>, <code>long</code>, <code>ulong</code> types and is <code>+INF</code> for
floating-point types.
Similarly if <strong>op</strong> = max, the identity I is <code>INT_MIN</code>, 0, <code>LONG_MIN</code>, 0 and <code>-INF</code>.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The order of floating-point operations is not guaranteed for the <strong>sub_group_reduce_&lt;op&gt;</strong>, <strong>sub_group_scan_inclusive_&lt;op&gt;</strong> and <strong>sub_group_scan_exclusive_&lt;op&gt;</strong> built-in functions that operate on <code>half</code>, <code>float</code> and <code>double</code> data types.
The order of these floating-point operations is also non-deterministic for a given sub-group.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="cl_khr_subgroups-additions-to-section-6.13.16-pipe-functions"><a class="anchor" href="#cl_khr_subgroups-additions-to-section-6.13.16-pipe-functions"></a>28.5.5. Additions to section 6.13.16&#8201;&#8212;&#8201;Pipe Functions</h4>
<div class="paragraph">
<p>The OpenCL C programming language implements the following built-in pipe
functions that operate at a subgroup level.
These built-in functions must be encountered by all work items in a subgroup
executing the kernel with the same argument values; otherwise the behavior
is undefined.
We use the generic type name <code>gentype</code> to indicate the built-in OpenCL C
scalar or vector integer or floating-point data types or any user defined
type built from these scalar and vector data types can be used as the type
for the arguments to the pipe functions listed in <em>table 6.29</em>.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><strong>Function</strong></th>
<th class="tableblock halign-left valign-top"><strong>Description</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">reserve_id_t <strong>sub_group_reserve_read_pipe</strong> (<br>
  read_only pipe gentype <em>pipe</em>,<br>
  uint <em>num_packets</em>)</p>
<p class="tableblock">  reserve_id_t <strong>sub_group_reserve_write_pipe</strong> (<br>
  write_only pipe gentype <em>pipe</em>,<br>
  uint <em>num_packets</em>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Reserve <em>num_packets</em> entries for reading from or writing to <em>pipe</em>.
  Returns a valid non-zero reservation ID if the reservation is successful
  and 0 otherwise.</p>
<p class="tableblock">  The reserved pipe entries are referred to by indices that go from 0 &#8230;&#8203;
  <em>num_packets</em> - 1.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">void <strong>sub_group_commit_read_pipe</strong> (<br>
  read_only pipe gentype <em>pipe</em>,<br>
  reserve_id_t <em>reserve_id</em>)</p>
<p class="tableblock">  void <strong>sub_group_commit_write_pipe</strong> (<br>
  write_only pipe gentype <em>pipe</em>,<br>
  reserve_id_t <em>reserve_id</em>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates that all reads and writes to <em>num_packets</em> associated with
  reservation <em>reserve_id</em> are completed.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Note: Reservations made by a subgroup are ordered in the pipe as they are
ordered in the program.
Reservations made by different subgroups that belong to the same work group
can be ordered using subgroup synchronization.
The order of subgroup based reservations that belong to different work
groups is implementation defined.</p>
</div>
</div>
<div class="sect3">
<h4 id="cl_khr_subgroups-additions-to-section-6.13.17.6-enqueuing-kernels-kernel-query-functions"><a class="anchor" href="#cl_khr_subgroups-additions-to-section-6.13.17.6-enqueuing-kernels-kernel-query-functions"></a>28.5.6. Additions to section 6.13.17.6&#8201;&#8212;&#8201;Enqueuing Kernels (Kernel Query Functions)</h4>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 55.5555%;">
<col style="width: 44.4445%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><strong>Built-in Function</strong></th>
<th class="tableblock halign-left valign-top"><strong>Description</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">uint <strong>get_kernel_sub_group_count_for_ndrange</strong> (<br>
  const ndrange_t <em>ndrange</em>,<br>
  void (^block)(void));</p>
<p class="tableblock">  uint <strong>get_kernel_sub_group_count_for_ndrange</strong> (<br>
  const ndrange_t <em>ndrange</em>,<br>
  void (^block)(local void *, &#8230;&#8203;));</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Returns the number of subgroups in each work group of the dispatch (except
  for the last in cases where the global size does not divide cleanly into
  work groups) given the combination of the passed ndrange and block.</p>
<p class="tableblock">  <em>block</em> specifies the block to be enqueued.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">uint <strong>get_kernel_max_sub_group_size_for_ndrange</strong> (<br>
  const ndrange_t <em>ndrange</em>,<br>
  void (^block)(void));<br></p>
<p class="tableblock">  uint <strong>get_kernel_max_sub_group_size_for_ndrange</strong> (<br>
  const ndrange_t <em>ndrange</em>,<br>
  void (^block)(local void *, &#8230;&#8203;));</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Returns the maximum subgroup size for a block.</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="cl_khr_mipmap_image"><a class="anchor" href="#cl_khr_mipmap_image"></a>29. Mipmaps</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This section describes OpenCL support for mipmaps.</p>
</div>
<div class="paragraph">
<p>There are two optional mipmap extensions.
The <strong>cl_khr_mipmap_image</strong> extension adds the ability to create a mip-mapped
image, enqueue commands to read/write/copy/map/unmap a region of a mipmapped
image, and built-in functions that can be used to read a mip-mapped image in
an OpenCL C program.
The <strong>cl_khr_mipmap_image_writes</strong> extension adds built-in functions that can
be used to write a mip-mapped image in an OpenCL C program.
If the <strong>cl_khr_mipmap_image_writes</strong> extension is supported by the OpenCL
device, the <strong>cl_khr_mipmap_image</strong> extension must also be supported.</p>
</div>
<div class="sect2">
<h3 id="_general_information_28"><a class="anchor" href="#_general_information_28"></a>29.1. General information</h3>
<div class="sect3">
<h4 id="_version_history_28"><a class="anchor" href="#_version_history_28"></a>29.1.1. Version history</h4>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 60%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><strong>Date</strong></th>
<th class="tableblock halign-left valign-top"><strong>Version</strong></th>
<th class="tableblock halign-left valign-top"><strong>Description</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">2020-04-21</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.0.0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">First assigned version.</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect2">
<h3 id="cl_khr_mipmap_image-additions-to-chapter-5"><a class="anchor" href="#cl_khr_mipmap_image-additions-to-chapter-5"></a>29.2. Additions to Chapter 5 of the OpenCL 2.2 Specification</h3>
<div class="sect3">
<h4 id="cl_khr_mipmap_image-additions-to-section-5.3"><a class="anchor" href="#cl_khr_mipmap_image-additions-to-section-5.3"></a>29.2.1. Additions to section 5.3&#8201;&#8212;&#8201;Image Objects</h4>
<div class="paragraph">
<p>A mip-mapped 1D image, 1D image array, 2D image, 2D image array or 3D image
is created by specifying <em>num_mip_levels</em> to be a value greater than one in
the <em>image_desc</em> passed to <strong>clCreateImage</strong>.
The dimensions of a mip-mapped image can be a power of two or a non-power of
two.
Each successively smaller mipmap level is half the size of the previous
level.
If this half value is a fractional value, it is rounded down to the nearest
integer.</p>
</div>
<div class="paragraph">
<p><strong>Restrictions</strong></p>
</div>
<div class="paragraph">
<p>The following restrictions apply when mip-mapped images are created with
<strong>clCreateImage</strong>:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>CL_MEM_<wbr>USE_<wbr>HOST_<wbr>PTR</code> or <code>CL_MEM_<wbr>COPY_<wbr>HOST_<wbr>PTR</code> cannot be specified if a
mip-mapped image is created.</p>
</li>
<li>
<p>The <em>host_ptr</em> argument to <strong>clCreateImage</strong> must be a <code>NULL</code> value.</p>
</li>
<li>
<p>Mip-mapped images cannot be created for <code>CL_MEM_<wbr>OBJECT_<wbr>IMAGE1D_<wbr>BUFFER</code>
images, depth images or multi-sampled (i.e. msaa) images.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Calls to <strong>clEnqueueReadImage</strong>, <strong>clEnqueueWriteImage</strong> and <strong>clEnqueueMapImage</strong>
can be used to read from or write to a specific mip-level of a mip-mapped
image.
If image argument is a 1D image, <em>origin</em>[1] specifies the mip-level to use.
If image argument is a 1D image array, <em>origin</em>[2] specifies the mip-level
to use.
If image argument is a 2D image, <em>origin</em>[2] specifies the mip-level to use.
If image argument is a 2D image array or a 3D image, <em>origin</em>[3] specifies
the mip-level to use.</p>
</div>
<div class="paragraph">
<p>Calls to <strong>clEnqueueCopyImage</strong>, <strong>clEnqueueCopyImageToBuffer</strong> and
<strong>clEnqueueCopyBufferToImage</strong> can also be used to copy from and to a specific
mip-level of a mip-mapped image.
If <em>src_image</em> argument is a 1D image, <em>src_origin</em>[1] specifies the
mip-level to use.
If <em>src_image</em> argument is a 1D image array, <em>src_origin</em>[2] specifies the
mip-level to use.
If <em>src_image</em> argument is a 2D image, <em>src_origin</em>[2] specifies the
mip-level to use.
If <em>src_image</em> argument is a 2D image array or a 3D image, <em>src_origin</em>[3]
specifies the mip-level to use.
If <em>dst_image</em> argument is a 1D image, <em>dst_origin</em>[1] specifies the
mip-level to use.
If <em>dst_image</em> argument is a 1D image array, <em>dst_origin</em>[2] specifies the
mip-level to use.
If <em>dst_image</em> argument is a 2D image, <em>dst_origin</em>[2] specifies the
mip-level to use.
If <em>dst_image</em> argument is a 2D image array or a 3D image, <em>dst_origin</em>[3]
specifies the mip-level to use.</p>
</div>
<div class="paragraph">
<p>If the mip level specified is not a valid value, these functions return the
error <code>CL_INVALID_<wbr>MIP_<wbr>LEVEL</code>.</p>
</div>
<div class="paragraph">
<p>Calls to <strong>clEnqueueFillImage</strong> can be used to write to a specific mip-level of
a mip-mapped image.
If image argument is a 1D image, origin[1] specifies the mip-level to use.
If image argument is a 1D image array, origin[2] specifies the mip-level to
use.
If image argument is a 2D image, origin[2] specifies the mip-level to use.
If image argument is a 2D image array or a 3D image, origin[3] specifies the
mip-level to use.</p>
</div>
</div>
<div class="sect3">
<h4 id="cl_khr_mipmap_image-additions-to-section-5.7"><a class="anchor" href="#cl_khr_mipmap_image-additions-to-section-5.7"></a>29.2.2. Additions to section 5.7&#8201;&#8212;&#8201;Sampler Objects</h4>
<div class="paragraph">
<p>Add the following sampler properties <em>to table 5.14</em> that can be specified
when a sampler object is created using <strong>clCreateSamplerWithProperties</strong>.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 16.6666%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Sampler Property</th>
<th class="tableblock halign-left valign-top">Property Value</th>
<th class="tableblock halign-left valign-top">Default Value</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CL_SAMPLER_<wbr>MIP_<wbr>FILTER_<wbr>MODE_<wbr>KHR</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>cl_filter_<wbr>mode</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CL_FILTER_<wbr>NEAREST</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CL_SAMPLER_<wbr>LOD_<wbr>MIN_<wbr>KHR</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>cl_float</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>0.0f</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CL_SAMPLER_<wbr>LOD_<wbr>MAX_<wbr>KHR</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>cl_float</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>MAXFLOAT</code></p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Note: The sampler properties <code>CL_SAMPLER_<wbr>MIP_<wbr>FILTER_<wbr>MODE_<wbr>KHR</code>,
<code>CL_SAMPLER_<wbr>LOD_<wbr>MIN_<wbr>KHR</code> and <code>CL_SAMPLER_<wbr>LOD_<wbr>MAX_<wbr>KHR</code> cannot be specified with
any samplers initialized in the OpenCL program source.
Only the default values for these properties will be used.
To create a sampler with specific values for these properties, a sampler
object must be created with <strong>clCreateSamplerWithProperties</strong> and passed as an
argument to a kernel.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="cl_khr_mipmap_image-additions-to-chapter-6-of-the-opencl-2.0-specification"><a class="anchor" href="#cl_khr_mipmap_image-additions-to-chapter-6-of-the-opencl-2.0-specification"></a>29.3. Additions to Chapter 6 of the OpenCL 2.0 Specification</h3>
<div class="sect3">
<h4 id="cl_khr_mipmap_image-additions-to-section-6.13.14-image-read-write-and-query-functions"><a class="anchor" href="#cl_khr_mipmap_image-additions-to-section-6.13.14-image-read-write-and-query-functions"></a>29.3.1. Additions to section 6.13.14  Image Read, Write and Query Functions</h4>
<div class="paragraph">
<p>The image read and write functions described in <em>sections 6.13.14.2</em>,
<em>6.13.14.3</em> and <em>6.13.14.4</em> read from and write to mip-level 0 if the
image argument is a mip-mapped image.</p>
</div>
<div class="paragraph">
<p>The following new built-in functions are added to <em>section 6.13.14.2</em>.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 55.5555%;">
<col style="width: 44.4445%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><strong>Function</strong></th>
<th class="tableblock halign-left valign-top"><strong>Description</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="opencl_c"><span class="kt">float4</span> <span class="fm">read_imagef</span><span class="p">(</span>
    <span class="nx">read_only</span> <span class="kt">image2d_t</span> <span class="n">image</span><span class="p">,</span>
    <span class="kt">sampler_t</span> <span class="n">sampler</span><span class="p">,</span>
    <span class="kt">float2</span> <span class="n">coord</span><span class="p">,</span>
    <span class="kt">float</span> <span class="n">lod</span><span class="p">)</span>

<span class="kt">int4</span> <span class="fm">read_imagei</span><span class="p">(</span>
    <span class="nx">read_only</span> <span class="kt">image2d_t</span> <span class="n">image</span><span class="p">,</span>
    <span class="kt">sampler_t</span> <span class="n">sampler</span><span class="p">,</span>
    <span class="kt">float2</span> <span class="n">coord</span><span class="p">,</span>
    <span class="kt">float</span> <span class="n">lod</span><span class="p">)</span>

<span class="kt">uint4</span> <span class="fm">read_imageui</span><span class="p">(</span>
    <span class="nx">read_only</span> <span class="kt">image2d_t</span> <span class="n">image</span><span class="p">,</span>
    <span class="kt">sampler_t</span> <span class="n">sampler</span><span class="p">,</span>
    <span class="kt">float2</span> <span class="n">coord</span><span class="p">,</span>
    <span class="kt">float</span> <span class="n">lod</span><span class="p">)</span>

<span class="kt">float</span> <span class="fm">read_imagef</span><span class="p">(</span>
    <span class="nx">read_only</span> <span class="kt">image2d_depth_t</span> <span class="n">image</span><span class="p">,</span>
    <span class="kt">sampler_t</span> <span class="n">sampler</span><span class="p">,</span>
    <span class="kt">float2</span> <span class="n">coord</span><span class="p">,</span>
    <span class="kt">float</span> <span class="n">lod</span><span class="p">)</span></code></pre>
</div>
</div></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Use the coordinate <em>coord.xy</em> to do an element lookup in the mip-level specified by <em>lod</em> in the 2D image object specified by <em>image</em>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="opencl_c"><span class="kt">float4</span> <span class="fm">read_imagef</span><span class="p">(</span>
    <span class="nx">read_only</span> <span class="kt">image2d_t</span> <span class="n">image</span><span class="p">,</span>
    <span class="kt">sampler_t</span> <span class="n">sampler</span><span class="p">,</span>
    <span class="kt">float2</span> <span class="n">coord</span><span class="p">,</span>
    <span class="kt">float2</span> <span class="n">gradient_x</span><span class="p">,</span>
    <span class="kt">float2</span> <span class="n">gradient_y</span><span class="p">)</span>

<span class="kt">int4</span> <span class="fm">read_imagei</span><span class="p">(</span>
    <span class="nx">read_only</span> <span class="kt">image2d_t</span> <span class="n">image</span><span class="p">,</span>
    <span class="kt">sampler_t</span> <span class="n">sampler</span><span class="p">,</span>
    <span class="kt">float2</span> <span class="n">coord</span><span class="p">,</span>
    <span class="kt">float2</span> <span class="n">gradient_x</span><span class="p">,</span>
    <span class="kt">float2</span> <span class="n">gradient_y</span><span class="p">)</span>

<span class="kt">uint4</span> <span class="fm">read_imageui</span><span class="p">(</span>
    <span class="nx">read_only</span> <span class="kt">image2d_t</span> <span class="n">image</span><span class="p">,</span>
    <span class="kt">sampler_t</span> <span class="n">sampler</span><span class="p">,</span>
    <span class="kt">float2</span> <span class="n">coord</span><span class="p">,</span>
    <span class="kt">float2</span> <span class="n">gradient_x</span><span class="p">,</span>
    <span class="kt">float2</span> <span class="n">gradient_y</span><span class="p">)</span>

<span class="kt">float</span> <span class="fm">read_imagef</span><span class="p">(</span>
    <span class="nx">read_only</span> <span class="kt">image2d_depth_t</span> <span class="n">image</span><span class="p">,</span>
    <span class="kt">sampler_t</span> <span class="n">sampler</span><span class="p">,</span>
    <span class="kt">float2</span> <span class="n">coord</span><span class="p">,</span>
    <span class="kt">float2</span> <span class="n">gradient_x</span><span class="p">,</span>
    <span class="kt">float2</span> <span class="n">gradient_y</span><span class="p">)</span></code></pre>
</div>
</div></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Use the gradients to compute the lod and coordinate <em>coord.xy</em> to do an element lookup in the mip-level specified by the computed lod in the 2D image object specified by <em>image</em>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="opencl_c"><span class="kt">float4</span> <span class="fm">read_imagef</span><span class="p">(</span>
    <span class="nx">read_only</span> <span class="kt">image1d_t</span> <span class="n">image</span><span class="p">,</span>
    <span class="kt">sampler_t</span> <span class="n">sampler</span><span class="p">,</span>
    <span class="kt">float</span> <span class="n">coord</span><span class="p">,</span>
    <span class="kt">float</span> <span class="n">lod</span><span class="p">)</span>

<span class="kt">int4</span> <span class="fm">read_imagei</span><span class="p">(</span>
    <span class="nx">read_only</span> <span class="kt">image1d_t</span> <span class="n">image</span><span class="p">,</span>
    <span class="kt">sampler_t</span> <span class="n">sampler</span><span class="p">,</span>
    <span class="kt">float</span> <span class="n">coord</span><span class="p">,</span>
    <span class="kt">float</span> <span class="n">lod</span><span class="p">)</span>

<span class="kt">uint4</span> <span class="fm">read_imageui</span><span class="p">(</span>
    <span class="nx">read_only</span> <span class="kt">image1d_t</span> <span class="n">image</span><span class="p">,</span>
    <span class="kt">sampler_t</span> <span class="n">sampler</span><span class="p">,</span>
    <span class="kt">float</span> <span class="n">coord</span><span class="p">,</span>
    <span class="kt">float</span> <span class="n">lod</span><span class="p">)</span></code></pre>
</div>
</div></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Use the coordinate <em>coord</em> to do an element lookup in the mip-level specified by <em>lod</em> in the 1D image object specified by <em>image</em>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="opencl_c"><span class="kt">float4</span> <span class="fm">read_imagef</span><span class="p">(</span>
    <span class="nx">read_only</span> <span class="kt">image1d_t</span> <span class="n">image</span><span class="p">,</span>
    <span class="kt">sampler_t</span> <span class="n">sampler</span><span class="p">,</span>
    <span class="kt">float</span> <span class="n">coord</span><span class="p">,</span>
    <span class="kt">float</span> <span class="n">gradient_x</span><span class="p">,</span>
    <span class="kt">float</span> <span class="n">gradient_y</span><span class="p">)</span>

<span class="kt">int4</span> <span class="fm">read_imagei</span><span class="p">(</span>
    <span class="nx">read_only</span> <span class="kt">image1d_t</span> <span class="n">image</span><span class="p">,</span>
    <span class="kt">sampler_t</span> <span class="n">sampler</span><span class="p">,</span>
    <span class="kt">float</span> <span class="n">coord</span><span class="p">,</span>
    <span class="kt">float</span> <span class="n">gradient_x</span><span class="p">,</span>
    <span class="kt">float</span> <span class="n">gradient_y</span><span class="p">)</span>

<span class="kt">uint4</span> <span class="fm">read_imageui</span><span class="p">(</span>
    <span class="nx">read_only</span> <span class="kt">image1d_t</span> <span class="n">image</span><span class="p">,</span>
    <span class="kt">sampler_t</span> <span class="n">sampler</span><span class="p">,</span>
    <span class="kt">float</span> <span class="n">coord</span><span class="p">,</span>
    <span class="kt">float</span> <span class="n">gradient_x</span><span class="p">,</span>
    <span class="kt">float</span> <span class="n">gradient_y</span><span class="p">)</span></code></pre>
</div>
</div></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Use the gradients to compute the lod and coordinate <em>coord</em> to do an element lookup in the mip-level specified by the computed lod in the 1D image object specified by <em>image</em>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="opencl_c"><span class="kt">float4</span> <span class="fm">read_imagef</span><span class="p">(</span>
    <span class="nx">read_only</span> <span class="kt">image3d_t</span> <span class="n">image</span><span class="p">,</span>
    <span class="kt">sampler_t</span> <span class="n">sampler</span><span class="p">,</span>
    <span class="kt">float4</span> <span class="n">coord</span><span class="p">,</span>
    <span class="kt">float</span> <span class="n">lod</span><span class="p">)</span>

<span class="kt">int4</span> <span class="fm">read_imagei</span><span class="p">(</span>
    <span class="nx">read_only</span> <span class="kt">image3d_t</span> <span class="n">image</span><span class="p">,</span>
    <span class="kt">sampler_t</span> <span class="n">sampler</span><span class="p">,</span>
    <span class="kt">float4</span> <span class="n">coord</span><span class="p">,</span>
    <span class="kt">float</span> <span class="n">lod</span><span class="p">)</span>

<span class="kt">uint4</span> <span class="fm">read_imageui</span><span class="p">(</span>
    <span class="nx">read_only</span> <span class="kt">image3d_t</span> <span class="n">image</span><span class="p">,</span>
    <span class="kt">sampler_t</span> <span class="n">sampler</span><span class="p">,</span>
    <span class="kt">float4</span> <span class="n">coord</span><span class="p">,</span>
    <span class="kt">float</span> <span class="n">lod</span><span class="p">)</span></code></pre>
</div>
</div></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Use the coordinate <em>coord.xyz</em> to do an element lookup in the mip-level specified by <em>lod</em> in the 3D image object specified by <em>image</em>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="opencl_c"><span class="kt">float4</span> <span class="fm">read_imagef</span><span class="p">(</span>
    <span class="nx">read_only</span> <span class="kt">image3d_t</span> <span class="n">image</span><span class="p">,</span>
    <span class="kt">sampler_t</span> <span class="n">sampler</span><span class="p">,</span>
    <span class="kt">float4</span> <span class="n">coord</span><span class="p">,</span>
    <span class="kt">float4</span> <span class="n">gradient_x</span><span class="p">,</span>
    <span class="kt">float4</span> <span class="n">gradient_y</span><span class="p">)</span>

<span class="kt">int4</span> <span class="fm">read_imagei</span><span class="p">(</span>
    <span class="nx">read_only</span> <span class="kt">image3d_t</span> <span class="n">image</span><span class="p">,</span>
    <span class="kt">sampler_t</span> <span class="n">sampler</span><span class="p">,</span>
    <span class="kt">float4</span> <span class="n">coord</span><span class="p">,</span>
    <span class="kt">float4</span> <span class="n">gradient_x</span><span class="p">,</span>
    <span class="kt">float4</span> <span class="n">gradient_y</span><span class="p">)</span>

<span class="kt">uint4</span> <span class="fm">read_imageui</span><span class="p">(</span>
    <span class="nx">read_only</span> <span class="kt">image3d_t</span> <span class="n">image</span><span class="p">,</span>
    <span class="kt">sampler_t</span> <span class="n">sampler</span><span class="p">,</span>
    <span class="kt">float4</span> <span class="n">coord</span><span class="p">,</span>
    <span class="kt">float4</span> <span class="n">gradient_x</span><span class="p">,</span>
    <span class="kt">float4</span> <span class="n">gradient_y</span><span class="p">)</span></code></pre>
</div>
</div></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Use the gradients to compute the lod and coordinate <em>coord.xyz</em> to do an element lookup in the mip-level specified by the computed lod in the 3D image object specified by <em>image</em>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="opencl_c"><span class="kt">float4</span> <span class="fm">read_imagef</span><span class="p">(</span>
    <span class="nx">read_only</span> <span class="kt">image1d_array_t</span> <span class="n">image</span><span class="p">,</span>
    <span class="kt">sampler_t</span> <span class="n">sampler</span><span class="p">,</span>
    <span class="kt">float2</span> <span class="n">coord</span><span class="p">,</span>
    <span class="kt">float</span> <span class="n">lod</span><span class="p">)</span>

<span class="kt">int4</span> <span class="fm">read_imagei</span><span class="p">(</span>
    <span class="nx">read_only</span> <span class="kt">image1d_array_t</span> <span class="n">image</span><span class="p">,</span>
    <span class="kt">sampler_t</span> <span class="n">sampler</span><span class="p">,</span>
    <span class="kt">float2</span> <span class="n">coord</span><span class="p">,</span>
    <span class="kt">float</span> <span class="n">lod</span><span class="p">)</span>

<span class="kt">uint4</span> <span class="fm">read_imageui</span><span class="p">(</span>
    <span class="nx">read_only</span> <span class="kt">image1d_array_t</span> <span class="n">image</span><span class="p">,</span>
    <span class="kt">sampler_t</span> <span class="n">sampler</span><span class="p">,</span>
    <span class="kt">float2</span> <span class="n">coord</span><span class="p">,</span>
    <span class="kt">float</span> <span class="n">lod</span><span class="p">)</span></code></pre>
</div>
</div></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Use the coordinate <em>coord.x</em> to do an element lookup in the 1D image identified by <em>coord.x</em> and mip-level specified by <em>lod</em> in the 1D image array specified by <em>image</em>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="opencl_c"><span class="kt">float4</span> <span class="fm">read_imagef</span><span class="p">(</span>
    <span class="nx">read_only</span> <span class="kt">image1d_array_t</span> <span class="n">image</span><span class="p">,</span>
    <span class="kt">sampler_t</span> <span class="n">sampler</span><span class="p">,</span>
    <span class="kt">float2</span> <span class="n">coord</span><span class="p">,</span>
    <span class="kt">float</span> <span class="n">gradient_x</span><span class="p">,</span>
    <span class="kt">float</span> <span class="n">gradient_y</span><span class="p">)</span>

<span class="kt">int4</span> <span class="fm">read_imagei</span><span class="p">(</span>
    <span class="nx">read_only</span> <span class="kt">image1d_array_t</span> <span class="n">image</span><span class="p">,</span>
    <span class="kt">sampler_t</span> <span class="n">sampler</span><span class="p">,</span>
    <span class="kt">float2</span> <span class="n">coord</span><span class="p">,</span>
    <span class="kt">float</span> <span class="n">gradient_x</span><span class="p">,</span>
    <span class="kt">float</span> <span class="n">gradient_y</span><span class="p">)</span>

<span class="kt">uint4</span> <span class="fm">read_imageui</span><span class="p">(</span>
    <span class="nx">read_only</span> <span class="kt">image1d_array_t</span> <span class="n">image</span><span class="p">,</span>
    <span class="kt">sampler_t</span> <span class="n">sampler</span><span class="p">,</span>
    <span class="kt">float2</span> <span class="n">coord</span><span class="p">,</span>
    <span class="kt">float</span> <span class="n">gradient_x</span><span class="p">,</span>
    <span class="kt">float</span> <span class="n">gradient_y</span><span class="p">)</span></code></pre>
</div>
</div></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Use the gradients to compute the lod and coordinate <em>coord.x</em> to do an element lookup in the mip-level specified by the computed lod in the 1D image array specified by <em>image</em>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="opencl_c"><span class="kt">float4</span> <span class="fm">read_imagef</span><span class="p">(</span>
    <span class="nx">read_only</span> <span class="kt">image2d_array_t</span> <span class="n">image</span><span class="p">,</span>
    <span class="kt">sampler_t</span> <span class="n">sampler</span><span class="p">,</span>
    <span class="kt">float4</span> <span class="n">coord</span><span class="p">,</span>
    <span class="kt">float</span> <span class="n">lod</span><span class="p">)</span>

<span class="kt">int4</span> <span class="fm">read_imagei</span><span class="p">(</span>
    <span class="nx">read_only</span> <span class="kt">image2d_array_t</span> <span class="n">image</span><span class="p">,</span>
    <span class="kt">sampler_t</span> <span class="n">sampler</span><span class="p">,</span>
    <span class="kt">float4</span> <span class="n">coord</span><span class="p">,</span>
    <span class="kt">float</span> <span class="n">lod</span><span class="p">)</span>

<span class="kt">uint4</span> <span class="fm">read_imageui</span><span class="p">(</span>
    <span class="nx">read_only</span> <span class="kt">image2d_array_t</span> <span class="n">image</span><span class="p">,</span>
    <span class="kt">sampler_t</span> <span class="n">sampler</span><span class="p">,</span>
    <span class="kt">float4</span> <span class="n">coord</span><span class="p">,</span>
    <span class="kt">float</span> <span class="n">lod</span><span class="p">)</span>

<span class="kt">float</span> <span class="fm">read_imagef</span><span class="p">(</span>
    <span class="nx">read_only</span> <span class="kt">image2d_array_depth_t</span> <span class="n">image</span><span class="p">,</span>
    <span class="kt">sampler_t</span> <span class="n">sampler</span><span class="p">,</span>
    <span class="kt">float4</span> <span class="n">coord</span><span class="p">,</span>
    <span class="kt">float</span> <span class="n">lod</span><span class="p">)</span></code></pre>
</div>
</div></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Use the coordinate <em>coord.xy</em> to do an element lookup in the 2D image identified by <em>coord.z</em> and mip-level specified by <em>lod</em> in the 2D image array specified by <em>image</em>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="opencl_c"><span class="kt">float4</span> <span class="fm">read_imagef</span><span class="p">(</span>
    <span class="nx">read_only</span> <span class="kt">image2d_array_t</span> <span class="n">image</span><span class="p">,</span>
    <span class="kt">sampler_t</span> <span class="n">sampler</span><span class="p">,</span>
    <span class="kt">float4</span> <span class="n">coord</span><span class="p">,</span>
    <span class="kt">float2</span> <span class="n">gradient_x</span><span class="p">,</span>
    <span class="kt">float2</span> <span class="n">gradient_y</span><span class="p">)</span>

<span class="kt">int4</span> <span class="fm">read_imagei</span><span class="p">(</span>
    <span class="nx">read_only</span> <span class="kt">image2d_array_t</span> <span class="n">image</span><span class="p">,</span>
    <span class="kt">sampler_t</span> <span class="n">sampler</span><span class="p">,</span>
    <span class="kt">float4</span> <span class="n">coord</span><span class="p">,</span>
    <span class="kt">float2</span> <span class="n">gradient_x</span><span class="p">,</span>
    <span class="kt">float2</span> <span class="n">gradient_y</span><span class="p">)</span>

<span class="kt">uint4</span> <span class="fm">read_imageui</span><span class="p">(</span>
    <span class="nx">read_only</span> <span class="kt">image2d_array_t</span> <span class="n">image</span><span class="p">,</span>
    <span class="kt">sampler_t</span> <span class="n">sampler</span><span class="p">,</span>
    <span class="kt">float4</span> <span class="n">coord</span><span class="p">,</span>
    <span class="kt">float2</span> <span class="n">gradient_x</span><span class="p">,</span>
    <span class="kt">float2</span> <span class="n">gradient_y</span><span class="p">)</span>

<span class="kt">float</span> <span class="fm">read_imagef</span><span class="p">(</span>
    <span class="nx">read_only</span> <span class="kt">image2d_array_depth_t</span> <span class="n">image</span><span class="p">,</span>
    <span class="kt">sampler_t</span> <span class="n">sampler</span><span class="p">,</span>
    <span class="kt">float4</span> <span class="n">coord</span><span class="p">,</span>
    <span class="kt">float2</span> <span class="n">gradient_x</span><span class="p">,</span>
    <span class="kt">float2</span> <span class="n">gradient_y</span><span class="p">)</span></code></pre>
</div>
</div></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Use the gradients to compute the lod coordinate and <em>coord.xy</em> to do an element lookup in the 2D image identified by <em>coord.z</em> and mip-level specified by the computed lod in the 2D image array specified by <em>image</em>.</p></td>
</tr>
</tbody>
</table>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<code>CL_SAMPLER_<wbr>NORMALIZED_<wbr>COORDS</code> must be <code>CL_TRUE</code> for built-in functions described in the table above that read from a mip-mapped image; otherwise the behavior is undefined.
The value specified in the <em>lod</em> argument is clamped to the minimum of (actual number of mip-levels  1) in the image or value specified for <code>CL_SAMPLER_<wbr>LOD_<wbr>MAX</code>.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The following new built-in functions are added to <em>section 6.13.14.4</em>.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><strong>Function</strong></th>
<th class="tableblock halign-left valign-top"><strong>Description</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="opencl_c"><span class="kt">void</span> <span class="fm">write_imagef</span><span class="p">(</span>
    <span class="nx">write_only</span> <span class="kt">image2d_t</span> <span class="n">image</span><span class="p">,</span>
    <span class="kt">int2</span> <span class="n">coord</span><span class="p">,</span>
    <span class="kt">int</span> <span class="n">lod</span><span class="p">,</span>
    <span class="kt">float4</span> <span class="n">color</span><span class="p">)</span>

<span class="kt">void</span> <span class="fm">write_imagei</span><span class="p">(</span>
    <span class="nx">write_only</span> <span class="kt">image2d_t</span> <span class="n">image</span><span class="p">,</span>
    <span class="kt">int2</span> <span class="n">coord</span><span class="p">,</span>
    <span class="kt">int</span> <span class="n">lod</span><span class="p">,</span>
    <span class="kt">int4</span> <span class="n">color</span><span class="p">)</span>

<span class="kt">void</span> <span class="fm">write_imageui</span><span class="p">(</span>
    <span class="nx">write_only</span> <span class="kt">image2d_t</span> <span class="n">image</span><span class="p">,</span>
    <span class="kt">int2</span> <span class="n">coord</span><span class="p">,</span>
    <span class="kt">int</span> <span class="n">lod</span><span class="p">,</span>
    <span class="kt">uint4</span> <span class="n">color</span><span class="p">)</span>

<span class="kt">void</span> <span class="fm">write_imagef</span><span class="p">(</span>
    <span class="nx">write_only</span> <span class="kt">image2d_depth_t</span> <span class="n">image</span><span class="p">,</span>
    <span class="kt">int2</span> <span class="n">coord</span><span class="p">,</span>
    <span class="kt">int</span> <span class="n">lod</span><span class="p">,</span>
    <span class="kt">float</span> <span class="n">depth</span><span class="p">)</span></code></pre>
</div>
</div></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Write <em>color</em> value to location specified by <em>coord.xy</em> in the mip-level specified by <em>lod</em> in the 2D image object specified by <em>image</em>.
Appropriate data format conversion to the specified image format is done before writing the color value.
<em>coord.x</em> and <em>coord.y</em> are considered to be unnormalized coordinates and must be in the range 0 .. image width of mip-level specified by <em>lod</em>  1, and 0 .. image height of mip-level specified by <em>lod</em>  1.</p>
<p class="tableblock">The behavior of <strong>write_imagef</strong>, <strong>write_imagei</strong> and <strong>write_imageui</strong> if (<em>x</em>, <em>y</em>) coordinate values are not in the range (0 .. image width of the mip-level specified by <em>lod</em>  1, 0 .. image height of the mip-level specified by <em>lod</em>  1) or <em>lod</em> value exceeds the (number of mip-levels in the image  1) is undefined.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="opencl_c"><span class="kt">void</span> <span class="fm">write_imagef</span><span class="p">(</span>
    <span class="nx">write_only</span> <span class="kt">image1d_t</span> <span class="n">image</span><span class="p">,</span>
    <span class="kt">int</span> <span class="n">coord</span><span class="p">,</span>
    <span class="kt">int</span> <span class="n">lod</span><span class="p">,</span>
    <span class="kt">float4</span> <span class="n">color</span><span class="p">)</span>

<span class="kt">void</span> <span class="fm">write_imagei</span><span class="p">(</span>
    <span class="nx">write_only</span> <span class="kt">image1d_t</span> <span class="n">image</span><span class="p">,</span>
    <span class="kt">int</span> <span class="n">coord</span><span class="p">,</span>
    <span class="kt">int</span> <span class="n">lod</span><span class="p">,</span>
    <span class="kt">int4</span> <span class="n">color</span><span class="p">)</span>

<span class="kt">void</span> <span class="fm">write_imageui</span><span class="p">(</span>
    <span class="nx">write_only</span> <span class="kt">image1d_t</span> <span class="n">image</span><span class="p">,</span>
    <span class="kt">int</span> <span class="n">coord</span><span class="p">,</span>
    <span class="kt">int</span> <span class="n">lod</span><span class="p">,</span>
    <span class="kt">uint4</span> <span class="n">color</span><span class="p">)</span></code></pre>
</div>
</div></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Write <em>color</em> value to location specified by <em>coord</em> in the mip-level specified by <em>lod</em> in the 1D image object specified by <em>image</em>.
Appropriate data format conversion to the specified image format is done before writing the color value.
<em>coord</em> is considered to be unnormalized coordinates and must be in the range 0 .. image width of the mip-level
specified by <em>lod</em>  1.</p>
<p class="tableblock">The behavior of <strong>write_imagef</strong>, <strong>write_imagei</strong> and <strong>write_imageui</strong> if coordinate value is not in the range (0 .. image width of the mip-level specified by <em>lod</em>  1) or <em>lod</em> value exceeds the (number of mip-levels in the image  1), is undefined.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="opencl_c"><span class="kt">void</span> <span class="fm">write_imagef</span><span class="p">(</span>
    <span class="nx">write_only</span> <span class="kt">image1d_array_t</span> <span class="n">image</span><span class="p">,</span>
    <span class="kt">int2</span> <span class="n">coord</span><span class="p">,</span>
    <span class="kt">int</span> <span class="n">lod</span><span class="p">,</span>
    <span class="kt">float4</span> <span class="n">color</span><span class="p">)</span>

<span class="kt">void</span> <span class="fm">write_imagei</span><span class="p">(</span>
    <span class="nx">write_only</span> <span class="kt">image1d_array_t</span> <span class="n">image</span><span class="p">,</span>
    <span class="kt">int2</span> <span class="n">coord</span><span class="p">,</span>
    <span class="kt">int</span> <span class="n">lod</span><span class="p">,</span>
    <span class="kt">int4</span> <span class="n">color</span><span class="p">)</span>

<span class="kt">void</span> <span class="fm">write_imageui</span><span class="p">(</span>
    <span class="nx">write_only</span> <span class="kt">image1d_array_t</span> <span class="n">image</span><span class="p">,</span>
    <span class="kt">int2</span> <span class="n">coord</span><span class="p">,</span>
    <span class="kt">int</span> <span class="n">lod</span><span class="p">,</span>
    <span class="kt">uint4</span> <span class="n">color</span><span class="p">)</span></code></pre>
</div>
</div></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Write <em>color</em> value to location specified by <em>coord.x</em> in the 1D image identified by <em>coord.y</em> and mip-level <em>lod</em> in the 1D image array specified by <em>image</em>.
Appropriate data format conversion to the specified image format is done before writing the color value.
<em>coord.x</em> and <em>coord.y</em> are considered to be unnormalized coordinates and must be in the range 0 .. image width of the mip-level specified by <em>lod</em>  1 and 0 .. image number of layers  1.</p>
<p class="tableblock">The behavior of <strong>write_imagef</strong>, <strong>write_imagei</strong> and <strong>write_imageui</strong> if (<em>x</em>, <em>y</em>) coordinate values are not in the range (0 .. image width of the mip-level specified by <em>lod</em>  1, 0 .. image number of layers  1), respectively or <em>lod</em> value exceeds the (number of mip-levels in the image  1), is undefined.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="opencl_c"><span class="kt">void</span> <span class="fm">write_imagef</span><span class="p">(</span>
    <span class="nx">write_only</span> <span class="kt">image2d_array_t</span> <span class="n">image</span><span class="p">,</span>
    <span class="kt">int4</span> <span class="n">coord</span><span class="p">,</span>
    <span class="kt">int</span> <span class="n">lod</span><span class="p">,</span>
    <span class="kt">float4</span> <span class="n">color</span><span class="p">)</span>

<span class="kt">void</span> <span class="fm">write_imagei</span><span class="p">(</span>
    <span class="nx">write_only</span> <span class="kt">image2d_array_t</span> <span class="n">image</span><span class="p">,</span>
    <span class="kt">int4</span> <span class="n">coord</span><span class="p">,</span>
    <span class="kt">int</span> <span class="n">lod</span><span class="p">,</span>
    <span class="kt">int4</span> <span class="n">color</span><span class="p">)</span>

<span class="kt">void</span> <span class="fm">write_imageui</span><span class="p">(</span>
    <span class="nx">write_only</span> <span class="kt">image2d_array_t</span> <span class="n">image</span><span class="p">,</span>
    <span class="kt">int4</span> <span class="n">coord</span><span class="p">,</span>
    <span class="kt">int</span> <span class="n">lod</span><span class="p">,</span>
    <span class="kt">uint4</span> <span class="n">color</span><span class="p">)</span>

<span class="kt">void</span> <span class="fm">write_imagef</span><span class="p">(</span>
    <span class="nx">write_only</span> <span class="kt">image2d_array_depth_t</span> <span class="n">image</span><span class="p">,</span>
    <span class="kt">int4</span> <span class="n">coord</span><span class="p">,</span>
    <span class="kt">int</span> <span class="n">lod</span><span class="p">,</span>
    <span class="kt">float</span> <span class="n">depth</span><span class="p">)</span></code></pre>
</div>
</div></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Write <em>color</em> value to location specified by <em>coord.xy</em> in the 2D image identified by <em>coord.z</em> and mip-level <em>lod</em> in the 2D image array specified by <em>image</em>.
Appropriate data format conversion to the specified image format is done before writing the color value.
<em>coord.x</em>, <em>coord.y</em> and <em>coord.z</em> are considered to be unnormalized coordinates and must be in the range 0 .. image width of the mip-level specified by <em>lod</em>  1, 0 .. image height  1 specified by <em>lod</em>  1 and 0 .. image number of layers  1.</p>
<p class="tableblock">The behavior of <strong>write_imagef</strong>, <strong>write_imagei</strong> and <strong>write_imageui</strong> if (<em>x</em>, <em>y, z</em>) coordinate values are not in the range (0 .. image width of the mip-level specified by <em>lod</em>  1, 0 .. image height of the mip-level specified by <em>lod</em>  1, 0 .. image number of layers  1), respectively or <em>lod</em> value exceeds the (number of mip-levels in the image  1), is undefined.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="opencl_c"><span class="kt">void</span> <span class="fm">write_imagef</span><span class="p">(</span>
    <span class="nx">write_only</span> <span class="kt">image3d_t</span> <span class="n">image</span><span class="p">,</span>
    <span class="kt">int4</span> <span class="n">coord</span><span class="p">,</span>
    <span class="kt">int</span> <span class="n">lod</span><span class="p">,</span>
    <span class="kt">float4</span> <span class="n">color</span><span class="p">)</span>

<span class="kt">void</span> <span class="fm">write_imagei</span><span class="p">(</span>
    <span class="nx">write_only</span> <span class="kt">image3d_t</span> <span class="n">image</span><span class="p">,</span>
    <span class="kt">int4</span> <span class="n">coord</span><span class="p">,</span>
    <span class="kt">int</span> <span class="n">lod</span><span class="p">,</span>
    <span class="kt">int4</span> <span class="n">color</span><span class="p">)</span>

<span class="kt">void</span> <span class="fm">write_imageui</span><span class="p">(</span>
    <span class="nx">write_only</span> <span class="kt">image3d_t</span> <span class="n">image</span><span class="p">,</span>
    <span class="kt">int4</span> <span class="n">coord</span><span class="p">,</span>
    <span class="kt">int</span> <span class="n">lod</span><span class="p">,</span>
    <span class="kt">uint4</span> <span class="n">color</span><span class="p">)</span></code></pre>
</div>
</div></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Write color value to location specified by <em>coord.xyz</em> and mip-level <em>lod</em> in the 3D image object specified by <em>image</em>.
Appropriate data format conversion to the specified image format is done before writing the color value.
<em>coord.x</em>, <em>coord.y</em> and <em>coord.z</em> are considered to be unnormalized coordinates and must be in the range 0 .. image width  1
specified by <em>lod</em>  1, 0 .. image height  1 specified by <em>lod</em>  1 and 0 .. image depth  1 specified by <em>lod</em>  1.</p>
<p class="tableblock">The behavior of <strong>write_imagef</strong>, <strong>write_imagei</strong> and <strong>write_imageui</strong> if (<em>x</em>, <em>y, z</em>) coordinate values are not in the range (0 .. image width of the mip-level specified by <em>lod</em>  1, 0 .. image height of the mip-level specified by <em>lod</em>  1, 0 .. image depth  1), respectively or <em>lod</em> value exceeds the (number of mip-levels in the image  1), is undefined.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>The following new built-in functions are added to <em>section 6.13.14.5</em>.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><strong>Function</strong></th>
<th class="tableblock halign-left valign-top"><strong>Description</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="opencl_c"><span class="kt">int</span> <span class="n">get_image_num_mip_levels</span><span class="p">(</span>
    <span class="kt">image1d_t</span> <span class="n">image</span><span class="p">)</span>

<span class="kt">int</span> <span class="n">get_image_num_mip_levels</span><span class="p">(</span>
    <span class="kt">image2d_t</span> <span class="n">image</span><span class="p">)</span>

<span class="kt">int</span> <span class="n">get_image_num_mip_levels</span><span class="p">(</span>
    <span class="kt">image3d_t</span> <span class="n">image</span><span class="p">)</span>

<span class="kt">int</span> <span class="n">get_image_num_mip_levels</span><span class="p">(</span>
    <span class="kt">image1d_array_t</span> <span class="n">image</span><span class="p">)</span>

<span class="kt">int</span> <span class="n">get_image_num_mip_levels</span><span class="p">(</span>
    <span class="kt">image2d_array_t</span> <span class="n">image</span><span class="p">)</span>

<span class="kt">int</span> <span class="n">get_image_num_mip_levels</span><span class="p">(</span>
    <span class="kt">image2d_depth_t</span> <span class="n">image</span><span class="p">)</span>

<span class="kt">int</span> <span class="n">get_image_num_mip_levels</span><span class="p">(</span>
    <span class="kt">image2d_array_depth_t</span> <span class="n">image</span><span class="p">)</span></code></pre>
</div>
</div></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Return the number of mip-levels.</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect2">
<h3 id="cl_khr_mipmap_image-additions-to-creating-opencl-memory-objects-from-opengl-objects"><a class="anchor" href="#cl_khr_mipmap_image-additions-to-creating-opencl-memory-objects-from-opengl-objects"></a>29.4. Additions to <a href="#cl_khr_gl_sharing__memobjs">Creating OpenCL Memory Objects from OpenGL Objects</a></h3>
<div class="paragraph">
<p>If both the <strong>cl_khr_mipmap_image</strong> and <strong>cl_khr_gl_sharing</strong> extensions are
supported by the OpenCL device, the <strong>cl_khr_gl_sharing</strong> extension may also
be used to create a mipmapped OpenCL image from a mipmapped OpenGL texture.</p>
</div>
<div class="paragraph">
<p>To create a mipmapped OpenCL image from a mipmapped OpenGL texture, pass a
negative value as the <em>miplevel</em> argument to <strong>clCreateFromGLTexture</strong>.
If <em>miplevel</em> is a negative value then an OpenCL mipmapped image object is
created from a mipmapped OpenGL texture object, instead of an OpenCL image
object for a specific miplevel of the OpenGL texture.</p>
</div>
<div class="paragraph">
<p>Note: For a detailed description of how the level of detail is computed,
please refer to <em>section 3.9.7</em> of the OpenGL 3.0 specification.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="cl_khr_srgb_image_writes"><a class="anchor" href="#cl_khr_srgb_image_writes"></a>30. sRGB Image Writes</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This section describes the <strong>cl_khr_srgb_image_writes</strong> extension.</p>
</div>
<div class="paragraph">
<p>This extension enables kernels to write to sRGB images using the <strong>write_imagef</strong> built-in function.
The sRGB image formats that may be written to will be returned by <strong>clGetSupportedImageFormats</strong>.</p>
</div>
<div class="paragraph">
<p>When the image is an sRGB image, the <strong>write_imagef</strong> built-in function will perform the linear to sRGB conversion.
Only the R, G, and B components are converted from linear to sRGB; the A component is written as-is.</p>
</div>
<div class="sect2">
<h3 id="_general_information_29"><a class="anchor" href="#_general_information_29"></a>30.1. General information</h3>
<div class="sect3">
<h4 id="_version_history_29"><a class="anchor" href="#_version_history_29"></a>30.1.1. Version history</h4>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 60%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><strong>Date</strong></th>
<th class="tableblock halign-left valign-top"><strong>Version</strong></th>
<th class="tableblock halign-left valign-top"><strong>Description</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">2020-04-21</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.0.0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">First assigned version.</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="cl_khr_priority_hints"><a class="anchor" href="#cl_khr_priority_hints"></a>31. Priority Hints</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This section describes the <strong>cl_khr_priority_hints</strong> extension.
This extension adds priority hints for OpenCL, but does not specify the
scheduling behavior or minimum guarantees.
It is expected that the the user guides associated with each implementation
which supports this extension will describe the scheduling behavior
guarantees.</p>
</div>
<div class="sect2">
<h3 id="_general_information_30"><a class="anchor" href="#_general_information_30"></a>31.1. General information</h3>
<div class="sect3">
<h4 id="_version_history_30"><a class="anchor" href="#_version_history_30"></a>31.1.1. Version history</h4>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 60%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><strong>Date</strong></th>
<th class="tableblock halign-left valign-top"><strong>Version</strong></th>
<th class="tableblock halign-left valign-top"><strong>Description</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">2020-04-21</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.0.0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">First assigned version.</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect2">
<h3 id="cl_khr_priority_hints-host-side-api-modifications"><a class="anchor" href="#cl_khr_priority_hints-host-side-api-modifications"></a>31.2. Host-side API modifications</h3>
<div class="paragraph">
<p>The function <strong>clCreateCommandQueueWithProperties</strong> (Section 5.1) is
extended to support a priority value as part of the <em>properties</em> argument.</p>
</div>
<div class="paragraph">
<p>The priority property applies to OpenCL command queues that belong to the
same OpenCL context.</p>
</div>
<div class="paragraph">
<p>The properties field accepts the <code>CL_QUEUE_<wbr>PRIORITY_<wbr>KHR</code> property, with a
value of type <code>cl_queue_<wbr>priority_<wbr>khr</code>, which can be one of:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>CL_QUEUE_<wbr>PRIORITY_<wbr>HIGH_<wbr>KHR</code></p>
</li>
<li>
<p><code>CL_QUEUE_<wbr>PRIORITY_<wbr>MED_<wbr>KHR</code></p>
</li>
<li>
<p><code>CL_QUEUE_<wbr>PRIORITY_<wbr>LOW_<wbr>KHR</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>If <code>CL_QUEUE_<wbr>PRIORITY_<wbr>KHR</code> is not specified then the default priority is
<code>CL_QUEUE_<wbr>PRIORITY_<wbr>MED_<wbr>KHR</code>.</p>
</div>
<div class="paragraph">
<p>To the error section for <strong>clCreateCommandQueueWithProperties</strong>, the
following is added:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>CL_INVALID_<wbr>QUEUE_<wbr>PROPERTIES</code> if the <code>CL_QUEUE_<wbr>PRIORITY_<wbr>KHR</code> property is
specified and the queue is a <code>CL_QUEUE_<wbr>ON_<wbr>DEVICE</code>.</p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="cl_khr_throttle_hints"><a class="anchor" href="#cl_khr_throttle_hints"></a>32. Throttle Hints</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This section describes the <strong>cl_khr_throttle_hints</strong> extension.
This extension adds throttle hints for OpenCL, but does not specify the
throttling behavior or minimum guarantees.
It is expected that the user guide associated with each implementation which
supports this extension will describe the throttling behavior guarantees.</p>
</div>
<div class="paragraph">
<p>Note that the throttle hint is orthogonal to functionality defined in
<strong>cl_khr_priority_hints</strong> extension.
For example, a task may have high priority (<code>CL_QUEUE_<wbr>PRIORITY_<wbr>HIGH_<wbr>KHR</code>)
but should at the same time be executed at an optimized throttle setting
(<code>CL_QUEUE_<wbr>THROTTLE_<wbr>LOW_<wbr>KHR</code>).</p>
</div>
<div class="sect2">
<h3 id="_general_information_31"><a class="anchor" href="#_general_information_31"></a>32.1. General information</h3>
<div class="sect3">
<h4 id="_version_history_31"><a class="anchor" href="#_version_history_31"></a>32.1.1. Version history</h4>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 60%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><strong>Date</strong></th>
<th class="tableblock halign-left valign-top"><strong>Version</strong></th>
<th class="tableblock halign-left valign-top"><strong>Description</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">2020-04-21</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.0.0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">First assigned version.</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect2">
<h3 id="cl_khr_throttle_hints-host-side-api-modifications"><a class="anchor" href="#cl_khr_throttle_hints-host-side-api-modifications"></a>32.2. Host-side API modifications</h3>
<div class="paragraph">
<p>The function <strong>clCreateCommandQueueWithProperties</strong> (Section 5.1) is
extended to support a new <code>CL_QUEUE_<wbr>THROTTLE_<wbr>KHR</code> value as part of the
<em>properties</em> argument.</p>
</div>
<div class="paragraph">
<p>The properties field accepts the following values:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>CL_QUEUE_<wbr>THROTTLE_<wbr>HIGH_<wbr>KHR</code> (full throttle, i.e., OK to consume more
energy)</p>
</li>
<li>
<p><code>CL_QUEUE_<wbr>THROTTLE_<wbr>MED_<wbr>KHR</code> (normal throttle)</p>
</li>
<li>
<p><code>CL_QUEUE_<wbr>THROTTLE_<wbr>LOW_<wbr>KHR</code> (optimized/lowest energy consumption)</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>If <code>CL_QUEUE_<wbr>THROTTLE_<wbr>KHR</code> is not specified then the default priority is
<code>CL_QUEUE_<wbr>THROTTLE_<wbr>MED_<wbr>KHR</code>.</p>
</div>
<div class="paragraph">
<p>To the error section for <strong>clCreateCommandQueueWithProperties</strong>, the
following is added:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>CL_INVALID_<wbr>QUEUE_<wbr>PROPERTIES</code> if the <code>CL_QUEUE_<wbr>THROTTLE_<wbr>KHR</code> property is
specified and the queue is a <code>CL_QUEUE_<wbr>ON_<wbr>DEVICE</code>.</p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="cl_khr_subgroup_named_barrier"><a class="anchor" href="#cl_khr_subgroup_named_barrier"></a>33. Named Barriers for Subgroups</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This section describes the <strong>cl_khr_subgroup_named_barrier</strong> extension.
This extension adds barrier operations that cover subsets of an OpenCL
work-group.
Only the OpenCL API changes are described in this section.
Please refer to the SPIR-V specification for information about using
subgroups named barriers in the SPIR-V intermediate representation, and to
the OpenCL C++ specification for descriptions of the subgroup named
barrier built-in functions in the OpenCL C++ kernel language.</p>
</div>
<div class="sect2">
<h3 id="_general_information_32"><a class="anchor" href="#_general_information_32"></a>33.1. General information</h3>
<div class="sect3">
<h4 id="_version_history_32"><a class="anchor" href="#_version_history_32"></a>33.1.1. Version history</h4>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 60%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><strong>Date</strong></th>
<th class="tableblock halign-left valign-top"><strong>Version</strong></th>
<th class="tableblock halign-left valign-top"><strong>Description</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">2020-04-21</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.0.0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">First assigned version.</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_changes_to_opencl_specification"><a class="anchor" href="#_changes_to_opencl_specification"></a>33.2. Changes to OpenCL specification</h3>
<div class="paragraph">
<p>Add to <em>table 4.3</em>:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 52. List of supported param_names by <strong>clGetDeviceInfo</strong></caption>
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 16.6666%;">
<col style="width: 50.0001%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Device Info</th>
<th class="tableblock halign-left valign-top">Return Type</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CL_DEVICE_<wbr>MAX_<wbr>NAMED_<wbr>BARRIER_<wbr>COUNT_<wbr>KHR</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>cl_uint</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Maximum number of named barriers in a work-group for any given
  kernel-instance running on the device.
  The minimum value is 8.</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="cl_khr_extended_async_copies"><a class="anchor" href="#cl_khr_extended_async_copies"></a>34. Extended Async Copies</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This section describes the <strong>cl_khr_extended_async_copies</strong> extension.
This extension augments built-in asynchronous copy functions to OpenCL C
to support more patterns:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>for async copy between 2D source and 2D destination.</p>
</li>
<li>
<p>for async copy between 3D source and 3D destination.</p>
</li>
</ol>
</div>
<div class="sect2">
<h3 id="_general_information_33"><a class="anchor" href="#_general_information_33"></a>34.1. General information</h3>
<div class="sect3">
<h4 id="_version_history_33"><a class="anchor" href="#_version_history_33"></a>34.1.1. Version history</h4>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 60%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><strong>Date</strong></th>
<th class="tableblock halign-left valign-top"><strong>Version</strong></th>
<th class="tableblock halign-left valign-top"><strong>Description</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">2020-04-21</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.9.0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">First assigned version (provisional).</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">2021-09-06</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.9.1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Elements-based proposal update.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">2021-11-10</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.0.0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">First non-provisional version.</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect2">
<h3 id="cl_khr_extended_async_copies-additions-to-chapter-6-of-the-opencl-specification"><a class="anchor" href="#cl_khr_extended_async_copies-additions-to-chapter-6-of-the-opencl-specification"></a>34.2. Additions to Chapter 6 of the OpenCL C Specification</h3>
<div class="paragraph">
<p>The following new built-in functions are added to the <em>Async Copies from Global to
Local Memory, Local to Global Memory, and Prefetch</em> functions described in <em>section 6.12.10</em>
and <em>section 6.13.10</em> of the OpenCL 1.2 and OpenCL 2.0 C specifications.</p>
</div>
<div class="paragraph">
<p>Note that <strong>async_work_group_strided_copy</strong> is a special case of
<strong>async_work_group_copy_2D2D</strong>, namely one which copies a single column to a
single line or vice versa.
For example:<br>
<code>async_work_group_strided_copy(dst, src, num_gentypes, src_stride, event)</code> is equal to
<code>async_work_group_copy_2D2D(dst, 0, src, 0, sizeof(gentype), 1, num_gentypes, src_stride, 1, event)</code></p>
</div>
<div class="paragraph">
<p>The async copy built-in functions described in this section support arbitrary
<code>gentype</code>-based buffers by casting pointers to <code>void*</code>.</p>
</div>
<div class="paragraph">
<p>These async copy built-in functions do not perform any implicit synchronization
of source data such as using a <strong>barrier</strong> before performing the copy.</p>
</div>
<div class="paragraph">
<p>These async copy built-in functions are performed by all work-items in a
work-group and must therefore be encountered by all work-items in a work-group
executing the kernel with the same argument values; otherwise the results are
undefined.</p>
</div>
<div class="paragraph">
<p>The <em>src_offset</em>, <em>dst_offset</em>, <em>src_total_line_length</em>,
<em>dst_total_line_length</em>, <em>src_total_plane_area</em> and <em>dst_total_plane_area</em>
function arguments are expressed in elements.</p>
</div>
<div class="paragraph">
<p>Both <em>src_total_line_length</em> and <em>dst_total_line_length</em> describe the number of
elements between the beginning of the current line and the beginning of the next
line.</p>
</div>
<div class="paragraph">
<p>Both <em>src_total_plane_area</em> and <em>dst_total_plane_area</em> describe the number of
elements between the beginning of the current plane and the beginning of the
next plane.</p>
</div>
<div class="paragraph">
<p>These async copy built-in functions return an event object that can be used by
<strong>wait_group_events</strong> to wait for the async copy to finish.  The <em>event</em> argument
can also be used to associate the async copy with a previous async copy allowing
an event to be shared by multiple async copies; otherwise <em>event</em> should be
zero.  If the <em>event</em> argument is non-zero, the event object supplied as the
<em>event</em> argument will be returned.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><strong>Function</strong></th>
<th class="tableblock halign-left valign-top"><strong>Description</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="opencl_c"><span class="kt">event_t</span> <span class="fm">async_work_group_copy_2D2D</span><span class="p">(</span>
    <span class="nx">__local</span> <span class="kt">void</span> <span class="o">*</span><span class="n">dst</span><span class="p">,</span>
    <span class="kt">size_t</span> <span class="n">dst_offset</span><span class="p">,</span>
    <span class="k">const</span> <span class="nx">__global</span> <span class="kt">void</span> <span class="o">*</span><span class="n">src</span><span class="p">,</span>
    <span class="kt">size_t</span> <span class="n">src_offset</span><span class="p">,</span>
    <span class="kt">size_t</span> <span class="n">num_bytes_per_element</span><span class="p">,</span>
    <span class="kt">size_t</span> <span class="n">num_elements_per_line</span><span class="p">,</span>
    <span class="kt">size_t</span> <span class="n">num_lines</span><span class="p">,</span>
    <span class="kt">size_t</span> <span class="n">src_total_line_length</span><span class="p">,</span>
    <span class="kt">size_t</span> <span class="n">dst_total_line_length</span><span class="p">,</span>
    <span class="kt">event_t</span> <span class="n">event</span><span class="p">)</span>

<span class="kt">event_t</span> <span class="fm">async_work_group_copy_2D2D</span><span class="p">(</span>
    <span class="nx">__global</span> <span class="kt">void</span> <span class="o">*</span><span class="n">dst</span><span class="p">,</span>
    <span class="kt">size_t</span> <span class="n">dst_offset</span><span class="p">,</span>
    <span class="k">const</span> <span class="nx">__local</span> <span class="kt">void</span> <span class="o">*</span><span class="n">src</span><span class="p">,</span>
    <span class="kt">size_t</span> <span class="n">src_offset</span><span class="p">,</span>
    <span class="kt">size_t</span> <span class="n">num_bytes_per_element</span><span class="p">,</span>
    <span class="kt">size_t</span> <span class="n">num_elements_per_line</span><span class="p">,</span>
    <span class="kt">size_t</span> <span class="n">num_lines</span><span class="p">,</span>
    <span class="kt">size_t</span> <span class="n">src_total_line_length</span><span class="p">,</span>
    <span class="kt">size_t</span> <span class="n">dst_total_line_length</span><span class="p">,</span>
    <span class="kt">event_t</span> <span class="n">event</span><span class="p">)</span></code></pre>
</div>
</div></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Perform an async copy of (<em>num_elements_per_line</em> * <em>num_lines</em>) elements
of size <em>num_bytes_per_element</em> from
(<em>src</em> + (<em>src_offset</em> * <em>num_bytes_per_element</em>)) to
(<em>dst</em> + (<em>dst_offset</em> * <em>num_bytes_per_element</em>)). All pointer arithmetic
is performed with implicit casting to <code>char*</code> by the implementation.
Each line contains <em>num_elements_per_line</em> elements of size
<em>num_bytes_per_element</em>.
After each line of transfer, the <em>src</em> address is incremented by
<em>src_total_line_length</em> elements
(i.e. <em>src_total_line_length</em> * <em>num_bytes_per_element</em> bytes),
and the <em>dst</em> address is incremented by <em>dst_total_line_length</em> elements
(i.e. <em>dst_total_line_length</em> * <em>num_bytes_per_element</em> bytes),
for the next line of transfer.</p>
<p class="tableblock">The behavior of <strong>async_work_group_copy_2D2D</strong> is undefined if the
source or destination addresses exceed the upper bounds of the address space
during the copy.</p>
<p class="tableblock">The behavior of <strong>async_work_group_copy_2D2D</strong> is also undefined if the
<em>src_total_line_length</em> or <em>dst_total_line_length</em> values are smaller
than <em>num_elements_per_line</em>, i.e. overlapping of lines is undefined.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="opencl_c"><span class="kt">event_t</span> <span class="fm">async_work_group_copy_3D3D</span><span class="p">(</span>
    <span class="nx">__local</span> <span class="kt">void</span> <span class="o">*</span><span class="n">dst</span><span class="p">,</span>
    <span class="kt">size_t</span> <span class="n">dst_offset</span><span class="p">,</span>
    <span class="k">const</span> <span class="nx">__global</span> <span class="kt">void</span> <span class="o">*</span><span class="n">src</span><span class="p">,</span>
    <span class="kt">size_t</span> <span class="n">src_offset</span><span class="p">,</span>
    <span class="kt">size_t</span> <span class="n">num_bytes_per_element</span><span class="p">,</span>
    <span class="kt">size_t</span> <span class="n">num_elements_per_line</span><span class="p">,</span>
    <span class="kt">size_t</span> <span class="n">num_lines</span><span class="p">,</span>
    <span class="kt">size_t</span> <span class="n">num_planes</span><span class="p">,</span>
    <span class="kt">size_t</span> <span class="n">src_total_line_length</span><span class="p">,</span>
    <span class="kt">size_t</span> <span class="n">src_total_plane_area</span><span class="p">,</span>
    <span class="kt">size_t</span> <span class="n">dst_total_line_length</span><span class="p">,</span>
    <span class="kt">size_t</span> <span class="n">dst_total_plane_area</span><span class="p">,</span>
    <span class="kt">event_t</span> <span class="n">event</span><span class="p">)</span>

<span class="kt">event_t</span> <span class="fm">async_work_group_copy_3D3D</span><span class="p">(</span>
    <span class="nx">__global</span> <span class="kt">void</span> <span class="o">*</span><span class="n">dst</span><span class="p">,</span>
    <span class="kt">size_t</span> <span class="n">dst_offset</span><span class="p">,</span>
    <span class="k">const</span> <span class="nx">__local</span> <span class="kt">void</span> <span class="o">*</span><span class="n">src</span><span class="p">,</span>
    <span class="kt">size_t</span> <span class="n">src_offset</span><span class="p">,</span>
    <span class="kt">size_t</span> <span class="n">num_bytes_per_element</span><span class="p">,</span>
    <span class="kt">size_t</span> <span class="n">num_elements_per_line</span><span class="p">,</span>
    <span class="kt">size_t</span> <span class="n">num_lines</span><span class="p">,</span>
    <span class="kt">size_t</span> <span class="n">num_planes</span><span class="p">,</span>
    <span class="kt">size_t</span> <span class="n">src_total_line_length</span><span class="p">,</span>
    <span class="kt">size_t</span> <span class="n">src_total_plane_area</span><span class="p">,</span>
    <span class="kt">size_t</span> <span class="n">dst_total_line_length</span><span class="p">,</span>
    <span class="kt">size_t</span> <span class="n">dst_total_plane_area</span><span class="p">,</span>
    <span class="kt">event_t</span> <span class="n">event</span><span class="p">)</span></code></pre>
</div>
</div></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Perform an async copy of ((<em>num_elements_per_line</em> * <em>num_lines</em>) * <em>num_planes</em>) elements
of size <em>num_bytes_per_element</em> from
(<em>src</em> + (<em>src_offset</em> * <em>num_bytes_per_element</em>)) to
(<em>dst</em> + (<em>dst_offset</em> * <em>num_bytes_per_element</em>)),
arranged in <em>num_planes</em> planes. All pointer arithmetic
is performed with implicit casting to <code>char*</code> by the implementation.
Each plane contains <em>num_lines</em> lines.
Each line contains <em>num_elements_per_line</em> elements.
After each line of transfer, the <em>src</em> address is incremented by
<em>src_total_line_length</em> elements
(i.e. <em>src_total_line_length</em> * <em>num_bytes_per_element</em> bytes),
and the <em>dst</em> address is incremented by <em>dst_total_line_length</em> elements
(i.e. <em>dst_total_line_length</em> * <em>num_bytes_per_element</em> bytes),
for the next line of transfer.</p>
<p class="tableblock">The behavior of <strong>async_work_group_copy_3D3D</strong> is undefined if the
source or destination addresses exceed the upper bounds of the address space
during the copy.</p>
<p class="tableblock">The behavior of <strong>async_work_group_copy_3D3D</strong> is also undefined if the
<em>src_total_line_length</em> or <em>dst_total_line_length</em> values are smaller
than <em>num_elements_per_line</em>, i.e. overlapping of lines is undefined.</p>
<p class="tableblock">The behavior of <strong>async_work_group_copy_3D3D</strong> is also undefined if
<em>src_total_plane_area</em> is smaller than (<em>num_lines</em> * <em>src_total_line_length</em>),
or <em>dst_total_plane_area</em> is smaller than (<em>num_lines</em> * <em>dst_total_line_length</em>),
i.e. overlapping of planes is undefined.</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="cl_khr_async_work_group_copy_fence"><a class="anchor" href="#cl_khr_async_work_group_copy_fence"></a>35. Async Work Group Copy Fence</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This section describes the <strong>cl_khr_async_work_group_copy_fence</strong> extension.
The extension adds a new built-in function to OpenCL C to establish a memory synchronization ordering of asynchronous copies.</p>
</div>
<div class="sect2">
<h3 id="_general_information_34"><a class="anchor" href="#_general_information_34"></a>35.1. General information</h3>
<div class="sect3">
<h4 id="_version_history_34"><a class="anchor" href="#_version_history_34"></a>35.1.1. Version history</h4>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 60%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><strong>Date</strong></th>
<th class="tableblock halign-left valign-top"><strong>Version</strong></th>
<th class="tableblock halign-left valign-top"><strong>Description</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">2020-04-21</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.9.0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">First assigned version (provisional).</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">2021-11-10</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.0.0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">First non-provisional version.</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect2">
<h3 id="cl_khr_async_work_group_copy_fence-additions-to-chapter-6-of-the-opencl-specification"><a class="anchor" href="#cl_khr_async_work_group_copy_fence-additions-to-chapter-6-of-the-opencl-specification"></a>35.2. Additions to Chapter 6 of the OpenCL C Specification</h3>
<div class="paragraph">
<p>The following new built-in function is added to the <em>Async Copies from Global to
Local Memory, Local to Global Memory, and Prefetch</em> functions described in <em>section 6.12.10</em>
and <em>section 6.13.10</em> of the OpenCL 1.2 and OpenCL 2.0 C specifications:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><strong>Function</strong></th>
<th class="tableblock halign-left valign-top"><strong>Description</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="opencl_c"><span class="kt">void</span> <span class="fm">async_work_group_copy_fence</span><span class="p">(</span>
    <span class="kt">cl_mem_fence_flags</span> <span class="n">flags</span><span class="p">)</span></code></pre>
</div>
</div></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Orders async copies produced by the work-items of a work-group executing
a kernel. Async copies preceding the <strong>async_work_group_copy_fence</strong> must
complete their access to the designated memory or memories,
including both reads-from and writes-to it, before async copies
following the fence are allowed to start accessing these memories.
In other words, every async copy preceding the <strong>async_work_group_copy_fence</strong>
must happen-before every async copy following the fence, with respect to
the designated memory or memories.</p>
<p class="tableblock">The <em>flags</em> argument specifies the memory address space and can be set to a
combination of the following literal values:</p>
<p class="tableblock"><code>CLK_LOCAL_MEM_FENCE</code><br>
<code>CLK_GLOBAL_MEM_FENCE</code></p>
<p class="tableblock">The async fence is performed by all work-items in a work-group and this
built-in function must therefore be encountered by all work-items in a
work-group executing the kernel with the same argument values;
otherwise the results are undefined. This rule applies to ND-ranges
implemented with uniform and non-uniform work-groups.</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="cl_khr_device_uuid"><a class="anchor" href="#cl_khr_device_uuid"></a>36. Unique Device Identifiers</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This section describes the <strong>cl_khr_device_uuid</strong> extension.</p>
</div>
<div class="paragraph">
<p>This extension adds the ability to query a universally unique identifier
(UUID) for an OpenCL driver and OpenCL device.
The UUIDs returned by the query may be used to identify drivers and devices
across processes or APIs.</p>
</div>
<div class="sect2">
<h3 id="_general_information_35"><a class="anchor" href="#_general_information_35"></a>36.1. General information</h3>
<div class="sect3">
<h4 id="_version_history_35"><a class="anchor" href="#_version_history_35"></a>36.1.1. Version history</h4>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 60%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><strong>Date</strong></th>
<th class="tableblock halign-left valign-top"><strong>Version</strong></th>
<th class="tableblock halign-left valign-top"><strong>Description</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">2020-08-27</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.0.0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">First assigned version.</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_additions_to_chapter_4_of_the_opencl_3_0_api_specification"><a class="anchor" href="#_additions_to_chapter_4_of_the_opencl_3_0_api_specification"></a>36.2. Additions to Chapter 4 of the OpenCL 3.0 API Specification</h3>
<div class="paragraph">
<p>Add to Table 5 - OpenCL Device Queries:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 5. List of supported param_names by <strong>clGetDeviceInfo</strong></caption>
<colgroup>
<col style="width: 33%;">
<col style="width: 17%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Device Info</th>
<th class="tableblock halign-left valign-top">Return Type</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CL_DEVICE_<wbr>UUID_<wbr>KHR</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>cl_uchar</code>[<code>CL_UUID_<wbr>SIZE_<wbr>KHR</code>]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Returns a universally unique identifier (UUID) for the device.</p>
<p class="tableblock">      Device UUIDs must be immutable for a given device across processes, driver APIs, driver versions, and system reboots.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CL_DRIVER_<wbr>UUID_<wbr>KHR</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>cl_uchar</code>[<code>CL_UUID_<wbr>SIZE_<wbr>KHR</code>]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Returns a universally unique identifier (UUID) for the software driver for the device.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CL_DEVICE_<wbr>LUID_<wbr>VALID_<wbr>KHR</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>cl_bool</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Returns <code>CL_TRUE</code> if the device has a valid LUID and <code>CL_FALSE</code> otherwise.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CL_DEVICE_<wbr>LUID_<wbr>KHR</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>cl_uchar</code>[<code>CL_LUID_<wbr>SIZE_<wbr>KHR</code>]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Returns a locally unique identifier (LUID) for the device.</p>
<p class="tableblock">      It is not an error to query <code>CL_DEVICE_<wbr>LUID_<wbr>KHR</code> when <code>CL_DEVICE_<wbr>LUID_<wbr>VALID_<wbr>KHR</code> returns <code>CL_FALSE</code>, but in this case the returned LUID value is undefined.</p>
<p class="tableblock">      When <code>CL_DEVICE_<wbr>LUID_<wbr>VALID_<wbr>KHR</code> returns <code>CL_TRUE</code>, and the OpenCL device is running on the Windows operating system, the returned LUID value can be cast to an <code>LUID</code> object and must be equal to the locally unique identifier of an <code>IDXGIAdapter1</code> object that corresponds to the OpenCL device.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CL_DEVICE_<wbr>NODE_<wbr>MASK_<wbr>KHR</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>cl_uint</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Returns a node mask for the device.</p>
<p class="tableblock">      It is not an error to query <code>CL_DEVICE_<wbr>NODE_<wbr>MASK_<wbr>KHR</code> when <code>CL_DEVICE_<wbr>LUID_<wbr>VALID_<wbr>KHR</code> returns <code>CL_FALSE</code>, but in this case the returned node mask is undefined.</p>
<p class="tableblock">      When <code>CL_DEVICE_<wbr>LUID_<wbr>VALID_<wbr>KHR</code> returns <code>CL_TRUE</code>, the returned node mask must contain exactly one bit.
      If the OpenCL device is running on an operating system that supports the Direct3D 12 API and the OpenCL device corresponds to an individual device in a linked device adapter, the returned node mask identifies the Direct3D 12 node corresponding to the OpenCL device.
      Otherwise, the returned node mask must be <code>1</code>.</p></td>
</tr>
</tbody>
</table>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
While <code>CL_DEVICE_<wbr>UUID_<wbr>KHR</code> is specified to remain consistent across driver versions and system reboots, it is not intended to be usable as a serializable persistent identifier for a device.
It may change when a device is physically added to, removed from, or moved to a different connector in a system while that system is powered down.
Further, there is no reasonable way to verify with conformance testing that a given device retains the same UUID in a given system across all driver versions supported in that system.
While implementations should make every effort to report consistent device UUIDs across driver versions, applications should avoid relying on the persistence of this value for uses other than identifying compatible devices for external object sharing purposes.
</td>
</tr>
</table>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="cl_khr_extended_versioning"><a class="anchor" href="#cl_khr_extended_versioning"></a>37. Extended versioning</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This extension introduces new platform and device queries that return detailed
version information to applications. It makes it possible to return the exact
revision of the specification or intermediate languages supported by an
implementation. It also enables implementations to communicate a version
number for each of the extensions they support and remove the requirement
for applications to process strings to test for the presence of an extension or
intermediate language or built-in kernel.</p>
</div>
<div class="paragraph">
<p>Extended versioning was promoted to a core feature in OpenCL 3.0, however note
that the query for <code>CL_DEVICE_<wbr>OPENCL_<wbr>C_<wbr>NUMERIC_<wbr>VERSION_<wbr>KHR</code> was replaced by the
query for <code>CL_DEVICE_<wbr>OPENCL_<wbr>C_<wbr>ALL_<wbr>VERSIONS</code>.</p>
</div>
<div class="sect2">
<h3 id="_general_information_36"><a class="anchor" href="#_general_information_36"></a>37.1. General information</h3>
<div class="sect3">
<h4 id="_name_strings"><a class="anchor" href="#_name_strings"></a>37.1.1. Name Strings</h4>
<div class="paragraph">
<p><code>cl_khr_extended_versioning</code></p>
</div>
</div>
<div class="sect3">
<h4 id="_contributors"><a class="anchor" href="#_contributors"></a>37.1.2. Contributors</h4>
<div class="paragraph">
<p>Kvin Petit, Arm Ltd.<br>
Ben Ashbaugh, Intel<br>
Alastair Murray, Codeplay Software Ltd.<br>
Einar Hov, Arm Ltd.</p>
</div>
</div>
<div class="sect3">
<h4 id="_version_history_36"><a class="anchor" href="#_version_history_36"></a>37.1.3. Version history</h4>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 60%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><strong>Date</strong></th>
<th class="tableblock halign-left valign-top"><strong>Version</strong></th>
<th class="tableblock halign-left valign-top"><strong>Description</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">2020-02-12</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.0.0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Initial version.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="_dependencies"><a class="anchor" href="#_dependencies"></a>37.1.4. Dependencies</h4>
<div class="paragraph">
<p>This extension is written against the OpenCL Specification
Version 2.2, Revision 11.</p>
</div>
<div class="paragraph">
<p>This extension requires OpenCL 1.0.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_new_api_types_2"><a class="anchor" href="#_new_api_types_2"></a>37.2. New API Types</h3>
<div class="sect3">
<h4 id="_version"><a class="anchor" href="#_version"></a>37.2.1. Version</h4>
<div class="paragraph">
<p>This extension introduces a new scheme to encode detailed
(major, minor, patch/revision) version information into a single 32-bit unsigned
integer:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The major version is using bits 31-22</p>
</li>
<li>
<p>The minor version is using bits 21-12</p>
</li>
<li>
<p>The patch version is using bits 11-0</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>This scheme enables two versions to be ordered using the standard C/C++ operators.
Macros are provided to extract individual fields or compose a full version
from the individual fields.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="opencl"><span class="k">typedef</span> <span class="kt">cl_uint</span> <span class="kt">cl_version_khr</span><span class="p">;</span>

<span class="cp">#define CL_VERSION_MAJOR_BITS_KHR (10)
#define CL_VERSION_MINOR_BITS_KHR (10)
#define CL_VERSION_PATCH_BITS_KHR (12)
</span>
<span class="cp">#define CL_VERSION_MAJOR_MASK_KHR ((1 &lt;&lt; CL_VERSION_MAJOR_BITS_KHR) - 1)
#define CL_VERSION_MINOR_MASK_KHR ((1 &lt;&lt; CL_VERSION_MINOR_BITS_KHR) - 1)
#define CL_VERSION_PATCH_MASK_KHR ((1 &lt;&lt; CL_VERSION_PATCH_BITS_KHR) - 1)
</span>
<span class="cp">#define CL_VERSION_MAJOR_KHR(version) \
        ((version) &gt;&gt; (CL_VERSION_MINOR_BITS_KHR + CL_VERSION_PATCH_BITS_KHR))
#define CL_VERSION_MINOR_KHR(version) \
        (((version) &gt;&gt; CL_VERSION_PATCH_BITS_KHR) &amp; CL_VERSION_MINOR_MASK_KHR)
#define CL_VERSION_PATCH_KHR(version) ((version) &amp; CL_VERSION_PATCH_MASK_KHR)
</span>
<span class="cp">#define CL_MAKE_VERSION_KHR(major, minor, patch) \
    ((((major) &amp; CL_VERSION_MAJOR_MASK_KHR) &lt;&lt; (CL_VERSION_MINOR_BITS_KHR + CL_VERSION_PATCH_BITS_KHR)) | \
     (((minor) &amp; CL_VERSION_MINOR_MASK_KHR) &lt;&lt; CL_VERSION_PATCH_BITS_KHR) | \
     ((patch) &amp; CL_VERSION_PATCH_MASK_KHR))</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_name_and_version"><a class="anchor" href="#_name_and_version"></a>37.2.2. Name and version</h4>
<div class="paragraph">
<p>This extension adds a structure that can be used to describe a combination of a
name alongside a version number:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="opencl"><span class="cp">#define CL_NAME_VERSION_MAX_NAME_SIZE_KHR 64
</span>
<span class="k">typedef</span> <span class="k">struct</span> <span class="nc">_cl_name_version_khr</span> <span class="p">{</span>
    <span class="kt">cl_version_khr</span> <span class="n">version</span><span class="p">;</span>
    <span class="kt">char</span> <span class="n">name</span><span class="p">[</span><span class="n">CL_NAME_VERSION_MAX_NAME_SIZE_KHR</span><span class="p">];</span>
<span class="p">}</span> <span class="kt">cl_name_version_khr</span><span class="p">;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>name</code> field is an array of <code>CL_NAME_<wbr>VERSION_<wbr>MAX_<wbr>NAME_<wbr>SIZE_<wbr>KHR</code> bytes used as
storage for a NUL-terminated string whose maximum length is therefore
<code>CL_NAME_<wbr>VERSION_<wbr>MAX_<wbr>NAME_<wbr>SIZE_<wbr>KHR</code> <code>- 1</code>.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_new_api_enums"><a class="anchor" href="#_new_api_enums"></a>37.3. New API Enums</h3>
<div class="paragraph">
<p>Accepted value for the <em>param_name</em> parameter to <strong>clGetPlatformInfo</strong>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="opencl"><span class="n">CL_PLATFORM_NUMERIC_VERSION_KHR</span>
<span class="n">CL_PLATFORM_EXTENSIONS_WITH_VERSION_KHR</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Accepted value for the <em>param_name</em> parameter to <strong>clGetDeviceInfo</strong>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="opencl"><span class="n">CL_DEVICE_NUMERIC_VERSION_KHR</span>
<span class="n">CL_DEVICE_OPENCL_C_NUMERIC_VERSION_KHR</span>
<span class="n">CL_DEVICE_EXTENSIONS_WITH_VERSION_KHR</span>
<span class="n">CL_DEVICE_ILS_WITH_VERSION_KHR</span>
<span class="n">CL_DEVICE_BUILT_IN_KERNELS_WITH_VERSION_KHR</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_modifications_to_the_opencl_api_specification"><a class="anchor" href="#_modifications_to_the_opencl_api_specification"></a>37.4. Modifications to the OpenCL API Specification</h3>
<div class="dlist">
<dl>
<dt class="hdlist1">(Modify Section 4.1, <strong>Querying Platform Info</strong>) </dt>
<dd>
<div class="openblock">
<div class="content">
<div class="dlist">
<dl>
<dt class="hdlist1">(Add the following to Table 3, <em>List of supported param_names by <strong>clGetPlatformInfo</strong></em>) </dt>
</dl>
</div>
</div>
</div>
</dd>
</dl>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 37.5%;">
<col style="width: 25%;">
<col style="width: 37.5%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Platform Info</th>
<th class="tableblock halign-left valign-top">Return Type</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CL_PLATFORM_<wbr>NUMERIC_<wbr>VERSION_<wbr>KHR</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>cl_version_<wbr>khr</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Returns detailed (major, minor, patch) numeric version information. The major
  and minor version numbers returned must match those returned via
  <code>CL_PLATFORM_<wbr>VERSION</code>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CL_PLATFORM_<wbr>EXTENSIONS_<wbr>WITH_<wbr>VERSION_<wbr>KHR</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>cl_name_<wbr>version_<wbr>khr</code>[]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Returns an array of description (name and version) structures. The same
  extension name must not be reported more than once. The list of extensions
  reported must match the list reported via <code>CL_PLATFORM_<wbr>EXTENSIONS</code>.</p></td>
</tr>
</tbody>
</table>
<div class="dlist">
<dl>
<dt class="hdlist1">(Modify Section 4.2, <strong>Querying Devices</strong>) </dt>
<dd>
<div class="openblock">
<div class="content">
<div class="dlist">
<dl>
<dt class="hdlist1">(Add the following to Table 5, <em>List of supported param_names by <strong>clGetDeviceInfo</strong></em>) </dt>
</dl>
</div>
</div>
</div>
</dd>
</dl>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 37.5%;">
<col style="width: 25%;">
<col style="width: 37.5%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Device Info</th>
<th class="tableblock halign-left valign-top">Return Type</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CL_DEVICE_<wbr>NUMERIC_<wbr>VERSION_<wbr>KHR</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>cl_version_<wbr>khr</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Returns detailed (major, minor, patch) numeric version information. The major
  and minor version numbers returned must match those returned via
  <code>CL_DEVICE_<wbr>VERSION</code>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CL_DEVICE_<wbr>OPENCL_<wbr>C_<wbr>NUMERIC_<wbr>VERSION_<wbr>KHR</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>cl_version_<wbr>khr</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Returns detailed (major, minor, patch) numeric version information. The major
  and minor version numbers returned must match those returned via
  <code>CL_DEVICE_<wbr>OPENCL_<wbr>C_<wbr>VERSION</code>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CL_DEVICE_<wbr>EXTENSIONS_<wbr>WITH_<wbr>VERSION_<wbr>KHR</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>cl_name_<wbr>version_<wbr>khr</code>[]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Returns an array of description (name and version) structures. The same
  extension name must not be reported more than once. The list of extensions
  reported must match the list reported via <code>CL_DEVICE_<wbr>EXTENSIONS</code>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CL_DEVICE_<wbr>ILS_<wbr>WITH_<wbr>VERSION_<wbr>KHR</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>cl_name_<wbr>version_<wbr>khr</code>[]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Returns an array of descriptions (name and version) for all supported
  Intermediate Languages. Intermediate Languages with the same name may be
  reported more than once but each name and major/minor version combination
  may only be reported once. The list of intermediate languages reported must
  match the list reported via <code>CL_DEVICE_<wbr>IL_<wbr>VERSION</code>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CL_DEVICE_<wbr>BUILT_<wbr>IN_<wbr>KERNELS_<wbr>WITH_<wbr>VERSION_<wbr>KHR</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>cl_name_<wbr>version_<wbr>khr</code>[]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Returns an array of descriptions for the built-in kernels supported by the device.
  Each built-in kernel may only be reported once. The list of reported kernels must
  match the list returned via <code>CL_DEVICE_<wbr>BUILT_<wbr>IN_<wbr>KERNELS</code>.</p></td>
</tr>
</tbody>
</table>
<div class="openblock">
<div class="content">

</div>
</div>
</div>
<div class="sect2">
<h3 id="_conformance_tests"><a class="anchor" href="#_conformance_tests"></a>37.5. Conformance tests</h3>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Each of the new queries described in this extension must be attempted and
succeed.</p>
</li>
<li>
<p>It must be verified that the information returned by all queries that
extend existing queries is consistent with the information returned
by existing queries.</p>
</li>
<li>
<p>Some of the queries introduced by this extension impose uniqueness constraints
on the list of returned values. It must be verified that these constraints are
satisfied.</p>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="_issues"><a class="anchor" href="#_issues"></a>37.6. Issues</h3>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>What compatibility policy should we define? e.g. a <em>revision</em> has to be
backwards-compatible with previous ones</p>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p><strong>RESOLVED</strong>: No general rules as that wouldn&#8217;t be testable. Here&#8217;s a recommended policy:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Patch version bump: only clarifications and small/obvious bugfixes.</p>
</li>
<li>
<p>Minor version bump: backwards-compatible changes only.</p>
</li>
<li>
<p>Major version bump: backwards compatibility may break.</p>
</li>
</ul>
</div>
</div>
</div>
</li>
<li>
<p>Do we want versioning for built-in kernels as returned by <code>CL_DEVICE_<wbr>BUILT_<wbr>IN_<wbr>KERNELS</code>?</p>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p><strong>RESOLVED</strong>: No immediate use-case for versioning but being able to get a list of
  individual kernels without parsing a string is desirable. Adding
  <code>CL_DEVICE_<wbr>BUILT_<wbr>IN_<wbr>KERNELS_<wbr>WITH_<wbr>VERSION_<wbr>KHR</code>.</p>
</div>
</div>
</div>
</li>
<li>
<p>What is the behaviour of the queries that return an array of structures when
there are no elements to return?</p>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p><strong>RESOLVED</strong>: The query succeeds and the size returned is zero.</p>
</div>
</div>
</div>
</li>
<li>
<p>What value should be returned when version information is not available?</p>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p><strong>RESOLVED</strong>: If a patch version is not available, it should be reported as 0.
            If no version information is available, 0.0.0 should be reported.
            These values have been chosen as they are guaranteed to be lower
            than or equal to any other version.</p>
</div>
</div>
</div>
</li>
<li>
<p>Should we add a query to report SPIR-V extended instruction sets?</p>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p><strong>RESOLVED</strong>: It is unlikely that we will introduce many SPIR-V extended
            instruction sets without an accompanying API extension. Decided
            not to do this.</p>
</div>
</div>
</div>
</li>
<li>
<p>Should the queries for which the old-style query doesn&#8217;t exist in a given
OpenCL version be present (e.g. <code>CL_DEVICE_<wbr>BUILT_<wbr>IN_<wbr>KERNELS_<wbr>WITH_<wbr>VERSION_<wbr>KHR</code>
prior to OpenCL 2.1 or without support for <code>cl_khr_il_program</code> or
<code>CL_DEVICE_<wbr>OPENCL_<wbr>C_<wbr>NUMERIC_<wbr>VERSION_<wbr>KHR</code> on OpenCL 1.0)?</p>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p><strong>RESOLVED</strong>: All the queries are always present.
            <code>CL_DEVICE_<wbr>BUILT_<wbr>IN_<wbr>KERNELS_<wbr>WITH_<wbr>VERSION_<wbr>KHR</code> returns an empty set
            when Intermediate Languages are not supported.
            <code>CL_DEVICE_<wbr>OPENCL_<wbr>C_<wbr>NUMERIC_<wbr>VERSION_<wbr>KHR</code> always returns 1.0 on an
            OpenCL 1.0 platform.</p>
</div>
</div>
</div>
</li>
<li>
<p>Is reporting multiple Intermediate Languages with the same name and major/minor
versions but differing patch versions allowed?</p>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p><strong>RESOLVED</strong>: No. This isn&#8217;t aligned with the intended use for patch versions and
            makes it harder for implementations to guarantee consistency with
            the existing IL queries.</p>
</div>
</div>
</div>
</li>
</ol>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_extended_subgroup_functions"><a class="anchor" href="#_extended_subgroup_functions"></a>38. Extended Subgroup Functions</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="extended-subgroups"><a class="anchor" href="#extended-subgroups"></a>38.1. Overview</h3>
<div class="paragraph">
<p>This section describes a family of extensions that provide extended subgroup functionality.
The extensions in this family are:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>cl_khr_subgroup_extended_types</code></p>
</li>
<li>
<p><code>cl_khr_subgroup_non_uniform_vote</code></p>
</li>
<li>
<p><code>cl_khr_subgroup_ballot</code></p>
</li>
<li>
<p><code>cl_khr_subgroup_non_uniform_arithmetic</code></p>
</li>
<li>
<p><code>cl_khr_subgroup_shuffle</code></p>
</li>
<li>
<p><code>cl_khr_subgroup_shuffle_relative</code></p>
</li>
<li>
<p><code>cl_khr_subgroup_clustered_reduce</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The functionality added by these extensions includes:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Additional data type support for subgroup broadcast, scan, and reduction functions;</p>
</li>
<li>
<p>The ability to elect a single work item from a subgroup to perform a task;</p>
</li>
<li>
<p>The ability to hold votes among work items in a subgroup;</p>
</li>
<li>
<p>The ability to collect and operate on ballots from work items in the subgroup;</p>
</li>
<li>
<p>The ability to use some subgroup functions, such as any, all, broadcasts, scans, and reductions within non-uniform flow control;</p>
</li>
<li>
<p>Additional scan and reduction operators;</p>
</li>
<li>
<p>Additional ways to exchange data among work items in a subgroup;</p>
</li>
<li>
<p>Clustered reductions, that operate on a subset of work items in the subgroup.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>This section describes changes to the OpenCL C Language for these extensions.
There are no new API functions or enums added by these extensions.</p>
</div>
</div>
<div class="sect2">
<h3 id="_general_information_37"><a class="anchor" href="#_general_information_37"></a>38.2. General information</h3>
<div class="sect3">
<h4 id="_version_history_37"><a class="anchor" href="#_version_history_37"></a>38.2.1. Version history</h4>
<div class="paragraph">
<p>For all of the extensions described in this section:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 60%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><strong>Date</strong></th>
<th class="tableblock halign-left valign-top"><strong>Version</strong></th>
<th class="tableblock halign-left valign-top"><strong>Description</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">2020-12-15</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.0.0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">First assigned version.</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect2">
<h3 id="extended-subgroups-summary"><a class="anchor" href="#extended-subgroups-summary"></a>38.3. Summary of New OpenCL C Functions</h3>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="opencl_c"><span class="c1">// These functions are available to devices supporting</span>
<span class="c1">// cl_khr_subgroup_extended_types:</span>

<span class="c1">// Note: Existing functions supporting additional data types.</span>

<span class="kp">gentype</span> <span class="n">sub_group_broadcast</span><span class="p">(</span> <span class="kp">gentype</span> <span class="n">value</span><span class="p">,</span> <span class="kt">uint</span> <span class="n">index</span> <span class="p">)</span>

<span class="kp">gentype</span> <span class="n">sub_group_reduce_add</span><span class="p">(</span> <span class="kp">gentype</span> <span class="n">value</span> <span class="p">)</span>
<span class="kp">gentype</span> <span class="n">sub_group_reduce_min</span><span class="p">(</span> <span class="kp">gentype</span> <span class="n">value</span> <span class="p">)</span>
<span class="kp">gentype</span> <span class="n">sub_group_reduce_max</span><span class="p">(</span> <span class="kp">gentype</span> <span class="n">value</span> <span class="p">)</span>

<span class="kp">gentype</span> <span class="n">sub_group_scan_inclusive_add</span><span class="p">(</span> <span class="kp">gentype</span> <span class="n">value</span> <span class="p">)</span>
<span class="kp">gentype</span> <span class="n">sub_group_scan_inclusive_min</span><span class="p">(</span> <span class="kp">gentype</span> <span class="n">value</span> <span class="p">)</span>
<span class="kp">gentype</span> <span class="n">sub_group_scan_inclusive_max</span><span class="p">(</span> <span class="kp">gentype</span> <span class="n">value</span> <span class="p">)</span>

<span class="kp">gentype</span> <span class="n">sub_group_scan_exclusive_add</span><span class="p">(</span> <span class="kp">gentype</span> <span class="n">value</span> <span class="p">)</span>
<span class="kp">gentype</span> <span class="n">sub_group_scan_exclusive_min</span><span class="p">(</span> <span class="kp">gentype</span> <span class="n">value</span> <span class="p">)</span>
<span class="kp">gentype</span> <span class="n">sub_group_scan_exclusive_max</span><span class="p">(</span> <span class="kp">gentype</span> <span class="n">value</span> <span class="p">)</span>

<span class="c1">// These functions are available to devices supporting</span>
<span class="c1">// cl_khr_subgroup_non_uniform_vote:</span>

<span class="kt">int</span> <span class="n">sub_group_elect</span><span class="p">()</span>

<span class="kt">int</span> <span class="n">sub_group_non_uniform_all</span><span class="p">(</span> <span class="kt">int</span> <span class="n">predicate</span> <span class="p">)</span>
<span class="kt">int</span> <span class="n">sub_group_non_uniform_any</span><span class="p">(</span> <span class="kt">int</span> <span class="n">predicate</span> <span class="p">)</span>
<span class="kt">int</span> <span class="n">sub_group_non_uniform_all_equal</span><span class="p">(</span> <span class="kp">gentype</span> <span class="n">value</span> <span class="p">)</span>

<span class="c1">// These functions are available to devices supporting</span>
<span class="c1">// cl_khr_subgroup_ballot:</span>

<span class="kp">gentype</span> <span class="n">sub_group_non_uniform_broadcast</span><span class="p">(</span> <span class="kp">gentype</span> <span class="n">value</span><span class="p">,</span> <span class="kt">uint</span> <span class="n">index</span> <span class="p">)</span>
<span class="kp">gentype</span> <span class="n">sub_group_broadcast_first</span><span class="p">(</span> <span class="kp">gentype</span> <span class="n">value</span> <span class="p">)</span>

<span class="kt">uint4</span> <span class="n">sub_group_ballot</span><span class="p">(</span> <span class="kt">int</span> <span class="n">predicate</span> <span class="p">)</span>
<span class="kt">int</span>   <span class="n">sub_group_inverse_ballot</span><span class="p">(</span> <span class="kt">uint4</span> <span class="n">value</span> <span class="p">)</span>
<span class="kt">int</span>   <span class="n">sub_group_ballot_bit_extract</span><span class="p">(</span> <span class="kt">uint4</span> <span class="n">value</span><span class="p">,</span> <span class="kt">uint</span> <span class="n">index</span> <span class="p">)</span>
<span class="kt">uint</span>  <span class="n">sub_group_ballot_bit_count</span><span class="p">(</span> <span class="kt">uint4</span> <span class="n">value</span> <span class="p">)</span>
<span class="kt">uint</span>  <span class="n">sub_group_ballot_inclusive_scan</span><span class="p">(</span> <span class="kt">uint4</span> <span class="n">value</span> <span class="p">)</span>
<span class="kt">uint</span>  <span class="n">sub_group_ballot_exclusive_scan</span><span class="p">(</span> <span class="kt">uint4</span> <span class="n">value</span> <span class="p">)</span>
<span class="kt">uint</span>  <span class="n">sub_group_ballot_find_lsb</span><span class="p">(</span> <span class="kt">uint4</span> <span class="n">value</span> <span class="p">)</span>
<span class="kt">uint</span>  <span class="n">sub_group_ballot_find_msb</span><span class="p">(</span> <span class="kt">uint4</span> <span class="n">value</span> <span class="p">)</span>

<span class="kt">uint4</span> <span class="n">get_sub_group_eq_mask</span><span class="p">()</span>
<span class="kt">uint4</span> <span class="n">get_sub_group_ge_mask</span><span class="p">()</span>
<span class="kt">uint4</span> <span class="n">get_sub_group_gt_mask</span><span class="p">()</span>
<span class="kt">uint4</span> <span class="n">get_sub_group_le_mask</span><span class="p">()</span>
<span class="kt">uint4</span> <span class="n">get_sub_group_lt_mask</span><span class="p">()</span>

<span class="c1">// These functions are available to devices supporting</span>
<span class="c1">// cl_khr_subgroup_non_uniform_arithmetic:</span>

<span class="kp">gentype</span> <span class="n">sub_group_non_uniform_reduce_add</span><span class="p">(</span> <span class="kp">gentype</span> <span class="n">value</span> <span class="p">)</span>
<span class="kp">gentype</span> <span class="n">sub_group_non_uniform_reduce_mul</span><span class="p">(</span> <span class="kp">gentype</span> <span class="n">value</span> <span class="p">)</span>
<span class="kp">gentype</span> <span class="n">sub_group_non_uniform_reduce_min</span><span class="p">(</span> <span class="kp">gentype</span> <span class="n">value</span> <span class="p">)</span>
<span class="kp">gentype</span> <span class="n">sub_group_non_uniform_reduce_max</span><span class="p">(</span> <span class="kp">gentype</span> <span class="n">value</span> <span class="p">)</span>
<span class="kp">gentype</span> <span class="n">sub_group_non_uniform_reduce_and</span><span class="p">(</span> <span class="kp">gentype</span> <span class="n">value</span> <span class="p">)</span>
<span class="kp">gentype</span> <span class="n">sub_group_non_uniform_reduce_or</span><span class="p">(</span> <span class="kp">gentype</span> <span class="n">value</span> <span class="p">)</span>
<span class="kp">gentype</span> <span class="n">sub_group_non_uniform_reduce_xor</span><span class="p">(</span> <span class="kp">gentype</span> <span class="n">value</span> <span class="p">)</span>
<span class="kt">int</span>     <span class="n">sub_group_non_uniform_reduce_logical_and</span><span class="p">(</span> <span class="kt">int</span> <span class="n">predicate</span> <span class="p">)</span>
<span class="kt">int</span>     <span class="n">sub_group_non_uniform_reduce_logical_or</span><span class="p">(</span> <span class="kt">int</span> <span class="n">predicate</span> <span class="p">)</span>
<span class="kt">int</span>     <span class="n">sub_group_non_uniform_reduce_logical_xor</span><span class="p">(</span> <span class="kt">int</span> <span class="n">predicate</span> <span class="p">)</span>

<span class="kp">gentype</span> <span class="n">sub_group_non_uniform_scan_inclusive_add</span><span class="p">(</span> <span class="kp">gentype</span> <span class="n">value</span> <span class="p">)</span>
<span class="kp">gentype</span> <span class="n">sub_group_non_uniform_scan_inclusive_mul</span><span class="p">(</span> <span class="kp">gentype</span> <span class="n">value</span> <span class="p">)</span>
<span class="kp">gentype</span> <span class="n">sub_group_non_uniform_scan_inclusive_min</span><span class="p">(</span> <span class="kp">gentype</span> <span class="n">value</span> <span class="p">)</span>
<span class="kp">gentype</span> <span class="n">sub_group_non_uniform_scan_inclusive_max</span><span class="p">(</span> <span class="kp">gentype</span> <span class="n">value</span> <span class="p">)</span>
<span class="kp">gentype</span> <span class="n">sub_group_non_uniform_scan_inclusive_and</span><span class="p">(</span> <span class="kp">gentype</span> <span class="n">value</span> <span class="p">)</span>
<span class="kp">gentype</span> <span class="n">sub_group_non_uniform_scan_inclusive_or</span><span class="p">(</span> <span class="kp">gentype</span> <span class="n">value</span> <span class="p">)</span>
<span class="kp">gentype</span> <span class="n">sub_group_non_uniform_scan_inclusive_xor</span><span class="p">(</span> <span class="kp">gentype</span> <span class="n">value</span> <span class="p">)</span>
<span class="kt">int</span>     <span class="n">sub_group_non_uniform_scan_inclusive_logical_and</span><span class="p">(</span> <span class="kt">int</span> <span class="n">predicate</span> <span class="p">)</span>
<span class="kt">int</span>     <span class="n">sub_group_non_uniform_scan_inclusive_logical_or</span><span class="p">(</span> <span class="kt">int</span> <span class="n">predicate</span> <span class="p">)</span>
<span class="kt">int</span>     <span class="n">sub_group_non_uniform_scan_inclusive_logical_xor</span><span class="p">(</span> <span class="kt">int</span> <span class="n">predicate</span> <span class="p">)</span>

<span class="kp">gentype</span> <span class="n">sub_group_non_uniform_scan_exclusive_add</span><span class="p">(</span> <span class="kp">gentype</span> <span class="n">value</span> <span class="p">)</span>
<span class="kp">gentype</span> <span class="n">sub_group_non_uniform_scan_exclusive_mul</span><span class="p">(</span> <span class="kp">gentype</span> <span class="n">value</span> <span class="p">)</span>
<span class="kp">gentype</span> <span class="n">sub_group_non_uniform_scan_exclusive_min</span><span class="p">(</span> <span class="kp">gentype</span> <span class="n">value</span> <span class="p">)</span>
<span class="kp">gentype</span> <span class="n">sub_group_non_uniform_scan_exclusive_max</span><span class="p">(</span> <span class="kp">gentype</span> <span class="n">value</span> <span class="p">)</span>
<span class="kp">gentype</span> <span class="n">sub_group_non_uniform_scan_exclusive_and</span><span class="p">(</span> <span class="kp">gentype</span> <span class="n">value</span> <span class="p">)</span>
<span class="kp">gentype</span> <span class="n">sub_group_non_uniform_scan_exclusive_or</span><span class="p">(</span> <span class="kp">gentype</span> <span class="n">value</span> <span class="p">)</span>
<span class="kp">gentype</span> <span class="n">sub_group_non_uniform_scan_exclusive_xor</span><span class="p">(</span> <span class="kp">gentype</span> <span class="n">value</span> <span class="p">)</span>
<span class="kt">int</span>     <span class="n">sub_group_non_uniform_scan_exclusive_logical_and</span><span class="p">(</span> <span class="kt">int</span> <span class="n">predicate</span> <span class="p">)</span>
<span class="kt">int</span>     <span class="n">sub_group_non_uniform_scan_exclusive_logical_or</span><span class="p">(</span> <span class="kt">int</span> <span class="n">predicate</span> <span class="p">)</span>
<span class="kt">int</span>     <span class="n">sub_group_non_uniform_scan_exclusive_logical_xor</span><span class="p">(</span> <span class="kt">int</span> <span class="n">predicate</span> <span class="p">)</span>

<span class="c1">// These functions are available to devices supporting</span>
<span class="c1">// cl_khr_subgroup_shuffle:</span>

<span class="kp">gentype</span> <span class="n">sub_group_shuffle</span><span class="p">(</span> <span class="kp">gentype</span> <span class="n">value</span><span class="p">,</span> <span class="kt">uint</span> <span class="n">index</span> <span class="p">)</span>
<span class="kp">gentype</span> <span class="n">sub_group_shuffle_xor</span><span class="p">(</span> <span class="kp">gentype</span> <span class="n">value</span><span class="p">,</span> <span class="kt">uint</span> <span class="n">mask</span> <span class="p">)</span>

<span class="c1">// These functions are available to devices supporting</span>
<span class="c1">// cl_khr_subgroup_shuffle_relative:</span>

<span class="kp">gentype</span> <span class="n">sub_group_shuffle_up</span><span class="p">(</span> <span class="kp">gentype</span> <span class="n">value</span><span class="p">,</span> <span class="kt">uint</span> <span class="n">delta</span> <span class="p">)</span>
<span class="kp">gentype</span> <span class="n">sub_group_shuffle_down</span><span class="p">(</span> <span class="kp">gentype</span> <span class="n">value</span><span class="p">,</span> <span class="kt">uint</span> <span class="n">delta</span> <span class="p">)</span>

<span class="c1">// These functions are available to devices supporting</span>
<span class="c1">// cl_khr_subgroup_clustered_reduce:</span>

<span class="kp">gentype</span> <span class="n">sub_group_clustered_reduce_add</span><span class="p">(</span> <span class="kp">gentype</span> <span class="n">value</span><span class="p">,</span> <span class="kt">uint</span> <span class="n">clustersize</span> <span class="p">)</span>
<span class="kp">gentype</span> <span class="n">sub_group_clustered_reduce_mul</span><span class="p">(</span> <span class="kp">gentype</span> <span class="n">value</span><span class="p">,</span> <span class="kt">uint</span> <span class="n">clustersize</span> <span class="p">)</span>
<span class="kp">gentype</span> <span class="n">sub_group_clustered_reduce_min</span><span class="p">(</span> <span class="kp">gentype</span> <span class="n">value</span><span class="p">,</span> <span class="kt">uint</span> <span class="n">clustersize</span> <span class="p">)</span>
<span class="kp">gentype</span> <span class="n">sub_group_clustered_reduce_max</span><span class="p">(</span> <span class="kp">gentype</span> <span class="n">value</span><span class="p">,</span> <span class="kt">uint</span> <span class="n">clustersize</span> <span class="p">)</span>
<span class="kp">gentype</span> <span class="n">sub_group_clustered_reduce_and</span><span class="p">(</span> <span class="kp">gentype</span> <span class="n">value</span><span class="p">,</span> <span class="kt">uint</span> <span class="n">clustersize</span> <span class="p">)</span>
<span class="kp">gentype</span> <span class="n">sub_group_clustered_reduce_or</span><span class="p">(</span> <span class="kp">gentype</span> <span class="n">value</span><span class="p">,</span> <span class="kt">uint</span> <span class="n">clustersize</span> <span class="p">)</span>
<span class="kp">gentype</span> <span class="n">sub_group_clustered_reduce_xor</span><span class="p">(</span> <span class="kp">gentype</span> <span class="n">value</span><span class="p">,</span> <span class="kt">uint</span> <span class="n">clustersize</span> <span class="p">)</span>
<span class="kt">int</span>     <span class="n">sub_group_clustered_reduce_logical_and</span><span class="p">(</span> <span class="kt">int</span> <span class="n">predicate</span><span class="p">,</span> <span class="kt">uint</span> <span class="n">clustersize</span> <span class="p">)</span>
<span class="kt">int</span>     <span class="n">sub_group_clustered_reduce_logical_or</span><span class="p">(</span> <span class="kt">int</span> <span class="n">predicate</span><span class="p">,</span> <span class="kt">uint</span> <span class="n">clustersize</span> <span class="p">)</span>
<span class="kt">int</span>     <span class="n">sub_group_clustered_reduce_logical_xor</span><span class="p">(</span> <span class="kt">int</span> <span class="n">predicate</span><span class="p">,</span> <span class="kt">uint</span> <span class="n">clustersize</span> <span class="p">)</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="cl_khr_subgroup_extended_types"><a class="anchor" href="#cl_khr_subgroup_extended_types"></a>38.4. Extended Types</h3>
<div class="paragraph">
<p>This section describes functionality added by <code>cl_khr_subgroup_extended_types</code>.
This extension adds additional supported data types to the existing subgroup broadcast, scan, and reduction functions.</p>
</div>
<div class="sect3">
<h4 id="_modify_the_existing_section_describing_subgroup_functions"><a class="anchor" href="#_modify_the_existing_section_describing_subgroup_functions"></a>38.4.1. Modify the Existing Section Describing Subgroup Functions</h4>
<div class="paragraph">
<p>Modify the first paragraph in this section that describes <code>gentype</code> type support for the subgroup <code>broadcast</code>, <code>scan</code>, and <code>reduction</code> functions to add scalar <code>char</code>, <code>uchar</code>, <code>short</code>, and <code>ushort</code> support, and to additionally add built-in vector type support for <code>broadcast</code> specifically.
The functions in the table and their descriptions remain unchanged by this extension:</p>
</div>
<div class="paragraph">
<p>The table below describes OpenCL C programming language built-in functions that operate on a subgroup level.
These built-in functions must be encountered by all work items in the subgroup executing the kernel.
We use the generic type name <code>gentype</code> to indicate the built-in scalar data types <code>char</code>, <code>uchar</code>, <code>short</code>, <code>ushort</code>, <code>int</code>, <code>uint</code>, <code>long</code>, <code>ulong</code>, <code>float</code>, <code>double</code> (if double precision is supported), or <code>half</code> (if half precision is supported).</p>
</div>
<div class="paragraph">
<p>For the <code>sub_group_broadcast</code> function, the generic type name <code>gentype</code> may additionally be one of the supported built-in vector data types <code>char<em>n</em></code>, <code>uchar<em>n</em></code>, <code>short<em>n</em></code>, <code>ushort<em>n</em></code>, <code>int<em>n</em></code>, <code>uint<em>n</em></code>, <code>long<em>n</em></code>, <code>ulong<em>n</em></code>, <code>float<em>n</em></code>, <code>double<em>n</em></code> (if double precision is supported), or <code>half<em>n</em></code> (if half precision is supported).</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="cl_khr_subgroup_non_uniform_vote"><a class="anchor" href="#cl_khr_subgroup_non_uniform_vote"></a>38.5. Votes and Elections</h3>
<div class="paragraph">
<p>This section describes functionality added by <code>cl_khr_subgroup_non_uniform_vote</code>.
This extension adds the ability to elect a single work item from a subgroup to perform a task and to hold votes among work items in a subgroup.</p>
</div>
<div class="sect3">
<h4 id="_add_a_new_section_6_15_x_subgroup_vote_and_elect_built_in_functions"><a class="anchor" href="#_add_a_new_section_6_15_x_subgroup_vote_and_elect_built_in_functions"></a>38.5.1. Add a new Section 6.15.X - Subgroup Vote and Elect Built-in Functions</h4>
<div class="paragraph">
<p>The table below describes the OpenCL C programming language built-in functions to elect a single work item in a subgroup to perform a task and to collectively vote to determine a boolean condition for the subgroup.
These functions need not be encountered by all work items in a subgroup executing the kernel.
For the functions below, the generic type name <code>gentype</code> may be the one of the supported built-in scalar data types <code>char</code>, <code>uchar</code>, <code>short</code>, <code>ushort</code>, <code>int</code>, <code>uint</code>, <code>long</code>, <code>ulong</code>, <code>float</code>, <code>double</code> (if double precision is supported), or <code>half</code> (if half precision is supported).</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><strong>Function</strong></th>
<th class="tableblock halign-left valign-top"><strong>Description</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="opencl_c"><span class="kt">int</span> <span class="n">sub_group_elect</span><span class="p">()</span></code></pre>
</div>
</div></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Elects a single work item in the subgroup to perform a task.
This function will return true (nonzero) for the active work item in the subgroup with the smallest subgroup local ID, and false (zero) for all other active work items in the subgroup.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="opencl_c"><span class="kt">int</span> <span class="n">sub_group_non_uniform_all</span><span class="p">(</span>
    <span class="kt">int</span> <span class="n">predicate</span> <span class="p">)</span></code></pre>
</div>
</div></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Examines <em>predicate</em> for all active work items in the subgroup and returns a non-zero value if <em>predicate</em> is non-zero for all active work items in the subgroup and zero otherwise.</p>
<p class="tableblock">Note: This behavior is the same as <code>sub_group_all</code> from <code>cl_khr_subgroups</code> and OpenCL 2.1, except this function need not be encountered by all work items in the subgroup executing the kernel.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="opencl_c"><span class="kt">int</span> <span class="n">sub_group_non_uniform_any</span><span class="p">(</span>
    <span class="kt">int</span> <span class="n">predicate</span> <span class="p">)</span></code></pre>
</div>
</div></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Examines <em>predicate</em> for all active work items in the subgroup and returns a non-zero value if <em>predicate</em> is non-zero for any active work item in the subgroup and zero otherwise.</p>
<p class="tableblock">Note: This behavior is the same as <code>sub_group_any</code> from <code>cl_khr_subgroups</code> and OpenCL 2.1, except this function need not be encountered by all work items in the subgroup executing the kernel.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="opencl_c"><span class="kt">int</span> <span class="n">sub_group_non_uniform_all_equal</span><span class="p">(</span>
    <span class="kp">gentype</span> <span class="n">value</span> <span class="p">)</span></code></pre>
</div>
</div></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Examines <em>value</em> for all active work items in the subgroup and returns a non-zero value if <em>value</em> is equivalent for all active invocations in the subgroup and zero otherwise.</p>
<p class="tableblock">Integer types use a bitwise test for equality.  Floating-point types use an ordered floating-point test for equality.</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect2">
<h3 id="cl_khr_subgroup_ballot"><a class="anchor" href="#cl_khr_subgroup_ballot"></a>38.6. Ballots</h3>
<div class="paragraph">
<p>This section describes functionality added by <code>cl_khr_subgroup_ballot</code>.
This extension adds the ability to collect and operate on ballots from work items in the subgroup.</p>
</div>
<div class="sect3">
<h4 id="_add_a_new_section_6_15_x_subgroup_ballot_built_in_functions"><a class="anchor" href="#_add_a_new_section_6_15_x_subgroup_ballot_built_in_functions"></a>38.6.1. Add a new Section 6.15.X - Subgroup Ballot Built-in Functions</h4>
<div class="paragraph">
<p>The table below describes the OpenCL C programming language built-in functions to allow work items in a subgroup to collect and operate on ballots from work items in the subgroup.
These functions need not be encountered by all work items in a subgroup executing the kernel.</p>
</div>
<div class="paragraph">
<p>For the <code>sub_group_non_uniform_broadcast</code> and <code>sub_group_broadcast_first</code> functions, the generic type name <code>gentype</code> may be one of the supported built-in scalar data types <code>char</code>, <code>uchar</code>, <code>short</code>, <code>ushort</code>, <code>int</code>, <code>uint</code>, <code>long</code>, <code>ulong</code>, <code>float</code>, <code>double</code> (if double precision is supported), or <code>half</code> (if half precision is supported).</p>
</div>
<div class="paragraph">
<p>For the <code>sub_group_non_uniform_broadcast</code> function, the generic type name <code>gentype</code> may additionally be one of the supported built-in vector data types <code>char<em>n</em></code>, <code>uchar<em>n</em></code>, <code>short<em>n</em></code>, <code>ushort<em>n</em></code>, <code>int<em>n</em></code>, <code>uint<em>n</em></code>, <code>long<em>n</em></code>, <code>ulong<em>n</em></code>, <code>float<em>n</em></code>, <code>double<em>n</em></code> (if double precision is supported), or <code>half<em>n</em></code> (if half precision is supported).</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><strong>Function</strong></th>
<th class="tableblock halign-left valign-top"><strong>Description</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="opencl_c"><span class="kp">gentype</span> <span class="n">sub_group_non_uniform_broadcast</span><span class="p">(</span>
    <span class="kp">gentype</span> <span class="n">value</span><span class="p">,</span>
    <span class="kt">uint</span> <span class="n">index</span> <span class="p">)</span></code></pre>
</div>
</div></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Returns <em>value</em> for the work item with subgroup local ID equal to <em>index</em>.</p>
<p class="tableblock">Behavior is undefined when the value of <em>index</em> is not equivalent for all active work items in the subgroup.</p>
<p class="tableblock">The return value is undefined if the work item with subgroup local ID equal to <em>index</em> is inactive or if <em>index</em> is greater than or equal to the size of the subgroup.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="opencl_c"><span class="kp">gentype</span> <span class="n">sub_group_broadcast_first</span><span class="p">(</span>
    <span class="kp">gentype</span> <span class="n">value</span> <span class="p">)</span></code></pre>
</div>
</div></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Returns <em>value</em> for the work item with the smallest subgroup local ID among active work items in the subgroup.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="opencl_c"><span class="kt">uint4</span> <span class="n">sub_group_ballot</span><span class="p">(</span>
    <span class="kt">int</span> <span class="n">predicate</span> <span class="p">)</span></code></pre>
</div>
</div></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Returns a bitfield combining the <em>predicate</em> values from all work items in the subgroup.
Bit zero of the first vector component represents the subgroup local ID zero, with higher-order bits and subsequent vector components representing, in order, increasing subgroup local IDs.
The representative bit in the bitfield is set if the work item is active and the <em>predicate</em> is non-zero, and is unset otherwise.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="opencl_c"><span class="kt">int</span> <span class="n">sub_group_inverse_ballot</span><span class="p">(</span>
    <span class="kt">uint4</span> <span class="n">value</span> <span class="p">)</span></code></pre>
</div>
</div></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Returns the predicate value for this work item in the subgroup from the bitfield <em>value</em> representing predicate values from all work items in the subgroup.
The predicate return value will be non-zero if the bit in the bitfield <em>value</em> for this work item is set, and zero otherwise.</p>
<p class="tableblock">Behavior is undefined when <em>value</em> is not equivalent for all active work items in the subgroup.</p>
<p class="tableblock">This is a specialized function that may perform better than the equivalent <code>sub_group_ballot_bit_extract</code> on some implementations.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="opencl_c"><span class="kt">int</span> <span class="n">sub_group_ballot_bit_extract</span><span class="p">(</span>
    <span class="kt">uint4</span> <span class="n">value</span><span class="p">,</span>
    <span class="kt">uint</span> <span class="n">index</span> <span class="p">)</span></code></pre>
</div>
</div></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Returns the predicate value for the work item with subgroup local ID equal to <em>index</em> from the bitfield <em>value</em> representing predicate values from all work items in the subgroup.
The predicate return value will be non-zero if the bit in the bitfield <em>value</em> for the work item with subgroup local ID equal to <em>index</em> is set, and zero otherwise.</p>
<p class="tableblock">The predicate return value is undefined if the work item with subgroup local ID equal to <em>index</em> is greater than or equal to the size of the subgroup.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="opencl_c"><span class="kt">uint</span> <span class="n">sub_group_ballot_bit_count</span><span class="p">(</span>
    <span class="kt">uint4</span> <span class="n">value</span> <span class="p">)</span></code></pre>
</div>
</div></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Returns the number of bits that are set in the bitfield <em>value</em>, only considering the bits in <em>value</em> that represent predicate values corresponding to subgroup local IDs less than the maximum subgroup size within the dispatch (as returned by <code>get_max_sub_group_size</code>).</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="opencl_c"><span class="kt">uint</span> <span class="n">sub_group_ballot_inclusive_scan</span><span class="p">(</span>
    <span class="kt">uint4</span> <span class="n">value</span> <span class="p">)</span></code></pre>
</div>
</div></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Returns the number of bits that are set in the bitfield <em>value</em>, only considering the bits in <em>value</em> representing work items with a subgroup local ID less than or equal to this work item&#8217;s subgroup local ID.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="opencl_c"><span class="kt">uint</span> <span class="n">sub_group_ballot_exclusive_scan</span><span class="p">(</span>
    <span class="kt">uint4</span> <span class="n">value</span> <span class="p">)</span></code></pre>
</div>
</div></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Returns the number of bits that are set in the bitfield <em>value</em>, only considering the bits in <em>value</em> representing work items with a subgroup local ID less than this work item&#8217;s subgroup local ID.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="opencl_c"><span class="kt">uint</span> <span class="n">sub_group_ballot_find_lsb</span><span class="p">(</span>
    <span class="kt">uint4</span> <span class="n">value</span> <span class="p">)</span></code></pre>
</div>
</div></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Returns the smallest subgroup local ID with a bit set in the bitfield <em>value</em>, only considering the bits in <em>value</em> that represent predicate values corresponding to subgroup local IDs less than the maximum subgroup size within the dispatch (as returned by <code>get_max_sub_group_size</code>).
If no bits representing predicate values from all work items in the subgroup are set in the bitfield <em>value</em> then the return value is undefined.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="opencl_c"><span class="kt">uint</span> <span class="n">sub_group_ballot_find_msb</span><span class="p">(</span>
    <span class="kt">uint4</span> <span class="n">value</span> <span class="p">)</span></code></pre>
</div>
</div></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Returns the largest subgroup local ID with a bit set in the bitfield <em>value</em>, only considering the bits in <em>value</em> that represent predicate values corresponding to subgroup local IDs less than the maximum subgroup size within the dispatch (as returned by <code>get_max_sub_group_size</code>).
If no bits representing predicate values from all work items in the subgroup are set in the bitfield <em>value</em> then the return value is undefined.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="opencl_c"><span class="kt">uint4</span> <span class="n">get_sub_group_eq_mask</span><span class="p">()</span></code></pre>
</div>
</div></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Generates a bitmask where the bit is set in the bitmask if the bit index equals the subgroup local ID and unset otherwise.
Bit zero of the first vector component represents the subgroup local ID zero, with higher-order bits and subsequent vector components representing, in order, increasing subgroup local IDs.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="opencl_c"><span class="kt">uint4</span> <span class="n">get_sub_group_ge_mask</span><span class="p">()</span></code></pre>
</div>
</div></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Generates a bitmask where the bit is set in the bitmask if the bit index is greater than or equal to the subgroup local ID and less than the maximum subgroup size, and unset otherwise.
Bit zero of the first vector component represents the subgroup local ID zero, with higher-order bits and subsequent vector components representing, in order, increasing subgroup local IDs.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="opencl_c"><span class="kt">uint4</span> <span class="n">get_sub_group_gt_mask</span><span class="p">()</span></code></pre>
</div>
</div></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Generates a bitmask where the bit is set in the bitmask if the bit index is greater than the subgroup local ID and less than the maximum subgroup size, and unset otherwise.
Bit zero of the first vector component represents the subgroup local ID zero, with higher-order bits and subsequent vector components representing, in order, increasing subgroup local IDs.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="opencl_c"><span class="kt">uint4</span> <span class="n">get_sub_group_le_mask</span><span class="p">()</span></code></pre>
</div>
</div></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Generates a bitmask where the bit is set in the bitmask if the bit index is less than or equal to the subgroup local ID and unset otherwise.
Bit zero of the first vector component represents the subgroup local ID zero, with higher-order bits and subsequent vector components representing, in order, increasing subgroup local IDs.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="opencl_c"><span class="kt">uint4</span> <span class="n">get_sub_group_lt_mask</span><span class="p">()</span></code></pre>
</div>
</div></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Generates a bitmask where the bit is set in the bitmask if the bit index is less than the subgroup local ID and unset otherwise.
Bit zero of the first vector component represents the subgroup local ID zero, with higher-order bits and subsequent vector components representing, in order, increasing subgroup local IDs.</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect2">
<h3 id="cl_khr_subgroup_non_uniform_arithmetic"><a class="anchor" href="#cl_khr_subgroup_non_uniform_arithmetic"></a>38.7. Non-Uniform Arithmetic</h3>
<div class="paragraph">
<p>This section describes functionality added by <code>cl_khr_subgroup_non_uniform_arithmetic</code>.
This extension adds the ability to use some subgroup functions within non-uniform flow control, including additional scan and reduction operators.</p>
</div>
<div class="sect3">
<h4 id="_add_a_new_section_6_15_x_non_uniform_subgroup_scan_and_reduction_built_in_functions"><a class="anchor" href="#_add_a_new_section_6_15_x_non_uniform_subgroup_scan_and_reduction_built_in_functions"></a>38.7.1. Add a new Section 6.15.X - Non Uniform Subgroup Scan and Reduction Built-in Functions</h4>
<div class="sect4">
<h5 id="_arithmetic_operations"><a class="anchor" href="#_arithmetic_operations"></a>38.7.1.1. Arithmetic Operations</h5>
<div class="paragraph">
<p>The table below describes the OpenCL C programming language built-in functions that perform simple arithmetic operations across work items in a subgroup.
These functions need not be encountered by all work items in a subgroup executing the kernel.
For the functions below, the generic type name <code>gentype</code> may be one of the supported built-in scalar data types <code>char</code>, <code>uchar</code>, <code>short</code>, <code>ushort</code>, <code>int</code>, <code>uint</code>, <code>long</code>, <code>ulong</code>, <code>float</code>, <code>double</code> (if double precision is supported), or <code>half</code> (if half precision is supported).</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 60%;">
<col style="width: 40%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><strong>Function</strong></th>
<th class="tableblock halign-left valign-top"><strong>Description</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="opencl_c"><span class="kp">gentype</span> <span class="n">sub_group_non_uniform_reduce_add</span><span class="p">(</span>
    <span class="kp">gentype</span> <span class="n">value</span> <span class="p">)</span>
<span class="kp">gentype</span> <span class="n">sub_group_non_uniform_reduce_min</span><span class="p">(</span>
    <span class="kp">gentype</span> <span class="n">value</span> <span class="p">)</span>
<span class="kp">gentype</span> <span class="n">sub_group_non_uniform_reduce_max</span><span class="p">(</span>
    <span class="kp">gentype</span> <span class="n">value</span> <span class="p">)</span>
<span class="kp">gentype</span> <span class="n">sub_group_non_uniform_reduce_mul</span><span class="p">(</span>
    <span class="kp">gentype</span> <span class="n">value</span> <span class="p">)</span></code></pre>
</div>
</div></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Returns the summation, multiplication, minimum, or maximum of <em>value</em> for all active work items in the subgroup.</p>
<p class="tableblock">Note: This behavior is the same as the <strong>add</strong>, <strong>min</strong>, and <strong>max</strong> reduction built-in functions from <code>cl_khr_subgroups</code> and OpenCL 2.1, except these functions support additional types and need not be encountered by all work items in the subgroup executing the kernel.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="opencl_c"><span class="kp">gentype</span> <span class="n">sub_group_non_uniform_scan_inclusive_add</span><span class="p">(</span>
    <span class="kp">gentype</span> <span class="n">value</span> <span class="p">)</span>
<span class="kp">gentype</span> <span class="n">sub_group_non_uniform_scan_inclusive_min</span><span class="p">(</span>
    <span class="kp">gentype</span> <span class="n">value</span> <span class="p">)</span>
<span class="kp">gentype</span> <span class="n">sub_group_non_uniform_scan_inclusive_max</span><span class="p">(</span>
    <span class="kp">gentype</span> <span class="n">value</span> <span class="p">)</span>
<span class="kp">gentype</span> <span class="n">sub_group_non_uniform_scan_inclusive_mul</span><span class="p">(</span>
    <span class="kp">gentype</span> <span class="n">value</span> <span class="p">)</span></code></pre>
</div>
</div></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Returns the result of an inclusive scan operation, which is the summation, multiplication, minimum, or maximum of <em>value</em> for all active work items in the subgroup with a subgroup local ID less than or equal to this work item&#8217;s subgroup local ID.</p>
<p class="tableblock">Note: This behavior is the same as the <strong>add</strong>, <strong>min</strong>, and <strong>max</strong> inclusive scan built-in functions from <code>cl_khr_subgroups</code> and OpenCL 2.1, except these functions support additional types and need not be encountered by all work items in the subgroup executing the kernel.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="opencl_c"><span class="kp">gentype</span> <span class="n">sub_group_non_uniform_scan_exclusive_add</span><span class="p">(</span>
    <span class="kp">gentype</span> <span class="n">value</span> <span class="p">)</span>
<span class="kp">gentype</span> <span class="n">sub_group_non_uniform_scan_exclusive_min</span><span class="p">(</span>
    <span class="kp">gentype</span> <span class="n">value</span> <span class="p">)</span>
<span class="kp">gentype</span> <span class="n">sub_group_non_uniform_scan_exclusive_max</span><span class="p">(</span>
    <span class="kp">gentype</span> <span class="n">value</span> <span class="p">)</span>
<span class="kp">gentype</span> <span class="n">sub_group_non_uniform_scan_exclusive_mul</span><span class="p">(</span>
    <span class="kp">gentype</span> <span class="n">value</span> <span class="p">)</span></code></pre>
</div>
</div></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Returns the result of an exclusive scan operation, which is the summation, multiplication, minimum, or maximum of <em>value</em> for all active work items in the subgroup with a subgroup local ID less than this work item&#8217;s subgroup local ID.</p>
<p class="tableblock">If there is no active work item in the subgroup with a subgroup local ID less than this work item&#8217;s subgroup local ID then an identity value <code>I</code> is returned.
For <strong>add</strong>, the identity value is <code>0</code>.
For <strong>min</strong>, the identity value is the largest representable value for integer types, or <code>+INF</code> for floating point types.
For <strong>max</strong>, the identity value is the minimum representable value for integer types, or <code>-INF</code> for floating point types.
For <strong>mul</strong>, the identity value is <code>1</code>.</p>
<p class="tableblock">Note: This behavior is the same as the <strong>add</strong>, <strong>min</strong>, and <strong>max</strong> exclusive scan built-in functions from <code>cl_khr_subgroups</code> and OpenCL 2.1, except these functions support additional types and need not be encountered by all work items in the subgroup executing the kernel.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Note: The order of floating-point operations is not guaranteed for the subgroup scan and reduction built-in functions that operate on floating point types, and the order of operations may additionally be non-deterministic for a given subgroup.</p>
</div>
</div>
<div class="sect4">
<h5 id="_bitwise_operations"><a class="anchor" href="#_bitwise_operations"></a>38.7.1.2. Bitwise Operations</h5>
<div class="paragraph">
<p>The table below describes the OpenCL C programming language built-in functions that perform simple bitwise integer operations across work items in a subgroup.
These functions need not be encountered by all work items in a subgroup executing the kernel.
For the functions below, the generic type name <code>gentype</code> may be one of the supported built-in scalar data types <code>char</code>, <code>uchar</code>, <code>short</code>, <code>ushort</code>, <code>int</code>, <code>uint</code>, <code>long</code>, and <code>ulong</code>.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 60%;">
<col style="width: 40%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><strong>Function</strong></th>
<th class="tableblock halign-left valign-top"><strong>Description</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="opencl_c"><span class="kp">gentype</span> <span class="n">sub_group_non_uniform_reduce_and</span><span class="p">(</span>
    <span class="kp">gentype</span> <span class="n">value</span> <span class="p">)</span>
<span class="kp">gentype</span> <span class="n">sub_group_non_uniform_reduce_or</span><span class="p">(</span>
    <span class="kp">gentype</span> <span class="n">value</span> <span class="p">)</span>
<span class="kp">gentype</span> <span class="n">sub_group_non_uniform_reduce_xor</span><span class="p">(</span>
    <span class="kp">gentype</span> <span class="n">value</span> <span class="p">)</span></code></pre>
</div>
</div></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Returns the bitwise <strong>and</strong>, <strong>or</strong>, or <strong>xor</strong> of <em>value</em> for all active work items in the subgroup.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="opencl_c"><span class="kp">gentype</span> <span class="n">sub_group_non_uniform_scan_inclusive_and</span><span class="p">(</span>
    <span class="kp">gentype</span> <span class="n">value</span> <span class="p">)</span>
<span class="kp">gentype</span> <span class="n">sub_group_non_uniform_scan_inclusive_or</span><span class="p">(</span>
    <span class="kp">gentype</span> <span class="n">value</span> <span class="p">)</span>
<span class="kp">gentype</span> <span class="n">sub_group_non_uniform_scan_inclusive_xor</span><span class="p">(</span>
    <span class="kp">gentype</span> <span class="n">value</span> <span class="p">)</span></code></pre>
</div>
</div></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Returns the result of an inclusive scan operation, which is the bitwise <strong>and</strong>, <strong>or</strong>, or <strong>xor</strong> of <em>value</em> for all active work items in the subgroup with a subgroup local ID less than or equal to this work item&#8217;s subgroup local ID.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="opencl_c"><span class="kp">gentype</span> <span class="n">sub_group_non_uniform_scan_exclusive_and</span><span class="p">(</span>
    <span class="kp">gentype</span> <span class="n">value</span> <span class="p">)</span>
<span class="kp">gentype</span> <span class="n">sub_group_non_uniform_scan_exclusive_or</span><span class="p">(</span>
    <span class="kp">gentype</span> <span class="n">value</span> <span class="p">)</span>
<span class="kp">gentype</span> <span class="n">sub_group_non_uniform_scan_exclusive_xor</span><span class="p">(</span>
    <span class="kp">gentype</span> <span class="n">value</span> <span class="p">)</span></code></pre>
</div>
</div></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Returns the result of an exclusive scan operation, which is the bitwise <strong>and</strong>, <strong>or</strong>, or <strong>xor</strong> of <em>value</em> for all active work items in the subgroup with a subgroup local ID less than this work item&#8217;s subgroup local ID.</p>
<p class="tableblock">If there is no active work item in the subgroup with a subgroup local ID less than this work item&#8217;s subgroup local ID then an identity value <code>I</code> is returned.
For <strong>and</strong>, the identity value is <code>~0</code> (all bits set).
For <strong>or</strong> and <strong>xor</strong>, the identity value is <code>0</code>.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="_logical_operations"><a class="anchor" href="#_logical_operations"></a>38.7.1.3. Logical Operations</h5>
<div class="paragraph">
<p>The table below describes the OpenCL C programming language built-in functions that perform simple logical operations across work items in a subgroup.
These functions need not be encountered by all work items in a subgroup executing the kernel.
For these functions, a non-zero <em>predicate</em> argument or return value is logically <code>true</code> and a zero <em>predicate</em> argument or return value is logically <code>false</code>.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 66.6666%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><strong>Function</strong></th>
<th class="tableblock halign-left valign-top"><strong>Description</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="opencl_c"><span class="kt">int</span> <span class="n">sub_group_non_uniform_reduce_logical_and</span><span class="p">(</span>
    <span class="kt">int</span> <span class="n">predicate</span> <span class="p">)</span>
<span class="kt">int</span> <span class="n">sub_group_non_uniform_reduce_logical_or</span><span class="p">(</span>
    <span class="kt">int</span> <span class="n">predicate</span> <span class="p">)</span>
<span class="kt">int</span> <span class="n">sub_group_non_uniform_reduce_logical_xor</span><span class="p">(</span>
    <span class="kt">int</span> <span class="n">predicate</span> <span class="p">)</span></code></pre>
</div>
</div></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Returns the logical <strong>and</strong>, <strong>or</strong>, or <strong>xor</strong> of <em>predicate</em> for all active work items in the subgroup.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="opencl_c"><span class="kt">int</span> <span class="n">sub_group_non_uniform_scan_inclusive_logical_and</span><span class="p">(</span>
    <span class="kt">int</span> <span class="n">predicate</span> <span class="p">)</span>
<span class="kt">int</span> <span class="n">sub_group_non_uniform_scan_inclusive_logical_or</span><span class="p">(</span>
    <span class="kt">int</span> <span class="n">predicate</span> <span class="p">)</span>
<span class="kt">int</span> <span class="n">sub_group_non_uniform_scan_inclusive_logical_xor</span><span class="p">(</span>
    <span class="kt">int</span> <span class="n">predicate</span> <span class="p">)</span></code></pre>
</div>
</div></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Returns the result of an inclusive scan operation, which is the logical <strong>and</strong>, <strong>or</strong>, or <strong>xor</strong> of <em>predicate</em> for all active work items in the subgroup with a subgroup local ID less than or equal to this work item&#8217;s subgroup local ID.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="opencl_c"><span class="kt">int</span> <span class="n">sub_group_non_uniform_scan_exclusive_logical_and</span><span class="p">(</span>
    <span class="kt">int</span> <span class="n">predicate</span> <span class="p">)</span>
<span class="kt">int</span> <span class="n">sub_group_non_uniform_scan_exclusive_logical_or</span><span class="p">(</span>
    <span class="kt">int</span> <span class="n">predicate</span> <span class="p">)</span>
<span class="kt">int</span> <span class="n">sub_group_non_uniform_scan_exclusive_logical_xor</span><span class="p">(</span>
    <span class="kt">int</span> <span class="n">predicate</span> <span class="p">)</span></code></pre>
</div>
</div></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Returns the result of an exclusive scan operation, which is the logical <strong>and</strong>, <strong>or</strong>, or <strong>xor</strong> of <em>predicate</em> for all active work items in the subgroup with a subgroup local ID less than this work item&#8217;s subgroup local ID.</p>
<p class="tableblock">If there is no active work item in the subgroup with a subgroup local ID less than this work item&#8217;s subgroup local ID then an identity value <code>I</code> is returned.
For <strong>and</strong>, the identity value is <code>true</code> (non-zero).
For <strong>or</strong> and <strong>xor</strong>, the identity value is <code>false</code> (zero).</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="sect2">
<h3 id="cl_khr_subgroup_shuffle"><a class="anchor" href="#cl_khr_subgroup_shuffle"></a>38.8. General Purpose Shuffles</h3>
<div class="paragraph">
<p>This section describes functionality added by <code>cl_khr_subgroup_shuffle</code>.
This extension adds additional ways to exchange data among work items in a subgroup.</p>
</div>
<div class="sect3">
<h4 id="_add_a_new_section_6_15_x_subgroup_shuffle_built_in_functions"><a class="anchor" href="#_add_a_new_section_6_15_x_subgroup_shuffle_built_in_functions"></a>38.8.1. Add a new Section 6.15.X - Subgroup Shuffle Built-in Functions</h4>
<div class="paragraph">
<p>The table below describes the OpenCL C programming language built-in functions that allow work items in a subgroup to exchange data.
These functions need not be encountered by all work items in a subgroup executing the kernel.
For the functions below, the generic type name <code>gentype</code> may be one of the supported built-in scalar data types <code>char</code>, <code>uchar</code>, <code>short</code>, <code>ushort</code>, <code>int</code>, <code>uint</code>, <code>long</code>, <code>ulong</code>, <code>float</code>, <code>double</code> (if double precision is supported), or <code>half</code> (if half precision is supported).</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><strong>Function</strong></th>
<th class="tableblock halign-left valign-top"><strong>Description</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="opencl_c"><span class="kp">gentype</span> <span class="n">sub_group_shuffle</span><span class="p">(</span>
    <span class="kp">gentype</span> <span class="n">value</span><span class="p">,</span> <span class="kt">uint</span> <span class="n">index</span> <span class="p">)</span></code></pre>
</div>
</div></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Returns <em>value</em> for the work item with subgroup local ID equal to <em>index</em>.
The shuffle <em>index</em> need not be the same for all work items in the subgroup.</p>
<p class="tableblock">The return value is undefined if the work item with subgroup local ID equal to <em>index</em> is inactive or if <em>index</em> is greater than or equal to the size of the subgroup.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="opencl_c"><span class="kp">gentype</span> <span class="n">sub_group_shuffle_xor</span><span class="p">(</span>
    <span class="kp">gentype</span> <span class="n">value</span><span class="p">,</span> <span class="kt">uint</span> <span class="n">mask</span> <span class="p">)</span></code></pre>
</div>
</div></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Returns <em>value</em> for the work item with subgroup local ID equal to this work item&#8217;s subgroup local ID xor&#8217;d with <em>mask</em>.
The shuffle <em>mask</em> need not be the same for all work items in the subgroup.</p>
<p class="tableblock">The return value is undefined if the work item with subgroup local ID equal to the calculated index is inactive or if the calculated index is greater than or equal to the size of the subgroup.</p>
<p class="tableblock">This is a specialized function that may perform better than the equivalent <code>sub_group_shuffle</code> on some implementations.</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect2">
<h3 id="cl_khr_subgroup_shuffle_relative"><a class="anchor" href="#cl_khr_subgroup_shuffle_relative"></a>38.9. Relative Shuffles</h3>
<div class="paragraph">
<p>This section describes functionality added by <code>cl_khr_subgroup_shuffle_relative</code>.
This extension adds specialized ways to exchange data among work items in a subgroup that may perform better on some implementations.</p>
</div>
<div class="sect3">
<h4 id="_add_a_new_section_6_15_x_subgroup_relative_shuffle_built_in_functions"><a class="anchor" href="#_add_a_new_section_6_15_x_subgroup_relative_shuffle_built_in_functions"></a>38.9.1. Add a new Section 6.15.X - Subgroup Relative Shuffle Built-in Functions</h4>
<div class="paragraph">
<p>The table below describes specialized OpenCL C programming language built-in functions that allow work items in a subgroup to exchange data.
These functions need not be encountered by all work items in a subgroup executing the kernel.
For the functions below, the generic type name <code>gentype</code> may be one of the supported built-in scalar data types <code>char</code>, <code>uchar</code>, <code>short</code>, <code>ushort</code>, <code>int</code>, <code>uint</code>, <code>long</code>, <code>ulong</code>, <code>float</code>, <code>double</code> (if double precision is supported), or <code>half</code> (if half precision is supported).</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><strong>Function</strong></th>
<th class="tableblock halign-left valign-top"><strong>Description</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="opencl_c"><span class="kp">gentype</span> <span class="n">sub_group_shuffle_up</span><span class="p">(</span>
    <span class="kp">gentype</span> <span class="n">value</span><span class="p">,</span> <span class="kt">uint</span> <span class="n">delta</span> <span class="p">)</span></code></pre>
</div>
</div></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Returns <em>value</em> for the work item with subgroup local ID equal to this work item&#8217;s subgroup local ID minus <em>delta</em>.
The shuffle <em>delta</em> need not be the same for all work items in the subgroup.</p>
<p class="tableblock">The return value is undefined if the work item with subgroup local ID equal to the calculated index is inactive, or <em>delta</em> is greater than this work item&#8217;s subgroup local ID.</p>
<p class="tableblock">This is a specialized function that may perform better than the equivalent <code>sub_group_shuffle</code> on some implementations.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="opencl_c"><span class="kp">gentype</span> <span class="n">sub_group_shuffle_down</span><span class="p">(</span>
    <span class="kp">gentype</span> <span class="n">value</span><span class="p">,</span> <span class="kt">uint</span> <span class="n">delta</span> <span class="p">)</span></code></pre>
</div>
</div></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Returns <em>value</em> for the work item with subgroup local ID equal to this work item&#8217;s subgroup local ID plus <em>delta</em>.
The shuffle <em>delta</em> need not be the same for all work items in the subgroup.</p>
<p class="tableblock">The return value is undefined if the work item with subgroup local ID equal to the calculated index is inactive, or this work item&#8217;s subgroup local ID plus <em>delta</em> is greater than or equal to the size of the subgroup.</p>
<p class="tableblock">This is a specialized function that may perform better than the equivalent <code>sub_group_shuffle</code> on some implementations.</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect2">
<h3 id="cl_khr_subgroup_clustered_reduce"><a class="anchor" href="#cl_khr_subgroup_clustered_reduce"></a>38.10. Clustered Reductions</h3>
<div class="paragraph">
<p>This section describes functionality added by <code>cl_khr_subgroup_clustered_reduce</code>.
This extension adds support for clustered reductions that operate on a subset of work items in the subgroup.</p>
</div>
<div class="sect3">
<h4 id="_add_a_new_section_6_15_x_subgroup_clustered_reduction_built_in_functions"><a class="anchor" href="#_add_a_new_section_6_15_x_subgroup_clustered_reduction_built_in_functions"></a>38.10.1. Add a new Section 6.15.X - Subgroup Clustered Reduction Built-in Functions</h4>
<div class="paragraph">
<p>This section describes arithmetic operations that are performed on a subset of work items in a subgroup, referred to as a cluster.
A cluster is described by a specified cluster size.
Work items in a subgroup are assigned to clusters such that for cluster size <em>n</em>, the <em>n</em> work items in the subgroup with the smallest subgroup local IDs are assigned to the first cluster, then the <em>n</em> remaining work items with the smallest subgroup local IDs are assigned to the next cluster, and so on.
Behavior is undefined if the specified cluster size is not an integer constant expression, is not a power-of-two, or is greater than the maximum size of a subgroup within the dispatch.</p>
</div>
<div class="sect4">
<h5 id="_arithmetic_operations_2"><a class="anchor" href="#_arithmetic_operations_2"></a>38.10.1.1. Arithmetic Operations</h5>
<div class="paragraph">
<p>The table below describes the OpenCL C programming language built-in functions that perform simple arithmetic operations on a cluster of work items in a subgroup.
These functions need not be encountered by all work items in a subgroup executing the kernel.
For the functions below, the generic type name <code>gentype</code> may be one of the supported built-in scalar data types <code>char</code>, <code>uchar</code>, <code>short</code>, <code>ushort</code>, <code>int</code>, <code>uint</code>, <code>long</code>, <code>ulong</code>, <code>float</code>, <code>double</code> (if double precision is supported), or <code>half</code> (if half precision is supported).</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><strong>Function</strong></th>
<th class="tableblock halign-left valign-top"><strong>Description</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="opencl_c"><span class="kp">gentype</span> <span class="n">sub_group_clustered_reduce_add</span><span class="p">(</span>
    <span class="kp">gentype</span> <span class="n">value</span><span class="p">,</span> <span class="kt">uint</span> <span class="n">clustersize</span> <span class="p">)</span>
<span class="kp">gentype</span> <span class="n">sub_group_clustered_reduce_mul</span><span class="p">(</span>
    <span class="kp">gentype</span> <span class="n">value</span><span class="p">,</span> <span class="kt">uint</span> <span class="n">clustersize</span> <span class="p">)</span>
<span class="kp">gentype</span> <span class="n">sub_group_clustered_reduce_min</span><span class="p">(</span>
    <span class="kp">gentype</span> <span class="n">value</span><span class="p">,</span> <span class="kt">uint</span> <span class="n">clustersize</span> <span class="p">)</span>
<span class="kp">gentype</span> <span class="n">sub_group_clustered_reduce_max</span><span class="p">(</span>
    <span class="kp">gentype</span> <span class="n">value</span><span class="p">,</span> <span class="kt">uint</span> <span class="n">clustersize</span> <span class="p">)</span></code></pre>
</div>
</div></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Returns the summation, multiplication, minimum, or maximum of <em>value</em> for all active work items in the subgroup within a cluster of the specified <em>clustersize</em>.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Note: The order of floating-point operations is not guaranteed for the subgroup clustered reduction built-in functions that operate on floating point types, and the order of operations may additionally be non-deterministic for a given subgroup.</p>
</div>
</div>
<div class="sect4">
<h5 id="_bitwise_operations_2"><a class="anchor" href="#_bitwise_operations_2"></a>38.10.1.2. Bitwise Operations</h5>
<div class="paragraph">
<p>The table below describes the OpenCL C programming language built-in functions to perform simple bitwise integer operations across a cluster of work items in a subgroup.
These functions need not be encountered by all work items in a subgroup executing the kernel.
For the functions below, the generic type name <code>gentype</code> may be the one of the supported built-in scalar data types <code>char</code>, <code>uchar</code>, <code>short</code>, <code>ushort</code>, <code>int</code>, <code>uint</code>, <code>long</code>, or <code>ulong</code>.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><strong>Function</strong></th>
<th class="tableblock halign-left valign-top"><strong>Description</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="opencl_c"><span class="kp">gentype</span> <span class="n">sub_group_clustered_reduce_and</span><span class="p">(</span>
    <span class="kp">gentype</span> <span class="n">value</span><span class="p">,</span> <span class="kt">uint</span> <span class="n">clustersize</span> <span class="p">)</span>
<span class="kp">gentype</span> <span class="n">sub_group_clustered_reduce_or</span><span class="p">(</span>
    <span class="kp">gentype</span> <span class="n">value</span><span class="p">,</span> <span class="kt">uint</span> <span class="n">clustersize</span> <span class="p">)</span>
<span class="kp">gentype</span> <span class="n">sub_group_clustered_reduce_xor</span><span class="p">(</span>
    <span class="kp">gentype</span> <span class="n">value</span><span class="p">,</span> <span class="kt">uint</span> <span class="n">clustersize</span> <span class="p">)</span></code></pre>
</div>
</div></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Returns the bitwise <strong>and</strong>, <strong>or</strong>, or <strong>xor</strong> of <em>value</em> for all active work items in the subgroup within a cluster of the specified <em>clustersize</em>.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="_logical_operations_2"><a class="anchor" href="#_logical_operations_2"></a>38.10.1.3. Logical Operations</h5>
<div class="paragraph">
<p>The table below describes the OpenCL C programming language built-in functions to perform simple logical operations across a cluster of work items in a subgroup.
These functions need not be encountered by all work items in a subgroup executing the kernel.
For these functions, a non-zero <em>predicate</em> argument or return value is logically <code>true</code> and a zero <em>predicate</em> argument or return value is logically <code>false</code>.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 60%;">
<col style="width: 40%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><strong>Function</strong></th>
<th class="tableblock halign-left valign-top"><strong>Description</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="opencl_c"><span class="kt">int</span> <span class="n">sub_group_clustered_reduce_logical_and</span><span class="p">(</span>
    <span class="kt">int</span> <span class="n">predicate</span><span class="p">,</span> <span class="kt">uint</span> <span class="n">clustersize</span> <span class="p">)</span>
<span class="kt">int</span> <span class="n">sub_group_clustered_reduce_logical_or</span><span class="p">(</span>
    <span class="kt">int</span> <span class="n">predicate</span><span class="p">,</span> <span class="kt">uint</span> <span class="n">clustersize</span> <span class="p">)</span>
<span class="kt">int</span> <span class="n">sub_group_clustered_reduce_logical_xor</span><span class="p">(</span>
    <span class="kt">int</span> <span class="n">predicate</span><span class="p">,</span> <span class="kt">uint</span> <span class="n">clustersize</span> <span class="p">)</span></code></pre>
</div>
</div></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Returns the logical <strong>and</strong>, <strong>or</strong>, or <strong>xor</strong> of <em>predicate</em> for all active work items in the subgroup within a cluster of the specified <em>clustersize</em>.</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="sect2">
<h3 id="extended-subgroups-mapping"><a class="anchor" href="#extended-subgroups-mapping"></a>38.11. Function Mapping and Capabilities</h3>
<div class="paragraph">
<p>This section describes a possible mapping between OpenCL built-in functions and SPIR-V instructions and required SPIR-V capabilities.</p>
</div>
<div class="paragraph">
<p>This section is informational and non-normative.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><strong>OpenCL C Function</strong></th>
<th class="tableblock halign-left valign-top"><strong>SPIR-V BuiltIn or Instruction</strong></th>
<th class="tableblock halign-left valign-top"><strong>Enabling SPIR-V Capability</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top" colspan="3"><p class="tableblock">For OpenCL 2.1 or <code>cl_khr_subgroups</code>:</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>get_&#8203;sub_&#8203;group_&#8203;size</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>SubgroupSize</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Kernel</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>get_&#8203;max_&#8203;sub_&#8203;group_&#8203;size</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>SubgroupMaxSize</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Kernel</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>get_&#8203;num_&#8203;sub_&#8203;groups</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>NumSubgroups</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Kernel</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>get_&#8203;enqueued_&#8203;num_&#8203;sub_&#8203;groups</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>NumEnqueuedSubgroups</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Kernel</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>get_&#8203;sub_&#8203;group_&#8203;id</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>SubgroupId</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Kernel</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>get_&#8203;sub_&#8203;group_&#8203;local_&#8203;id</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>SubgroupLocalInvocationId</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Kernel</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>sub_&#8203;group_&#8203;barrier</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>OpControlBarrier</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">None Needed</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>sub_&#8203;group_&#8203;all</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>OpGroupAll</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Groups</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>sub_&#8203;group_&#8203;any</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>OpGroupAny</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Groups</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>sub_&#8203;group_&#8203;broadcast</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>OpGroupBroadcast</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Groups</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>sub_&#8203;group_&#8203;reduce_&#8203;add</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>OpGroupIAdd</strong>, <strong>OpGroupFAdd</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Groups</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>sub_&#8203;group_&#8203;reduce_&#8203;min</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>OpGroupSMin</strong>, <strong>OpGroupUMin</strong>, <strong>OpGroupFMin</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Groups</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>sub_&#8203;group_&#8203;reduce_&#8203;max</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>OpGroupSMax</strong>, <strong>OpGroupUMax</strong>, <strong>OpGroupFMax</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Groups</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>sub_&#8203;group_&#8203;scan_&#8203;exclusive_&#8203;add</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>OpGroupIAdd</strong>, <strong>OpGroupFAdd</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Groups</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>sub_&#8203;group_&#8203;scan_&#8203;exclusive_&#8203;min</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>OpGroupSMin</strong>, <strong>OpGroupUMin</strong>, <strong>OpGroupFMin</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Groups</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>sub_&#8203;group_&#8203;scan_&#8203;exclusive_&#8203;max</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>OpGroupSMax</strong>, <strong>OpGroupUMax</strong>, <strong>OpGroupFMax</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Groups</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>sub_&#8203;group_&#8203;scan_&#8203;inclusive_&#8203;add</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>OpGroupIAdd</strong>, <strong>OpGroupFAdd</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Groups</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>sub_&#8203;group_&#8203;scan_&#8203;inclusive_&#8203;min</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>OpGroupSMin</strong>, <strong>OpGroupUMin</strong>, <strong>OpGroupFMin</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Groups</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>sub_&#8203;group_&#8203;scan_&#8203;inclusive_&#8203;max</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>OpGroupSMax</strong>, <strong>OpGroupUMax</strong>, <strong>OpGroupFMax</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Groups</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>sub_&#8203;group_&#8203;reserve_&#8203;read_&#8203;pipe</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>OpGroupReserveReadPipePackets</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Pipes</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>sub_&#8203;group_&#8203;reserve_&#8203;write_&#8203;pipe</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>OpGroupReserveReadWritePackets</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Pipes</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>sub_&#8203;group_&#8203;commit_&#8203;read_&#8203;pipe</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>OpGroupCommitReadPipe</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Pipes</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>sub_&#8203;group_&#8203;commit_&#8203;write_&#8203;pipe</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>OpGroupCommitWritePipe</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Pipes</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>get_&#8203;kernel_&#8203;sub_&#8203;group_&#8203;count_&#8203;for_&#8203;ndrange</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>OpGetKernelNDrangeSubGroupCount</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>DeviceEnqueue</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>get_&#8203;kernel_&#8203;max_&#8203;sub_&#8203;group_&#8203;size_&#8203;for_&#8203;ndrange</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>OpGetKernelNDrangeMaxSubGroupSize</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>DeviceEnqueue</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top" colspan="3"><p class="tableblock">For <code>cl_khr_subgroup_extended_types</code>:<br>
Note: This extension adds new types to uniform subgroup operations.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>sub_&#8203;group_&#8203;broadcast</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>OpGroupBroadcast</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Groups</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>sub_&#8203;group_&#8203;reduce_&#8203;add</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>OpGroupIAdd</strong>, <strong>OpGroupFAdd</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Groups</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>sub_&#8203;group_&#8203;reduce_&#8203;min</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>OpGroupSMin</strong>, <strong>OpGroupUMin</strong>, <strong>OpGroupFMin</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Groups</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>sub_&#8203;group_&#8203;reduce_&#8203;max</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>OpGroupSMax</strong>, <strong>OpGroupUMax</strong>, <strong>OpGroupFMax</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Groups</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>sub_&#8203;group_&#8203;scan_&#8203;exclusive_&#8203;add</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>OpGroupIAdd</strong>, <strong>OpGroupFAdd</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Groups</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>sub_&#8203;group_&#8203;scan_&#8203;exclusive_&#8203;min</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>OpGroupSMin</strong>, <strong>OpGroupUMin</strong>, <strong>OpGroupFMin</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Groups</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>sub_&#8203;group_&#8203;scan_&#8203;exclusive_&#8203;max</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>OpGroupSMax</strong>, <strong>OpGroupUMax</strong>, <strong>OpGroupFMax</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Groups</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>sub_&#8203;group_&#8203;scan_&#8203;inclusive_&#8203;add</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>OpGroupIAdd</strong>, <strong>OpGroupFAdd</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Groups</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>sub_&#8203;group_&#8203;scan_&#8203;inclusive_&#8203;min</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>OpGroupSMin</strong>, <strong>OpGroupUMin</strong>, <strong>OpGroupFMin</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Groups</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>sub_&#8203;group_&#8203;scan_&#8203;inclusive_&#8203;max</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>OpGroupSMax</strong>, <strong>OpGroupUMax</strong>, <strong>OpGroupFMax</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Groups</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top" colspan="3"><p class="tableblock">For <code>cl_khr_subgroup_non_uniform_vote</code>:</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>sub_&#8203;group_&#8203;elect</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>OpGroupNonUniformElect</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>GroupNonUniform</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>sub_&#8203;group_&#8203;non_&#8203;uniform_&#8203;all</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>OpGroupNonUniformAll</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>GroupNonUniformVote</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>sub_&#8203;group_&#8203;non_&#8203;uniform_&#8203;any</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>OpGroupNonUniformAny</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>GroupNonUniformVote</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>sub_&#8203;group_&#8203;non_&#8203;uniform_&#8203;all_&#8203;equal</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>OpGroupNonUniformAllEqual</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>GroupNonUniformVote</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top" colspan="3"><p class="tableblock">For <code>cl_khr_subgroup_ballot</code>:</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>sub_&#8203;group_&#8203;non_&#8203;uniform_&#8203;broadcast</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>OpGroupNonUniformBroadcast</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>GroupNonUniformBallot</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>sub_&#8203;group_&#8203;broadcast_&#8203;first</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>OpGroupNonUniformBroadcastFirst</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>GroupNonUniformBallot</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>sub_&#8203;group_&#8203;ballot</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>OpGroupNonUniformBallot</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>GroupNonUniformBallot</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>sub_&#8203;group_&#8203;inverse_&#8203;ballot</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>OpGroupNonUniformInverseBallot</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>GroupNonUniformBallot</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>sub_&#8203;group_&#8203;ballot_&#8203;bit_&#8203;extract</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>OpGroupNonUniformBallotBitExtract</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>GroupNonUniformBallot</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>sub_&#8203;group_&#8203;ballot_&#8203;bit_&#8203;count</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>OpGroupNonUniformBallotBitCount</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>GroupNonUniformBallot</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>sub_&#8203;group_&#8203;ballot_&#8203;inclusive_&#8203;scan</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>OpGroupNonUniformBallotBitCount</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>GroupNonUniformBallot</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>sub_&#8203;group_&#8203;ballot_&#8203;exclusive_&#8203;scan</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>OpGroupNonUniformBallotBitCount</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>GroupNonUniformBallot</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>sub_&#8203;group_&#8203;ballot_&#8203;find_&#8203;lsb</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>OpGroupNonUniformBallotFindLSB</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>GroupNonUniformBallot</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>sub_&#8203;group_&#8203;ballot_&#8203;find_&#8203;msb</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>OpGroupNonUniformBallotFindMSB</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>GroupNonUniformBallot</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>get_&#8203;sub_&#8203;group_&#8203;eq_&#8203;mask</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>SubgroupEqMask</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>GroupNonUniformBallot</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>get_&#8203;sub_&#8203;group_&#8203;ge_&#8203;mask</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>SubgroupGeMask</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>GroupNonUniformBallot</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>get_&#8203;sub_&#8203;group_&#8203;gt_&#8203;mask</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>SubgroupGtMask</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>GroupNonUniformBallot</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>get_&#8203;sub_&#8203;group_&#8203;le_&#8203;mask</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>SubgroupLeMask</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>GroupNonUniformBallot</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>get_&#8203;sub_&#8203;group_&#8203;lt_&#8203;mask</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>SubgroupLtMask</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>GroupNonUniformBallot</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top" colspan="3"><p class="tableblock">For <code>cl_khr_subgroup_non_uniform_arithmetic</code>:</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>sub_&#8203;group_&#8203;non_&#8203;uniform_&#8203;reduce_&#8203;add</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>OpGroupNonUniformIAdd</strong>, <strong>OpGroupNonUniformFAdd</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>GroupNonUniformArithmetic</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>sub_&#8203;group_&#8203;non_&#8203;uniform_&#8203;reduce_&#8203;mul</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>OpGroupNonUniformIMul</strong>, <strong>OpGroupNonUniformFMul</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>GroupNonUniformArithmetic</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>sub_&#8203;group_&#8203;non_&#8203;uniform_&#8203;reduce_&#8203;min</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>OpGroupNonUniformSMin</strong>, <strong>OpGroupNonUniformUMin</strong>, <strong>OpGroupNonUniformFMin</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>GroupNonUniformArithmetic</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>sub_&#8203;group_&#8203;non_&#8203;uniform_&#8203;reduce_&#8203;max</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>OpGroupNonUniformSMax</strong>, <strong>OpGroupNonUniformUMax</strong>, <strong>OpGroupNonUniformFMax</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>GroupNonUniformArithmetic</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>sub_&#8203;group_&#8203;non_&#8203;uniform_&#8203;reduce_&#8203;and</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>OpGroupNonUniformBitwiseAnd</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>GroupNonUniformArithmetic</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>sub_&#8203;group_&#8203;non_&#8203;uniform_&#8203;reduce_&#8203;or</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>OpGroupNonUniformBitwiseOr</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>GroupNonUniformArithmetic</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>sub_&#8203;group_&#8203;non_&#8203;uniform_&#8203;reduce_&#8203;xor</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>OpGroupNonUniformBitwiseXor</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>GroupNonUniformArithmetic</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>sub_&#8203;group_&#8203;non_&#8203;uniform_&#8203;reduce_&#8203;logical_&#8203;and</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>OpGroupNonUniformLogicalAnd</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>GroupNonUniformArithmetic</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>sub_&#8203;group_&#8203;non_&#8203;uniform_&#8203;reduce_&#8203;logical_&#8203;or</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>OpGroupNonUniformLogicalOr</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>GroupNonUniformArithmetic</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>sub_&#8203;group_&#8203;non_&#8203;uniform_&#8203;reduce_&#8203;logical_&#8203;xor</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>OpGroupNonUniformLogicalXor</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>GroupNonUniformArithmetic</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>sub_&#8203;group_&#8203;non_&#8203;uniform_&#8203;scan_&#8203;inclusive_&#8203;add</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>OpGroupNonUniformIAdd</strong>, <strong>OpGroupNonUniformFAdd</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>GroupNonUniformArithmetic</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>sub_&#8203;group_&#8203;non_&#8203;uniform_&#8203;scan_&#8203;inclusive_&#8203;mul</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>OpGroupNonUniformIMul</strong>, <strong>OpGroupNonUniformFMul</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>GroupNonUniformArithmetic</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>sub_&#8203;group_&#8203;non_&#8203;uniform_&#8203;scan_&#8203;inclusive_&#8203;min</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>OpGroupNonUniformSMin</strong>, <strong>OpGroupNonUniformUMin</strong>, <strong>OpGroupNonUniformFMin</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>GroupNonUniformArithmetic</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>sub_&#8203;group_&#8203;non_&#8203;uniform_&#8203;scan_&#8203;inclusive_&#8203;max</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>OpGroupNonUniformSMax</strong>, <strong>OpGroupNonUniformUMax</strong>, <strong>OpGroupNonUniformFMax</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>GroupNonUniformArithmetic</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>sub_&#8203;group_&#8203;non_&#8203;uniform_&#8203;scan_&#8203;inclusive_&#8203;and</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>OpGroupNonUniformBitwiseAnd</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>GroupNonUniformArithmetic</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>sub_&#8203;group_&#8203;non_&#8203;uniform_&#8203;scan_&#8203;inclusive_&#8203;or</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>OpGroupNonUniformBitwiseOr</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>GroupNonUniformArithmetic</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>sub_&#8203;group_&#8203;non_&#8203;uniform_&#8203;scan_&#8203;inclusive_&#8203;xor</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>OpGroupNonUniformBitwiseXor</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>GroupNonUniformArithmetic</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>sub_&#8203;group_&#8203;non_&#8203;uniform_&#8203;scan_&#8203;inclusive_&#8203;logical_&#8203;and</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>OpGroupNonUniformLogicalAnd</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>GroupNonUniformArithmetic</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>sub_&#8203;group_&#8203;non_&#8203;uniform_&#8203;scan_&#8203;inclusive_&#8203;logical_&#8203;or</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>OpGroupNonUniformLogicalOr</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>GroupNonUniformArithmetic</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>sub_&#8203;group_&#8203;non_&#8203;uniform_&#8203;scan_&#8203;inclusive_&#8203;logical_&#8203;xor</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>OpGroupNonUniformLogicalXor</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>GroupNonUniformArithmetic</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>sub_&#8203;group_&#8203;non_&#8203;uniform_&#8203;scan_&#8203;exclusive_&#8203;add</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>OpGroupNonUniformIAdd</strong>, <strong>OpGroupNonUniformFAdd</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>GroupNonUniformArithmetic</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>sub_&#8203;group_&#8203;non_&#8203;uniform_&#8203;scan_&#8203;exclusive_&#8203;mul</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>OpGroupNonUniformIMul</strong>, <strong>OpGroupNonUniformFMul</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>GroupNonUniformArithmetic</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>sub_&#8203;group_&#8203;non_&#8203;uniform_&#8203;scan_&#8203;exclusive_&#8203;min</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>OpGroupNonUniformSMin</strong>, <strong>OpGroupNonUniformUMin</strong>, <strong>OpGroupNonUniformFMin</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>GroupNonUniformArithmetic</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>sub_&#8203;group_&#8203;non_&#8203;uniform_&#8203;&#8203;scan_&#8203;exclusive_&#8203;max</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>OpGroupNonUniformSMax</strong>, <strong>OpGroupNonUniformUMax</strong>, <strong>OpGroupNonUniformFMax</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>GroupNonUniformArithmetic</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>sub_&#8203;group_&#8203;non_&#8203;uniform_&#8203;&#8203;scan_&#8203;exclusive_&#8203;and</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>OpGroupNonUniformBitwiseAnd</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>GroupNonUniformArithmetic</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>sub_&#8203;group_&#8203;non_&#8203;uniform_&#8203;&#8203;scan_&#8203;exclusive_&#8203;or</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>OpGroupNonUniformBitwiseOr</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>GroupNonUniformArithmetic</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>sub_&#8203;group_&#8203;non_&#8203;uniform_&#8203;&#8203;scan_&#8203;exclusive_&#8203;xor</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>OpGroupNonUniformBitwiseXor</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>GroupNonUniformArithmetic</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>sub_&#8203;group_&#8203;non_&#8203;uniform_&#8203;&#8203;scan_&#8203;exclusive_&#8203;logical_&#8203;and</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>OpGroupNonUniformLogicalAnd</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>GroupNonUniformArithmetic</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>sub_&#8203;group_&#8203;non_&#8203;uniform_&#8203;&#8203;scan_&#8203;exclusive_&#8203;logical_&#8203;or</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>OpGroupNonUniformLogicalOr</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>GroupNonUniformArithmetic</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>sub_&#8203;group_&#8203;non_&#8203;uniform_&#8203;&#8203;scan_&#8203;exclusive_&#8203;logical_&#8203;xor</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>OpGroupNonUniformLogicalXor</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>GroupNonUniformArithmetic</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top" colspan="3"><p class="tableblock">For <code>cl_khr_subgroup_shuffle</code>:</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>sub_&#8203;group_&#8203;shuffle</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>OpGroupNonUniformShuffle</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>GroupNonUniformShuffle</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>sub_&#8203;group_&#8203;shuffle_&#8203;xor</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>OpGroupNonUniformShuffleXor</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>GroupNonUniformShuffle</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top" colspan="3"><p class="tableblock">For <code>cl_khr_subgroup_shuffle_relative</code>:</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>sub_&#8203;group_&#8203;shuffle_&#8203;up</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>OpGroupNonUniformShuffleUp</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>GroupNonUniformShuffleRelative</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>sub_&#8203;group_&#8203;shuffle_&#8203;down</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>OpGroupNonUniformShuffleDown</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>GroupNonUniformShuffleRelative</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top" colspan="3"><p class="tableblock">For <code>cl_khr_subgroup_clustered_reduce</code>:</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>sub_&#8203;group_&#8203;clustered_&#8203;reduce_&#8203;add</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>OpGroupNonUniformIAdd</strong>, <strong>OpGroupNonUniformFAdd</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>GroupNonUniformClustered</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>sub_&#8203;group_&#8203;clustered_&#8203;reduce_&#8203;mul</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>OpGroupNonUniformIMul</strong>, <strong>OpGroupNonUniformFMul</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>GroupNonUniformClustered</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>sub_&#8203;group_&#8203;clustered_&#8203;reduce_&#8203;min</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>OpGroupNonUniformSMin</strong>, <strong>OpGroupNonUniformUMin</strong>, <strong>OpGroupNonUniformFMin</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>GroupNonUniformClustered</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>sub_&#8203;group_&#8203;clustered_&#8203;reduce_&#8203;max</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>OpGroupNonUniformSMax</strong>, <strong>OpGroupNonUniformUMax</strong>, <strong>OpGroupNonUniformFMax</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>GroupNonUniformClustered</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>sub_&#8203;group_&#8203;clustered_&#8203;reduce_&#8203;and</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>OpGroupNonUniformBitwiseAnd</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>GroupNonUniformClustered</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>sub_&#8203;group_&#8203;clustered_&#8203;reduce_&#8203;or</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>OpGroupNonUniformBitwiseOr</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>GroupNonUniformClustered</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>sub_&#8203;group_&#8203;clustered_&#8203;reduce_&#8203;xor</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>OpGroupNonUniformBitwiseXor</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>GroupNonUniformClustered</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>sub_&#8203;group_&#8203;clustered_&#8203;reduce_&#8203;logical_&#8203;and</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>OpGroupNonUniformLogicalAnd</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>GroupNonUniformClustered</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>sub_&#8203;group_&#8203;clustered_&#8203;reduce_&#8203;logical_&#8203;or</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>OpGroupNonUniformLogicalOr</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>GroupNonUniformClustered</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>sub_&#8203;group_&#8203;clustered_&#8203;reduce_&#8203;logical_&#8203;xor</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>OpGroupNonUniformLogicalXor</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>GroupNonUniformClustered</strong></p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="cl_khr_pci_bus_info"><a class="anchor" href="#cl_khr_pci_bus_info"></a>39. PCI Bus Information Query</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This extension adds a new query to obtain PCI bus information about an OpenCL
device.</p>
</div>
<div class="paragraph">
<p>Not all OpenCL devices have PCI bus information, either due to the device not
being connected to the system through a PCI interface or due to platform
specific restrictions and policies. Thus this extension is only expected to be
supported by OpenCL devices which can provide the information.</p>
</div>
<div class="paragraph">
<p>As a consequence, applications should always check for the presence of the
extension string for each individual OpenCL device for which they intend to
issue the new query for and should not have any assumptions about the
availability of the extension on any given platform.</p>
</div>
<div class="sect2">
<h3 id="_general_information_38"><a class="anchor" href="#_general_information_38"></a>39.1. General information</h3>
<div class="sect3">
<h4 id="_name_strings_2"><a class="anchor" href="#_name_strings_2"></a>39.1.1. Name Strings</h4>
<div class="paragraph">
<p><code>cl_khr_pci_bus_info</code></p>
</div>
</div>
<div class="sect3">
<h4 id="_version_history_38"><a class="anchor" href="#_version_history_38"></a>39.1.2. Version History</h4>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 60%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><strong>Date</strong></th>
<th class="tableblock halign-left valign-top"><strong>Version</strong></th>
<th class="tableblock halign-left valign-top"><strong>Description</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">2021-04-19</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.0.0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Initial version.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="_dependencies_2"><a class="anchor" href="#_dependencies_2"></a>39.1.3. Dependencies</h4>
<div class="paragraph">
<p>This extension is written against the OpenCL API Specification Version V3.0.6.</p>
</div>
<div class="paragraph">
<p>This extension requires OpenCL 1.0.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_new_api_types_3"><a class="anchor" href="#_new_api_types_3"></a>39.2. New API Types</h3>
<div class="paragraph">
<p>Structure returned by the device info query for <code>CL_DEVICE_<wbr>PCI_<wbr>BUS_<wbr>INFO_<wbr>KHR</code>:</p>
</div>
<div id="cl_device_pci_bus_info_khr" class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="opencl"><span class="k">typedef</span> <span class="k">struct</span> <span class="nc">cl_device_pci_bus_info_khr</span> <span class="p">{</span>
    <span class="kt">cl_uint</span>    <span class="n">pci_domain</span><span class="p">;</span>
    <span class="kt">cl_uint</span>    <span class="n">pci_bus</span><span class="p">;</span>
    <span class="kt">cl_uint</span>    <span class="n">pci_device</span><span class="p">;</span>
    <span class="kt">cl_uint</span>    <span class="n">pci_function</span><span class="p">;</span>
<span class="p">}</span> <span class="kt">cl_device_pci_bus_info_khr</span><span class="p">;</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_new_api_enums_2"><a class="anchor" href="#_new_api_enums_2"></a>39.3. New API Enums</h3>
<div class="paragraph">
<p>Accepted value for the <em>param_name</em> parameter to <strong>clGetDeviceInfo</strong>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="opencl"><span class="cp">#define CL_DEVICE_PCI_BUS_INFO_KHR  0x410F</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_modifications_to_the_opencl_api_specification_2"><a class="anchor" href="#_modifications_to_the_opencl_api_specification_2"></a>39.4. Modifications to the OpenCL API Specification</h3>
<div class="sect3">
<h4 id="_section_4_2_querying_devices"><a class="anchor" href="#_section_4_2_querying_devices"></a>39.4.1. Section 4.2 - Querying Devices:</h4>
<div class="paragraph">
<p>Add to Table 5 - OpenCL Device Queries:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 5. OpenCL Device Queries</caption>
<colgroup>
<col style="width: 30%;">
<col style="width: 20%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">DeviceInfo</th>
<th class="tableblock halign-left valign-top">Return Type</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CL_DEVICE_<wbr>PCI_<wbr>BUS_<wbr>INFO_<wbr>KHR</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>cl_device_<wbr>pci_<wbr>bus_<wbr>info_<wbr>khr</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Returns PCI bus information for the device.</p>
<p class="tableblock">      The PCI bus information is returned as a single structure that includes
      the PCI bus domain, the PCI bus identifier, the PCI device identifier, and
      the PCI device function identifier.</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="cl_khr_extended_bit_ops"><a class="anchor" href="#cl_khr_extended_bit_ops"></a>40. Extended Bit Operations</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This extension adds OpenCL C functions for performing extended bit operations.
Specifically, the following functions are added:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>bitfield insert: insert bits from one source operand into another source operand.</p>
</li>
<li>
<p>bitfield extract: extract bits from a source operand, with sign- or zero-extension.</p>
</li>
<li>
<p>bit reverse: reverse the bits of a source operand.</p>
</li>
</ul>
</div>
<div class="sect2">
<h3 id="_general_information_39"><a class="anchor" href="#_general_information_39"></a>40.1. General Information</h3>
<div class="sect3">
<h4 id="_name_strings_3"><a class="anchor" href="#_name_strings_3"></a>40.1.1. Name Strings</h4>
<div class="paragraph">
<p><code>cl_khr_extended_bit_ops</code></p>
</div>
</div>
<div class="sect3">
<h4 id="_version_history_39"><a class="anchor" href="#_version_history_39"></a>40.1.2. Version History</h4>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 60%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><strong>Date</strong></th>
<th class="tableblock halign-left valign-top"><strong>Version</strong></th>
<th class="tableblock halign-left valign-top"><strong>Description</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">2021-04-22</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.0.0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Initial version.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="_dependencies_3"><a class="anchor" href="#_dependencies_3"></a>40.1.3. Dependencies</h4>
<div class="paragraph">
<p>This extension is written against the OpenCL 3.0 C Language Specification and the OpenCL SPIR-V Environment Specification Version V3.0.6.</p>
</div>
<div class="paragraph">
<p>This extension requires OpenCL 1.0.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_new_opencl_c_functions"><a class="anchor" href="#_new_opencl_c_functions"></a>40.2. New OpenCL C Functions</h3>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="opencl_c"><span class="kp">gentype</span> <span class="n">bitfield_insert</span><span class="p">(</span> <span class="kp">gentype</span> <span class="n">base</span><span class="p">,</span> <span class="kp">gentype</span> <span class="n">insert</span><span class="p">,</span> <span class="kt">uint</span> <span class="n">offset</span><span class="p">,</span> <span class="kt">uint</span> <span class="n">count</span> <span class="p">)</span>
<span class="kp">igentype</span> <span class="n">bitfield_extract_signed</span><span class="p">(</span> <span class="kp">gentype</span> <span class="n">base</span><span class="p">,</span> <span class="kt">uint</span> <span class="n">offset</span><span class="p">,</span> <span class="kt">uint</span> <span class="n">count</span> <span class="p">)</span>
<span class="kp">ugentype</span> <span class="n">bitfield_extract_unsigned</span><span class="p">(</span> <span class="kp">gentype</span> <span class="n">base</span><span class="p">,</span> <span class="kt">uint</span> <span class="n">offset</span><span class="p">,</span> <span class="kt">uint</span> <span class="n">count</span> <span class="p">)</span>
<span class="kp">gentype</span> <span class="n">bit_reverse</span><span class="p">(</span> <span class="kp">gentype</span> <span class="n">base</span> <span class="p">)</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_modifications_to_the_opencl_c_specification"><a class="anchor" href="#_modifications_to_the_opencl_c_specification"></a>40.3. Modifications to the OpenCL C Specification</h3>
<div class="sect3">
<h4 id="_modify_section_6_15_3_integer_functions"><a class="anchor" href="#_modify_section_6_15_3_integer_functions"></a>40.3.1. Modify Section 6.15.3. Integer Functions:</h4>
<div class="dlist">
<dl>
<dt class="hdlist1">Add a new Section 6.15.3.X. Extended Bit Operations: </dt>
<dd>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The functions described in the following table can be used with built-in scalar or vector integer types to perform extended bit operations.
The functions that operate on vector types operate component-wise.
The description is per-component.</p>
</div>
<div class="paragraph">
<p>In the table below, the generic type name <code>gentype</code> refers to the built-in integer types <code>char</code>, <code>char<em>n</em></code>, <code>uchar</code>, <code>uchar<em>n</em></code>, <code>short</code>, <code>short<em>n</em></code>, <code>ushort</code>, <code>ushort<em>n</em></code>, <code>int</code>, <code>int<em>n</em></code>, <code>uint</code>, <code>uint<em>n</em></code>, <code>long</code>, <code>long<em>n</em></code>, <code>ulong</code>, and <code>ulong<em>n</em></code>.
The generic type name <code>igentype</code> refers to the built-in signed integer types <code>char</code>, <code>char<em>n</em></code>, <code>short</code>, <code>short<em>n</em></code>, <code>int</code>, <code>int<em>n</em></code>, <code>long</code>, and <code>long<em>n</em></code>.
The generic type name <code>ugentype</code> refers to the built-in unsigned integer types <code>uchar</code>, <code>uchar<em>n</em></code>, <code>ushort</code>, <code>ushort<em>n</em></code>, <code>uint</code>, <code>uint<em>n</em></code>, <code>ulong</code>, and <code>ulong<em>n</em></code>.
<em>n</em> is 2, 3, 4, 8, or 16.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 53. Built-in Scalar and Vector Extended Bit Operations</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><strong>Function</strong></th>
<th class="tableblock halign-left valign-top"><strong>Description</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="opencl_c"><span class="kp">gentype</span> <span class="n">bitfield_insert</span><span class="p">(</span>
    <span class="kp">gentype</span> <span class="n">base</span><span class="p">,</span> <span class="kp">gentype</span> <span class="n">insert</span><span class="p">,</span>
    <span class="kt">uint</span> <span class="n">offset</span><span class="p">,</span> <span class="kt">uint</span> <span class="n">count</span><span class="p">)</span></code></pre>
</div>
</div></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Returns a copy of <em>base</em>, with a modified bitfield that comes from <em>insert</em>.</p>
<p class="tableblock">Any bits of the result value numbered outside [<em>offset</em>, <em>offset</em> + <em>count</em> - 1] (inclusive) will come from the corresponding bits in <em>base</em>.</p>
<p class="tableblock">Any bits of the result value numbered inside [<em>offset</em>, <em>offset</em> + <em>count</em> - 1] (inclusive) will come from the bits numbered [0, <em>count</em> - 1] (inclusive) of <em>insert</em>.</p>
<p class="tableblock"><em>count</em> is the number of bits to be modified.
If <em>count</em> equals 0, the return value will be equal to <em>base</em>.</p>
<p class="tableblock">If <em>count</em> or <em>offset</em> or <em>offset</em> + <em>count</em> is greater than number of bits in <code>gentype</code> (for scalar types) or components of <code>gentype</code> (for vector types), the result is undefined.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="opencl_c"><span class="kp">igentype</span> <span class="n">bitfield_extract_signed</span><span class="p">(</span>
    <span class="kp">gentype</span> <span class="n">base</span><span class="p">,</span>
    <span class="kt">uint</span> <span class="n">offset</span><span class="p">,</span> <span class="kt">uint</span> <span class="n">count</span><span class="p">)</span></code></pre>
</div>
</div></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Returns an extracted bitfield from <em>base</em> with sign extension.
The type of the return value is always a signed type.</p>
<p class="tableblock">The bits of <em>base</em> numbered in [<em>offset</em>, <em>offset</em> + <em>count</em> - 1] (inclusive) are returned as the bits numbered in [0, <em>count</em> - 1] (inclusive) of the result.
The remaining bits in the result will be sign extended by replicating the bit numbered <em>offset</em> + <em>count</em> - 1 of <em>base</em>.</p>
<p class="tableblock"><em>count</em> is the number of bits to be extracted.
If <em>count</em> equals 0, the result is 0.</p>
<p class="tableblock">If the <em>count</em> or <em>offset</em> or <em>offset</em> + <em>count</em> is greater than number of bits in <code>gentype</code> (for scalar types) or components of <code>gentype</code> (for vector types), the result is undefined.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="opencl_c"><span class="kp">ugentype</span> <span class="n">bitfield_extract_unsigned</span><span class="p">(</span>
    <span class="kp">gentype</span> <span class="n">base</span><span class="p">,</span>
    <span class="kt">uint</span> <span class="n">offset</span><span class="p">,</span> <span class="kt">uint</span> <span class="n">count</span><span class="p">)</span></code></pre>
</div>
</div></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Returns an extracted bitfield from <em>base</em> with zero extension.
The type of the return value is always an unsigned type.</p>
<p class="tableblock">The bits of <em>base</em> numbered in [<em>offset</em>, <em>offset</em> + <em>count</em> - 1] (inclusive) are returned as the bits numbered in [0, <em>count</em> - 1] (inclusive) of the result.
The remaining bits in the result will be zero.</p>
<p class="tableblock"><em>count</em> is the number of bits to be extracted.
If <em>count</em> equals 0, the result is 0.</p>
<p class="tableblock">If the <em>count</em> or <em>offset</em> or <em>offset</em> + <em>count</em> is greater than number of bits in <code>gentype</code> (for scalar types) or components of <code>gentype</code> (for vector types), the result is undefined.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="opencl_c"><span class="kp">gentype</span> <span class="n">bit_reverse</span><span class="p">(</span>
    <span class="kp">gentype</span> <span class="n">base</span><span class="p">)</span></code></pre>
</div>
</div></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Returns the value of <em>base</em> with reversed bits.
That is, the bit numbered <em>n</em> of the result value will be taken from the bit numbered <em>width</em> - <em>n</em> - 1 of <em>base</em> (for scalar types) or a component of <em>base</em> (for vector types), where <em>width</em> is number of bits of <code>gentype</code> (for scalar types) or components of <code>gentype</code> (for vector types).</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</dd>
</dl>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="cl_khr_suggested_local_work_size"><a class="anchor" href="#cl_khr_suggested_local_work_size"></a>41. Suggested Local Work Size Query</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This extension adds the ability to query a suggested local work group size for a kernel running on a device for a specified global work size and global work offset.
The suggested local work group size will match the work group size that would be chosen if the kernel were enqueued with the specified global work size and global work offset and a <code>NULL</code> local work size.</p>
</div>
<div class="paragraph">
<p>By using the suggested local work group size query an application has greater insight into the local work group size chosen by the OpenCL implementation, and the OpenCL implementation need not re-compute the local work group size if the same kernel is enqueued multiple times with the same parameters.</p>
</div>
<div class="sect2">
<h3 id="_general_information_40"><a class="anchor" href="#_general_information_40"></a>41.1. General Information</h3>
<div class="sect3">
<h4 id="_name_strings_4"><a class="anchor" href="#_name_strings_4"></a>41.1.1. Name Strings</h4>
<div class="paragraph">
<p><code>cl_khr_suggested_local_work_size</code></p>
</div>
</div>
<div class="sect3">
<h4 id="_version_history_40"><a class="anchor" href="#_version_history_40"></a>41.1.2. Version History</h4>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 60%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><strong>Date</strong></th>
<th class="tableblock halign-left valign-top"><strong>Version</strong></th>
<th class="tableblock halign-left valign-top"><strong>Description</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">2021-04-22</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.0.0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Initial version.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="_dependencies_4"><a class="anchor" href="#_dependencies_4"></a>41.1.3. Dependencies</h4>
<div class="paragraph">
<p>This extension is written against the OpenCL API Specification Version V3.0.6.</p>
</div>
<div class="paragraph">
<p>This extension requires OpenCL 1.0.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_new_api_functions_2"><a class="anchor" href="#_new_api_functions_2"></a>41.2. New API Functions</h3>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="opencl"><span class="kt">cl_int</span>  <span class="nf">clGetKernelSuggestedLocalWorkSizeKHR</span><span class="p">(</span>
    <span class="kt">cl_command_queue</span> <span class="n">command_queue</span><span class="p">,</span>
    <span class="kt">cl_kernel</span> <span class="n">kernel</span><span class="p">,</span>
    <span class="kt">cl_uint</span> <span class="n">work_dim</span><span class="p">,</span>
    <span class="k">const</span> <span class="kt">size_t</span> <span class="o">*</span><span class="n">global_work_offset</span><span class="p">,</span>
    <span class="k">const</span> <span class="kt">size_t</span> <span class="o">*</span><span class="n">global_work_size</span><span class="p">,</span>
    <span class="kt">size_t</span> <span class="o">*</span><span class="n">suggested_local_work_size</span><span class="p">);</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_modifications_to_the_opencl_api_specification_3"><a class="anchor" href="#_modifications_to_the_opencl_api_specification_3"></a>41.3. Modifications to the OpenCL API Specification</h3>
<div class="sect3">
<h4 id="_section_5_9_kernel_objects"><a class="anchor" href="#_section_5_9_kernel_objects"></a>41.3.1. Section 5.9 - Kernel Objects:</h4>
<div class="sect4">
<h5 id="_new_section_5_9_4_x_suggested_local_work_size_query"><a class="anchor" href="#_new_section_5_9_4_x_suggested_local_work_size_query"></a>41.3.1.1. New Section 5.9.4.X - Suggested Local Work Size Query</h5>
<div class="paragraph">
<p>To query a suggested local work size for a kernel object, call the function</p>
</div>
<div id="clGetKernelSuggestedLocalWorkSizeKHR" class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="opencl"><span class="kt">cl_int</span> <span class="nf">clGetKernelSuggestedLocalWorkSizeKHR</span><span class="p">(</span>
    <span class="kt">cl_command_queue</span> <span class="n">command_queue</span><span class="p">,</span>
    <span class="kt">cl_kernel</span> <span class="n">kernel</span><span class="p">,</span>
    <span class="kt">cl_uint</span> <span class="n">work_dim</span><span class="p">,</span>
    <span class="k">const</span> <span class="kt">size_t</span><span class="o">*</span> <span class="n">global_work_offset</span><span class="p">,</span>
    <span class="k">const</span> <span class="kt">size_t</span><span class="o">*</span> <span class="n">global_work_size</span><span class="p">,</span>
    <span class="kt">size_t</span><span class="o">*</span> <span class="n">suggested_local_work_size</span><span class="p">);</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The returned suggested local work size is expected to match the local work size that would be chosen if the specified kernel object, with the same kernel arguments, were enqueued into the specified command queue with the specified global work size, specified global work offset, and with a <code>NULL</code> local work size.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><em>command_queue</em> specifies the command queue and device for the query.</p>
</li>
<li>
<p><em>kernel</em> specifies the kernel object and kernel arguments for the query.
The OpenCL context associated with <em>kernel</em> and <em>command_queue</em> must the same.</p>
</li>
<li>
<p><em>work_dim</em> specifies the number of work dimensions in the input global work offset and global work size, and the output suggested local work size.</p>
</li>
<li>
<p><em>global_work_offset</em> can be used to specify an array of at least <em>work_dim</em> global ID offset values for the query.
This is optional and may be <code>NULL</code> to indicate there is no global ID offset.</p>
</li>
<li>
<p><em>global_work_size</em> is an array of at least <em>work_dim</em> values describing the global work size for the query.</p>
</li>
<li>
<p><em>suggested_local_work_size</em> is an output array of at least <em>work_dim</em> values that will contain the result of the query.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>clGetKernelSuggestedLocalWorkSizeKHR</strong> returns <code>CL_SUCCESS</code> if the query executed successfully.
Otherwise, it returns one of the following errors:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>CL_INVALID_<wbr>COMMAND_<wbr>QUEUE</code> if <em>command_queue</em> is not a valid host command queue.</p>
</li>
<li>
<p><code>CL_INVALID_<wbr>KERNEL</code> if <em>kernel</em> is not a valid kernel object.</p>
</li>
<li>
<p><code>CL_INVALID_<wbr>CONTEXT</code> if the context associated with <em>kernel</em> is not the same as the context associated with <em>command_queue</em>.</p>
</li>
<li>
<p><code>CL_INVALID_<wbr>PROGRAM_<wbr>EXECUTABLE</code> if there is no successfully built program executable available for <em>kernel</em> for the device associated with <em>command_queue</em>.</p>
</li>
<li>
<p><code>CL_INVALID_<wbr>KERNEL_<wbr>ARGS</code> if all argument values for <em>kernel</em> have not been set.</p>
</li>
<li>
<p><code>CL_MISALIGNED_<wbr>SUB_<wbr>BUFFER_<wbr>OFFSET</code> if a sub-buffer object is set as an argument to <em>kernel</em> and the offset specified when the sub-buffer object was created is not aligned to <code>CL_DEVICE_<wbr>MEM_<wbr>BASE_<wbr>ADDR_<wbr>ALIGN</code> for the device associated with <em>command_queue</em>.</p>
</li>
<li>
<p><code>CL_INVALID_<wbr>IMAGE_<wbr>SIZE</code> if an image object is set as an argument to <em>kernel</em> and the image dimensions are not supported by device associated with <em>command_queue</em>.</p>
</li>
<li>
<p><code>CL_IMAGE_<wbr>FORMAT_<wbr>NOT_<wbr>SUPPORTED</code> if an image object is set as an argument to <em>kernel</em> and the image format is not supported by the device associated with <em>command_queue</em>.</p>
</li>
<li>
<p><code>CL_INVALID_<wbr>OPERATION</code> if an SVM pointer is set as an argument to <em>kernel</em> and the device associated with <em>command_queue</em> does not support SVM or the required SVM capabilities for the SVM pointer.</p>
</li>
<li>
<p><code>CL_INVALID_<wbr>WORK_<wbr>DIMENSION</code> if <em>work_dim</em> is not a valid value (i.e. a value between 1 and <code>CL_DEVICE_<wbr>MAX_<wbr>WORK_<wbr>ITEM_<wbr>DIMENSIONS</code>).</p>
</li>
<li>
<p><code>CL_INVALID_<wbr>GLOBAL_<wbr>WORK_<wbr>SIZE</code> if <em>global_work_size</em> is NULL or if any of the values specified in <em>global_work_size</em> are 0.</p>
</li>
<li>
<p><code>CL_INVALID_<wbr>GLOBAL_<wbr>WORK_<wbr>SIZE</code> if any of the values specified in <em>global_work_size</em> exceed the maximum value representable by <code>size_t</code> on the device associated with <em>command_queue</em>.</p>
</li>
<li>
<p><code>CL_INVALID_<wbr>GLOBAL_<wbr>OFFSET</code> if the value specified in <em>global_work_size</em> plus the corresponding value in <em>global_work_offset</em> for dimension exceeds the maximum value representable by <code>size_t</code> on the device associated with <em>command_queue</em>.</p>
</li>
<li>
<p><code>CL_INVALID_<wbr>VALUE</code> if <em>suggested_local_work_size</em> is NULL.</p>
</li>
<li>
<p><code>CL_OUT_<wbr>OF_<wbr>RESOURCES</code> if there is a failure to allocate resources required by the OpenCL implementation on the device.</p>
</li>
<li>
<p><code>CL_OUT_<wbr>OF_<wbr>HOST_<wbr>MEMORY</code> if there is a failure to allocate resources required by the OpenCL implementation on the host.</p>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
These error conditions are consistent with error conditions for <strong>clEnqueueNDRangeKernel</strong>.
</td>
</tr>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="cl_khr_integer_dot_product"><a class="anchor" href="#cl_khr_integer_dot_product"></a>42. Integer dot product</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This extension adds support for SPIR-V instructions and OpenCL C built-in
functions to compute the dot product of vectors of integers.</p>
</div>
<div class="sect2">
<h3 id="_general_information_41"><a class="anchor" href="#_general_information_41"></a>42.1. General Information</h3>
<div class="sect3">
<h4 id="_name_strings_5"><a class="anchor" href="#_name_strings_5"></a>42.1.1. Name Strings</h4>
<div class="paragraph">
<p><code>cl_khr_integer_dot_product</code></p>
</div>
</div>
<div class="sect3">
<h4 id="_version_history_41"><a class="anchor" href="#_version_history_41"></a>42.1.2. Version History</h4>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 60%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><strong>Date</strong></th>
<th class="tableblock halign-left valign-top"><strong>Version</strong></th>
<th class="tableblock halign-left valign-top"><strong>Description</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">2021-06-23</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2.0.0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">All 8-bit support is mandatory, added 8-bit acceleration properties.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">2021-06-17</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.0.0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Initial version.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="_dependencies_5"><a class="anchor" href="#_dependencies_5"></a>42.1.3. Dependencies</h4>
<div class="paragraph">
<p>This extension is written against the OpenCL Specification Version 3.0.6,
and OpenCL C Specification Version 3.0.6 and OpenCL Environment Specification
Version 3.0.6.</p>
</div>
<div class="paragraph">
<p>This extension requires OpenCL 1.0.</p>
</div>
</div>
<div class="sect3">
<h4 id="_contributors_2"><a class="anchor" href="#_contributors_2"></a>42.1.4. Contributors</h4>
<div class="paragraph">
<p>Kvin Petit, Arm Ltd.<br>
Jeremy Kemp, Imagination Technologies<br>
Ben Ashbaugh, Intel<br>
Ruihao Zhang, Qualcomm<br>
Stuart Brady, Arm Ltd<br>
Balaji Calidas, Qualcomm<br>
Ayal Zaks, Intel<br></p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_new_api_enums_3"><a class="anchor" href="#_new_api_enums_3"></a>42.2. New API Enums</h3>
<div class="paragraph">
<p>Accepted value for the <em>param_name</em> parameter to <strong>clGetDeviceInfo</strong>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="opencl"><span class="n">CL_DEVICE_INTEGER_DOT_PRODUCT_INPUT_4x8BIT_PACKED_KHR</span>      <span class="p">(</span><span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="mi">0</span><span class="p">)</span>
<span class="n">CL_DEVICE_INTEGER_DOT_PRODUCT_INPUT_4x8BIT_KHR</span>             <span class="p">(</span><span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="mi">1</span><span class="p">)</span>

<span class="n">CL_DEVICE_INTEGER_DOT_PRODUCT_CAPABILITIES_KHR</span>              <span class="mh">0x1073</span>

<span class="n">CL_DEVICE_INTEGER_DOT_PRODUCT_ACCELERATION_PROPERTIES_8BIT_KHR</span>           <span class="mh">0x1074</span>
<span class="n">CL_DEVICE_INTEGER_DOT_PRODUCT_ACCELERATION_PROPERTIES_4x8BIT_PACKED_KHR</span>  <span class="mh">0x1075</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_new_opencl_c_functions_2"><a class="anchor" href="#_new_opencl_c_functions_2"></a>42.3. New OpenCL C Functions</h3>
<div class="paragraph">
<p>This extension defines a number of new functions that operate on vectors
of integers. The exact function overloads available depend on the features
supported by the target device.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="opencl_c"><span class="kt">uint</span> <span class="nf">dot</span><span class="p">(</span><span class="kt">uchar4</span> <span class="n">a</span><span class="p">,</span> <span class="kt">uchar4</span> <span class="n">b</span><span class="p">);</span>
<span class="kt">int</span> <span class="nf">dot</span><span class="p">(</span><span class="kt">char4</span> <span class="n">a</span><span class="p">,</span> <span class="kt">char4</span> <span class="n">b</span><span class="p">);</span>
<span class="kt">int</span> <span class="nf">dot</span><span class="p">(</span><span class="kt">uchar4</span> <span class="n">a</span><span class="p">,</span> <span class="kt">char4</span> <span class="n">b</span><span class="p">);</span>
<span class="kt">int</span> <span class="nf">dot</span><span class="p">(</span><span class="kt">char4</span> <span class="n">a</span><span class="p">,</span> <span class="kt">uchar4</span> <span class="n">b</span><span class="p">);</span>

<span class="kt">uint</span> <span class="nf">dot_acc_sat</span><span class="p">(</span><span class="kt">uchar4</span> <span class="n">a</span><span class="p">,</span> <span class="kt">uchar4</span> <span class="n">b</span><span class="p">,</span> <span class="kt">uint</span> <span class="n">acc</span><span class="p">);</span>
<span class="kt">int</span> <span class="nf">dot_acc_sat</span><span class="p">(</span><span class="kt">char4</span> <span class="n">a</span><span class="p">,</span> <span class="kt">char4</span> <span class="n">b</span><span class="p">,</span> <span class="kt">int</span> <span class="n">acc</span><span class="p">);</span>
<span class="kt">int</span> <span class="nf">dot_acc_sat</span><span class="p">(</span><span class="kt">uchar4</span> <span class="n">a</span><span class="p">,</span> <span class="kt">char4</span> <span class="n">b</span><span class="p">,</span> <span class="kt">int</span> <span class="n">acc</span><span class="p">);</span>
<span class="kt">int</span> <span class="nf">dot_acc_sat</span><span class="p">(</span><span class="kt">char4</span> <span class="n">a</span><span class="p">,</span> <span class="kt">uchar4</span> <span class="n">b</span><span class="p">,</span> <span class="kt">int</span> <span class="n">acc</span><span class="p">);</span>

<span class="kt">uint</span> <span class="nf">dot_4x8packed_uu_uint</span><span class="p">(</span><span class="kt">uint</span> <span class="n">a</span><span class="p">,</span> <span class="kt">uint</span> <span class="n">b</span><span class="p">);</span>
<span class="kt">int</span> <span class="nf">dot_4x8packed_ss_int</span><span class="p">(</span><span class="kt">uint</span> <span class="n">a</span><span class="p">,</span> <span class="kt">uint</span> <span class="n">b</span><span class="p">);</span>
<span class="kt">int</span> <span class="nf">dot_4x8packed_us_int</span><span class="p">(</span><span class="kt">uint</span> <span class="n">a</span><span class="p">,</span> <span class="kt">uint</span> <span class="n">b</span><span class="p">);</span>
<span class="kt">int</span> <span class="nf">dot_4x8packed_su_int</span><span class="p">(</span><span class="kt">uint</span> <span class="n">a</span><span class="p">,</span> <span class="kt">uint</span> <span class="n">b</span><span class="p">);</span>

<span class="kt">uint</span> <span class="nf">dot_acc_sat_4x8packed_uu_uint</span><span class="p">(</span><span class="kt">uint</span> <span class="n">a</span><span class="p">,</span> <span class="kt">uint</span> <span class="n">b</span><span class="p">,</span> <span class="kt">uint</span> <span class="n">acc</span><span class="p">);</span>
<span class="kt">int</span> <span class="nf">dot_acc_sat_4x8packed_ss_int</span><span class="p">(</span><span class="kt">uint</span> <span class="n">a</span><span class="p">,</span> <span class="kt">uint</span> <span class="n">b</span><span class="p">,</span> <span class="kt">int</span> <span class="n">acc</span><span class="p">);</span>
<span class="kt">int</span> <span class="nf">dot_acc_sat_4x8packed_us_int</span><span class="p">(</span><span class="kt">uint</span> <span class="n">a</span><span class="p">,</span> <span class="kt">uint</span> <span class="n">b</span><span class="p">,</span> <span class="kt">int</span> <span class="n">acc</span><span class="p">);</span>
<span class="kt">int</span> <span class="nf">dot_acc_sat_4x8packed_su_int</span><span class="p">(</span><span class="kt">uint</span> <span class="n">a</span><span class="p">,</span> <span class="kt">uint</span> <span class="n">b</span><span class="p">,</span> <span class="kt">int</span> <span class="n">acc</span><span class="p">);</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_modifications_to_the_opencl_api_specification_4"><a class="anchor" href="#_modifications_to_the_opencl_api_specification_4"></a>42.4. Modifications to the OpenCL API Specification</h3>
<div class="dlist">
<dl>
<dt class="hdlist1">(Modify Section 4.2, <strong>Querying Devices</strong>) </dt>
<dd>
<div class="openblock">
<div class="content">
<div class="dlist">
<dl>
<dt class="hdlist1">(Add the following to Table 4.3, <em>Device Queries</em>) </dt>
</dl>
</div>
</div>
</div>
</dd>
</dl>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Device Info</th>
<th class="tableblock halign-left valign-top">Return Type</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CL_DEVICE_<wbr>INTEGER_<wbr>DOT_<wbr>PRODUCT_<wbr>CAPABILITIES_<wbr>KHR</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>cl_device_<wbr>integer_<wbr>dot_<wbr>product_<wbr>capabilities_<wbr>khr</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Returns the integer dot product capabilities supported by the device.<br>
<br>
<code>CL_DEVICE_<wbr>INTEGER_<wbr>DOT_<wbr>PRODUCT_<wbr>INPUT_<wbr>4x8BIT_<wbr>PACKED_<wbr>KHR</code> is always set
  indicating that all implementations that support <code>cl_khr_integer_dot_product</code>
  must support dot product built-in functions and, when SPIR-V is supported,
  SPIR-V instructions that take four-component vectors of 8-bit integers packed
  into 32-bit integers as input.<br>
<code>CL_DEVICE_<wbr>INTEGER_<wbr>DOT_<wbr>PRODUCT_<wbr>INPUT_<wbr>4x8BIT_<wbr>KHR</code> is set when dot product
  built-in functions and, when SPIR-V is supported, SPIR-V instructions that
  take four-component of 8-bit elements as input are supported.<br>
  NOTE: <code>CL_DEVICE_<wbr>INTEGER_<wbr>DOT_<wbr>PRODUCT_<wbr>INPUT_<wbr>4x8BIT_<wbr>KHR</code> must be set in version
  2.x of the extension.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CL_DEVICE_<wbr>INTEGER_<wbr>DOT_<wbr>PRODUCT_<wbr>ACCELERATION_<wbr>PROPERTIES_<wbr>8BIT_<wbr>KHR</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>cl_device_<wbr>integer_<wbr>dot_<wbr>product_<wbr>acceleration_<wbr>properties_<wbr>khr</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Returns a structure describing the exact 8-bit dot product combinations
  that are <a href="#integer-dot-product-acceleration-properties">accelerated</a> on the device.<br>
  Each member is <code>CL_TRUE</code> if the combination it corresponds to is accelerated,
  <code>CL_FALSE</code> otherwise.<br>
  NOTE: <code>CL_DEVICE_<wbr>INTEGER_<wbr>DOT_<wbr>PRODUCT_<wbr>ACCELERATION_<wbr>PROPERTIES_<wbr>8BIT_<wbr>KHR</code> is missing
  before version 2.0 of the extension.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CL_DEVICE_<wbr>INTEGER_<wbr>DOT_<wbr>PRODUCT_<wbr>ACCELERATION_<wbr>PROPERTIES_<wbr>4x8BIT_<wbr>PACKED_<wbr>KHR</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>cl_device_<wbr>integer_<wbr>dot_<wbr>product_<wbr>acceleration_<wbr>properties_<wbr>khr</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Returns a structure describing the exact 4x8-bit packed dot product combinations
  that are <a href="#integer-dot-product-acceleration-properties">accelerated</a> on the device.<br>
  Each member is <code>CL_TRUE</code> if the combination it corresponds to is accelerated,
  <code>CL_FALSE</code> otherwise.<br>
  NOTE: <code>CL_DEVICE_<wbr>INTEGER_<wbr>DOT_<wbr>PRODUCT_<wbr>ACCELERATION_<wbr>PROPERTIES_<wbr>4x8BIT_<wbr>PACKED_<wbr>KHR</code> is missing
  before version 2.0 of the extension.</p></td>
</tr>
</tbody>
</table>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>OpenCL 3 devices must report the following feature macros via
<code>CL_DEVICE_<wbr>OPENCL_<wbr>C_<wbr>FEATURES</code> when the corresponding bit is set in the bitfield
returned for <code>CL_DEVICE_<wbr>INTEGER_<wbr>DOT_<wbr>PRODUCT_<wbr>CAPABILITIES_<wbr>KHR</code>:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Feature bit</th>
<th class="tableblock halign-left valign-top">Feature macro</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CL_DEVICE_<wbr>INTEGER_<wbr>DOT_<wbr>PRODUCT_<wbr>INPUT_<wbr>4x8BIT_<wbr>PACKED_<wbr>KHR</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>__opencl_c_integer_dot_product_input_4x8bit_packed</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CL_DEVICE_<wbr>INTEGER_<wbr>DOT_<wbr>PRODUCT_<wbr>INPUT_<wbr>4x8BIT_<wbr>KHR</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>__opencl_c_integer_dot_product_input_4x8bit</code></p></td>
</tr>
</tbody>
</table>
<div id="integer-dot-product-acceleration-properties" class="paragraph">
<p>The <code>cl_device_<wbr>integer_<wbr>dot_<wbr>product_<wbr>acceleration_<wbr>properties_<wbr>khr</code> structure
describes the exact dot product operations that are accelerated on the device:</p>
</div>
<div id="cl_device_integer_dot_product_acceleration_properties_khr" class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="opencl"><span class="k">typedef</span> <span class="k">struct</span> <span class="nc">cl_device_integer_dot_product_acceleration_properties_khr</span> <span class="p">{</span>
    <span class="kt">cl_bool</span>    <span class="n">signed_accelerated</span><span class="p">;</span>
    <span class="kt">cl_bool</span>    <span class="n">unsigned_accelerated</span><span class="p">;</span>
    <span class="kt">cl_bool</span>    <span class="n">mixed_signedness_accelerated</span><span class="p">;</span>
    <span class="kt">cl_bool</span>    <span class="n">accumulating_saturating_signed_accelerated</span><span class="p">;</span>
    <span class="kt">cl_bool</span>    <span class="n">accumulating_saturating_unsigned_accelerated</span><span class="p">;</span>
    <span class="kt">cl_bool</span>    <span class="n">accumulating_saturating_mixed_signedness_accelerated</span><span class="p">;</span>
<span class="p">}</span> <span class="kt">cl_device_integer_dot_product_acceleration_properties_khr</span><span class="p">;</span></code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><em>signed_accelerated</em> is <code>CL_TRUE</code> when signed dot product operations are
accelerated, <code>CL_FALSE</code> otherwise.</p>
</li>
<li>
<p><em>unsigned_accelerated</em> is <code>CL_TRUE</code> when unsigned dot product operations
are accelerated, <code>CL_FALSE</code> otherwise.</p>
</li>
<li>
<p><em>mixed_signedness_accelerated</em> is <code>CL_TRUE</code> when mixed signedness dot
product operations are accelerated, <code>CL_FALSE</code> otherwise.</p>
</li>
<li>
<p><em>accumulating_saturating_signed_accelerated</em> is <code>CL_TRUE</code> when accumulating
saturating signed dot product operations are accelerated, <code>CL_FALSE</code>
otherwise.</p>
</li>
<li>
<p><em>accumulating_saturating_unsigned_accelerated</em> is <code>CL_TRUE</code> when accumulating
saturating unsigned dot product operations are accelerated, <code>CL_FALSE</code>
otherwise.</p>
</li>
<li>
<p><em>accumulating_saturating_mixed_signedness_accelerated</em> is <code>CL_TRUE</code> when
accumulating saturating mixed signedness dot product operations are
accelerated, <code>CL_FALSE</code> otherwise.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>A dot product operation is deemed accelerated if its implementation provides
a performance advantage over application-provided code composed from elementary
instructions and/or other dot product instructions, either because the
implementation uses optimized machine code sequences whose generation from
application-provided code cannot be guaranteed or because it uses hardware
features that cannot otherwise be targeted from application-provided code.</p>
</div>
</div>
</div>
<div class="openblock">
<div class="content">

</div>
</div>
</div>
<div class="sect2">
<h3 id="_modifications_to_the_opencl_c_specification_2"><a class="anchor" href="#_modifications_to_the_opencl_c_specification_2"></a>42.5. Modifications to the OpenCL C Specification</h3>
<div class="dlist">
<dl>
<dt class="hdlist1">(Modify section 6.13.3, <strong>Integer Functions</strong>) </dt>
<dd>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The following built-in functions and preprocessor definitions are added:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="opencl_c"><span class="cp">#define cl_khr_integer_dot_product 1
</span>
<span class="k">if</span> <span class="p">(</span><span class="n">CL_DEVICE_INTEGER_DOT_PRODUCT_INPUT_4x8BIT_PACKED_KHR</span><span class="p">)</span> <span class="p">{</span>
    <span class="cp">#define __opencl_c_integer_dot_product_input_4x8bit_packed 1
</span>
    <span class="kt">uint</span> <span class="n">dot_4x8packed_uu_uint</span><span class="p">(</span><span class="kt">uint</span> <span class="n">a</span><span class="p">,</span> <span class="kt">uint</span> <span class="n">b</span><span class="p">);</span>
    <span class="kt">int</span> <span class="n">dot_4x8packed_ss_int</span><span class="p">(</span><span class="kt">uint</span> <span class="n">a</span><span class="p">,</span> <span class="kt">uint</span> <span class="n">b</span><span class="p">);</span>
    <span class="kt">int</span> <span class="n">dot_4x8packed_us_int</span><span class="p">(</span><span class="kt">uint</span> <span class="n">a</span><span class="p">,</span> <span class="kt">uint</span> <span class="n">b</span><span class="p">);</span>
    <span class="kt">int</span> <span class="n">dot_4x8packed_su_int</span><span class="p">(</span><span class="kt">uint</span> <span class="n">a</span><span class="p">,</span> <span class="kt">uint</span> <span class="n">b</span><span class="p">);</span>

    <span class="kt">uint</span> <span class="n">dot_acc_sat_4x8packed_uu_uint</span><span class="p">(</span><span class="kt">uint</span> <span class="n">a</span><span class="p">,</span> <span class="kt">uint</span> <span class="n">b</span><span class="p">,</span> <span class="kt">uint</span> <span class="n">acc</span><span class="p">);</span>
    <span class="kt">int</span> <span class="n">dot_acc_sat_4x8packed_ss_int</span><span class="p">(</span><span class="kt">uint</span> <span class="n">a</span><span class="p">,</span> <span class="kt">uint</span> <span class="n">b</span><span class="p">,</span> <span class="kt">int</span> <span class="n">acc</span><span class="p">);</span>
    <span class="kt">int</span> <span class="n">dot_acc_sat_4x8packed_us_int</span><span class="p">(</span><span class="kt">uint</span> <span class="n">a</span><span class="p">,</span> <span class="kt">uint</span> <span class="n">b</span><span class="p">,</span> <span class="kt">int</span> <span class="n">acc</span><span class="p">);</span>
    <span class="kt">int</span> <span class="n">dot_acc_sat_4x8packed_su_int</span><span class="p">(</span><span class="kt">uint</span> <span class="n">a</span><span class="p">,</span> <span class="kt">uint</span> <span class="n">b</span><span class="p">,</span> <span class="kt">int</span> <span class="n">acc</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">if</span> <span class="p">(</span><span class="n">CL_DEVICE_INTEGER_DOT_PRODUCT_INPUT_4x8BIT_KHR</span><span class="p">)</span> <span class="p">{</span>
    <span class="cp">#define __opencl_c_integer_dot_product_input_4x8bit 1
</span>
    <span class="kt">uint</span> <span class="n">dot</span><span class="p">(</span><span class="kt">uchar4</span> <span class="n">a</span><span class="p">,</span> <span class="kt">uchar4</span> <span class="n">b</span><span class="p">);</span>
    <span class="kt">int</span> <span class="n">dot</span><span class="p">(</span><span class="kt">char4</span> <span class="n">a</span><span class="p">,</span> <span class="kt">char4</span> <span class="n">b</span><span class="p">);</span>
    <span class="kt">int</span> <span class="n">dot</span><span class="p">(</span><span class="kt">uchar4</span> <span class="n">a</span><span class="p">,</span> <span class="kt">char4</span> <span class="n">b</span><span class="p">);</span>
    <span class="kt">int</span> <span class="n">dot</span><span class="p">(</span><span class="kt">char4</span> <span class="n">a</span><span class="p">,</span> <span class="kt">uchar4</span> <span class="n">b</span><span class="p">);</span>

    <span class="kt">uint</span> <span class="n">dot_acc_sat</span><span class="p">(</span><span class="kt">uchar4</span> <span class="n">a</span><span class="p">,</span> <span class="kt">uchar4</span> <span class="n">b</span><span class="p">,</span> <span class="kt">uint</span> <span class="n">acc</span><span class="p">);</span>
    <span class="kt">int</span> <span class="n">dot_acc_sat</span><span class="p">(</span><span class="kt">char4</span> <span class="n">a</span><span class="p">,</span> <span class="kt">char4</span> <span class="n">b</span><span class="p">,</span> <span class="kt">int</span> <span class="n">acc</span><span class="p">);</span>
    <span class="kt">int</span> <span class="n">dot_acc_sat</span><span class="p">(</span><span class="kt">uchar4</span> <span class="n">a</span><span class="p">,</span> <span class="kt">char4</span> <span class="n">b</span><span class="p">,</span> <span class="kt">int</span> <span class="n">acc</span><span class="p">);</span>
    <span class="kt">int</span> <span class="n">dot_acc_sat</span><span class="p">(</span><span class="kt">char4</span> <span class="n">a</span><span class="p">,</span> <span class="kt">uchar4</span> <span class="n">b</span><span class="p">,</span> <span class="kt">int</span> <span class="n">acc</span><span class="p">);</span>
<span class="p">}</span></code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>dot</code> returns the dot product of the two input vectors <code>a</code> and <code>b</code>. The
components of <code>a</code> and <code>b</code> are sign- or zero-extended to the width of the
destination type and the vectors with extended components are multiplied
component-wise. All the components of the resulting vectors are added
together to form the final result.</p>
</li>
<li>
<p><code>dot_acc_sat</code> returns the saturating addition of the dot product of the two
input vectors <code>a</code> and <code>b</code> and the accumulator <code>acc</code>:</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="opencl"><span class="n">product</span> <span class="o">=</span> <span class="n">dot</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">);</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">add_sat</span><span class="p">(</span><span class="n">product</span><span class="p">,</span> <span class="n">acc</span><span class="p">);</span></code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>dot_*_4x8packed_XY_R</code> returns the dot product of the two vectors packed
into <code>a</code> and <code>b</code> (lowest component in least significant byte). The components
are unpacked, sign- or zero-extended to the width of the destination type before
the multiplications and additions. <code>X</code> represents the signedness of the components
of <code>a</code>, <code>Y</code> that of the components of <code>b</code>. <code>R</code> is the return type.</p>
</li>
</ul>
</div>
</div>
</div>
</dd>
</dl>
</div>
</div>
<div class="sect2">
<h3 id="_modifications_to_the_opencl_spir_v_environment_specification"><a class="anchor" href="#_modifications_to_the_opencl_spir_v_environment_specification"></a>42.6. Modifications to the OpenCL SPIR-V Environment Specification</h3>
<div class="paragraph">
<p>See OpenCL SPIR-V Environment Specification.</p>
</div>
</div>
<div class="sect2">
<h3 id="_interactions_with_other_extensions"><a class="anchor" href="#_interactions_with_other_extensions"></a>42.7. Interactions with Other Extensions</h3>
<div class="paragraph">
<p>If <code>cl_khr_il_program</code> is supported then the SPIR-V environment specification
modifications described above apply.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="cl_khr_semaphore"><a class="anchor" href="#cl_khr_semaphore"></a>43. Semaphores (Provisional)</h2>
<div class="sectionbody">
<div class="paragraph">
<p>OpenCL provides <code>cl_event</code> as a primary mechanism of synchronization between host and device as well as across devices.
While events can be waited on or can be passed as dependencies across work-submissions, they suffer from following limitations:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>They are immutable.</p>
</li>
<li>
<p>They are not reusable.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>This extension introduces a new type of synchronization object to represent semaphores that can be reused, waited on, and signaled multiple times by OpenCL work-submissions.</p>
</div>
<div class="paragraph">
<p>In particular, this extension defines:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>A new type called <code>cl_semaphore_<wbr>khr</code> to represent the semaphore objects.</p>
</li>
<li>
<p>A new type called <code>cl_semaphore_<wbr>properties_<wbr>khr</code> to specify metadata associated with semaphores.</p>
</li>
<li>
<p>Routines to create, retain, and release semaphores.</p>
</li>
<li>
<p>Routines to wait on and signal semaphore objects.</p>
</li>
<li>
<p>Routine to query the properties of semaphore objects.</p>
</li>
</ul>
</div>
<div class="sect2">
<h3 id="_general_information_42"><a class="anchor" href="#_general_information_42"></a>43.1. General Information</h3>
<div class="sect3">
<h4 id="_name_strings_6"><a class="anchor" href="#_name_strings_6"></a>43.1.1. Name Strings</h4>
<div class="paragraph">
<p><code>cl_khr_semaphore</code></p>
</div>
</div>
<div class="sect3">
<h4 id="_version_history_42"><a class="anchor" href="#_version_history_42"></a>43.1.2. Version History</h4>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 60%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><strong>Date</strong></th>
<th class="tableblock halign-left valign-top"><strong>Version</strong></th>
<th class="tableblock halign-left valign-top"><strong>Description</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">2021-09-10</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.9.0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Initial version (provisional).</p></td>
</tr>
</tbody>
</table>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
This is a preview of an OpenCL provisional extension specification that has been Ratified under the Khronos Intellectual Property Framework. It is being made publicly available prior to being uploaded to the Khronos registry to enable review and feedback from the community. If you have feedback please create an issue on <a href="https://github.com/KhronosGroup/OpenCL-Docs/" class="bare">https://github.com/KhronosGroup/OpenCL-Docs/</a>
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_dependencies_6"><a class="anchor" href="#_dependencies_6"></a>43.1.3. Dependencies</h4>
<div class="paragraph">
<p>This extension is written against the OpenCL Specification Version 3.0.8.</p>
</div>
<div class="paragraph">
<p>This extension requires OpenCL 1.2.</p>
</div>
</div>
<div class="sect3">
<h4 id="_contributors_3"><a class="anchor" href="#_contributors_3"></a>43.1.4. Contributors</h4>
<div class="paragraph">
<p>Ajit Hakke-Patil,  NVIDIA<br>
Amit Rao, NVIDIA<br>
Balaji Calidas, QUALCOMM<br>
Ben Ashbaugh, INTEL<br>
Carsten Rohde, NVIDIA<br>
Christoph Kubisch, NVIDIA<br>
Debalina Bhattacharjee, NVIDIA<br>
James Jones,  NVIDIA<br>
Jason Ekstrand, INTEL<br>
Jeremy Kemp, IMAGINATION<br>
Joshua Kelly, QUALCOMM<br>
Karthik Raghavan Ravi, NVIDIA<br>
Kedar Patil, NVIDIA<br>
Kevin Petit, ARM<br>
Nikhil Joshi, NVIDIA<br>
Sharan Ashwathnarayan, NVIDIA<br>
Vivek Kini,  NVIDIA<br></p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_new_types"><a class="anchor" href="#_new_types"></a>43.2. New Types</h3>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="opencl"><span class="k">typedef</span> <span class="k">struct</span> <span class="nc">_cl_semaphore_khr</span><span class="o">*</span> <span class="kt">cl_semaphore_khr</span><span class="p">;</span>

<span class="k">typedef</span> <span class="kt">cl_properties</span> <span class="kt">cl_semaphore_properties_khr</span><span class="p">;</span>
<span class="k">typedef</span> <span class="kt">cl_uint</span> <span class="kt">cl_semaphore_info_khr</span><span class="p">;</span>
<span class="k">typedef</span> <span class="kt">cl_uint</span> <span class="kt">cl_semaphore_type_khr</span><span class="p">;</span>
<span class="k">typedef</span> <span class="kt">cl_ulong</span> <span class="kt">cl_semaphore_payload_khr</span><span class="p">;</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_new_api_functions_3"><a class="anchor" href="#_new_api_functions_3"></a>43.3. New API Functions</h3>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="opencl"><span class="kt">cl_semaphore_khr</span> <span class="nf">clCreateSemaphoreWithPropertiesKHR</span><span class="p">(</span>
    <span class="kt">cl_context</span> <span class="n">context</span><span class="p">,</span>
    <span class="k">const</span> <span class="kt">cl_semaphore_properties_khr</span> <span class="o">*</span><span class="n">sema_props</span><span class="p">,</span>
    <span class="kt">cl_int</span> <span class="o">*</span><span class="n">errcode_ret</span><span class="p">);</span>

<span class="kt">cl_int</span> <span class="nf">clEnqueueWaitSemaphoresKHR</span><span class="p">(</span>
    <span class="kt">cl_command_queue</span> <span class="n">command_queue</span><span class="p">,</span>
    <span class="kt">cl_uint</span> <span class="n">num_sema_objects</span><span class="p">,</span>
    <span class="k">const</span> <span class="kt">cl_semaphore_khr</span> <span class="o">*</span><span class="n">sema_objects</span><span class="p">,</span>
    <span class="k">const</span> <span class="kt">cl_semaphore_payload_khr</span> <span class="o">*</span><span class="n">sema_payload_list</span><span class="p">,</span>
    <span class="kt">cl_uint</span> <span class="n">num_events_in_wait_list</span><span class="p">,</span>
    <span class="k">const</span> <span class="kt">cl_event</span> <span class="o">*</span><span class="n">event_wait_list</span><span class="p">,</span>
    <span class="kt">cl_event</span> <span class="o">*</span><span class="n">event</span><span class="p">);</span>

<span class="kt">cl_int</span> <span class="nf">clEnqueueSignalSemaphoresKHR</span><span class="p">(</span>
    <span class="kt">cl_command_queue</span> <span class="n">command_queue</span><span class="p">,</span>
    <span class="kt">cl_uint</span> <span class="n">num_sema_objects</span><span class="p">,</span>
    <span class="k">const</span> <span class="kt">cl_semaphore_khr</span> <span class="o">*</span><span class="n">sema_objects</span><span class="p">,</span>
    <span class="k">const</span> <span class="kt">cl_semaphore_payload_khr</span> <span class="o">*</span><span class="n">sema_payload_list</span><span class="p">,</span>
    <span class="kt">cl_uint</span> <span class="n">num_events_in_wait_list</span><span class="p">,</span>
    <span class="k">const</span> <span class="kt">cl_event</span> <span class="o">*</span><span class="n">event_wait_list</span><span class="p">,</span>
    <span class="kt">cl_event</span> <span class="o">*</span><span class="n">event</span><span class="p">);</span>

<span class="kt">cl_int</span> <span class="nf">clGetSemaphoreInfoKHR</span><span class="p">(</span>
    <span class="kt">cl_semaphore_khr</span> <span class="n">sema_object</span><span class="p">,</span>
    <span class="kt">cl_semaphore_info_khr</span> <span class="n">param_name</span><span class="p">,</span>
    <span class="kt">size_t</span> <span class="n">param_value_size</span><span class="p">,</span>
    <span class="kt">void</span> <span class="o">*</span><span class="n">param_value</span><span class="p">,</span>
    <span class="kt">size_t</span> <span class="o">*</span><span class="n">param_value_size_ret</span><span class="p">);</span>

<span class="kt">cl_int</span> <span class="nf">clReleaseSemaphoreKHR</span><span class="p">(</span><span class="kt">cl_semaphore_khr</span> <span class="n">sema_object</span><span class="p">);</span>

<span class="kt">cl_int</span> <span class="nf">clRetainSemaphoreKHR</span><span class="p">(</span><span class="kt">cl_semaphore_khr</span> <span class="n">sema_object</span><span class="p">);</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_new_api_enums_4"><a class="anchor" href="#_new_api_enums_4"></a>43.4. New API Enums</h3>
<div class="paragraph">
<p>Accepted value for the <em>param_name</em> parameter to <strong>clGetPlatformInfo</strong> to query the semaphore types supported by an OpenCL platform:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="opencl"><span class="n">CL_PLATFORM_SEMAPHORE_TYPES_KHR</span>                             <span class="mh">0x2036</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Accepted value for the <em>param_name</em> parameter to <strong>clGetDeviceInfo</strong> to query the semaphore types supported by an OpenCL device:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="opencl"><span class="n">CL_DEVICE_SEMAPHORE_TYPES_KHR</span>                               <span class="mh">0x204C</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Semaphore types:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="opencl"><span class="n">CL_SEMAPHORE_TYPE_BINARY_KHR</span>                                <span class="mi">1</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>New attributes that can be passed as part of <code>cl_semaphore_<wbr>info_<wbr>khr</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="opencl"><span class="n">CL_SEMAPHORE_CONTEXT_KHR</span>                                    <span class="mh">0x2039</span>
<span class="n">CL_SEMAPHORE_REFERENCE_COUNT_KHR</span>                            <span class="mh">0x203A</span>
<span class="n">CL_SEMAPHORE_PROPERTIES_KHR</span>                                 <span class="mh">0x203B</span>
<span class="n">CL_SEMAPHORE_PAYLOAD_KHR</span>                                    <span class="mh">0x203C</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>New attributes that can be passed as part of <code>cl_semaphore_<wbr>info_<wbr>khr</code> or <code>cl_semaphore_<wbr>properties_<wbr>khr</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="opencl"><span class="n">CL_SEMAPHORE_TYPE_KHR</span>                                       <span class="mh">0x203D</span>
<span class="n">CL_DEVICE_HANDLE_LIST_KHR</span>                                   <span class="mh">0x2051</span>
<span class="n">CL_DEVICE_HANDLE_LIST_END_KHR</span>                               <span class="mi">0</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>New return values from <strong>clGetEventInfo</strong> when <em>param_name</em> is <code>CL_EVENT_<wbr>COMMAND_<wbr>TYPE</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="opencl"><span class="n">CL_COMMAND_SEMAPHORE_WAIT_KHR</span>                               <span class="mh">0x2042</span>
<span class="n">CL_COMMAND_SEMAPHORE_SIGNAL_KHR</span>                             <span class="mh">0x2043</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The following error codes can be returned by APIs introduced as part of this specification or the specifications that depend on this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="opencl"><span class="n">CL_INVALID_SEMAPHORE_KHR</span>                                    <span class="o">-</span><span class="mi">1142</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_modifications_to_existing_apis_added_by_this_spec"><a class="anchor" href="#_modifications_to_existing_apis_added_by_this_spec"></a>43.5. Modifications to existing APIs added by this spec</h3>
<div class="paragraph">
<p>Following new enums are added to the list of supported <em>param_names</em> by <strong>clGetPlatformInfo</strong>:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 54. List of supported param_names by <strong>clGetPlatformInfo</strong></caption>
<colgroup>
<col style="width: 33%;">
<col style="width: 17%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Platform Info</th>
<th class="tableblock halign-left valign-top">Return Type</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CL_PLATFORM_<wbr>SEMAPHORE_<wbr>TYPES_<wbr>KHR</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>cl_semaphore_<wbr>type_<wbr>khr</code>[]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Returns the list of the semaphore types supported all devices in <em>platform</em>.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><strong>clGetPlatformInfo</strong> when called with <em>param_name</em> <code>CL_PLATFORM_<wbr>SEMAPHORE_<wbr>TYPES_<wbr>KHR</code> must return common list of semaphore types supported by all devices in the platform.</p>
</div>
<div class="paragraph">
<p>Following new enums are added to the list of supported <em>param_names</em> by <strong>clGetDeviceInfo</strong>:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 55. List of supported param_names by <strong>clGetDeviceInfo</strong></caption>
<colgroup>
<col style="width: 33%;">
<col style="width: 17%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Device Info</th>
<th class="tableblock halign-left valign-top">Return Type</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CL_DEVICE_<wbr>SEMAPHORE_<wbr>TYPES_<wbr>KHR</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>cl_semaphore_<wbr>type_<wbr>khr</code>[]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Returns the list of the semaphore types supported by <em>device</em>.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><strong>clGetDeviceInfo</strong> when called with param_name <code>CL_DEVICE_<wbr>SEMAPHORE_<wbr>TYPES_<wbr>KHR</code> must return a non-empty list of semaphore types for at least one of the devices in the platform.
The results of this query should meet minimum requirements for <code>cl_semaphore_<wbr>type_<wbr>khr</code> as described by <a href="#_description_of_new_types_added_by_this_spec">Description of new types added by this spec</a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="_description_of_new_types_added_by_this_spec"><a class="anchor" href="#_description_of_new_types_added_by_this_spec"></a>43.6. Description of new types added by this spec</h3>
<div class="paragraph">
<p>Following new types are added:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>cl_semaphore_<wbr>type_<wbr>khr</code> to represent the different types of semaphores.</p>
<div class="ulist">
<ul>
<li>
<p>It is mandatory to support <code>CL_SEMAPHORE_<wbr>TYPE_<wbr>BINARY_<wbr>KHR</code>.</p>
</li>
</ul>
</div>
</li>
<li>
<p><code>cl_semaphore_<wbr>properties_<wbr>khr</code> to represent properties associated with semaphores.</p>
<div class="ulist">
<ul>
<li>
<p><code>CL_SEMAPHORE_<wbr>TYPE_<wbr>KHR</code> must be supported.</p>
</li>
</ul>
</div>
</li>
<li>
<p><code>cl_semaphore_<wbr>info_<wbr>khr</code> to represent queries to get additional information about semaphores.</p>
<div class="ulist">
<ul>
<li>
<p>All enums described in New API Enums for <code>cl_semaphore_<wbr>info_<wbr>khr</code> must be supported.</p>
</li>
</ul>
</div>
</li>
<li>
<p><code>cl_semaphore_<wbr>payload_<wbr>khr</code> to represent payload values of semaphores.</p>
</li>
<li>
<p><code>cl_semaphore_<wbr>khr</code> to represent semaphore objects.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Note that above types can be extended in future based on the need for additional types of semaphore and properties required by them.
The specifics of the same can be added as a newer version of this specification or by a separate specification that depends on this for basic semaphore support.</p>
</div>
</div>
<div class="sect2">
<h3 id="_description_of_new_apis_added_by_this_spec"><a class="anchor" href="#_description_of_new_apis_added_by_this_spec"></a>43.7. Description of new APIs added by this spec</h3>
<div class="paragraph">
<p>The following new APIs are added as part of this spec. The details of each are described below:</p>
</div>
<div class="sect3">
<h4 id="_creating_semaphores"><a class="anchor" href="#_creating_semaphores"></a>43.7.1. Creating semaphores</h4>
<div class="paragraph">
<p>A <strong>semaphore object</strong> may be created using the function</p>
</div>
<div id="clCreateSemaphoreWithPropertiesKHR" class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="opencl"><span class="kt">cl_semaphore_khr</span> <span class="nf">clCreateSemaphoreWithPropertiesKHR</span><span class="p">(</span>
    <span class="kt">cl_context</span> <span class="n">context</span><span class="p">,</span>
    <span class="k">const</span> <span class="kt">cl_semaphore_properties_khr</span><span class="o">*</span> <span class="n">sema_props</span><span class="p">,</span>
    <span class="kt">cl_int</span><span class="o">*</span> <span class="n">errcode_ret</span><span class="p">);</span></code></pre>
</div>
</div>
<div class="paragraph">
<p><em>context</em> identifies a valid OpenCL context that the created <code>cl_semaphore_<wbr>khr</code> will belong to.</p>
</div>
<div class="paragraph">
<p><em>sema_props</em> specifies additional semaphore properties in the form list of &lt;property_name, property_value&gt; pairs terminated with 0.
<code>CL_SEMAPHORE_<wbr>TYPE_<wbr>KHR</code> must be part of the list of properties specified by <em>sema_props</em>.</p>
</div>
<div class="paragraph">
<p>Following new properties are added to the list of possible supported properties by <code>cl_semaphore_<wbr>properties_<wbr>khr</code> that can be passed to <strong>clCreateSemaphoreWithPropertiesKHR</strong>:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 56. List of supported semaphore creation properties by <strong>clCreateSemaphoreWithPropertiesKHR</strong></caption>
<colgroup>
<col style="width: 33%;">
<col style="width: 17%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Semaphore Property</th>
<th class="tableblock halign-left valign-top">Property Value</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CL_SEMAPHORE_<wbr>TYPE_<wbr>KHR</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>cl_semaphore_<wbr>type_<wbr>khr</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Specifies the type of semaphore to create. This property is always required.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CL_DEVICE_<wbr>HANDLE_<wbr>LIST_<wbr>KHR</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>cl_device_<wbr>id</code>[]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Specifies the list of OpenCL devices (terminated with <code>CL_DEVICE_<wbr>HANDLE_<wbr>LIST_<wbr>END_<wbr>KHR</code>) to associate with the semaphore.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>If <code>CL_DEVICE_<wbr>HANDLE_<wbr>LIST_<wbr>KHR</code> is not specified as part of <em>sema_props</em>, the semaphore object created by <strong>clCreateSemaphoreWithPropertiesKHR</strong> is by default accessible to all devices in the <em>context</em>.</p>
</div>
<div class="paragraph">
<p><em>errcode_ret</em> returns an appropriate error code. If <em>errcode_ret</em> is <code>NULL</code>, no error code is returned.</p>
</div>
<div class="paragraph">
<p><strong>clCreateSemaphoreWithPropertiesKHR</strong> returns a valid semaphore object in an un-signaled state and and <em>errcode_ret</em> is set to <code>CL_SUCCESS</code> if the function is executed successfully.
Otherwise, it returns a <code>NULL</code> value with one of the following error values returned in <em>errcode_ret</em>:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>CL_INVALID_<wbr>CONTEXT</code> if <em>context</em> is not a valid context.</p>
</li>
<li>
<p><code>CL_INVALID_<wbr>PROPERTY</code> if a property name in <em>sema_props</em> is not a supported property name, if the value specified for a supported property name is not valid, or if the same property name is specified more than once.</p>
</li>
<li>
<p><code>CL_INVALID_<wbr>DEVICE</code> if <code>CL_DEVICE_<wbr>HANDLE_<wbr>LIST_<wbr>KHR</code> is specified as part of <em>sema_props</em>, but it does not identify a valid device or if a device identified by <code>CL_DEVICE_<wbr>HANDLE_<wbr>LIST_<wbr>KHR</code> is not one of the devices within <em>context</em>.</p>
</li>
<li>
<p><code>CL_INVALID_<wbr>VALUE</code></p>
<div class="ulist">
<ul>
<li>
<p>if <em>sema_props</em> is <code>NULL</code>, or</p>
</li>
<li>
<p>if <em>sema_props</em> do not specify &lt;property, value&gt; pairs for minimum set of properties (i.e. <code>CL_SEMAPHORE_<wbr>TYPE_<wbr>KHR</code>) required for successful creation of a <code>cl_semaphore_<wbr>khr</code>, or</p>
</li>
</ul>
</div>
</li>
<li>
<p><code>CL_OUT_<wbr>OF_<wbr>RESOURCES</code> if there is a failure to allocate resources required by the OpenCL implementation on the device.</p>
</li>
<li>
<p><code>CL_OUT_<wbr>OF_<wbr>HOST_<wbr>MEMORY</code> if there is a failure to allocate resources required by the OpenCL implementation on the host.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_waiting_on_and_signaling_semaphores"><a class="anchor" href="#_waiting_on_and_signaling_semaphores"></a>43.7.2. Waiting on and signaling semaphores</h4>
<div class="paragraph">
<p>To enqueue a command to wait on a set of semaphores, call the function</p>
</div>
<div id="clEnqueueWaitSemaphoresKHR" class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="opencl"><span class="kt">cl_int</span> <span class="nf">clEnqueueWaitSemaphoresKHR</span><span class="p">(</span>
    <span class="kt">cl_command_queue</span> <span class="n">command_queue</span><span class="p">,</span>
    <span class="kt">cl_uint</span> <span class="n">num_sema_objects</span><span class="p">,</span>
    <span class="k">const</span> <span class="kt">cl_semaphore_khr</span><span class="o">*</span> <span class="n">sema_objects</span><span class="p">,</span>
    <span class="k">const</span> <span class="kt">cl_semaphore_payload_khr</span><span class="o">*</span> <span class="n">sema_payload_list</span><span class="p">,</span>
    <span class="kt">cl_uint</span> <span class="n">num_events_in_wait_list</span><span class="p">,</span>
    <span class="k">const</span> <span class="kt">cl_event</span><span class="o">*</span> <span class="n">event_wait_list</span><span class="p">,</span>
    <span class="kt">cl_event</span><span class="o">*</span> <span class="n">event</span><span class="p">);</span></code></pre>
</div>
</div>
<div class="paragraph">
<p><em>command_queue</em> specifies a valid command-queue.</p>
</div>
<div class="paragraph">
<p><em>num_sema_objects</em> specifies the number of semaphore objects to wait on.</p>
</div>
<div class="paragraph">
<p><em>sema_objects</em> points to the list of semaphore objects to wait on.
The length of the list must be at least <em>num_sema_objects</em>.</p>
</div>
<div class="paragraph">
<p><em>sema_payload_list</em> points to the list of values of type <code>cl_semaphore_<wbr>payload_<wbr>khr</code> containing valid semaphore payload values to wait on.
This can be set to <code>NULL</code> or will be ignored when all semaphores in the list of <em>sema_objects</em> are of type <code>CL_SEMAPHORE_<wbr>TYPE_<wbr>BINARY_<wbr>KHR</code>.</p>
</div>
<div class="paragraph">
<p><em>num_events_in_wait_list</em> specifies the number of events in <em>event_wait_list</em>.</p>
</div>
<div class="paragraph">
<p><em>event_wait_list</em> specifies list of events that need to complete before <strong>clEnqueueWaitSemaphoresKHR</strong> can be executed.
If <em>event_wait_list</em> is <code>NULL</code>, then <strong>clEnqueueWaitSemaphoresKHR</strong> does not wait on any event to complete.
If <em>event_wait_list</em> is <code>NULL</code>, <em>num_events_in_wait_list</em> must be 0.
If <em>event_wait_list</em> is not <code>NULL</code>, the list of events pointed to by <em>event_wait_list</em> must be valid and <em>num_events_in_wait_list</em> must be greater than 0.
The events specified in <em>event_wait_list</em> act as synchronization points.
The context associated with events in <em>event_wait_list</em> and that associated with <em>command_queue</em> must be the same.</p>
</div>
<div class="paragraph">
<p><em>event</em> returns an event object that identifies this particular command and can be used to query or queue a wait for this particular command to complete.
<em>event</em> can be <code>NULL</code> in which case it will not be possible for the application to query the status of this command or queue a wait for this command to complete.</p>
</div>
<div class="paragraph">
<p>The semaphore wait command waits for a list of events to complete and a list of semaphore objects to become signaled.
The semaphore wait command returns an <em>event</em> which can be waited on to ensure that all events in the <em>event_wait_list</em> have completed and all semaphores in <em>sema_objects</em> have been signaled.
<strong>clEnqueueWaitSemaphoresKHR</strong> will not return until the binary semaphores in <em>sema_objects</em> are in a state that makes them safe to re-signal. If necessary, implementations may block in <strong>clEnqueueWaitSemaphoresKHR</strong> to ensure the correct state of semaphores when returning. There are no implications from this behavior for the state of <em>event</em> or the events in <em>event_wait_list</em> when <strong>clEnqueueWaitSemaphoresKHR</strong> returns. Waiting on the same binary semaphore twice without an interleaving signal may lead to undefined behavior.</p>
</div>
<div class="paragraph">
<p><strong>clEnqueueWaitSemaphoresKHR</strong> returns <code>CL_SUCCESS</code> if the function is executed successfully.
Otherwise, it returns one of the following errors:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>CL_INVALID_<wbr>COMMAND_<wbr>QUEUE</code></p>
<div class="ulist">
<ul>
<li>
<p>if <em>command_queue</em> is not a valid command-queue, or</p>
</li>
<li>
<p>if the device associated with <em>command_queue</em> is not same as one of the devices specified by <code>CL_DEVICE_<wbr>HANDLE_<wbr>LIST_<wbr>KHR</code> at the time of creating one or more of <em>sema_objects</em>, or</p>
</li>
<li>
<p>if one or more of <em>sema_objects</em> belong to a context that does not contain a device associated with <em>command_queue</em>.</p>
</li>
</ul>
</div>
</li>
<li>
<p><code>CL_INVALID_<wbr>VALUE</code> if <em>num_sema_objects</em> is 0.</p>
</li>
<li>
<p><code>CL_INVALID_<wbr>SEMAPHORE_<wbr>KHR</code> if any of the semaphore objects specified by <em>sema_objects</em> is not valid.</p>
</li>
<li>
<p><code>CL_INVALID_<wbr>CONTEXT</code> if the context associated with <em>command_queue</em> and any of the semaphore objects in <em>sema_objects</em> are not the same or if the context associated with <em>command_queue</em> and that associated with events in <em>event_wait_list</em> are not the same.</p>
</li>
<li>
<p><code>CL_INVALID_<wbr>VALUE</code> if any of the semaphore objects specified by <em>sema_objects</em> requires a semaphore payload and <em>sema_payload_list</em> is <code>NULL</code>.</p>
</li>
<li>
<p><code>CL_INVALID_<wbr>EVENT_<wbr>WAIT_<wbr>LIST</code></p>
<div class="ulist">
<ul>
<li>
<p>if <em>event_wait_list</em> is <code>NULL</code> and <em>num_events_in_wait_list</em> is not 0, or</p>
</li>
<li>
<p>if <em>event_wait_list</em> is not <code>NULL</code> and <em>num_events_in_wait_list</em> is 0, or</p>
</li>
<li>
<p>if event objects in <em>event_wait_list</em> are not valid events.</p>
</li>
</ul>
</div>
</li>
<li>
<p><code>CL_EXEC_<wbr>STATUS_<wbr>ERROR_<wbr>FOR_<wbr>EVENTS_<wbr>IN_<wbr>WAIT_<wbr>LIST</code> if the execution status of any of the events in <em>event_wait_list</em> is a negative integer value.</p>
</li>
<li>
<p><code>CL_OUT_<wbr>OF_<wbr>RESOURCES</code> if there is a failure to allocate resources required by the OpenCL implementation on the device.</p>
</li>
<li>
<p><code>CL_OUT_<wbr>OF_<wbr>HOST_<wbr>MEMORY</code> if there is a failure to allocate resources required by the OpenCL implementation on the host.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>To enqueue a command to signal a set of semaphores, call the function</p>
</div>
<div id="clEnqueueSignalSemaphoresKHR" class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="opencl"><span class="kt">cl_int</span> <span class="nf">clEnqueueSignalSemaphoresKHR</span><span class="p">(</span>
    <span class="kt">cl_command_queue</span> <span class="n">command_queue</span><span class="p">,</span>
    <span class="kt">cl_uint</span> <span class="n">num_sema_objects</span><span class="p">,</span>
    <span class="k">const</span> <span class="kt">cl_semaphore_khr</span><span class="o">*</span> <span class="n">sema_objects</span><span class="p">,</span>
    <span class="k">const</span> <span class="kt">cl_semaphore_payload_khr</span><span class="o">*</span> <span class="n">sema_payload_list</span><span class="p">,</span>
    <span class="kt">cl_uint</span> <span class="n">num_events_in_wait_list</span><span class="p">,</span>
    <span class="k">const</span> <span class="kt">cl_event</span><span class="o">*</span> <span class="n">event_wait_list</span><span class="p">,</span>
    <span class="kt">cl_event</span><span class="o">*</span> <span class="n">event</span><span class="p">);</span></code></pre>
</div>
</div>
<div class="paragraph">
<p><em>command_queue</em> specifies a valid command-queue.</p>
</div>
<div class="paragraph">
<p><em>num_sema_objects</em> specifies the number of semaphore objects to signal.</p>
</div>
<div class="paragraph">
<p><em>sema_objects</em> points to the list of semaphore objects to signal.
The length of the list must be at least <em>num_sema_objects</em>.</p>
</div>
<div class="paragraph">
<p><em>sema_payload_list</em> points to the list of values of type <code>cl_semaphore_<wbr>payload_<wbr>khr</code> containing semaphore payload values to signal.
This can be set to <code>NULL</code> or will be ignored when all semaphores in the list of <em>sema_objects</em> are of type <code>CL_SEMAPHORE_<wbr>TYPE_<wbr>BINARY_<wbr>KHR</code>.</p>
</div>
<div class="paragraph">
<p><em>num_events_in_wait_list</em> specifies the number of events in event_wait_list.</p>
</div>
<div class="paragraph">
<p><em>event_wait_list</em> points to the list of events that need to complete before <strong>clEnqueueSignalSemaphoresKHR</strong> can be executed.
If <em>event_wait_list</em> is <code>NULL</code>, then <strong>clEnqueueSignalSemaphoresKHR</strong> does not wait on any event to complete.
If <em>event_wait_list</em> is <code>NULL</code>, <em>num_events_in_wait_list</em> must be 0.
If <em>event_wait_list</em> is not <code>NULL</code>, the list of events pointed to by <em>event_wait_list</em> must be valid and
<em>num_events_in_wait_list</em> must be greater than 0.
The events specified in <em>event_wait_list</em> act as synchronization points.
The context associated with events in <em>event_wait_list</em> and that associated with <em>command_queue</em> must be the same.</p>
</div>
<div class="paragraph">
<p><em>event</em> returns an event object that identifies this particular command and can be used to query or queue a wait for this particular command to complete.
<em>event</em> can be <code>NULL</code> in which case it will not be possible for the application to query the status of this command
or queue a wait for this command to complete.</p>
</div>
<div class="paragraph">
<p>The semaphore signal command waits for a list of events to complete and then signals a list of semaphore objects.
The semaphore signal command returns an <em>event</em> which can be waited on to ensure that all events in the <em>event_wait_list</em> have completed and all semaphores in <em>sema_objects</em> have been signaled.
The successful completion of the event generated by <strong>clEnqueueSignalSemaphoresKHR</strong> called on one or more semaphore objects of type <code>CL_SEMAPHORE_<wbr>TYPE_<wbr>BINARY_<wbr>KHR</code> changes the state of the corresponding semaphore objects to signaled.  <strong>clEnqueueSignalSemaphoresKHR</strong> will not return until the binary semaphores in <em>sema_objects</em> are in a state that makes them safe to wait on again.  If necessary, implementations may block in <strong>clEnqueueSignalSemaphoresKHR</strong> to ensure the correct state of semaphores when returning.  There are no implications from this behavior for the state of <em>event</em> or the events in <em>event_wait_list</em> when <strong>clEnqueueSignalSemaphoresKHR</strong> returns. Signaling the same binary semaphore twice without an interleaving wait may lead to undefined behavior.</p>
</div>
<div class="paragraph">
<p><strong>clEnqueueSignalSemaphoresKHR</strong> returns <code>CL_SUCCESS</code> if the function is executed successfully.
Otherwise, it returns one of the following errors:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>CL_INVALID_<wbr>COMMAND_<wbr>QUEUE</code></p>
<div class="ulist">
<ul>
<li>
<p>if <em>command_queue</em> is not a valid command-queue, or</p>
</li>
<li>
<p>if the device associated with <em>command_queue</em> is not same as one of the devices specified by <code>CL_DEVICE_<wbr>HANDLE_<wbr>LIST_<wbr>KHR</code> at the time of creating one or more of <em>sema_objects</em>, or</p>
</li>
<li>
<p>if one or more of <em>sema_objects</em> belong to a context that does not contain a device associated with <em>command_queue</em>.</p>
</li>
</ul>
</div>
</li>
<li>
<p><code>CL_INVALID_<wbr>VALUE</code> if <em>num_sema_objects</em> is 0</p>
</li>
<li>
<p><code>CL_INVALID_<wbr>SEMAPHORE_<wbr>KHR</code> if any of the semaphore objects specified by <em>sema_objects</em> is not valid.</p>
</li>
<li>
<p><code>CL_INVALID_<wbr>CONTEXT</code> if the context associated with <em>command_queue</em> and any of the semaphore objects in <em>sema_objects</em> are not the same or if the context associated with <em>command_queue</em> and that associated with events in <em>event_wait_list</em> are not the same.</p>
</li>
<li>
<p><code>CL_INVALID_<wbr>VALUE</code> if any of the semaphore objects specified by <em>sema_objects</em> requires a semaphore payload and <em>sema_payload_list</em> is <code>NULL</code>.</p>
</li>
<li>
<p><code>CL_INVALID_<wbr>EVENT_<wbr>WAIT_<wbr>LIST</code></p>
<div class="ulist">
<ul>
<li>
<p>if <em>event_wait_list</em> is <code>NULL</code> and <em>num_events_in_wait_list</em> is not 0, or</p>
</li>
<li>
<p>if <em>event_wait_list</em> is not <code>NULL</code> and <em>num_events_in_wait_list</em> is 0, or</p>
</li>
<li>
<p>if event objects in <em>event_wait_list</em> are not valid events.</p>
</li>
</ul>
</div>
</li>
<li>
<p><code>CL_EXEC_<wbr>STATUS_<wbr>ERROR_<wbr>FOR_<wbr>EVENTS_<wbr>IN_<wbr>WAIT_<wbr>LIST</code> if the execution status of any of the events in <em>event_wait_list</em> is a negative integer value.</p>
</li>
<li>
<p><code>CL_OUT_<wbr>OF_<wbr>RESOURCES</code> if there is a failure to allocate resources required by the OpenCL implementation on the device.</p>
</li>
<li>
<p><code>CL_OUT_<wbr>OF_<wbr>HOST_<wbr>MEMORY</code> if there is a failure to allocate resources required by the OpenCL implementation on the host.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_semaphore_queries"><a class="anchor" href="#_semaphore_queries"></a>43.7.3. Semaphore Queries</h4>
<div class="paragraph">
<p>To query information about a semaphore object, call the function</p>
</div>
<div id="clGetSemaphoreInfoKHR" class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="opencl"><span class="kt">cl_int</span> <span class="nf">clGetSemaphoreInfoKHR</span><span class="p">(</span>
    <span class="kt">cl_semaphore_khr</span> <span class="n">sema_object</span><span class="p">,</span>
    <span class="kt">cl_semaphore_info_khr</span> <span class="n">param_name</span><span class="p">,</span>
    <span class="kt">size_t</span> <span class="n">param_value_size</span><span class="p">,</span>
    <span class="kt">void</span><span class="o">*</span> <span class="n">param_value</span><span class="p">,</span>
    <span class="kt">size_t</span><span class="o">*</span> <span class="n">param_value_size_ret</span><span class="p">);</span></code></pre>
</div>
</div>
<div class="paragraph">
<p><em>sema_object</em> specifies the semaphore object being queried.</p>
</div>
<div class="paragraph">
<p><em>param_name</em> is a constant that specifies the semaphore information to query, and must be one of the values shown in <a href="#cl_khr_semaphore_info-table">List of supported param_names by <strong>clGetSemaphoreInfoKHR</strong></a>.</p>
</div>
<div class="paragraph">
<p><em>param_value</em> is a pointer to memory where the result of the query is returned as described in <a href="#cl_khr_semaphore_info-table">List of supported param_names by <strong>clGetSemaphoreInfoKHR</strong></a>. If <em>param_value</em> is <code>NULL</code>, it is ignored.</p>
</div>
<div class="paragraph">
<p><em>param_value_size</em> specifies the size in bytes of memory pointed to <em>param_value</em>. This size must be greater than or equal to the size of the return type described in table <a href="#cl_khr_semaphore_info-table">List of supported param_names by <strong>clGetSemaphoreInfoKHR</strong></a>.</p>
</div>
<div class="paragraph">
<p><em>param_value_size_ret</em> returns the actual size in bytes of data
being queried by <em>param_value</em>. If <em>param_value_size_ret</em> is <code>NULL</code>, it is ignored.</p>
</div>
<table id="cl_khr_semaphore_info-table" class="tableblock frame-all grid-all stretch">
<caption class="title">Table 57. List of supported param_names by <strong>clGetSemaphoreInfoKHR</strong></caption>
<colgroup>
<col style="width: 33%;">
<col style="width: 17%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Semaphore Info</th>
<th class="tableblock halign-left valign-top">Return Type</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CL_SEMAPHORE_<wbr>CONTEXT_<wbr>KHR</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>cl_context</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Returns the context specified when the semaphore is created.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CL_SEMAPHORE_<wbr>REFERENCE_<wbr>COUNT_<wbr>KHR</code> <sup class="footnote">[<a id="_footnoteref_1" class="footnote" href="#_footnotedef_1" title="View footnote.">1</a>]</sup></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>cl_uint</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Returns the semaphore reference count.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CL_SEMAPHORE_<wbr>PROPERTIES_<wbr>KHR</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>cl_semaphore_<wbr>properties_<wbr>khr</code>[]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Return the properties argument specified in
        <strong>clCreateSemaphoreWithPropertiesKHR</strong>.</p>
<p class="tableblock">        The implementation must return the values specified in the properties
        argument in the same order and without including additional properties.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CL_SEMAPHORE_<wbr>TYPE_<wbr>KHR</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>cl_semaphore_<wbr>type_<wbr>khr</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Returns the semaphore type.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CL_SEMAPHORE_<wbr>PAYLOAD_<wbr>KHR</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>cl_semaphore_<wbr>payload_<wbr>khr</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Returns the semaphore payload value. For semaphores of type
        <code>CL_SEMAPHORE_<wbr>TYPE_<wbr>BINARY_<wbr>KHR</code>, the payload value returned will be <code>0</code>
        if the semaphore is in an un-signaled state and <code>1</code> if it is in a
        signaled state.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CL_DEVICE_<wbr>HANDLE_<wbr>LIST_<wbr>KHR</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>cl_device_<wbr>id</code>[]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Returns the list of OpenCL devices the semaphore is associated with.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><strong>clGetSemaphoreInfoKHR</strong> returns <code>CL_SUCCESS</code> if the information is queried successfully.
Otherwise, it returns one of the following errors:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>CL_INVALID_<wbr>SEMAPHORE_<wbr>KHR</code></p>
<div class="ulist">
<ul>
<li>
<p>if <em>sema_object</em> is not a valid semaphore</p>
</li>
</ul>
</div>
</li>
<li>
<p><code>CL_INVALID_<wbr>VALUE</code></p>
<div class="ulist">
<ul>
<li>
<p>if <em>param_name</em> is not one of the attribute defined in table <a href="#cl_khr_semaphore_info-table">List of supported param_names by <strong>clGetSemaphoreInfoKHR</strong></a> or</p>
</li>
<li>
<p>if <em>param_value_size</em> is less than the size of Return Type of the corresponding <em>param_name</em> attribute as defined in table <a href="#cl_khr_semaphore_info-table">List of supported param_names by <strong>clGetSemaphoreInfoKHR</strong></a>.</p>
</li>
</ul>
</div>
</li>
<li>
<p><code>CL_OUT_<wbr>OF_<wbr>RESOURCES</code> if there is a failure to allocate resources required by the OpenCL implementation on the device.</p>
</li>
<li>
<p><code>CL_OUT_<wbr>OF_<wbr>HOST_<wbr>MEMORY</code> if there is a failure to allocate resources required by the OpenCL implementation on the host.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_retaining_and_releasing_semaphores"><a class="anchor" href="#_retaining_and_releasing_semaphores"></a>43.7.4. Retaining and Releasing Semaphores</h4>
<div class="paragraph">
<p>To release a semaphore object, call the function</p>
</div>
<div id="clReleaseSemaphoreKHR" class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="opencl"><span class="kt">cl_int</span> <span class="nf">clReleaseSemaphoreKHR</span><span class="p">(</span>
    <span class="kt">cl_semaphore_khr</span> <span class="n">sema_object</span><span class="p">);</span></code></pre>
</div>
</div>
<div class="paragraph">
<p><em>sema_object</em> specifies the semaphore object to be released.</p>
</div>
<div class="paragraph">
<p>The <em>sema_object</em> reference count is decremented.</p>
</div>
<div class="paragraph">
<p><strong>clReleaseSemaphoreKHR</strong> returns <code>CL_SUCCESS</code> if the function is executed successfully.
Otherwise, it returns one of the following errors:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>CL_INVALID_<wbr>SEMAPHORE_<wbr>KHR</code> if <em>sema_object</em> is not a valid semaphore object.</p>
</li>
<li>
<p><code>CL_OUT_<wbr>OF_<wbr>RESOURCES</code> if there is a failure to allocate resources required by the OpenCL implementation on the device.</p>
</li>
<li>
<p><code>CL_OUT_<wbr>OF_<wbr>HOST_<wbr>MEMORY</code> if there is a failure to allocate resources required by the OpenCL implementation on the host.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>After the reference count becomes zero and commands queued for execution on a
command-queue(s) that use <em>sema_object</em> have finished, the semaphore object is
deleted.
Using this function to release a reference that was not obtained by creating the
object via <strong>clCreateSemaphoreWithPropertiesKHR</strong> or by calling
<strong>clRetainSemaphoreKHR</strong> causes undefined behavior.</p>
</div>
<div class="paragraph">
<p>To retain a semaphore object, call the function</p>
</div>
<div id="clRetainSemaphoreKHR" class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="opencl"><span class="kt">cl_int</span> <span class="nf">clRetainSemaphoreKHR</span><span class="p">(</span>
    <span class="kt">cl_semaphore_khr</span> <span class="n">sema_object</span><span class="p">);</span></code></pre>
</div>
</div>
<div class="paragraph">
<p><em>sema_object</em> specifies the semaphore object to be retained.</p>
</div>
<div class="paragraph">
<p>increments the reference count of <em>sema_object</em>.</p>
</div>
<div class="paragraph">
<p><strong>clRetainSemaphoreKHR</strong> returns <code>CL_SUCCESS</code> if the function is executed successfully.
Otherwise, it returns one of the following errors:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>CL_INVALID_<wbr>SEMAPHORE_<wbr>KHR</code> if <em>sema_object</em> is not a valid semaphore object.</p>
</li>
<li>
<p><code>CL_OUT_<wbr>OF_<wbr>RESOURCES</code> if there is a failure to allocate resources required by the OpenCL implementation on the device.</p>
</li>
<li>
<p><code>CL_OUT_<wbr>OF_<wbr>HOST_<wbr>MEMORY</code> if there is a failure to allocate resources required by the OpenCL implementation on the host.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect2">
<h3 id="cl_khr_semaphore-Sample-Code"><a class="anchor" href="#cl_khr_semaphore-Sample-Code"></a>43.8. Sample Code</h3>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Example for semaphore creation in a single device context</p>
<div class="openblock">
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="opencl"><span class="c1">// Get cl_devices of the platform.</span>
<span class="n">clGetDeviceIDs</span><span class="p">(...,</span> <span class="o">&amp;</span><span class="n">devices</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">deviceCount</span><span class="p">);</span>

<span class="c1">// Create cl_context with just first device</span>
<span class="n">context</span> <span class="o">=</span> <span class="n">clCreateContext</span><span class="p">(...,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">devices</span><span class="p">,</span> <span class="p">...);</span>

<span class="c1">// Create clSema of type cl_semaphore_khr usable on single device in the context</span>

<span class="kt">cl_semaphore_properties_khr</span> <span class="n">sema_props</span><span class="p">[]</span> <span class="o">=</span>
        <span class="p">{(</span><span class="kt">cl_semaphore_properties_khr</span><span class="p">)</span><span class="n">CL_SEMAPHORE_TYPE_KHR</span><span class="p">,</span>
         <span class="p">(</span><span class="kt">cl_semaphore_properties_khr</span><span class="p">)</span><span class="n">CL_SEMAPHORE_TYPE_BINARY_KHR</span><span class="p">,</span>
          <span class="mi">0</span><span class="p">};</span>

<span class="kt">int</span> <span class="n">errcode_ret</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>

<span class="kt">cl_semaphore_khr</span> <span class="n">clSema</span> <span class="o">=</span> <span class="n">clCreateSemaphoreWithPropertiesKHR</span><span class="p">(</span><span class="n">context</span><span class="p">,</span>
                                                             <span class="n">sema_props</span><span class="p">,</span>
                                                             <span class="o">&amp;</span><span class="n">errcode_ret</span><span class="p">);</span></code></pre>
</div>
</div>
</div>
</div>
</li>
<li>
<p>Example for semaphore creation for a single device in a multi-device context</p>
<div class="openblock">
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="opencl"><span class="c1">// Get cl_devices of the platform.</span>
<span class="n">clGetDeviceIDs</span><span class="p">(...,</span> <span class="o">&amp;</span><span class="n">devices</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">deviceCount</span><span class="p">);</span>

<span class="c1">// Create cl_context with first two devices</span>
<span class="n">clCreateContext</span><span class="p">(...,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">devices</span><span class="p">,</span> <span class="p">...);</span>

<span class="c1">// Create clSema of type cl_semaphore_khr usable only on devices[0]</span>

<span class="kt">cl_semaphore_properties_khr</span> <span class="n">sema_props</span><span class="p">[]</span> <span class="o">=</span>
        <span class="p">{(</span><span class="kt">cl_semaphore_properties_khr</span><span class="p">)</span><span class="n">CL_SEMAPHORE_TYPE_KHR</span><span class="p">,</span>
         <span class="p">(</span><span class="kt">cl_semaphore_properties_khr</span><span class="p">)</span><span class="n">CL_SEMAPHORE_TYPE_BINARY_KHR</span><span class="p">,</span>
         <span class="p">(</span><span class="kt">cl_semaphore_properties_khr</span><span class="p">)</span><span class="n">CL_DEVICE_HANDLE_LIST_KHR</span><span class="p">,</span>
         <span class="p">(</span><span class="kt">cl_semaphore_properties_khr</span><span class="p">)</span><span class="n">devices</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">CL_DEVICE_HANDLE_LIST_END_KHR</span><span class="p">,</span>
          <span class="mi">0</span><span class="p">};</span>

<span class="kt">int</span> <span class="n">errcode_ret</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>

<span class="kt">cl_semaphore_khr</span> <span class="n">clSema</span> <span class="o">=</span> <span class="n">clCreateSemaphoreWithPropertiesKHR</span><span class="p">(</span><span class="n">context</span><span class="p">,</span>
                                                             <span class="n">sema_props</span><span class="p">,</span>
                                                             <span class="o">&amp;</span><span class="n">errcode_ret</span><span class="p">);</span></code></pre>
</div>
</div>
</div>
</div>
</li>
<li>
<p>Example for synchronization using Wait and Signal</p>
<div class="openblock">
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="opencl"><span class="c1">// clSema is created using clCreateSemaphoreWithPropertiesKHR</span>
<span class="c1">// using one of the examples for semaphore creation.</span>

<span class="kt">cl_semaphore_khr</span> <span class="n">clSema</span> <span class="o">=</span> <span class="n">clCreateSemaphoreWithPropertiesKHR</span><span class="p">(</span><span class="n">context</span><span class="p">,</span>
                                                             <span class="n">sema_props</span><span class="p">,</span>
                                                             <span class="o">&amp;</span><span class="n">errcode_ret</span><span class="p">);</span>

<span class="c1">// Start the main loop</span>

<span class="k">while</span> <span class="p">(</span><span class="nb">true</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// (not shown) Signal the semaphore from other work</span>

    <span class="c1">// Wait for the semaphore in OpenCL</span>
    <span class="c1">// by calling clEnqueueWaitSemaphoresKHR on 'clSema'</span>
    <span class="n">clEnqueueWaitSemaphoresKHR</span><span class="p">(</span><span class="cm">/*command_queue*/</span>              <span class="n">command_queue</span><span class="p">,</span>
                               <span class="cm">/*num_sema_objects*/</span>           <span class="mi">1</span><span class="p">,</span>
                               <span class="cm">/*sema_objects*/</span>               <span class="o">&amp;</span><span class="n">clSema</span><span class="p">,</span>
                               <span class="cm">/*sema_payload_list*/</span>          <span class="nb">NULL</span><span class="p">,</span>
                               <span class="cm">/*num_events_in_wait_list*/</span>    <span class="mi">0</span><span class="p">,</span>
                               <span class="cm">/*event_wait_list*/</span>            <span class="nb">NULL</span><span class="p">,</span>
                               <span class="cm">/*event*/</span>                      <span class="nb">NULL</span><span class="p">);</span>

    <span class="c1">// Launch kernel that accesses extMem</span>
    <span class="n">clEnqueueNDRangeKernel</span><span class="p">(</span><span class="n">command_queue</span><span class="p">,</span> <span class="p">...);</span>

    <span class="c1">// Signal the semaphore in OpenCL</span>
    <span class="n">clEnqueueSignalSemaphoresKHR</span><span class="p">(</span><span class="cm">/*command_queue*/</span>              <span class="n">command_queue</span><span class="p">,</span>
                                 <span class="cm">/*num_sema_objects*/</span>           <span class="mi">1</span><span class="p">,</span>
                                 <span class="cm">/*sema_objects*/</span>               <span class="o">&amp;</span><span class="n">clSema</span><span class="p">,</span>
                                 <span class="cm">/*sema_payload_list*/</span>          <span class="nb">NULL</span><span class="p">,</span>
                                 <span class="cm">/*num_events_in_wait_list*/</span>    <span class="mi">0</span><span class="p">,</span>
                                 <span class="cm">/*event_wait_list*/</span>            <span class="nb">NULL</span><span class="p">,</span>
                                 <span class="cm">/*event*/</span>                      <span class="nb">NULL</span><span class="p">);</span>

    <span class="c1">// (not shown) Launch other work that waits on 'clSema'</span>
<span class="p">}</span></code></pre>
</div>
</div>
</div>
</div>
</li>
<li>
<p>Example for <strong>clGetSemaphoreInfoKHR</strong></p>
<div class="openblock">
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="opencl"><span class="c1">// clSema is created using clCreateSemaphoreWithPropertiesKHR</span>
<span class="c1">// using one of the examples for semaphore creation.</span>

<span class="kt">cl_semaphore_khr</span> <span class="n">clSema</span> <span class="o">=</span> <span class="n">clCreateSemaphoreWithPropertiesKHR</span><span class="p">(</span><span class="n">context</span><span class="p">,</span>
                                                             <span class="n">sema_props</span><span class="p">,</span>
                                                             <span class="o">&amp;</span><span class="n">errcode_ret</span><span class="p">);</span>

<span class="c1">// Start the main rendering loop</span>

<span class="k">while</span> <span class="p">(</span><span class="nb">true</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// (not shown) Signal the semaphore from other work</span>

    <span class="c1">// Wait for the semaphore in OpenCL, by calling clEnqueueWaitSemaphoresKHR on 'clSema'</span>
    <span class="n">clEnqueueWaitSemaphoresKHR</span><span class="p">(</span><span class="cm">/*command_queue*/</span>              <span class="n">command_queue</span><span class="p">,</span>
                               <span class="cm">/*num_sema_objects*/</span>           <span class="mi">1</span><span class="p">,</span>
                               <span class="cm">/*sema_objects*/</span>               <span class="o">&amp;</span><span class="n">clSema</span><span class="p">,</span>
                               <span class="cm">/*sema_payload_list*/</span>          <span class="nb">NULL</span><span class="p">,</span>
                               <span class="cm">/*num_events_in_wait_list*/</span>    <span class="mi">0</span><span class="p">,</span>
                               <span class="cm">/*event_wait_list*/</span>            <span class="nb">NULL</span><span class="p">,</span>
                               <span class="cm">/*event*/</span>                      <span class="nb">NULL</span><span class="p">);</span>

    <span class="c1">// Launch kernel in OpenCL</span>
    <span class="n">clEnqueueNDRangeKernel</span><span class="p">(</span><span class="n">command_queue</span><span class="p">,</span> <span class="p">...);</span>

    <span class="c1">// Signal the semaphore in OpenCL</span>
    <span class="n">clEnqueueSignalSemaphoresKHR</span><span class="p">(</span><span class="cm">/*command_queue*/</span>              <span class="n">command_queue</span><span class="p">,</span>
                                 <span class="cm">/*num_sema_objects*/</span>           <span class="mi">1</span><span class="p">,</span>
                                 <span class="cm">/*sema_objects*/</span>               <span class="o">&amp;</span><span class="n">clSema</span><span class="p">,</span>
                                 <span class="cm">/*sema_payload_list*/</span>          <span class="nb">NULL</span><span class="p">,</span>
                                 <span class="cm">/*num_events_in_wait_list*/</span>    <span class="mi">0</span><span class="p">,</span>
                                 <span class="cm">/*event_wait_list*/</span>            <span class="nb">NULL</span><span class="p">,</span>
                                 <span class="cm">/*event*/</span>                      <span class="nb">NULL</span><span class="p">);</span>

    <span class="c1">// Query type of clSema</span>
    <span class="n">clGetSemaphoreInfoKHR</span><span class="p">(</span><span class="cm">/*sema_object*/</span>           <span class="n">clSema</span><span class="p">,</span>
                          <span class="cm">/*param_name*/</span>            <span class="n">CL_SEMAPHORE_TYPE_KHR</span><span class="p">,</span>
                          <span class="cm">/*param_value_size*/</span>      <span class="k">sizeof</span><span class="p">(</span><span class="kt">cl_semaphore_type_khr</span><span class="p">),</span>
                          <span class="cm">/*param_value*/</span>           <span class="o">&amp;</span><span class="n">clSemaType</span><span class="p">,</span>
                          <span class="cm">/*param_value_ret_size*/</span>  <span class="o">&amp;</span><span class="n">clSemaTypeSize</span><span class="p">);</span>

    <span class="k">if</span> <span class="p">(</span><span class="n">clSemaType</span> <span class="o">==</span> <span class="n">CL_SEMAPHORE_TYPE_BINARY_KHR</span><span class="p">)</span> <span class="p">{</span>
        <span class="c1">// Do something</span>
    <span class="p">}</span>
    <span class="k">else</span> <span class="p">{</span>
        <span class="c1">// Do something else</span>
    <span class="p">}</span>
    <span class="c1">// (not shown) Launch other work that waits on 'clSema'</span>
<span class="p">}</span></code></pre>
</div>
</div>
</div>
</div>
</li>
</ol>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="cl_khr_external_semaphore"><a class="anchor" href="#cl_khr_external_semaphore"></a>44. External Semaphores (Provisional)</h2>
<div class="sectionbody">
<div class="paragraph">
<p><code>cl_khr_semaphore</code> introduced semaphores as a new type along with a set of APIs for create, release, retain, wait and signal operations on it.
This extension defines APIs and mechanisms to share semaphores created in an external API by importing into and exporting from OpenCL.</p>
</div>
<div class="paragraph">
<p>This extension defines:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>New attributes that can be passed as part of <code>cl_semaphore_<wbr>properties_<wbr>khr</code> for specifying properties of external semaphores to be imported or exported.</p>
</li>
<li>
<p>New attributes that can be passed as part of <code>cl_semaphore_<wbr>info_<wbr>khr</code> for specifying properties of external semaphores to be exported.</p>
</li>
<li>
<p>An extension to <strong>clCreateSemaphoreWithPropertiesKHR</strong> to accept external semaphore properties allowing to import or export an external semaphore into or from OpenCL.</p>
</li>
<li>
<p>Semaphore handle types required for importing and exporting semaphores.</p>
</li>
<li>
<p>Modifications to Wait and Signal API behavior when dealing with external semaphores created from different handle types.</p>
</li>
<li>
<p>API query exportable semaphores handles using specified handle type.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Other related extensions define specific external semaphores that may be imported into or exported from OpenCL.</p>
</div>
<div class="sect2">
<h3 id="_general_information_43"><a class="anchor" href="#_general_information_43"></a>44.1. General Information</h3>
<div class="sect3">
<h4 id="_name_strings_7"><a class="anchor" href="#_name_strings_7"></a>44.1.1. Name Strings</h4>
<div class="paragraph">
<p><code>cl_khr_external_semaphore</code><br>
<code>cl_khr_external_semaphore_dx_fence</code><br>
<code>cl_khr_external_semaphore_opaque_fd</code><br>
<code>cl_khr_external_semaphore_sync_fd</code><br>
<code>cl_khr_external_semaphore_win32</code></p>
</div>
</div>
<div class="sect3">
<h4 id="_version_history_43"><a class="anchor" href="#_version_history_43"></a>44.1.2. Version History</h4>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 60%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><strong>Date</strong></th>
<th class="tableblock halign-left valign-top"><strong>Version</strong></th>
<th class="tableblock halign-left valign-top"><strong>Description</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">2021-09-10</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.9.0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Initial version (provisional).</p></td>
</tr>
</tbody>
</table>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
This is a preview of an OpenCL provisional extension specification that has been Ratified under the Khronos Intellectual Property Framework. It is being made publicly available prior to being uploaded to the Khronos registry to enable review and feedback from the community. If you have feedback please create an issue on <a href="https://github.com/KhronosGroup/OpenCL-Docs/" class="bare">https://github.com/KhronosGroup/OpenCL-Docs/</a>
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_dependencies_7"><a class="anchor" href="#_dependencies_7"></a>44.1.3. Dependencies</h4>
<div class="paragraph">
<p>This extension is written against the OpenCL Specification Version 3.0.8.</p>
</div>
<div class="paragraph">
<p>This extension requires OpenCL 1.2.</p>
</div>
<div class="paragraph">
<p>The <code>cl_khr_semaphore</code> extension is required as it defines semaphore objects as well as for wait and signal operations on semaphores.</p>
</div>
<div class="paragraph">
<p>For OpenCL to be able to import external semaphores from other APIs using this extension, the other API is required to provide below mechanisms:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Ability to export semaphore handles</p>
</li>
<li>
<p>Ability to query semaphore handle in the form of one of the handle type supported by OpenCL.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The other APIs that want to use semaphore exported by OpenCL using this extension are required to provide below mechanism:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Ability to import semaphore handles using handle types exported by OpenCL.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_contributors_4"><a class="anchor" href="#_contributors_4"></a>44.1.4. Contributors</h4>
<div class="paragraph">
<p>Ajit Hakke-Patil,  NVIDIA<br>
Amit Rao, NVIDIA<br>
Balaji Calidas, QUALCOMM<br>
Ben Ashbaugh, INTEL<br>
Carsten Rohde, NVIDIA<br>
Christoph Kubisch, NVIDIA<br>
Debalina Bhattacharjee, NVIDIA<br>
James Jones, NVIDIA<br>
Jason Ekstrand, INTEL<br>
Jeremy Kemp, IMAGINATION<br>
Joshua Kelly, QUALCOMM<br>
Karthik Raghavan Ravi, NVIDIA<br>
Kedar Patil, NVIDIA<br>
Kevin Petit, ARM<br>
Nikhil Joshi, NVIDIA<br>
Sharan Ashwathnarayan, NVIDIA<br>
Vivek Kini, NVIDIA<br></p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_new_types_2"><a class="anchor" href="#_new_types_2"></a>44.2. New Types</h3>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="opencl"><span class="k">typedef</span> <span class="kt">cl_uint</span> <span class="kt">cl_external_semaphore_handle_type_khr</span><span class="p">;</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_new_api_functions_4"><a class="anchor" href="#_new_api_functions_4"></a>44.3. New API Functions</h3>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="opencl"><span class="kt">cl_int</span> <span class="nf">clGetSemaphoreHandleForTypeKHR</span><span class="p">(</span>
    <span class="kt">cl_semaphore_khr</span> <span class="n">sema_object</span><span class="p">,</span>
    <span class="kt">cl_device_id</span> <span class="n">device</span><span class="p">,</span>
    <span class="kt">cl_external_semaphore_handle_type_khr</span> <span class="n">handle_type</span><span class="p">,</span>
    <span class="kt">size_t</span> <span class="n">handle_size</span><span class="p">,</span>
    <span class="kt">void</span> <span class="o">*</span><span class="n">handle_ptr</span><span class="p">,</span>
    <span class="kt">size_t</span> <span class="o">*</span><span class="n">handle_size_ret</span><span class="p">);</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_new_api_enums_5"><a class="anchor" href="#_new_api_enums_5"></a>44.4. New API Enums</h3>
<div class="paragraph">
<p>Accepted value for the <em>param_name</em> parameter to <strong>clGetPlatformInfo</strong> to query external semaphore handle types that may be imported or exported by all devices in an OpenCL platform:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="opencl"><span class="n">CL_PLATFORM_SEMAPHORE_IMPORT_HANDLE_TYPES_KHR</span>                       <span class="mh">0x2037</span>
<span class="n">CL_PLATFORM_SEMAPHORE_EXPORT_HANDLE_TYPES_KHR</span>                       <span class="mh">0x2038</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Accepted value for the <em>param_name</em> parameter to <strong>clGetDeviceInfo</strong> to query external semaphore handle types that may be imported or exported by an OpenCL device:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="opencl"><span class="n">CL_DEVICE_SEMAPHORE_IMPORT_HANDLE_TYPES_KHR</span>                         <span class="mh">0x204D</span>
<span class="n">CL_DEVICE_SEMAPHORE_EXPORT_HANDLE_TYPES_KHR</span>                         <span class="mh">0x204E</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Following new attributes can be passed as part of <code>cl_semaphore_<wbr>properties_<wbr>khr</code> and <code>cl_semaphore_<wbr>info_<wbr>khr</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="opencl"><span class="n">CL_SEMAPHORE_EXPORT_HANDLE_TYPES_KHR</span>                                <span class="mh">0x203F</span>
<span class="n">CL_SEMAPHORE_EXPORT_HANDLE_TYPES_LIST_END_KHR</span>                       <span class="mi">0</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>External semaphore handle type added by <code>cl_khr_external_semaphore_dx_fence</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="opencl"><span class="n">CL_SEMAPHORE_HANDLE_D3D12_FENCE_KHR</span>                    <span class="mh">0x2059</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>External semaphore handle type added by <code>cl_khr_external_semaphore_opaque_fd</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="opencl"><span class="n">CL_SEMAPHORE_HANDLE_OPAQUE_FD_KHR</span>                      <span class="mh">0x2055</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>External semaphore handle type added by <code>cl_khr_external_semaphore_sync_fd</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="opencl"><span class="n">CL_SEMAPHORE_HANDLE_SYNC_FD_KHR</span>                        <span class="mh">0x2058</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>External semaphore handle types added by <code>cl_khr_external_semaphore_win32</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="opencl"><span class="n">CL_SEMAPHORE_HANDLE_OPAQUE_WIN32_KHR</span>                   <span class="mh">0x2056</span>
<span class="n">CL_SEMAPHORE_HANDLE_OPAQUE_WIN32_KMT_KHR</span>               <span class="mh">0x2057</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_modifications_to_existing_apis_added_by_this_spec_2"><a class="anchor" href="#_modifications_to_existing_apis_added_by_this_spec_2"></a>44.5. Modifications to existing APIs added by this spec</h3>
<div class="paragraph">
<p>Following new enums are added to the list of supported <em>param_names</em> by <strong>clGetPlatformInfo</strong>:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 58. List of supported param_names by <strong>clGetPlatformInfo</strong></caption>
<colgroup>
<col style="width: 33%;">
<col style="width: 17%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Platform Info</th>
<th class="tableblock halign-left valign-top">Return Type</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CL_PLATFORM_<wbr>SEMAPHORE_<wbr>IMPORT_<wbr>HANDLE_<wbr>TYPES_<wbr>KHR</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>cl_external_<wbr>semaphore_<wbr>handle_<wbr>type_<wbr>khr</code>[]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Returns the list of importable external semaphore handle types supported by all devices in <em>platform</em>.
      This size of this query may be 0 if no importable external semaphore handle types are supported by all devices in <em>platform</em>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CL_PLATFORM_<wbr>SEMAPHORE_<wbr>EXPORT_<wbr>HANDLE_<wbr>TYPES_<wbr>KHR</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>cl_external_<wbr>semaphore_<wbr>handle_<wbr>type_<wbr>khr</code>[]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Returns the list of exportable external semaphore handle types supported by all devices in the platform.
      This size of this query may be 0 if no exportable external semaphore handle types are supported by all devices in <em>platform</em>.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><strong>clGetPlatformInfo</strong> when called with <em>param_name</em> <code>CL_PLATFORM_<wbr>SEMAPHORE_<wbr>IMPORT_<wbr>HANDLE_<wbr>TYPES_<wbr>KHR</code> returns a common list of external semaphore handle types supported for importing by all devices in the platform.</p>
</div>
<div class="paragraph">
<p><strong>clGetPlatformInfo</strong> when called with <em>param_name</em> <code>CL_PLATFORM_<wbr>SEMAPHORE_<wbr>EXPORT_<wbr>HANDLE_<wbr>TYPES_<wbr>KHR</code> returns a common list of external semaphore handle types supported for exporting by all devices in the platform.</p>
</div>
<div class="paragraph">
<p>Following new enums are added to the list of supported <em>param_names</em> by <strong>clGetDeviceInfo</strong>:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 59. List of supported param_names by <strong>clGetDeviceInfo</strong></caption>
<colgroup>
<col style="width: 33%;">
<col style="width: 17%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Device Info</th>
<th class="tableblock halign-left valign-top">Return Type</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CL_DEVICE_<wbr>SEMAPHORE_<wbr>IMPORT_<wbr>HANDLE_<wbr>TYPES_<wbr>KHR</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>cl_external_<wbr>semaphore_<wbr>handle_<wbr>type_<wbr>khr</code>[]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Returns the list of importable external semaphore handle types supported by <em>device</em>.
        This size of this query may be 0 indicating that the device does not support importing semaphores.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CL_DEVICE_<wbr>SEMAPHORE_<wbr>EXPORT_<wbr>HANDLE_<wbr>TYPES_<wbr>KHR</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>cl_external_<wbr>semaphore_<wbr>handle_<wbr>type_<wbr>khr</code>[]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Returns the list of exportable external semaphore handle types supported by <em>device</em>.
        This size of this query may be 0 indicating that the device does not support exporting semaphores.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><strong>clGetDeviceInfo</strong> when called with <em>param_name</em> <code>CL_DEVICE_<wbr>SEMAPHORE_<wbr>IMPORT_<wbr>HANDLE_<wbr>TYPES_<wbr>KHR</code> returns a list of external semaphore handle types supported for importing.</p>
</div>
<div class="paragraph">
<p><strong>clGetDeviceInfo</strong> when called with <em>param_name</em> <code>CL_DEVICE_<wbr>SEMAPHORE_<wbr>EXPORT_<wbr>HANDLE_<wbr>TYPES_<wbr>KHR</code> returns a list of external semaphore handle types supported for exporting.</p>
</div>
<div class="paragraph">
<p>One of the above two queries <code>CL_DEVICE_<wbr>SEMAPHORE_<wbr>IMPORT_<wbr>HANDLE_<wbr>TYPES_<wbr>KHR</code> and <code>CL_DEVICE_<wbr>SEMAPHORE_<wbr>EXPORT_<wbr>HANDLE_<wbr>TYPES_<wbr>KHR</code> must return a non-empty list indicating support for at least one of the valid semaphore handles types either for import or for export or both.</p>
</div>
<div class="paragraph">
<p>Following new properties are added to the list of possible supported properties by <strong>clCreateSemaphoreWithPropertiesKHR</strong>:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 60. List of supported semaphore creation properties by <strong>clCreateSemaphoreWithPropertiesKHR</strong></caption>
<colgroup>
<col style="width: 33%;">
<col style="width: 17%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Semaphore Property</th>
<th class="tableblock halign-left valign-top">Property Value</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CL_SEMAPHORE_<wbr>EXPORT_<wbr>HANDLE_<wbr>TYPES_<wbr>KHR</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>cl_external_<wbr>semaphore_<wbr>handle_<wbr>type_<wbr>khr</code>[]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Specifies the list of semaphore handle type properties terminated with
      <code>CL_SEMAPHORE_<wbr>EXPORT_<wbr>HANDLE_<wbr>TYPES_<wbr>LIST_<wbr>END_<wbr>KHR</code> that can be used to export
      the semaphore being created.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Add to the list of error conditions for <strong>clCreateSemaphoreWithPropertiesKHR</strong>:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>CL_INVALID_<wbr>DEVICE</code> if one or more devices identified by properties <code>CL_DEVICE_<wbr>HANDLE_<wbr>LIST_<wbr>KHR</code> can not import the requested external semaphore handle type.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>clCreateSemaphoreWithPropertiesKHR</strong> may return a NULL value on some implementations if <em>sema_props</em> does not contain an external semaphore handle type to import.
Such implementations are required to return a valid semaphore when a supported external memory handle type and valid external semaphore handle is specified.</p>
</div>
<div class="paragraph">
<p>Add to the list of supported <em>param_names</em> by <strong>clGetSemaphoreInfoKHR</strong>:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 61. List of supported param_names by <strong>clGetSemaphoreInfoKHR</strong></caption>
<colgroup>
<col style="width: 33%;">
<col style="width: 17%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Semaphore Info</th>
<th class="tableblock halign-left valign-top">Return Type</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CL_SEMAPHORE_<wbr>EXPORT_<wbr>HANDLE_<wbr>TYPES_<wbr>KHR</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>cl_external_<wbr>semaphore_<wbr>handle_<wbr>type_<wbr>khr</code>[]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Returns the list of external semaphore handle types that may be used for
        exporting. The size of this query may be 0 indicating that this
        semaphore does not support any handle types for exporting.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="_exporting_semaphore_external_handles"><a class="anchor" href="#_exporting_semaphore_external_handles"></a>44.6. Exporting semaphore external handles</h3>
<div class="paragraph">
<p>To export an external handle from a semaphore, call the function</p>
</div>
<div id="clGetSemaphoreHandleForTypeKHR" class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="opencl"><span class="kt">cl_int</span> <span class="nf">clGetSemaphoreHandleForTypeKHR</span><span class="p">(</span>
    <span class="kt">cl_semaphore_khr</span> <span class="n">sema_object</span><span class="p">,</span>
    <span class="kt">cl_device_id</span> <span class="n">device</span><span class="p">,</span>
    <span class="kt">cl_external_semaphore_handle_type_khr</span> <span class="n">handle_type</span><span class="p">,</span>
    <span class="kt">size_t</span> <span class="n">handle_size</span><span class="p">,</span>
    <span class="kt">void</span><span class="o">*</span> <span class="n">handle_ptr</span><span class="p">,</span>
    <span class="kt">size_t</span><span class="o">*</span> <span class="n">handle_size_ret</span><span class="p">);</span></code></pre>
</div>
</div>
<div class="paragraph">
<p><em>sema_object</em> specifies a valid semaphore object with exportable properties.</p>
</div>
<div class="paragraph">
<p><em>device</em> specifies a valid device for which a semaphore handle is being requested.</p>
</div>
<div class="paragraph">
<p><em>handle_type</em> specifies the type of semaphore handle that should be returned for this exportable <em>sema_object</em> and must be one of the values specified when <em>sema_object</em> was created.</p>
</div>
<div class="paragraph">
<p><em>handle_size</em> specifies the size of memory pointed by <em>handle_ptr</em>.</p>
</div>
<div class="paragraph">
<p><em>handle_ptr</em> is a pointer to memory where the exported external handle is returned.
If <em>param_value</em> is <code>NULL</code>, it is ignored.</p>
</div>
<div class="paragraph">
<p><em>handle_size_ret</em> returns the actual size in bytes for the external handle.
If <em>handle_size_ret</em> is <code>NULL</code>, it is ignored.</p>
</div>
<div class="paragraph">
<p><strong>clGetSemaphoreHandleForTypeKHR</strong> returns <code>CL_SUCCESS</code> if the semaphore handle is queried successfully.
Otherwise, it returns one of the following errors:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>CL_INVALID_<wbr>SEMAPHORE_<wbr>KHR</code></p>
<div class="ulist">
<ul>
<li>
<p>if <em>sema_object</em> is not a valid semaphore</p>
</li>
<li>
<p>if <em>sema_object</em> is not exportable</p>
</li>
</ul>
</div>
</li>
<li>
<p><code>CL_INVALID_<wbr>DEVICE</code></p>
<div class="ulist">
<ul>
<li>
<p>if <em>device</em> is not a valid device, or</p>
</li>
<li>
<p>if <em>sema_object</em> belongs to a context that is not associated with <em>device</em>, or</p>
</li>
<li>
<p>if <em>sema_object</em> can not be shared with <em>device</em>.</p>
</li>
</ul>
</div>
</li>
<li>
<p><code>CL_INVALID_<wbr>VALUE</code> if the requested external semaphore handle type was not specified when <em>sema_object</em> was created.</p>
</li>
<li>
<p><code>CL_INVALID_<wbr>VALUE</code> if <em>handle_size</em> is less than the size needed to store the returned handle.</p>
</li>
<li>
<p><code>CL_OUT_<wbr>OF_<wbr>RESOURCES</code> if there is a failure to allocate resources required by the OpenCL implementation on the device.</p>
</li>
<li>
<p><code>CL_OUT_<wbr>OF_<wbr>HOST_<wbr>MEMORY</code> if there is a failure to allocate resources required by the OpenCL implementation on the host.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_importing_semaphore_external_handles"><a class="anchor" href="#_importing_semaphore_external_handles"></a>44.7. Importing semaphore external handles</h3>
<div class="paragraph">
<p>Applications can import a semaphore payload into an existing semaphore using an
external semaphore handle. The effects of the import operation will be either
temporary or permanent, as specified by the application. If the import is
temporary, the implementation must restore the semaphore to its prior permanent
state after submitting the next semaphore wait operation. Performing a
subsequent temporary import on a semaphore before performing a semaphore wait
has no effect on this requirement; the next wait submitted on the semaphore must
still restore its last permanent state. A permanent payload import behaves as if
the target semaphore was destroyed, and a new semaphore was created with the
same handle but the imported payload. Because importing a semaphore payload
temporarily or permanently detaches the existing payload from a semaphore,
similar usage restrictions to those applied to <strong>clReleaseSemaphoreKHR</strong> are
applied to any command that imports a semaphore payload. Which of these import
types is used is referred to as the import operation&#8217;s permanence. Each handle
type supports either one or both types of permanence.</p>
</div>
<div class="paragraph">
<p>The implementation must perform the import operation by either referencing or
copying the payload referred to by the specified external semaphore handle,
depending on the handle&#8217;s type. The import method used is referred to as the
handle type&#8217;s transference. When using handle types with reference transference,
importing a payload to a semaphore adds the semaphore to the set of all
semaphores sharing that payload. This set includes the semaphore from which the
payload was exported. Semaphore signaling and waiting operations performed on
any semaphore in the set must behave as if the set were a single semaphore.
Importing a payload using handle types with copy transference creates a
duplicate copy of the payload at the time of import, but makes no further
reference to it. Semaphore signaling and waiting operations performed on the
target of copy imports must not affect any other semaphore or payload.</p>
</div>
<div class="paragraph">
<p>Export operations have the same transference as the specified handle type&#8217;s
import operations. Additionally, exporting a semaphore payload to a handle with
copy transference has the same side effects on the source semaphore&#8217;s payload as
executing a semaphore wait operation. If the semaphore was using a temporarily
imported payload, the semaphore&#8217;s prior permanent payload will be restored.</p>
</div>
<div class="paragraph">
<p>Please refer to handle specific specifications for more details on transference and
permanence requirements specific to handle type.</p>
</div>
</div>
<div class="sect2">
<h3 id="_descriptions_of_external_semaphore_handle_types"><a class="anchor" href="#_descriptions_of_external_semaphore_handle_types"></a>44.8. Descriptions of External Semaphore Handle Types</h3>
<div class="paragraph">
<p>This section describes the external semaphore handle types that are added by related extensions.</p>
</div>
<div class="paragraph">
<p>Applications can import the same semaphore payload into multiple OpenCL contexts, into the same context from which it was exported, and multiple times into a given OpenCL context.
In all cases, each import operation must create a distinct semaphore object.</p>
</div>
<div class="sect3">
<h4 id="_file_descriptor_handle_types"><a class="anchor" href="#_file_descriptor_handle_types"></a>44.8.1. File Descriptor Handle Types</h4>
<div class="paragraph">
<p>The <code>cl_khr_external_semaphore_opaque_fd</code> extension extends <code>cl_external_<wbr>semaphore_<wbr>handle_<wbr>type_<wbr>khr</code> to support the following new types of handles, and adds as a property that may be specified when creating a semaphore from an external handle:</p>
</div>
<div class="openblock">
<div class="content">
<div class="ulist">
<ul>
<li>
<p><code>CL_SEMAPHORE_<wbr>HANDLE_<wbr>OPAQUE_<wbr>FD_<wbr>KHR</code> specifies a POSIX file descriptor handle that has only limited valid usage outside of OpenCL and other compatible APIs. It must be compatible with the POSIX system calls dup, dup2, close, and the non-standard system call dup3. Additionally, it must be transportable over a socket using an SCM_RIGHTS control message. It owns a reference to the underlying synchronization primitive represented by its semaphore object.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="paragraph">
<p>Transference and permanence properties for handle types added by <code>cl_khr_external_semaphore_opaque_fd</code>:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 62. Transference and Permanence Properties for <code>cl_khr_external_semaphore_opaque_fd</code> handles</caption>
<colgroup>
<col style="width: 60%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Handle Type</th>
<th class="tableblock halign-left valign-top">Transference</th>
<th class="tableblock halign-left valign-top">Permanence</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CL_SEMAPHORE_<wbr>HANDLE_<wbr>OPAQUE_<wbr>FD_<wbr>KHR</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Reference</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Temporary, Permanent</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>The <code>cl_khr_external_semaphore_sync_fd</code> extension extends <code>cl_external_<wbr>semaphore_<wbr>handle_<wbr>type_<wbr>khr</code> to support the following new types of handles, and adds as a property that may be specified when creating a semaphore from an external handle:</p>
</div>
<div class="openblock">
<div class="content">
<div class="ulist">
<ul>
<li>
<p><code>CL_SEMAPHORE_<wbr>HANDLE_<wbr>SYNC_<wbr>FD_<wbr>KHR</code> specifies a POSIX file descriptor handle to a Linux Sync File or Android Fence object. It can be used with any native API accepting a valid sync file or fence as input. It owns a reference to the underlying synchronization primitive associated with the file descriptor. Implementations which support importing this handle type must accept any type of sync or fence FD supported by the native system they are running on.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="paragraph">
<p>The special value -1 for fd is treated like a valid sync file descriptor referring to an object that has already signaled. The import operation will succeed and the semaphore will have a temporarily imported payload as if a valid file descriptor had been provided.</p>
</div>
<div class="paragraph">
<p>Note: This special behavior for importing an invalid sync file descriptor allows easier interoperability with other system APIs which use the convention that an invalid sync file descriptor represents work that has already completed and does not need to be waited for. It is consistent with the option for implementations to return a -1 file descriptor when exporting a <code>CL_SEMAPHORE_<wbr>HANDLE_<wbr>SYNC_<wbr>FD_<wbr>KHR</code> from a <code>cl_semaphore_<wbr>khr</code> which is signaled.</p>
</div>
<div class="paragraph">
<p>Transference and permanence properties for handle types added by <code>cl_khr_external_semaphore_sync_fd</code>:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 63. Transference and Permanence Properties for <code>cl_khr_external_semaphore_sync_fd</code> handles</caption>
<colgroup>
<col style="width: 60%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Handle Type</th>
<th class="tableblock halign-left valign-top">Transference</th>
<th class="tableblock halign-left valign-top">Permanence</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CL_SEMAPHORE_<wbr>HANDLE_<wbr>SYNC_<wbr>FD_<wbr>KHR</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Copy</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Temporary</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>For these extensions, importing a semaphore payload from a file descriptor transfers ownership of the file descriptor from the application to the OpenCL implementation. The application must not perform any operations on the file descriptor after a successful import.</p>
</div>
</div>
<div class="sect3">
<h4 id="_nt_handle_types"><a class="anchor" href="#_nt_handle_types"></a>44.8.2. NT Handle Types</h4>
<div class="paragraph">
<p>The <code>cl_khr_external_semaphore_dx_fence</code> extension extends <code>cl_external_<wbr>semaphore_<wbr>handle_<wbr>type_<wbr>khr</code> to support the following new types of handles, and adds as a property that may be specified when creating a semaphore from an external handle:</p>
</div>
<div class="openblock">
<div class="content">
<div class="ulist">
<ul>
<li>
<p><code>CL_SEMAPHORE_<wbr>HANDLE_<wbr>D3D12_<wbr>FENCE_<wbr>KHR</code> specifies an NT handle returned by ID3D12Device::CreateSharedHandle referring to a Direct3D 12 fence, or ID3D11Device5::CreateFence referring to a Direct3D 11 fence. It owns a reference to the underlying synchronization primitive associated with the Direct3D fence.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="paragraph">
<p>When waiting on semaphores using <strong>clEnqueueWaitSemaphoresKHR</strong> or signaling semaphores using <strong>clEnqueueSignalSemaphoresKHR</strong>, the semaphore payload must be provided for semaphores created from <code>CL_SEMAPHORE_<wbr>HANDLE_<wbr>D3D12_<wbr>FENCE_<wbr>KHR</code>.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>If <em>sema_objects</em> list has a mix of semaphores obtained from <code>CL_SEMAPHORE_<wbr>HANDLE_<wbr>D3D12_<wbr>FENCE_<wbr>KHR</code> and other handle types,
then the <em>sema_payload_list</em> should point to a list of <em>num_sema_objects</em> payload values for each semaphore in <em>sema_objects</em>.
However, the payload values corresponding to semaphores with type <code>CL_SEMAPHORE_<wbr>TYPE_<wbr>BINARY_<wbr>KHR</code> can be set to 0 or will be ignored.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>clEnqueueWaitSemaphoresKHR</strong> and <strong>clEnqueueSignalSemaphoresKHR</strong> may return <code>CL_INVALID_<wbr>VALUE</code> if <em>sema_objects</em> list has one or more semaphores obtained from <code>CL_SEMAPHORE_<wbr>HANDLE_<wbr>D3D12_<wbr>FENCE_<wbr>KHR</code> and <em>sema_payload_list</em> is NULL.</p>
</div>
<div class="paragraph">
<p>Transference and permanence properties for handle types added by <code>cl_khr_external_semaphore_dx_fence</code>:</p>
</div>
<div class="openblock">
<div class="content">
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 64. Transference and Permanence Properties for <code>cl_khr_external_semaphore_dx_fence</code> handles</caption>
<colgroup>
<col style="width: 60%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Handle Type</th>
<th class="tableblock halign-left valign-top">Transference</th>
<th class="tableblock halign-left valign-top">Permanence</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CL_SEMAPHORE_<wbr>HANDLE_<wbr>D3D12_<wbr>FENCE_<wbr>KHR</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Reference</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Temporary, Permanent</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="paragraph">
<p>The <code>cl_khr_external_semaphore_win32</code> extension extends <code>cl_external_<wbr>semaphore_<wbr>handle_<wbr>type_<wbr>khr</code> to support the following new types of handles, and adds as a property that may be specified when creating a semaphore from an external handle:</p>
</div>
<div class="openblock">
<div class="content">
<div class="ulist">
<ul>
<li>
<p><code>CL_SEMAPHORE_<wbr>HANDLE_<wbr>OPAQUE_<wbr>WIN32_<wbr>KHR</code> specifies an NT handle that has only limited valid usage outside of OpenCL and other compatible APIs. It must be compatible with the functions DuplicateHandle, CloseHandle, CompareObjectHandles, GetHandleInformation, and SetHandleInformation. It owns a reference to the underlying synchronization primitive represented by its semaphore object.</p>
</li>
<li>
<p><code>CL_SEMAPHORE_<wbr>HANDLE_<wbr>OPAQUE_<wbr>WIN32_<wbr>KMT_<wbr>KHR</code> specifies a global share handle that has only limited valid usage outside of OpenCL and other compatible APIs. It is not compatible with any native APIs. It does not own a reference to the underlying synchronization primitive represented by its semaphore object, and will therefore become invalid when all semaphore objects associated with it are destroyed.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="paragraph">
<p>Transference and permanence properties for handle types added by <code>cl_khr_external_semaphore_win32</code>:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 65. Transference and Permanence Properties for <code>cl_khr_external_semaphore_win32</code> handles</caption>
<colgroup>
<col style="width: 60%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Handle Type</th>
<th class="tableblock halign-left valign-top">Transference</th>
<th class="tableblock halign-left valign-top">Permanence</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CL_SEMAPHORE_<wbr>HANDLE_<wbr>OPAQUE_<wbr>WIN32_<wbr>KHR</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Reference</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Temporary, Permanent</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CL_SEMAPHORE_<wbr>HANDLE_<wbr>OPAQUE_<wbr>WIN32_<wbr>KMT_<wbr>KHR</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Reference</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Temporary, Permanent</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>For these extensions, importing a semaphore payload from Windows handles does not transfer ownership of the handle to the OpenCL implementation. For handle types defined as NT handles, the application must release ownership using the CloseHandle system call when the handle is no longer needed.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="cl_khr_external_semaphore-Sample-Code"><a class="anchor" href="#cl_khr_external_semaphore-Sample-Code"></a>44.9. Sample Code</h3>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Example for importing a semaphore created by another API in OpenCL in a single-device context.</p>
<div class="openblock">
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="opencl"><span class="c1">// Get cl_devices of the platform.</span>
<span class="n">clGetDeviceIDs</span><span class="p">(...,</span> <span class="o">&amp;</span><span class="n">devices</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">deviceCount</span><span class="p">);</span>

<span class="c1">// Create cl_context with just first device</span>
<span class="n">clCreateContext</span><span class="p">(...,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">devices</span><span class="p">,</span> <span class="p">...);</span>

<span class="c1">// Obtain fd/win32 or similar handle for external semaphore to be imported</span>
<span class="c1">// from the other API.</span>
<span class="kt">int</span> <span class="n">fd</span> <span class="o">=</span> <span class="n">getFdForExternalSemaphore</span><span class="p">();</span>

<span class="c1">// Create clSema of type cl_semaphore_khr usable on the only available device</span>
<span class="c1">// assuming the semaphore was imported from the same device.</span>

<span class="kt">cl_semaphore_properties_khr</span> <span class="n">sema_props</span><span class="p">[]</span> <span class="o">=</span>
        <span class="p">{(</span><span class="kt">cl_semaphore_properties_khr</span><span class="p">)</span><span class="n">CL_SEMAPHORE_TYPE_KHR</span><span class="p">,</span>
         <span class="p">(</span><span class="kt">cl_semaphore_properties_khr</span><span class="p">)</span><span class="n">CL_SEMAPHORE_TYPE_BINARY_KHR</span><span class="p">,</span>
         <span class="p">(</span><span class="kt">cl_semaphore_properties_khr</span><span class="p">)</span><span class="n">CL_SEMAPHORE_HANDLE_OPAQUE_FD_KHR</span><span class="p">,</span>
         <span class="p">(</span><span class="kt">cl_semaphore_properties_khr</span><span class="p">)</span><span class="n">fd</span><span class="p">,</span>
          <span class="mi">0</span><span class="p">};</span>


<span class="kt">int</span> <span class="n">errcode_ret</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
<span class="kt">cl_semaphore_khr</span> <span class="n">clSema</span> <span class="o">=</span> <span class="n">clCreateSemaphoreWithPropertiesKHR</span><span class="p">(</span><span class="n">context</span><span class="p">,</span>
                                                             <span class="n">sema_props</span><span class="p">,</span>
                                                             <span class="o">&amp;</span><span class="n">errcode_ret</span><span class="p">);</span></code></pre>
</div>
</div>
</div>
</div>
</li>
<li>
<p>Example for importing a semaphore created by another API in OpenCL in a multi-device context for single device usage.</p>
<div class="openblock">
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="opencl"><span class="c1">// Get cl_devices of the platform.</span>
<span class="n">clGetDeviceIDs</span><span class="p">(...,</span> <span class="o">&amp;</span><span class="n">devices</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">deviceCount</span><span class="p">);</span>

<span class="c1">// Create cl_context with first two devices</span>
<span class="n">clCreateContext</span><span class="p">(...,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">devices</span><span class="p">,</span> <span class="p">...);</span>

<span class="c1">// Obtain fd/win32 or similar handle for external semaphore to be imported</span>
<span class="c1">// from the other API.</span>
<span class="kt">int</span> <span class="n">fd</span> <span class="o">=</span> <span class="n">getFdForExternalSemaphore</span><span class="p">();</span>

<span class="c1">// Create clSema of type cl_semaphore_khr usable only on devices[1]</span>
<span class="c1">// assuming the semaphore was imported from the same device.</span>

<span class="kt">cl_semaphore_properties_khr</span> <span class="n">sema_props</span><span class="p">[]</span> <span class="o">=</span>
        <span class="p">{(</span><span class="kt">cl_semaphore_properties_khr</span><span class="p">)</span><span class="n">CL_SEMAPHORE_TYPE_KHR</span><span class="p">,</span>
         <span class="p">(</span><span class="kt">cl_semaphore_properties_khr</span><span class="p">)</span><span class="n">CL_SEMAPHORE_TYPE_BINARY_KHR</span><span class="p">,</span>
         <span class="p">(</span><span class="kt">cl_semaphore_properties_khr</span><span class="p">)</span><span class="n">CL_SEMAPHORE_HANDLE_OPAQUE_FD_KHR</span><span class="p">,</span>
         <span class="p">(</span><span class="kt">cl_semaphore_properties_khr</span><span class="p">)</span><span class="n">fd</span><span class="p">,</span>
         <span class="p">(</span><span class="kt">cl_semaphore_properties_khr</span><span class="p">)</span><span class="n">CL_DEVICE_HANDLE_LIST_KHR</span><span class="p">,</span>
         <span class="p">(</span><span class="kt">cl_semaphore_properties_khr</span><span class="p">)</span><span class="n">devices</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">CL_DEVICE_HANDLE_LIST_END_KHR</span><span class="p">,</span>
          <span class="mi">0</span><span class="p">};</span>


<span class="kt">int</span> <span class="n">errcode_ret</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
<span class="kt">cl_semaphore_khr</span> <span class="n">clSema</span> <span class="o">=</span> <span class="n">clCreateSemaphoreWithPropertiesKHR</span><span class="p">(</span><span class="n">context</span><span class="p">,</span>
                                                             <span class="n">sema_props</span><span class="p">,</span>
                                                             <span class="o">&amp;</span><span class="n">errcode_ret</span><span class="p">);</span></code></pre>
</div>
</div>
</div>
</div>
</li>
<li>
<p>Example for synchronization using a semaphore created by another API and imported in OpenCL</p>
<div class="openblock">
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="opencl"><span class="c1">// Create clSema using one of the above examples of external semaphore creation.</span>

<span class="kt">int</span> <span class="n">errcode_ret</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
<span class="kt">cl_semaphore_khr</span> <span class="n">clSema</span> <span class="o">=</span> <span class="n">clCreateSemaphoreWithPropertiesKHR</span><span class="p">(</span><span class="n">context</span><span class="p">,</span>
                                                             <span class="n">sema_props</span><span class="p">,</span>
                                                             <span class="o">&amp;</span><span class="n">errcode_ret</span><span class="p">);</span>

<span class="c1">// Start the main loop</span>

<span class="k">while</span> <span class="p">(</span><span class="nb">true</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// (not shown) Signal the semaphore from the other API</span>

    <span class="c1">// Wait for the semaphore in OpenCL</span>
    <span class="n">clEnqueueWaitSemaphoresKHR</span><span class="p">(</span><span class="cm">/*command_queue*/</span>           <span class="n">command_queue</span><span class="p">,</span>
                               <span class="cm">/*num_sema_objects*/</span>        <span class="mi">1</span><span class="p">,</span>
                               <span class="cm">/*sema_objects*/</span>            <span class="o">&amp;</span><span class="n">clSema</span><span class="p">,</span>
                               <span class="cm">/*num_events_in_wait_list*/</span> <span class="mi">0</span><span class="p">,</span>
                               <span class="cm">/*event_wait_list*/</span>         <span class="nb">NULL</span><span class="p">,</span>
                               <span class="cm">/*event*/</span>                   <span class="nb">NULL</span><span class="p">);</span>

    <span class="c1">// Launch kernel</span>
    <span class="n">clEnqueueNDRangeKernel</span><span class="p">(</span><span class="n">command_queue</span><span class="p">,</span> <span class="p">...);</span>

    <span class="c1">// Signal the semaphore in OpenCL</span>
    <span class="n">clEnqueueSignalSemaphoresKHR</span><span class="p">(</span><span class="cm">/*command_queue*/</span>           <span class="n">command_queue</span><span class="p">,</span>
                                 <span class="cm">/*num_sema_objects*/</span>        <span class="mi">1</span><span class="p">,</span>
                                 <span class="cm">/*sema_objects*/</span>            <span class="o">&amp;</span><span class="n">clSema</span><span class="p">,</span>
                                 <span class="cm">/*num_events_in_wait_list*/</span> <span class="mi">0</span><span class="p">,</span>
                                 <span class="cm">/*event_wait_list*/</span>         <span class="nb">NULL</span><span class="p">,</span>
                                 <span class="cm">/*event*/</span>                   <span class="nb">NULL</span><span class="p">);</span>

    <span class="c1">// (not shown) Launch work in the other API that waits on 'clSema'</span>

<span class="p">}</span></code></pre>
</div>
</div>
</div>
</div>
</li>
<li>
<p>Example for synchronization using semaphore exported by OpenCL</p>
<div class="openblock">
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="opencl"><span class="c1">// Get cl_devices of the platform.</span>
<span class="n">clGetDeviceIDs</span><span class="p">(...,</span> <span class="o">&amp;</span><span class="n">devices</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">deviceCount</span><span class="p">);</span>

<span class="c1">// Create cl_context with first two devices</span>
<span class="n">clCreateContext</span><span class="p">(...,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">devices</span><span class="p">,</span> <span class="p">...);</span>

<span class="c1">// Create clSema of type cl_semaphore_khr usable only on device 1</span>
<span class="kt">cl_semaphore_properties_khr</span> <span class="n">sema_props</span><span class="p">[]</span> <span class="o">=</span>
        <span class="p">{(</span><span class="kt">cl_semaphore_properties_khr</span><span class="p">)</span><span class="n">CL_SEMAPHORE_TYPE_KHR</span><span class="p">,</span>
         <span class="p">(</span><span class="kt">cl_semaphore_properties_khr</span><span class="p">)</span><span class="n">CL_SEMAPHORE_TYPE_BINARY_KHR</span><span class="p">,</span>
         <span class="p">(</span><span class="kt">cl_semaphore_properties_khr</span><span class="p">)</span><span class="n">CL_SEMAPHORE_EXPORT_HANDLE_TYPES_KHR</span><span class="p">,</span>
         <span class="p">(</span><span class="kt">cl_semaphore_properties_khr</span><span class="p">)</span><span class="n">CL_SEMAPHORE_HANDLE_OPAQUE_FD_KHR</span><span class="p">,</span>
         <span class="n">CL_SEMAPHORE_EXPORT_HANDLE_TYPES_LIST_END_KHR</span><span class="p">,</span>
         <span class="p">(</span><span class="kt">cl_semaphore_properties_khr</span><span class="p">)</span><span class="n">CL_DEVICE_HANDLE_LIST_KHR</span><span class="p">,</span>
         <span class="p">(</span><span class="kt">cl_semaphore_properties_khr</span><span class="p">)</span><span class="n">devices</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
         <span class="n">CL_DEVICE_HANDLE_LIST_END_KHR</span><span class="p">,</span>
         <span class="mi">0</span><span class="p">};</span>

<span class="kt">int</span> <span class="n">errcode_ret</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
<span class="kt">cl_semaphore_khr</span> <span class="n">clSema</span> <span class="o">=</span> <span class="n">clCreateSemaphoreWithPropertiesKHR</span><span class="p">(</span><span class="n">context</span><span class="p">,</span>
                                                             <span class="n">sema_props</span><span class="p">,</span>
                                                             <span class="o">&amp;</span><span class="n">errcode_ret</span><span class="p">);</span>

<span class="c1">// Application queries handle-type and the exportable handle associated with the semaphore.</span>
<span class="n">clGetSemaphoreInfoKHR</span><span class="p">(</span><span class="n">clSema</span><span class="p">,</span>
                      <span class="n">CL_SEMAPHORE_EXPORT_HANDLE_TYPES_KHR</span><span class="p">,</span>
                      <span class="k">sizeof</span><span class="p">(</span><span class="kt">cl_external_semaphore_handle_type_khr</span><span class="p">),</span>
                      <span class="o">&amp;</span><span class="n">handle_type</span><span class="p">,</span>
                      <span class="o">&amp;</span><span class="n">handle_type_size</span><span class="p">);</span>

<span class="c1">// The other API or process can use the exported semaphore handle</span>
<span class="c1">// to import</span>
<span class="kt">int</span> <span class="n">fd</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
<span class="k">if</span> <span class="p">(</span><span class="n">handle_type</span> <span class="o">==</span> <span class="n">CL_SEMAPHORE_HANDLE_OPAQUE_FD_KHR</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">clGetSemaphoreHandleForTypeKHR</span><span class="p">(</span><span class="n">clSema</span><span class="p">,</span>
                                   <span class="n">device</span><span class="p">,</span>
                                   <span class="n">CL_SEMAPHORE_HANDLE_OPAQUE_FD_KHR</span><span class="p">,</span>
                                   <span class="k">sizeof</span><span class="p">(</span><span class="kt">int</span><span class="p">),</span>
                                   <span class="o">&amp;</span><span class="n">fd</span><span class="p">,</span>
                                   <span class="nb">NULL</span><span class="p">);</span>
<span class="p">}</span>

<span class="c1">// Start the main rendering loop</span>

<span class="k">while</span> <span class="p">(</span><span class="nb">true</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// (not shown) Signal the semaphore from the other API</span>

    <span class="c1">// Wait for the semaphore in OpenCL</span>
    <span class="n">clEnqueueWaitSemaphoresKHR</span><span class="p">(</span><span class="cm">/*command_queue*/</span>           <span class="n">command_queue</span><span class="p">,</span>
                               <span class="cm">/*num_sema_objects*/</span>        <span class="mi">1</span><span class="p">,</span>
                               <span class="cm">/*sema_objects*/</span>            <span class="o">&amp;</span><span class="n">clSema</span><span class="p">,</span>
                               <span class="cm">/*num_events_in_wait_list*/</span> <span class="mi">0</span><span class="p">,</span>
                               <span class="cm">/*event_wait_list*/</span>         <span class="nb">NULL</span><span class="p">,</span>
                               <span class="cm">/*event*/</span>                   <span class="nb">NULL</span><span class="p">);</span>

    <span class="c1">// Launch kernel</span>
    <span class="n">clEnqueueNDRangeKernel</span><span class="p">(</span><span class="n">command_queue</span><span class="p">,</span> <span class="p">...);</span>

    <span class="c1">// Signal the semaphore in OpenCL</span>
    <span class="n">clEnqueueSignalSemaphoresKHR</span><span class="p">(</span><span class="cm">/*command_queue*/</span>           <span class="n">command_queue</span><span class="p">,</span>
                                 <span class="cm">/*num_sema_objects*/</span>        <span class="mi">1</span><span class="p">,</span>
                                 <span class="cm">/*sema_objects*/</span>            <span class="o">&amp;</span><span class="n">clSema</span><span class="p">,</span>
                                 <span class="cm">/*num_events_in_wait_list*/</span> <span class="mi">0</span><span class="p">,</span>
                                 <span class="cm">/*event_wait_list*/</span>         <span class="nb">NULL</span><span class="p">,</span>
                                 <span class="cm">/*event*/</span>                   <span class="nb">NULL</span><span class="p">);</span>

    <span class="c1">// (not shown) Launch work in the other API that waits on 'clSema'</span>

<span class="p">}</span></code></pre>
</div>
</div>
</div>
</div>
</li>
</ol>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="cl_khr_external_memory"><a class="anchor" href="#cl_khr_external_memory"></a>45. External Memory (Provisional)</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This extension defines a generic mechanism to share buffer and image objects between OpenCL and many other APIs.</p>
</div>
<div class="paragraph">
<p>In particular, the <code>cl_khr_external_memory</code> extension defines:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Optional properties to import external memory exported by other APIs into OpenCL for a set of devices.</p>
</li>
<li>
<p>Routines to explicitly hand off memory ownership between OpenCL and other APIs.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Other related extensions define specific external memory types that may be imported into OpenCL.</p>
</div>
<div class="sect2">
<h3 id="_general_information_44"><a class="anchor" href="#_general_information_44"></a>45.1. General Information</h3>
<div class="sect3">
<h4 id="_name_strings_8"><a class="anchor" href="#_name_strings_8"></a>45.1.1. Name Strings</h4>
<div class="paragraph">
<p><code>cl_khr_external_memory</code><br>
<code>cl_khr_external_memory_dma_buf</code><br>
<code>cl_khr_external_memory_dx</code><br>
<code>cl_khr_external_memory_opaque_fd</code><br>
<code>cl_khr_external_memory_win32</code></p>
</div>
</div>
<div class="sect3">
<h4 id="_version_history_44"><a class="anchor" href="#_version_history_44"></a>45.1.2. Version History</h4>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 60%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><strong>Date</strong></th>
<th class="tableblock halign-left valign-top"><strong>Version</strong></th>
<th class="tableblock halign-left valign-top"><strong>Description</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">2021-09-10</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.9.0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Initial version (provisional).</p></td>
</tr>
</tbody>
</table>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
This is a preview of an OpenCL provisional extension specification that has been Ratified under the Khronos Intellectual Property Framework. It is being made publicly available prior to being uploaded to the Khronos registry to enable review and feedback from the community. If you have feedback please create an issue on <a href="https://github.com/KhronosGroup/OpenCL-Docs/" class="bare">https://github.com/KhronosGroup/OpenCL-Docs/</a>
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_dependencies_8"><a class="anchor" href="#_dependencies_8"></a>45.1.3. Dependencies</h4>
<div class="paragraph">
<p>This extension is written against the OpenCL Specification Version 3.0.8.</p>
</div>
<div class="paragraph">
<p>Because this extension adds new properties for <strong>clCreateBufferWithProperties</strong>
and <strong>clCreateImageWithProperties</strong> this extension requires OpenCL 3.0.</p>
</div>
</div>
<div class="sect3">
<h4 id="_contributors_5"><a class="anchor" href="#_contributors_5"></a>45.1.4. Contributors</h4>
<div class="paragraph">
<p>Ajit Hakke-Patil,  NVIDIA<br>
Amit Rao, NVIDIA<br>
Balaji Calidas, QUALCOMM<br>
Ben Ashbaugh, INTEL<br>
Carsten Rohde, NVIDIA<br>
Christoph Kubisch, NVIDIA<br>
Debalina Bhattacharjee, NVIDIA<br>
James Jones,  NVIDIA<br>
Jason Ekstrand, INTEL<br>
Jeremy Kemp, IMAGINATION<br>
Joshua Kelly, QUALCOMM<br>
Karthik Raghavan Ravi, NVIDIA<br>
Kedar Patil, NVIDIA<br>
Kevin Petit, ARM<br>
Nikhil Joshi, NVIDIA<br>
Sharan Ashwathnarayan, NVIDIA<br>
Vivek Kini,  NVIDIA<br></p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_new_types_3"><a class="anchor" href="#_new_types_3"></a>45.2. New Types</h3>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="opencl"><span class="k">typedef</span> <span class="kt">cl_uint</span> <span class="kt">cl_external_memory_handle_type_khr</span><span class="p">;</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_new_api_functions_5"><a class="anchor" href="#_new_api_functions_5"></a>45.3. New API Functions</h3>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="opencl"><span class="kt">cl_int</span> <span class="nf">clEnqueueAcquireExternalMemObjectsKHR</span><span class="p">(</span>
    <span class="kt">cl_command_queue</span> <span class="n">command_queue</span><span class="p">,</span>
    <span class="kt">cl_uint</span> <span class="n">num_mem_objects</span><span class="p">,</span>
    <span class="k">const</span> <span class="kt">cl_mem</span> <span class="o">*</span><span class="n">mem_objects</span><span class="p">,</span>
    <span class="kt">cl_uint</span> <span class="n">num_events_in_wait_list</span><span class="p">,</span>
    <span class="k">const</span> <span class="kt">cl_event</span> <span class="o">*</span><span class="n">event_wait_list</span><span class="p">,</span>
    <span class="kt">cl_event</span> <span class="o">*</span><span class="n">event</span><span class="p">);</span>

<span class="kt">cl_int</span> <span class="nf">clEnqueueReleaseExternalMemObjectsKHR</span><span class="p">(</span>
    <span class="kt">cl_command_queue</span> <span class="n">command_queue</span><span class="p">,</span>
    <span class="kt">cl_uint</span> <span class="n">num_mem_objects</span><span class="p">,</span>
    <span class="k">const</span> <span class="kt">cl_mem</span> <span class="o">*</span><span class="n">mem_objects</span><span class="p">,</span>
    <span class="kt">cl_uint</span> <span class="n">num_events_in_wait_list</span><span class="p">,</span>
    <span class="k">const</span> <span class="kt">cl_event</span> <span class="o">*</span><span class="n">event_wait_list</span><span class="p">,</span>
    <span class="kt">cl_event</span> <span class="o">*</span><span class="n">event</span><span class="p">);</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_new_api_enums_6"><a class="anchor" href="#_new_api_enums_6"></a>45.4. New API Enums</h3>
<div class="paragraph">
<p>Accepted value for the <em>param_name</em> parameter to <strong>clGetPlatformInfo</strong> to query external memory handle types that may be imported by all devices in an OpenCL platform:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="opencl"><span class="n">CL_PLATFORM_EXTERNAL_MEMORY_IMPORT_HANDLE_TYPES_KHR</span>                    <span class="mh">0x2044</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Accepted value for the <em>param_name</em> parameter to <strong>clGetDeviceInfo</strong> to query external memory handle types that may be imported by an OpenCL device:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="opencl"><span class="n">CL_DEVICE_EXTERNAL_MEMORY_IMPORT_HANDLE_TYPES_KHR</span>                      <span class="mh">0x204F</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>New properties accepted as <em>properties</em> to <strong>clCreateBufferWithProperties</strong> and <strong>clCreateImageWithProperties</strong>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="opencl"><span class="n">CL_DEVICE_HANDLE_LIST_KHR</span>                                              <span class="mh">0x2051</span>
<span class="n">CL_DEVICE_HANDLE_LIST_END_KHR</span>                                          <span class="mi">0</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>New return values from <strong>clGetEventInfo</strong> when <em>param_name</em> is <code>CL_EVENT_<wbr>COMMAND_<wbr>TYPE</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="opencl"><span class="n">CL_COMMAND_ACQUIRE_EXTERNAL_MEM_OBJECTS_KHR</span>                            <span class="mh">0x2047</span>
<span class="n">CL_COMMAND_RELEASE_EXTERNAL_MEM_OBJECTS_KHR</span>                            <span class="mh">0x2048</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>External memory handle type added by <code>cl_khr_external_memory_dma_buf</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="opencl"><span class="n">CL_EXTERNAL_MEMORY_HANDLE_DMA_BUF_KHR</span>              <span class="mh">0x2067</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>External memory handle types added by <code>cl_khr_external_memory_dx</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="opencl"><span class="n">CL_EXTERNAL_MEMORY_HANDLE_D3D11_TEXTURE_KHR</span>        <span class="mh">0x2063</span>
<span class="n">CL_EXTERNAL_MEMORY_HANDLE_D3D11_TEXTURE_KMT_KHR</span>    <span class="mh">0x2064</span>
<span class="n">CL_EXTERNAL_MEMORY_HANDLE_D3D12_HEAP_KHR</span>           <span class="mh">0x2065</span>
<span class="n">CL_EXTERNAL_MEMORY_HANDLE_D3D12_RESOURCE_KHR</span>       <span class="mh">0x2066</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>External memory handle type added by <code>cl_khr_external_memory_opaque_fd</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="opencl"><span class="n">CL_EXTERNAL_MEMORY_HANDLE_OPAQUE_FD_KHR</span>            <span class="mh">0x2060</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>External memory handle types added by <code>cl_khr_external_memory_win32</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="opencl"><span class="n">CL_EXTERNAL_MEMORY_HANDLE_OPAQUE_WIN32_KHR</span>         <span class="mh">0x2061</span>
<span class="n">CL_EXTERNAL_MEMORY_HANDLE_OPAQUE_WIN32_KMT_KHR</span>     <span class="mh">0x2062</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_modifications_to_existing_apis_added_by_this_spec_3"><a class="anchor" href="#_modifications_to_existing_apis_added_by_this_spec_3"></a>45.5. Modifications to existing APIs added by this spec</h3>
<div class="paragraph">
<p>Following new enums are added to the list of supported <em>param_names</em> by <strong>clGetPlatformInfo</strong>:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 66. List of supported param_names by clGetPlatformInfo</caption>
<colgroup>
<col style="width: 33%;">
<col style="width: 17%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Platform Info</th>
<th class="tableblock halign-left valign-top">Return Type</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CL_PLATFORM_<wbr>EXTERNAL_<wbr>MEMORY_<wbr>IMPORT_<wbr>HANDLE_<wbr>TYPES_<wbr>KHR</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>cl_external_<wbr>memory_<wbr>handle_<wbr>type_<wbr>khr</code>[]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Returns the list of importable external memory handle types supported by all devices in <em>platform</em>.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><strong>clGetPlatformInfo</strong> when called with <em>param_name</em> <code>CL_PLATFORM_<wbr>EXTERNAL_<wbr>MEMORY_<wbr>IMPORT_<wbr>HANDLE_<wbr>TYPES_<wbr>KHR</code> must return a common list of external memory handle types supported by all devices in the platform.</p>
</div>
<div class="paragraph">
<p>Following new enums are added to the list of supported <em>param_names</em> by <strong>clGetDeviceInfo</strong>:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 67. List of supported param_names by clGetDeviceInfo</caption>
<colgroup>
<col style="width: 33%;">
<col style="width: 17%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Device Info</th>
<th class="tableblock halign-left valign-top">Return Type</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CL_DEVICE_<wbr>EXTERNAL_<wbr>MEMORY_<wbr>IMPORT_<wbr>HANDLE_<wbr>TYPES_<wbr>KHR</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>cl_external_<wbr>memory_<wbr>handle_<wbr>type_<wbr>khr</code>[]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Returns the list of importable external memory handle types supported by <em>device</em>.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><strong>clGetDeviceInfo</strong> when called with param_name <code>CL_DEVICE_<wbr>EXTERNAL_<wbr>MEMORY_<wbr>IMPORT_<wbr>HANDLE_<wbr>TYPES_<wbr>KHR</code> must return a non-empty list of external memory handle types for at least one of the devices in the platform.</p>
</div>
<div class="paragraph">
<p>Following new properties are added to the list of supported properties by <strong>clCreateBufferWithProperties</strong> and <strong>clCreateImageWithProperties</strong>.</p>
</div>
<table id="external-memory-properties-table" class="tableblock frame-all grid-all stretch">
<caption class="title">Table 68. List of supported buffer and image creation properties</caption>
<colgroup>
<col style="width: 33%;">
<col style="width: 17%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Property</th>
<th class="tableblock halign-left valign-top">Property Value</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CL_DEVICE_<wbr>HANDLE_<wbr>LIST_<wbr>KHR</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>cl_device_<wbr>id</code>[]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Specifies the list of OpenCL devices (terminated with <code>CL_DEVICE_<wbr>HANDLE_<wbr>LIST_<wbr>END_<wbr>KHR</code>) to associate with the external memory handle.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>If <code>CL_DEVICE_<wbr>HANDLE_<wbr>LIST_<wbr>KHR</code> is not specified as part of <em>properties</em>, the memory object created by <strong>clCreateBufferWithProperties</strong> or <strong>clCreateImageWithProperties</strong> is by default accessible to all devices in the <em>context</em>.</p>
</div>
<div class="paragraph">
<p>The properties used to create a buffer or image from an external memory handle are described by related extensions.
When a buffer or image is created from an external memory handle, the <em>flags</em> used to specify usage information for the buffer or image must not include <code>CL_MEM_<wbr>USE_<wbr>HOST_<wbr>PTR</code>, <code>CL_MEM_<wbr>ALLOC_<wbr>HOST_<wbr>PTR</code>, or <code>CL_MEM_<wbr>COPY_<wbr>HOST_<wbr>PTR</code>, and the <em>host_ptr</em> argument must be <code>NULL</code>.</p>
</div>
<div class="paragraph">
<p>Add to the list of error conditions for <strong>clCreateBufferWithProperties</strong> and <strong>clCreateImageWithProperties</strong>:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>CL_INVALID_<wbr>DEVICE</code></p>
<div class="ulist">
<ul>
<li>
<p>if a device identified by the property <code>CL_DEVICE_<wbr>HANDLE_<wbr>LIST_<wbr>KHR</code> is not a valid device or is not associated with <em>context</em>, or</p>
</li>
<li>
<p>if a device identified by property <code>CL_DEVICE_<wbr>HANDLE_<wbr>LIST_<wbr>KHR</code> cannot import the requested external memory object type, or</p>
</li>
<li>
<p>if <code>CL_DEVICE_<wbr>HANDLE_<wbr>LIST_<wbr>KHR</code> is not specified as part of <em>properties</em> and one or more devices in <em>context</em> cannot import the requested external memory object type.</p>
</li>
</ul>
</div>
</li>
<li>
<p><code>CL_INVALID_<wbr>VALUE</code></p>
<div class="ulist">
<ul>
<li>
<p>if <em>properties</em> includes a supported external memory handle and <em>flags</em> includes <code>CL_MEM_<wbr>USE_<wbr>HOST_<wbr>PTR</code>, <code>CL_MEM_<wbr>ALLOC_<wbr>HOST_<wbr>PTR</code>, or <code>CL_MEM_<wbr>COPY_<wbr>HOST_<wbr>PTR</code>.</p>
</li>
</ul>
</div>
</li>
<li>
<p><code>CL_INVALID_<wbr>HOST_<wbr>PTR</code></p>
<div class="ulist">
<ul>
<li>
<p>if <em>properties</em> includes a supported external memory handle and <em>host_ptr</em> is not <code>NULL</code>.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>Add images created from an external memory handle to the description of <code>image_row_pitch</code> and <code>image_slice_pitch</code> for <code>cl_image_<wbr>desc</code>:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>image_row_pitch</code> is the scan-line pitch in bytes.
The <code>image_row_pitch</code> must be zero if <em>host_ptr</em> is <code>NULL</code>, the image is not a
2D image created from a buffer, and the image is not an image created from an
external memory handle.
If <code>image_row_pitch</code> is zero and <em>host_ptr</em> is not <code>NULL</code> then the image row
pitch is calculated as <code>image_width</code>  the size of an image element in
bytes.
If <code>image_row_pitch</code> is zero and the image is created from an external memory
handle then the image row pitch is implementation-defined.
The image row pitch must be  <code>image_width</code>  the size of an image
element in bytes and must be a multiple of the size of an image element in
bytes.
For a 2D image created from a buffer the image row pitch must also be a multiple
of the maximum of the <code>CL_DEVICE_<wbr>IMAGE_<wbr>PITCH_<wbr>ALIGNMENT</code> value for all devices in
the context that support images.</p>
</li>
<li>
<p><code>image_slice_pitch</code> is the size in bytes of each 2D slice in a 3D image or the
size in bytes of each image in a 1D or 2D image array.
The <code>image_slice_pitch</code> must be zero if <em>host_ptr</em> is <code>NULL</code> and the image is
not created from an external memory handle.
If <code>image_slice_pitch</code> is zero and <em>host_ptr</em> is not <code>NULL</code> then the image slice
pitch is calculated as the image row pitch  <code>image_height</code> for a 2D image
array or a 3D image, and as the image row pitch for a 1D image array.
If <code>image_slice_pitch</code> is zero and the image is created from an external memory
handle then the image slice pitch is implementation-defined.
The image slice pitch must be  the image image row pitch 
<code>image_height</code> for a 2D image array or a 3D image, must be  the image row
pitch for a 1D image array, and must be a multiple of the image row pitch.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_description_of_new_types_added_by_this_spec_2"><a class="anchor" href="#_description_of_new_types_added_by_this_spec_2"></a>45.6. Description of new types added by this spec</h3>
<div class="paragraph">
<p>The following new APIs are added as part of this spec. The details of each are described below:</p>
</div>
<div class="sect3">
<h4 id="_acquiring_and_releasing_external_memory_objects"><a class="anchor" href="#_acquiring_and_releasing_external_memory_objects"></a>45.6.1. Acquiring and Releasing External Memory Objects</h4>
<div class="paragraph">
<p>To enqueue a command to acquire OpenCL memory objects created from external memory handles, call the function</p>
</div>
<div id="clEnqueueAcquireExternalMemObjectsKHR" class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="opencl"><span class="kt">cl_int</span> <span class="nf">clEnqueueAcquireExternalMemObjectsKHR</span><span class="p">(</span>
    <span class="kt">cl_command_queue</span> <span class="n">command_queue</span><span class="p">,</span>
    <span class="kt">cl_uint</span> <span class="n">num_mem_objects</span><span class="p">,</span>
    <span class="k">const</span> <span class="kt">cl_mem</span><span class="o">*</span> <span class="n">mem_objects</span><span class="p">,</span>
    <span class="kt">cl_uint</span> <span class="n">num_events_in_wait_list</span><span class="p">,</span>
    <span class="k">const</span> <span class="kt">cl_event</span><span class="o">*</span> <span class="n">event_wait_list</span><span class="p">,</span>
    <span class="kt">cl_event</span><span class="o">*</span> <span class="n">event</span><span class="p">);</span></code></pre>
</div>
</div>
<div class="paragraph">
<p><em>command_queue</em> specifies a valid command-queue.</p>
</div>
<div class="paragraph">
<p><em>num_mem_objects</em> specifies the number of memory objects to acquire.</p>
</div>
<div class="paragraph">
<p><em>mem_objects</em> points to a list of valid memory objects.</p>
</div>
<div class="paragraph">
<p><em>num_events_in_wait_list</em> specifies the number of events in <em>event_wait_list</em>.</p>
</div>
<div class="paragraph">
<p><em>event_wait_list</em> points to the list of events that need to complete before <strong>clEnqueueAcquireExternalMemObjectsKHR</strong> can be executed.
If <em>event_wait_list</em> is <code>NULL</code>, then <strong>clEnqueueAcquireExternalMemObjectsKHR</strong> does not explicitly wait on any event to complete.
If <em>event_wait_list</em> is <code>NULL</code>, <em>num_events_in_wait_list</em> must be 0.
If <em>event_wait_list</em> is not <code>NULL</code>, the list of events pointed to by <em>event_wait_list</em> must be valid and <em>num_events_in_wait_list</em> must be greater than 0.
The events specified in <em>event_wait_list</em> act as synchronization points.
The context associated with events in <em>event_wait_list</em> and that of <em>command_queue</em> must be the same.</p>
</div>
<div class="paragraph">
<p><em>event</em>  returns an event object that identifies this particular command and can be used to query or queue a wait for this particular command to complete.
<em>event</em> can be <code>NULL</code> in which case it will not be possible for the application to query the status of this command or queue a wait for this command to complete.</p>
</div>
<div class="paragraph">
<p>Applications must acquire the memory objects that are created using external handles before they can be used by any OpenCL commands queued to a command-queue.
Behavior is undefined if a memory object created from an external memory handle is used by an OpenCL command queued to a command-queue without being acquired.
This is to guarantee that the state of the memory objects is up-to-date and they are accessible to OpenCL.
See "Example with Acquire / Release" provided in <a href="#cl_khr_external_memory-Sample-Code">Sample Code</a> for more details on how to use this API.</p>
</div>
<div class="paragraph">
<p>If <em>num_mem_objects</em> is 0 and <em>mem_objects</em> is <code>NULL</code>, the command will trivially succeed after its event dependencies are satisfied and will update its completion event.</p>
</div>
<div class="paragraph">
<p><strong>clEnqueueAcquireExternalMemObjectsKHR</strong> returns <code>CL_SUCCESS</code> if the function is executed successfully.
Otherwise, it returns one of the following errors:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>CL_INVALID_<wbr>VALUE</code> if <em>num_mem_objects</em> is zero and <em>mem_objects</em> is not a <code>NULL</code> value or if <em>num_mem_objects</em> is greater than 0 and <em>mem_objects</em> is <code>NULL</code>.</p>
</li>
<li>
<p><code>CL_INVALID_<wbr>MEM_<wbr>OBJECT</code> if any of the memory objects in <em>mem_objects</em> is not a valid OpenCL memory object created using an external memory handle.</p>
</li>
<li>
<p><code>CL_INVALID_<wbr>COMMAND_<wbr>QUEUE</code></p>
<div class="ulist">
<ul>
<li>
<p>if <em>command_queue</em> is not a valid command-queue, or</p>
</li>
<li>
<p>if device associated with <em>command_queue</em> is not one of the devices specified by <code>CL_DEVICE_<wbr>HANDLE_<wbr>LIST_<wbr>KHR</code> at the time of creating one or more of <em>mem_objects</em>, or</p>
</li>
<li>
<p>if one or more of <em>mem_objects</em> belong to a context that does not contain a device associated with <em>command_queue</em>.</p>
</li>
</ul>
</div>
</li>
<li>
<p><code>CL_INVALID_<wbr>EVENT_<wbr>WAIT_<wbr>LIST</code></p>
<div class="ulist">
<ul>
<li>
<p>if <em>event_wait_list</em> is <code>NULL</code> and <em>num_events_in_wait_list</em> is not 0, or</p>
</li>
<li>
<p>if <em>event_wait_list</em> is not <code>NULL</code> and <em>num_events_in_wait_list</em> is 0, or</p>
</li>
<li>
<p>if event objects in <em>event_wait_list</em> are not valid events.</p>
</li>
</ul>
</div>
</li>
<li>
<p><code>CL_EXEC_<wbr>STATUS_<wbr>ERROR_<wbr>FOR_<wbr>EVENTS_<wbr>IN_<wbr>WAIT_<wbr>LIST</code> if the execution status of any of the events in <em>event_wait_list</em> is a negative integer value.</p>
</li>
<li>
<p><code>CL_OUT_<wbr>OF_<wbr>RESOURCES</code> if there is a failure to allocate resources required by the OpenCL implementation on the device.</p>
</li>
<li>
<p><code>CL_OUT_<wbr>OF_<wbr>HOST_<wbr>MEMORY</code> if there is a failure to allocate resources required by the OpenCL implementation on the host.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>To enqueue a command to release OpenCL memory objects created from external memory handles, call the function</p>
</div>
<div id="clEnqueueReleaseExternalMemObjectsKHR" class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="opencl"><span class="kt">cl_int</span> <span class="nf">clEnqueueReleaseExternalMemObjectsKHR</span><span class="p">(</span>
    <span class="kt">cl_command_queue</span> <span class="n">command_queue</span><span class="p">,</span>
    <span class="kt">cl_uint</span> <span class="n">num_mem_objects</span><span class="p">,</span>
    <span class="k">const</span> <span class="kt">cl_mem</span><span class="o">*</span> <span class="n">mem_objects</span><span class="p">,</span>
    <span class="kt">cl_uint</span> <span class="n">num_events_in_wait_list</span><span class="p">,</span>
    <span class="k">const</span> <span class="kt">cl_event</span><span class="o">*</span> <span class="n">event_wait_list</span><span class="p">,</span>
    <span class="kt">cl_event</span><span class="o">*</span> <span class="n">event</span><span class="p">);</span></code></pre>
</div>
</div>
<div class="paragraph">
<p><em>command_queue</em> specifies a valid command-queue.</p>
</div>
<div class="paragraph">
<p><em>num_mem_objects</em> specifies the number of memory objects to release.</p>
</div>
<div class="paragraph">
<p><em>mem_objects</em> points to a list of valid memory objects.</p>
</div>
<div class="paragraph">
<p><em>num_events_in_wait_list</em> specifies the number of events in <em>event_wait_list</em>.</p>
</div>
<div class="paragraph">
<p><em>event_wait_list</em> points to the list of events that need to complete before <strong>clEnqueueReleaseExternalMemObjectsKHR</strong> can be executed.
If <em>event_wait_list</em> is <code>NULL</code>, then <strong>clEnqueueReleaseExternalMemObjectsKHR</strong> does not wait on any event to complete.
If <em>event_wait_list</em> is <code>NULL</code>, <em>num_events_in_wait_list</em> must be 0.
If <em>event_wait_list</em> is not <code>NULL</code>, the list of events pointed to by <em>event_wait_list</em> must be valid and <em>num_events_in_wait_list</em> must be greater than 0.
The events specified in <em>event_wait_list</em> act as synchronization points.
The context associated with events in <em>event_wait_list</em> and that of <em>command_queue</em> must be the same.</p>
</div>
<div class="paragraph">
<p><em>event</em>  returns an event object that identifies this particular command and can be used to query or queue a wait for this particular command to complete.
<em>event</em> can be <code>NULL</code> in which case it will not be possible for the application to query the status of this command or queue a wait for this command to complete.</p>
</div>
<div class="paragraph">
<p>Applications must release the memory objects that are acquired using <strong>clEnqueueReleaseExternalMemObjectsKHR</strong> before using them through any commands in the other API.
This is to guarantee that the state of memory objects is up-to-date and they are accessible to the other API.
See "Example with Acquire / Release" provided in <a href="#cl_khr_external_memory-Sample-Code">Sample Code</a> for more details on how to use this API.</p>
</div>
<div class="paragraph">
<p>If <em>num_mem_objects</em> is 0 and <em>mem_objects</em> is <code>NULL</code>, the command will trivially succeed after its event dependencies are satisfied and will update its completion event.</p>
</div>
<div class="paragraph">
<p><strong>clEnqueueReleaseExternalMemObjectsKHR</strong> returns <code>CL_SUCCESS</code> if the function is executed successfully.
Otherwise, it returns one of the following errors:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>CL_INVALID_<wbr>VALUE</code> if <em>num_mem_objects</em> is zero and <em>mem_objects</em> is not a <code>NULL</code> value or if <em>num_mem_objects</em> is greater than 0 and <em>mem_objects</em> is <code>NULL</code>.</p>
</li>
<li>
<p><code>CL_INVALID_<wbr>MEM_<wbr>OBJECT</code> if any of the memory objects in <em>mem_objects</em> is not a valid OpenCL memory object created using an external memory handle.</p>
</li>
<li>
<p><code>CL_INVALID_<wbr>COMMAND_<wbr>QUEUE</code></p>
<div class="ulist">
<ul>
<li>
<p>if <em>command_queue</em> is not a valid command-queue, or</p>
</li>
<li>
<p>if device associated with <em>command_queue</em> is not one of the devices specified by <code>CL_DEVICE_<wbr>HANDLE_<wbr>LIST_<wbr>KHR</code> at the time of creating one or more of <em>mem_objects</em>, or</p>
</li>
<li>
<p>if one or more of <em>mem_objects</em> belong to a context that does not contain a device associated with <em>command_queue</em>.</p>
</li>
</ul>
</div>
</li>
<li>
<p><code>CL_INVALID_<wbr>EVENT_<wbr>WAIT_<wbr>LIST</code></p>
<div class="ulist">
<ul>
<li>
<p>if <em>event_wait_list</em> is <code>NULL</code> and <em>num_events_in_wait_list</em> is not 0, or</p>
</li>
<li>
<p>if <em>event_wait_list</em> is not <code>NULL</code> and <em>num_events_in_wait_list</em> is 0, or</p>
</li>
<li>
<p>if event objects in <em>event_wait_list</em> are not valid events.</p>
</li>
</ul>
</div>
</li>
<li>
<p><code>CL_EXEC_<wbr>STATUS_<wbr>ERROR_<wbr>FOR_<wbr>EVENTS_<wbr>IN_<wbr>WAIT_<wbr>LIST</code> if the execution status of any of the events in <em>event_wait_list</em> is a negative integer value.</p>
</li>
<li>
<p><code>CL_OUT_<wbr>OF_<wbr>RESOURCES</code> if there is a failure to allocate resources required by the OpenCL implementation on the device.</p>
</li>
<li>
<p><code>CL_OUT_<wbr>OF_<wbr>HOST_<wbr>MEMORY</code> if there is a failure to allocate resources required by the OpenCL implementation on the host.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_descriptions_of_external_memory_handle_types"><a class="anchor" href="#_descriptions_of_external_memory_handle_types"></a>45.7. Descriptions of External Memory Handle Types</h3>
<div class="paragraph">
<p>This section describes the external memory handle types that are added by related extensions.</p>
</div>
<div class="paragraph">
<p>Applications can import the same payload into multiple OpenCL contexts and multiple times into a given OpenCL context. In all cases, each import operation must create a distinct memory object.</p>
</div>
<div class="sect3">
<h4 id="_file_descriptor_handle_types_2"><a class="anchor" href="#_file_descriptor_handle_types_2"></a>45.7.1. File Descriptor Handle Types</h4>
<div class="paragraph">
<p>The <code>cl_khr_external_memory_opaque_fd</code> extension extends <code>cl_external_<wbr>memory_<wbr>handle_<wbr>type_<wbr>khr</code> to support the following new types of handles, and adds as a property that may be specified when creating a buffer or an image memory object from an external handle:</p>
</div>
<div class="openblock">
<div class="content">
<div class="ulist">
<ul>
<li>
<p><code>CL_EXTERNAL_<wbr>MEMORY_<wbr>HANDLE_<wbr>OPAQUE_<wbr>FD_<wbr>KHR</code> specifies a POSIX file descriptor handle that has only limited valid usage outside of OpenCL and other compatible APIs. It must be compatible with the POSIX system calls dup, dup2, close, and the non-standard system call dup3. Additionally, it must be transportable over a socket using an SCM_RIGHTS control message. It owns a reference to the underlying memory resource represented by its memory object.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="paragraph">
<p>The <code>cl_khr_external_memory_dma_buf</code> extension extends <code>cl_external_<wbr>memory_<wbr>handle_<wbr>type_<wbr>khr</code> to support the following types of handles, and adds as a property that may be specified when creating a buffer or an image memory object from an external handle:</p>
</div>
<div class="openblock">
<div class="content">
<div class="ulist">
<ul>
<li>
<p><code>CL_EXTERNAL_<wbr>MEMORY_<wbr>HANDLE_<wbr>DMA_<wbr>BUF_<wbr>KHR</code> is a file descriptor for a Linux dma_buf. It owns a reference to the underlying memory resource represented by its memory object.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="paragraph">
<p>For these extensions, importing memory from a file descriptor transfers ownership of the file descriptor from the application to the OpenCL implementation. The application must not perform any operations on the file descriptor after a successful import. The imported memory object holds a reference to its payload.</p>
</div>
</div>
<div class="sect3">
<h4 id="_nt_handle_types_2"><a class="anchor" href="#_nt_handle_types_2"></a>45.7.2. NT Handle Types</h4>
<div class="paragraph">
<p>The <code>cl_khr_external_memory_dx</code> extension extends <code>cl_external_<wbr>memory_<wbr>handle_<wbr>type_<wbr>khr</code>  to support the following new types of handles, and adds as a property that may be specified when creating a buffer or an image memory object from an external handle:</p>
</div>
<div class="openblock">
<div class="content">
<div class="ulist">
<ul>
<li>
<p><code>CL_EXTERNAL_<wbr>MEMORY_<wbr>HANDLE_<wbr>D3D11_<wbr>TEXTURE_<wbr>KHR</code> specifies an NT handle returned by IDXGIResource1::CreateSharedHandle referring to a Direct3D 10 or 11 texture resource. It owns a reference to the memory used by the Direct3D resource.</p>
</li>
<li>
<p><code>CL_EXTERNAL_<wbr>MEMORY_<wbr>HANDLE_<wbr>D3D11_<wbr>TEXTURE_<wbr>KMT_<wbr>KHR</code> specifies a global share handle returned by IDXGIResource::GetSharedHandle referring to a Direct3D 10 or 11 texture resource. It does not own a reference to the underlying Direct3D resource, and will therefore become invalid when all memory objects and Direct3D resources associated with it are destroyed.</p>
</li>
<li>
<p><code>CL_EXTERNAL_<wbr>MEMORY_<wbr>HANDLE_<wbr>D3D12_<wbr>HEAP_<wbr>KHR</code> specifies an NT handle returned by ID3D12Device::CreateSharedHandle referring to a Direct3D 12 heap resource. It owns a reference to the resources used by the Direct3D heap.</p>
</li>
<li>
<p><code>CL_EXTERNAL_<wbr>MEMORY_<wbr>HANDLE_<wbr>D3D12_<wbr>RESOURCE_<wbr>KHR</code> specifies an NT handle returned by ID3D12Device::CreateSharedHandle referring to a Direct3D 12 committed resource. It owns a reference to the memory used by the Direct3D resource.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="paragraph">
<p>The <code>cl_khr_external_memory_win32</code> extension extends <code>cl_external_<wbr>memory_<wbr>handle_<wbr>type_<wbr>khr</code> to support the following new types of handles, and adds as a property that may be specified when creating a buffer or an image memory object from an external handle:</p>
</div>
<div class="openblock">
<div class="content">
<div class="ulist">
<ul>
<li>
<p><code>CL_EXTERNAL_<wbr>MEMORY_<wbr>HANDLE_<wbr>OPAQUE_<wbr>WIN32_<wbr>KHR</code> specifies an NT handle that has only limited valid usage outside of OpenCL and other compatible APIs. It must be compatible with the functions DuplicateHandle, CloseHandle, CompareObjectHandles, GetHandleInformation, and SetHandleInformation. It owns a reference to the underlying memory resource represented by its memory object.</p>
</li>
<li>
<p><code>CL_EXTERNAL_<wbr>MEMORY_<wbr>HANDLE_<wbr>OPAQUE_<wbr>WIN32_<wbr>KMT_<wbr>KHR</code> specifies a global share handle that has only limited valid usage outside of OpenCL and other compatible APIs. It is not compatible with any native APIs. It does not own a reference to the underlying memory resource represented by its memory object, and will therefore become invalid when all memory objects associated with it are destroyed.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="paragraph">
<p>For these extensions, importing memory object payloads from Windows handles does not transfer ownership of the handle to the OpenCL implementation. For handle types defined as NT handles, the application must release handle ownership using the CloseHandle system call when the handle is no longer needed. For handle types defined as NT handles, the imported memory object holds a reference to its payload.</p>
</div>
<div class="paragraph">
<p>Note: Non-NT handle import operations do not add a reference to their associated payload. If the original object owning the payload is destroyed, all resources and handles sharing that payload will become invalid.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="cl_khr_external_memory-Sample-Code"><a class="anchor" href="#cl_khr_external_memory-Sample-Code"></a>45.8. Sample Code</h3>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Example for creating a CL buffer from an exported external buffer in a single device context.</p>
<div class="openblock">
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="opencl"><span class="c1">// Get cl_devices of the platform.</span>
<span class="n">clGetDeviceIDs</span><span class="p">(...,</span> <span class="o">&amp;</span><span class="n">devices</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">deviceCount</span><span class="p">);</span>

<span class="c1">// Create cl_context with just first device</span>
<span class="n">clCreateContext</span><span class="p">(...,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">devices</span><span class="p">,</span> <span class="p">...);</span>

<span class="c1">// Obtain fd/win32 or similar handle for external memory to be imported</span>
<span class="c1">// from other API.</span>
<span class="kt">int</span> <span class="n">fd</span> <span class="o">=</span> <span class="n">getFdForExternalMemory</span><span class="p">();</span>

<span class="c1">// Create extMemBuffer of type cl_mem from fd.</span>
<span class="n">cl_mem_properties_khr</span> <span class="n">extMemProperties</span><span class="p">[]</span> <span class="o">=</span>
<span class="p">{</span>
    <span class="p">(</span><span class="n">cl_mem_properties_khr</span><span class="p">)</span><span class="n">CL_EXTERNAL_MEMORY_HANDLE_OPAQUE_FD_KHR</span><span class="p">,</span>
    <span class="p">(</span><span class="n">cl_mem_properties_khr</span><span class="p">)</span><span class="n">fd</span><span class="p">,</span>
    <span class="mi">0</span>
<span class="p">};</span>

<span class="kt">cl_mem</span> <span class="n">extMemBuffer</span> <span class="o">=</span> <span class="n">clCreateBufferWithProperties</span><span class="p">(</span><span class="cm">/*context*/</span>          <span class="n">clContext</span><span class="p">,</span>
                                                   <span class="cm">/*properties*/</span>       <span class="n">extMemProperties</span><span class="p">,</span>
                                                   <span class="cm">/*flags*/</span>            <span class="mi">0</span><span class="p">,</span>
                                                   <span class="cm">/*size*/</span>             <span class="n">size</span><span class="p">,</span>
                                                   <span class="cm">/*host_ptr*/</span>         <span class="nb">NULL</span><span class="p">,</span>
                                                   <span class="cm">/*errcode_ret*/</span>      <span class="o">&amp;</span><span class="n">errcode_ret</span><span class="p">);</span></code></pre>
</div>
</div>
</div>
</div>
</li>
<li>
<p>Example for creating a CL Image from an exported external Image for single device usage in a multi-device context</p>
<div class="openblock">
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="opencl"><span class="c1">// Get cl_devices of the platform.</span>
<span class="n">clGetDeviceIDs</span><span class="p">(...,</span> <span class="o">&amp;</span><span class="n">devices</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">deviceCount</span><span class="p">);</span>

<span class="c1">// Create cl_context with first two devices</span>
<span class="n">clCreateContext</span><span class="p">(...,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">devices</span><span class="p">,</span> <span class="p">...);</span>

<span class="c1">// Create img of type cl_mem usable only on devices[0]</span>

<span class="c1">// Create img of type cl_mem.</span>
<span class="c1">// Obtain fd/win32 or similar handle for external memory to be imported</span>
<span class="c1">// from other API.</span>
<span class="kt">int</span> <span class="n">fd</span> <span class="o">=</span> <span class="n">getFdForExternalMemory</span><span class="p">();</span>

<span class="c1">// Set cl_image_format based on external image info</span>
<span class="kt">cl_image_format</span> <span class="n">clImgFormat</span> <span class="o">=</span> <span class="p">{</span> <span class="p">};</span>
<span class="n">clImageFormat</span><span class="p">.</span><span class="n">image_channel_order</span> <span class="o">=</span> <span class="n">CL_RGBA</span><span class="p">;</span>
<span class="n">clImageFormat</span><span class="p">.</span><span class="n">image_channel_data_type</span> <span class="o">=</span> <span class="n">CL_UNORM_INT8</span><span class="p">;</span>

<span class="c1">// Set cl_image_desc based on external image info</span>
<span class="kt">size_t</span> <span class="n">clImageFormatSize</span><span class="p">;</span>
<span class="kt">cl_image_desc</span> <span class="n">image_desc</span> <span class="o">=</span> <span class="p">{</span> <span class="p">};</span>
<span class="n">image_desc</span><span class="p">.</span><span class="n">image_type</span> <span class="o">=</span> <span class="n">CL_MEM_OBJECT_IMAGE2D_ARRAY</span><span class="p">;</span>
<span class="n">image_desc</span><span class="p">.</span><span class="n">image_width</span> <span class="o">=</span> <span class="n">width</span><span class="p">;</span>
<span class="n">image_desc</span><span class="p">.</span><span class="n">image_height</span> <span class="o">=</span> <span class="n">height</span><span class="p">;</span>
<span class="n">image_desc</span><span class="p">.</span><span class="n">image_depth</span> <span class="o">=</span> <span class="n">depth</span><span class="p">;</span>
<span class="n">image_desc</span><span class="p">.</span><span class="n">image_array_size</span> <span class="o">=</span> <span class="n">num_slices</span><span class="p">;</span>
<span class="n">image_desc</span><span class="p">.</span><span class="n">image_row_pitch</span> <span class="o">=</span> <span class="n">width</span> <span class="o">*</span> <span class="mi">8</span> <span class="o">*</span> <span class="mi">4</span><span class="p">;</span> <span class="c1">// May need alignment</span>
<span class="n">image_desc</span><span class="p">.</span><span class="n">image_slice_pitch</span> <span class="o">=</span> <span class="n">image_desc</span><span class="p">.</span><span class="n">image_row_pitch</span> <span class="o">*</span> <span class="n">height</span><span class="p">;</span>
<span class="n">image_desc</span><span class="p">.</span><span class="n">num_mip_levels</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
<span class="n">image_desc</span><span class="p">.</span><span class="n">num_samples</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
<span class="n">image_desc</span><span class="p">.</span><span class="n">buffer</span> <span class="o">=</span> <span class="nb">NULL</span><span class="p">;</span>

<span class="n">cl_mem_properties_khr</span> <span class="n">extMemProperties</span><span class="p">[]</span> <span class="o">=</span>
<span class="p">{</span>
    <span class="p">(</span><span class="n">cl_mem_properties_khr</span><span class="p">)</span><span class="n">CL_EXTERNAL_MEMORY_HANDLE_OPAQUE_FD_KHR</span><span class="p">,</span>
    <span class="p">(</span><span class="n">cl_mem_properties_khr</span><span class="p">)</span><span class="n">fd</span><span class="p">,</span>
    <span class="p">(</span><span class="n">cl_mem_properties_khr</span><span class="p">)</span><span class="n">CL_DEVICE_HANDLE_LIST_KHR</span><span class="p">,</span>
    <span class="p">(</span><span class="n">cl_mem_properties_khr</span><span class="p">)</span><span class="n">devices</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
    <span class="n">CL_DEVICE_HANDLE_LIST_END_KHR</span><span class="p">,</span>
    <span class="mi">0</span>
<span class="p">};</span>

<span class="kt">cl_mem</span> <span class="n">img</span> <span class="o">=</span> <span class="n">clCreateImageWithProperties</span><span class="p">(</span><span class="cm">/*context*/</span>        <span class="n">clContext</span><span class="p">,</span>
                                         <span class="cm">/*properties*/</span>     <span class="n">extMemProperties</span><span class="p">,</span>
                                         <span class="cm">/*flags*/</span>          <span class="mi">0</span><span class="p">,</span>
                                         <span class="cm">/*image_format*/</span>   <span class="o">&amp;</span><span class="n">clImgFormat</span><span class="p">,</span>
                                         <span class="cm">/*image_desc*/</span>     <span class="o">&amp;</span><span class="n">image_desc</span><span class="p">,</span>
                                         <span class="cm">/*errcode_ret*/</span>    <span class="o">&amp;</span><span class="n">errcode_ret</span><span class="p">);</span>

<span class="c1">// Use clGetImageInfo to get cl_image_format details.</span>
<span class="kt">size_t</span> <span class="n">clImageFormatSize</span><span class="p">;</span>
<span class="n">clGetImageInfo</span><span class="p">(</span><span class="n">img</span><span class="p">,</span>
               <span class="n">CL_IMAGE_FORMAT</span><span class="p">,</span>
               <span class="k">sizeof</span><span class="p">(</span><span class="kt">cl_image_format</span><span class="p">),</span>
               <span class="o">&amp;</span><span class="n">clImageFormat</span><span class="p">,</span>
               <span class="o">&amp;</span><span class="n">clImageFormatSize</span><span class="p">);</span></code></pre>
</div>
</div>
</div>
</div>
</li>
<li>
<p>Example for synchronization using Wait and Signal</p>
<div class="openblock">
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="opencl"><span class="c1">// Start the main rendering loop</span>

<span class="c1">// Create extSem of type cl_semaphore_khr using clCreateSemaphoreWithPropertiesKHR</span>

<span class="c1">// Create extMem of type cl_mem using clCreateBufferWithProperties or clCreateImageWithProperties</span>

<span class="k">while</span> <span class="p">(</span><span class="nb">true</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// (not shown) Signal the semaphore from the other API</span>

    <span class="c1">// Wait for the semaphore in OpenCL, by calling clEnqueueWaitSemaphoresKHR on 'extSem'</span>
    <span class="n">clEnqueueWaitSemaphoresKHR</span><span class="p">(</span><span class="cm">/*command_queue*/</span>            <span class="n">command_queue</span><span class="p">,</span>
                               <span class="cm">/*num_sema_objects*/</span>         <span class="mi">1</span><span class="p">,</span>
                               <span class="cm">/*sema_objects*/</span>             <span class="o">&amp;</span><span class="n">extSem</span><span class="p">,</span>
                               <span class="cm">/*sema_payload_list*/</span>        <span class="nb">NULL</span><span class="p">,</span>
                               <span class="cm">/*num_events_in_wait_list*/</span>  <span class="mi">0</span><span class="p">,</span>
                               <span class="cm">/*event_wait_list*/</span>          <span class="nb">NULL</span><span class="p">,</span>
                               <span class="cm">/*event*/</span>                    <span class="nb">NULL</span><span class="p">);</span>

    <span class="c1">// Launch kernel that accesses extMem</span>
    <span class="n">clEnqueueNDRangeKernel</span><span class="p">(</span><span class="n">command_queue</span><span class="p">,</span> <span class="p">...);</span>

    <span class="c1">// Signal the semaphore in OpenCL</span>
    <span class="n">clEnqueueSignalSemaphoresKHR</span><span class="p">(</span><span class="cm">/*command_queue*/</span>           <span class="n">command_queue</span><span class="p">,</span>
                                 <span class="cm">/*num_sema_objects*/</span>        <span class="mi">1</span><span class="p">,</span>
                                 <span class="cm">/*sema_objects*/</span>            <span class="o">&amp;</span><span class="n">extSem</span><span class="p">,</span>
                                 <span class="cm">/*sema_payload_list*/</span>       <span class="nb">NULL</span><span class="p">,</span>
                                 <span class="cm">/*num_events_in_wait_list*/</span> <span class="mi">0</span><span class="p">,</span>
                                 <span class="cm">/*event_wait_list*/</span>         <span class="nb">NULL</span><span class="p">,</span>
                                 <span class="cm">/*event*/</span>                   <span class="nb">NULL</span><span class="p">);</span>

    <span class="c1">// (not shown) Launch work in other API that waits on 'extSem'</span>
<span class="p">}</span></code></pre>
</div>
</div>
</div>
</div>
</li>
<li>
<p>Example with memory sharing using acquire/release</p>
<div class="openblock">
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="opencl"><span class="c1">// Create extSem of type cl_semaphore_khr using</span>
<span class="c1">// clCreateSemaphoreWithPropertiesKHR with CL_SEMAPHORE_HANDLE_*_KHR.</span>

<span class="c1">// Create extMem1 and extMem2 of type cl_mem using clCreateBufferWithProperties</span>
<span class="c1">// or clCreateImageWithProperties</span>

<span class="k">while</span> <span class="p">(</span><span class="nb">true</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// (not shown) Signal the semaphore from the other API. Wait for the</span>
    <span class="c1">// semaphore in OpenCL, by calling clEnqueueWaitForSemaphore on extSem</span>
    <span class="n">clEnqueueWaitSemaphoresKHR</span><span class="p">(</span><span class="cm">/*command_queue*/</span>            <span class="n">cq1</span><span class="p">,</span>
                               <span class="cm">/*num_sema_objects*/</span>         <span class="mi">1</span><span class="p">,</span>
                               <span class="cm">/*sema_objects*/</span>             <span class="o">&amp;</span><span class="n">extSem</span><span class="p">,</span>
                               <span class="cm">/*sema_payload_list*/</span>        <span class="nb">NULL</span><span class="p">,</span>
                               <span class="cm">/*num_events_in_wait_list*/</span>  <span class="mi">0</span><span class="p">,</span>
                               <span class="cm">/*event_wait_list*/</span>          <span class="nb">NULL</span><span class="p">,</span>
                               <span class="cm">/*event*/</span>                    <span class="nb">NULL</span><span class="p">);</span>

    <span class="c1">// Get explicit ownership of extMem1</span>
    <span class="n">clEnqueueAcquireExternalMemObjectsKHR</span><span class="p">(</span><span class="cm">/*command_queue*/</span>             <span class="n">cq1</span><span class="p">,</span>
                                          <span class="cm">/*num_mem_objects*/</span>           <span class="mi">1</span><span class="p">,</span>
                                          <span class="cm">/*mem_objects*/</span>               <span class="n">extMem1</span><span class="p">,</span>
                                          <span class="cm">/*num_events_in_wait_list*/</span>   <span class="mi">0</span><span class="p">,</span>
                                          <span class="cm">/*event_wait_list*/</span>           <span class="nb">NULL</span><span class="p">,</span>
                                          <span class="cm">/*event*/</span>                     <span class="nb">NULL</span><span class="p">);</span>

    <span class="c1">// Launch kernel that accesses extMem1 on cq1 on cl_device1</span>
    <span class="n">clEnqueueNDRangeKernel</span><span class="p">(</span><span class="n">cq1</span><span class="p">,</span>  <span class="p">...,</span> <span class="o">&amp;</span><span class="n">event1</span><span class="p">);</span>

    <span class="c1">// Launch kernel that accesses both extMem1 and extMem2 on cq2 on cl_device2</span>
    <span class="c1">// Migration of extMem1 and extMem2 handles through regular CL memory</span>
    <span class="c1">// migration.</span>
    <span class="n">clEnqueueNDRangeKernel</span><span class="p">(</span><span class="n">cq2</span><span class="p">,</span> <span class="p">...,</span> <span class="o">&amp;</span><span class="n">event1</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">event2</span><span class="p">);</span>

    <span class="c1">// Give up ownership of extMem1 before you signal the semaphore. Handle</span>
    <span class="c1">// memory migration here.</span>
    <span class="n">clEnqueueReleaseExternalMemObjectsKHR</span><span class="p">(</span><span class="cm">/*command_queue*/</span>           <span class="n">cq2</span>
                                          <span class="cm">/*num_mem_objects*/</span>         <span class="mi">1</span><span class="p">,</span>
                                          <span class="cm">/*mem_objects*/</span>             <span class="o">&amp;</span><span class="n">extMem1</span><span class="p">,</span>
                                          <span class="cm">/*num_events_in_wait_list*/</span> <span class="mi">0</span><span class="p">,</span>
                                          <span class="cm">/*event_wait_list*/</span>         <span class="nb">NULL</span><span class="p">,</span>
                                          <span class="cm">/*event*/</span>                   <span class="nb">NULL</span><span class="p">);</span>

    <span class="c1">// Signal the semaphore from OpenCL</span>
    <span class="n">clEnqueueSignalSemaphoresKHR</span><span class="p">(</span><span class="cm">/*command_queue*/</span>           <span class="n">cq2</span><span class="p">,</span>
                                 <span class="cm">/*num_sema_objects*/</span>        <span class="mi">1</span><span class="p">,</span>
                                 <span class="cm">/*sema_objects*/</span>            <span class="o">&amp;</span><span class="n">extSem</span><span class="p">,</span>
                                 <span class="cm">/*sema_payload_list*/</span>       <span class="nb">NULL</span><span class="p">,</span>
                                 <span class="cm">/*num_events_in_wait_list*/</span> <span class="mi">0</span><span class="p">,</span>
                                 <span class="cm">/*event_wait_list*/</span>         <span class="nb">NULL</span><span class="p">,</span>
                                 <span class="cm">/*event*/</span>                   <span class="nb">NULL</span><span class="p">);</span>

    <span class="c1">// (not shown) Launch work in other API that waits on 'extSem'</span>
    <span class="c1">// Other API accesses ext1, but not ext2 on device-1</span>
<span class="p">}</span></code></pre>
</div>
</div>
</div>
</div>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="_issues_2"><a class="anchor" href="#_issues_2"></a>45.9. Issues</h3>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>How should the import of images that are created in external APIs with non-linear tiling be robustly handled?</p>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p><strong>UNRESOLVED</strong></p>
</div>
</div>
</div>
</li>
</ol>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="cl_khr_command_buffer"><a class="anchor" href="#cl_khr_command_buffer"></a>46. Command Buffers (Provisional)</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This extension adds the ability to record and replay buffers of OpenCL commands.</p>
</div>
<div class="sect2">
<h3 id="_general_information_45"><a class="anchor" href="#_general_information_45"></a>46.1. General Information</h3>
<div class="sect3">
<h4 id="_name_strings_9"><a class="anchor" href="#_name_strings_9"></a>46.1.1. Name Strings</h4>
<div class="paragraph">
<p><code>cl_khr_command_buffer</code></p>
</div>
</div>
<div class="sect3">
<h4 id="_version_history_45"><a class="anchor" href="#_version_history_45"></a>46.1.2. Version History</h4>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 60%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><strong>Date</strong></th>
<th class="tableblock halign-left valign-top"><strong>Version</strong></th>
<th class="tableblock halign-left valign-top"><strong>Description</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">2021-11-10</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.9.0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">First assigned version (provisional).</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">2022-08-24</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.9.1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Specify an error if a command-buffer is finalized multiple times (provisional).</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">2023-03-31</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.9.2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Introduce context query <code>CL_COMMAND_<wbr>BUFFER_<wbr>CONTEXT_<wbr>KHR</code> (provisional).</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="_dependencies_9"><a class="anchor" href="#_dependencies_9"></a>46.1.3. Dependencies</h4>
<div class="paragraph">
<p>This extension is written against the OpenCL Specification version 3.0.6.</p>
</div>
<div class="paragraph">
<p>This extension requires OpenCL 1.2 or later.</p>
</div>
</div>
<div class="sect3">
<h4 id="_contributors_6"><a class="anchor" href="#_contributors_6"></a>46.1.4. Contributors</h4>
<div class="paragraph">
<p>Ewan Crawford, Codeplay Software Ltd.<br>
Gordon Brown, Codeplay Software Ltd.<br>
Kenneth Benzie, Codeplay Software Ltd.<br>
Alastair Murray, Codeplay Software Ltd.<br>
Jack Frankland, Codeplay Software Ltd.<br>
Balaji Calidas, Qualcomm Technologies Inc.<br>
Joshua Kelly, Qualcomm Technologies, Inc.<br>
Kevin Petit, Arm Ltd.<br>
Aharon Abramson, Intel.<br>
Ben Ashbaugh, Intel.<br>
Boaz Ouriel, Intel.<br>
Chris Gearing, Intel.<br>
Pekka Jskelinen, Tampere University<br>
Jan Solanti, Tampere University<br>
Nikhil Joshi, NVIDIA<br>
James Price, Google<br>
Brice Videau, Argonne National Laboratory<br></p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_overview_2"><a class="anchor" href="#_overview_2"></a>46.2. Overview</h3>
<div class="paragraph">
<p>Command-buffers enable a reduction in overhead when enqueuing the same
workload multiple times. By separating the command-queue setup from dispatch,
the ability to replay a set of previously created commands is introduced.</p>
</div>
<div class="paragraph">
<p>Device-side <em>cl_sync_point_khr</em> synchronization-points can be used within
command-buffers to define command dependencies. This allows the commands of a
command-buffer to execute out-of-order on a single <a href="#compatible">compatible</a>
command-queue. The command-buffer itself has no inherent in-order/out-of-order
property, this ordering is inferred from the command-queue used on command
recording. Out-of-order enqueues without event dependencies of both regular
commands, such as <strong>clEnqueueFillBuffer</strong>, and command-buffers are allowed to
execute concurrently, and it is up to the user to express any dependencies using
events.</p>
</div>
<div class="paragraph">
<p>The command-queues a command-buffer will be executed on can be set on replay via
parameters to <strong>clEnqueueCommandBufferKHR</strong>, provided they are
<a href="#compatible">compatible</a> with the command-queues used on command-buffer
recording.</p>
</div>
<div class="sect3">
<h4 id="_background"><a class="anchor" href="#_background"></a>46.2.1. Background</h4>
<div class="paragraph">
<p>On embedded devices where building a command stream accounts for a significant
expenditure of resources and where workloads are often required to be pipelined,
a solution that minimizes driver overhead can significantly improve the
utilization of accelerators by removing a bottleneck in repeated command stream
generation.</p>
</div>
<div class="paragraph">
<p>An additional motivator is lowering task execution latency, as devices can be
kept occupied with work by repeated submissions, without having to wait on
the host to construct commands again for a similar workload.</p>
</div>
</div>
<div class="sect3">
<h4 id="_rationale"><a class="anchor" href="#_rationale"></a>46.2.2. Rationale</h4>
<div class="paragraph">
<p>The command-buffer abstraction over the generation of command streams is a
proven approach which facilitates a significant reduction in driver overhead in
existing real-world applications with repetitive pipelined workloads which are
built on top of Vulkan, DirectX 12, and Metal.</p>
</div>
<div class="paragraph">
<p>A primary goal is for a command-buffer to avoid any interaction with
application code after being enqueued until all recorded commands have
completed. As such, any command which maps or migrates memory objects; reads
or writes memory objects; or enqueues a native kernel, is not available for
command-buffer recording. Finally commands recorded into a command buffer do
not wait for or return event objects, these are instead replaced with
device-side synchronization-point identifiers which enable out-of-order
execution when enqueued on <a href="#compatible">compatible</a> command-queues.</p>
</div>
<div class="paragraph">
<p>Adding new entry-points for individual commands, rather than recording existing
command-queue APIs with begin/end markers was a design decision made for the
following reasons:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Individually specified entry points makes it clearer to the user what&#8217;s
supported, as opposed to adding a large number of error conditions
throughout the specification with all the restrictions.</p>
</li>
<li>
<p>Prevents code forking in existing entry points for the implementer, as
otherwise separate paths in each entry point need to be maintained for both
the recording and normal cases.</p>
</li>
<li>
<p>Allows the definition of a new device-side synchronization primitive rather
than overloading <code>cl_event</code>. As use of <code>cl_event</code> in individual commands
allows host interaction from callback and user-events, as well as introducing
complexities when a command-buffer is enqueued multiple times regarding
profiling and execution status.</p>
</li>
<li>
<p>New entry points facilitate returning handles to individual commands, allowing
those commands to be modified between enqueues of the command buffer. Not all
command handles are used in this extension, but providing them facilitates
other extensions layered on top to take advantage of them to provide additional
mutable functionality.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_simultaneous_use"><a class="anchor" href="#_simultaneous_use"></a>46.2.3. Simultaneous Use</h4>
<div class="paragraph">
<p>The optional simultaneous use capability was added to the extension so that
vendors can support pipelined workflows, where command-buffers are repeatedly
enqueued without blocking in user code. However, simultaneous use may result in
command-buffers being more expensive to enqueue than in a sequential model, so
the capability is optional to enable optimizations on command-buffer recording.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_interactions_with_other_extensions_2"><a class="anchor" href="#_interactions_with_other_extensions_2"></a>46.3. Interactions with Other Extensions</h3>
<div class="paragraph">
<p>The introduction of the command-buffer abstraction enables functionality
beyond what the <code>cl_khr_command_buffer</code> extension currently provides, i.e.
the recording of immutable commands to a single queue which can then be
executed without commands synchronizing outside the command-buffer. It is
intended that extra functionality expanding on this will be provided as layered
extensions on top of <code>cl_khr_command_buffer</code>.</p>
</div>
<div class="paragraph">
<p>Having <code>cl_khr_command_buffer</code> as a minimal base specification means that the
API defines mechanisms for functionality that is not enabled by this extension,
these are described in the following sub-sections. <code>cl_khr_command_buffer</code> will
retain its provisional extension status until other layered extensions are
released, as these may reveal modifications needed to the base specification to
support their intended use cases.</p>
</div>
<div class="sect3">
<h4 id="_ndrange_kernel_command_properties"><a class="anchor" href="#_ndrange_kernel_command_properties"></a>46.3.1. NDRange Kernel Command Properties</h4>
<div class="paragraph">
<p>The <strong>clCommandNDRangeKernelKHR</strong> entry-point defines a <code>properties</code> parameter of
new type <code>cl_ndrange_<wbr>kernel_<wbr>command_<wbr>properties_<wbr>khr</code>. No properties are defined
in <code>cl_khr_command_buffer</code>, but the parameter is intended to enable future
functionality that would change the characteristics of the kernel command.</p>
</div>
</div>
<div class="sect3">
<h4 id="_command_handles"><a class="anchor" href="#_command_handles"></a>46.3.2. Command Handles</h4>
<div class="paragraph">
<p>All command recording entry-points define a <code>cl_mutable_<wbr>command_<wbr>khr</code> output
parameter which provides a handle to the specific command being recorded. Use of
these output handles is not enabled by the <code>cl_khr_command_buffer</code> extension,
but the handles will allow individual commands in a command-buffer to be
referenced by the user. In particular, the capability for an application to use
these handles to modify commands between enqueues of a command-buffer is
envisaged.</p>
</div>
</div>
<div class="sect3">
<h4 id="_list_of_queues"><a class="anchor" href="#_list_of_queues"></a>46.3.3. List of Queues</h4>
<div class="paragraph">
<p>Only a single command-queue can be associated with a command-buffer in the
<code>cl_khr_command_buffer</code> extension, but the API is designed with the intention
that a future extension will allow commands to be recorded across multiple
queues in the same command-buffer, providing replay of heterogeneous task
graphs.</p>
</div>
<div class="paragraph">
<p>Using multiple queue functionality will result in an error without any layered
extensions to relax usage of the following API features:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>When a command-buffer is created the API enables passing a list of queues
that the command-buffer will record commands to. Only a single queue is
permitted in <code>cl_khr_command_buffer</code>.</p>
</li>
<li>
<p>Individual command recording entry-points define a <code>cl_command_<wbr>queue</code>
parameter for which of the queues set on command-buffer creation that command
should be record to. This must be passed as NULL in <code>cl_khr_command_buffer</code>.</p>
</li>
<li>
<p><strong>clEnqueueCommandBufferKHR</strong> takes a list of queues for command-buffer execution,
correspond to those set on creation. Only a single queue is permitted in
<code>cl_khr_command_buffer</code>.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_new_types_4"><a class="anchor" href="#_new_types_4"></a>46.4. New Types</h3>
<div class="sect3">
<h4 id="_command_buffer_types"><a class="anchor" href="#_command_buffer_types"></a>46.4.1. Command Buffer Types</h4>
<div class="paragraph">
<p>Bitfield for querying command-buffer capabilities of an OpenCL device with
<strong>clGetDeviceInfo</strong>, see <a href="#command-buffer-queries">device queries table</a>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="opencl"><span class="k">typedef</span> <span class="kt">cl_bitfield</span> <span class="kt">cl_device_command_buffer_capabilities_khr</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Types describing <a href="#command-buffers">command-buffers</a>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="opencl"><span class="c1">// Returned by clCreateCommandBufferKHR()</span>
<span class="k">typedef</span> <span class="k">struct</span> <span class="nc">_cl_command_buffer_khr</span><span class="o">*</span> <span class="kt">cl_command_buffer_khr</span><span class="p">;</span>

<span class="c1">// Unique ID to a device-side synchronization-point used to describe the</span>
<span class="c1">// ordering of commands when recording a command-buffer. Valid for use</span>
<span class="c1">// only within the same command-buffer during recording.</span>
<span class="k">typedef</span> <span class="kt">cl_uint</span> <span class="kt">cl_sync_point_khr</span><span class="p">;</span>

<span class="c1">// Handle returned on command recording</span>
<span class="k">typedef</span> <span class="k">struct</span> <span class="nc">_cl_mutable_command_khr</span><span class="o">*</span> <span class="kt">cl_mutable_command_khr</span><span class="p">;</span>

<span class="c1">// Properties of a clCommandNDRangeKernelKHR command</span>
<span class="k">typedef</span> <span class="kt">cl_properties</span> <span class="kt">cl_ndrange_kernel_command_properties_khr</span><span class="p">;</span>

<span class="c1">// Properties for command-buffer creation</span>
<span class="k">typedef</span> <span class="kt">cl_properties</span> <span class="kt">cl_command_buffer_properties_khr</span><span class="p">;</span>

<span class="c1">// Bitfield representing flags for command-buffers</span>
<span class="k">typedef</span> <span class="kt">cl_bitfield</span> <span class="n">cl_command_buffer_flags_khr</span><span class="p">;</span>

<span class="c1">// Enumerated type for use in clGetCommandBufferInfoKHR()</span>
<span class="k">typedef</span> <span class="kt">cl_uint</span> <span class="kt">cl_command_buffer_info_khr</span><span class="p">;</span>

<span class="c1">// Return type for CL_COMMAND_BUFFER_STATE_KHR in clGetCommandBufferInfoKHR()</span>
<span class="k">typedef</span> <span class="kt">cl_uint</span> <span class="kt">cl_command_buffer_state_khr</span><span class="p">;</span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_new_api_functions_6"><a class="anchor" href="#_new_api_functions_6"></a>46.5. New API Functions</h3>
<div class="paragraph">
<p>Command-buffer entry points from <a href="#command-buffers">Section 5.X</a>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="opencl"><span class="kt">cl_command_buffer_khr</span> <span class="nf">clCreateCommandBufferKHR</span><span class="p">(</span>
    <span class="kt">cl_uint</span> <span class="n">num_queues</span><span class="p">,</span>
    <span class="k">const</span> <span class="kt">cl_command_queue</span><span class="o">*</span> <span class="n">queues</span><span class="p">,</span>
    <span class="k">const</span> <span class="kt">cl_command_buffer_properties_khr</span><span class="o">*</span> <span class="n">properties</span><span class="p">,</span>
    <span class="kt">cl_int</span><span class="o">*</span> <span class="n">errcode_ret</span><span class="p">);</span>

<span class="kt">cl_int</span> <span class="nf">clRetainCommandBufferKHR</span><span class="p">(</span><span class="kt">cl_command_buffer_khr</span> <span class="n">command_buffer</span><span class="p">);</span>

<span class="kt">cl_int</span> <span class="nf">clReleaseCommandBufferKHR</span><span class="p">(</span><span class="kt">cl_command_buffer_khr</span> <span class="n">command_buffer</span><span class="p">);</span>

<span class="kt">cl_int</span> <span class="nf">clFinalizeCommandBufferKHR</span><span class="p">(</span><span class="kt">cl_command_buffer_khr</span> <span class="n">command_buffer</span><span class="p">);</span>

<span class="kt">cl_int</span> <span class="nf">clEnqueueCommandBufferKHR</span><span class="p">(</span>
    <span class="kt">cl_uint</span> <span class="n">num_queues</span><span class="p">,</span>
    <span class="kt">cl_command_queue</span><span class="o">*</span> <span class="n">queues</span><span class="p">,</span>
    <span class="kt">cl_command_buffer_khr</span> <span class="n">command_buffer</span><span class="p">,</span>
    <span class="kt">cl_uint</span> <span class="n">num_events_in_wait_list</span><span class="p">,</span>
    <span class="k">const</span> <span class="kt">cl_event</span><span class="o">*</span> <span class="n">event_wait_list</span><span class="p">,</span>
    <span class="kt">cl_event</span><span class="o">*</span> <span class="n">event</span><span class="p">);</span>

<span class="kt">cl_int</span> <span class="nf">clCommandBarrierWithWaitListKHR</span><span class="p">(</span>
    <span class="kt">cl_command_buffer_khr</span> <span class="n">command_buffer</span><span class="p">,</span>
    <span class="kt">cl_command_queue</span> <span class="n">command_queue</span><span class="p">,</span>
    <span class="kt">cl_uint</span> <span class="n">num_sync_points_in_wait_list</span><span class="p">,</span>
    <span class="k">const</span> <span class="kt">cl_sync_point_khr</span><span class="o">*</span> <span class="n">sync_point_wait_list</span><span class="p">,</span>
    <span class="kt">cl_sync_point_khr</span><span class="o">*</span> <span class="n">sync_point</span><span class="p">,</span>
    <span class="kt">cl_mutable_command_khr</span><span class="o">*</span> <span class="n">mutable_handle</span><span class="p">);</span>

<span class="kt">cl_int</span> <span class="nf">clCommandCopyBufferKHR</span><span class="p">(</span>
    <span class="kt">cl_command_buffer_khr</span> <span class="n">command_buffer</span><span class="p">,</span>
    <span class="kt">cl_command_queue</span> <span class="n">command_queue</span><span class="p">,</span>
    <span class="kt">cl_mem</span> <span class="n">src_buffer</span><span class="p">,</span>
    <span class="kt">cl_mem</span> <span class="n">dst_buffer</span><span class="p">,</span>
    <span class="kt">size_t</span> <span class="n">src_offset</span><span class="p">,</span>
    <span class="kt">size_t</span> <span class="n">dst_offset</span><span class="p">,</span>
    <span class="kt">size_t</span> <span class="n">size</span><span class="p">,</span>
    <span class="kt">cl_uint</span> <span class="n">num_sync_points_in_wait_list</span><span class="p">,</span>
    <span class="k">const</span> <span class="kt">cl_sync_point_khr</span><span class="o">*</span> <span class="n">sync_point_wait_list</span><span class="p">,</span>
    <span class="kt">cl_sync_point_khr</span><span class="o">*</span> <span class="n">sync_point</span><span class="p">,</span>
    <span class="kt">cl_mutable_command_khr</span><span class="o">*</span> <span class="n">mutable_handle</span><span class="p">);</span>

<span class="kt">cl_int</span> <span class="nf">clCommandCopyBufferRectKHR</span><span class="p">(</span>
    <span class="kt">cl_command_buffer_khr</span> <span class="n">command_buffer</span><span class="p">,</span>
    <span class="kt">cl_command_queue</span> <span class="n">command_queue</span><span class="p">,</span>
    <span class="kt">cl_mem</span> <span class="n">src_buffer</span><span class="p">,</span>
    <span class="kt">cl_mem</span> <span class="n">dst_buffer</span><span class="p">,</span>
    <span class="k">const</span> <span class="kt">size_t</span><span class="o">*</span> <span class="n">src_origin</span><span class="p">,</span>
    <span class="k">const</span> <span class="kt">size_t</span><span class="o">*</span> <span class="n">dst_origin</span><span class="p">,</span>
    <span class="k">const</span> <span class="kt">size_t</span><span class="o">*</span> <span class="n">region</span><span class="p">,</span>
    <span class="kt">size_t</span> <span class="n">src_row_pitch</span><span class="p">,</span>
    <span class="kt">size_t</span> <span class="n">src_slice_pitch</span><span class="p">,</span>
    <span class="kt">size_t</span> <span class="n">dst_row_pitch</span><span class="p">,</span>
    <span class="kt">size_t</span> <span class="n">dst_slice_pitch</span><span class="p">,</span>
    <span class="kt">cl_uint</span> <span class="n">num_sync_points_in_wait_list</span><span class="p">,</span>
    <span class="k">const</span> <span class="kt">cl_sync_point_khr</span><span class="o">*</span> <span class="n">sync_point_wait_list</span><span class="p">,</span>
    <span class="kt">cl_sync_point_khr</span><span class="o">*</span> <span class="n">sync_point</span><span class="p">,</span>
    <span class="kt">cl_mutable_command_khr</span><span class="o">*</span> <span class="n">mutable_handle</span><span class="p">);</span>

<span class="kt">cl_int</span> <span class="nf">clCommandCopyBufferToImageKHR</span><span class="p">(</span>
    <span class="kt">cl_command_buffer_khr</span> <span class="n">command_buffer</span><span class="p">,</span>
    <span class="kt">cl_command_queue</span> <span class="n">command_queue</span><span class="p">,</span>
    <span class="kt">cl_mem</span> <span class="n">src_buffer</span><span class="p">,</span>
    <span class="kt">cl_mem</span> <span class="n">dst_image</span><span class="p">,</span>
    <span class="kt">size_t</span> <span class="n">src_offset</span><span class="p">,</span>
    <span class="k">const</span> <span class="kt">size_t</span><span class="o">*</span> <span class="n">dst_origin</span><span class="p">,</span>
    <span class="k">const</span> <span class="kt">size_t</span><span class="o">*</span> <span class="n">region</span><span class="p">,</span>
    <span class="kt">cl_uint</span> <span class="n">num_sync_points_in_wait_list</span><span class="p">,</span>
    <span class="k">const</span> <span class="kt">cl_sync_point_khr</span><span class="o">*</span> <span class="n">sync_point_wait_list</span><span class="p">,</span>
    <span class="kt">cl_sync_point_khr</span><span class="o">*</span> <span class="n">sync_point</span><span class="p">,</span>
    <span class="kt">cl_mutable_command_khr</span><span class="o">*</span> <span class="n">mutable_handle</span><span class="p">);</span>

<span class="kt">cl_int</span> <span class="nf">clCommandCopyImageKHR</span><span class="p">(</span>
    <span class="kt">cl_command_buffer_khr</span> <span class="n">command_buffer</span><span class="p">,</span>
    <span class="kt">cl_command_queue</span> <span class="n">command_queue</span><span class="p">,</span>
    <span class="kt">cl_mem</span> <span class="n">src_image</span><span class="p">,</span>
    <span class="kt">cl_mem</span> <span class="n">dst_image</span><span class="p">,</span>
    <span class="k">const</span> <span class="kt">size_t</span><span class="o">*</span> <span class="n">src_origin</span><span class="p">,</span>
    <span class="k">const</span> <span class="kt">size_t</span><span class="o">*</span> <span class="n">dst_origin</span><span class="p">,</span>
    <span class="k">const</span> <span class="kt">size_t</span><span class="o">*</span> <span class="n">region</span><span class="p">,</span>
    <span class="kt">cl_uint</span> <span class="n">num_sync_points_in_wait_list</span><span class="p">,</span>
    <span class="k">const</span> <span class="kt">cl_sync_point_khr</span><span class="o">*</span> <span class="n">sync_point_wait_list</span><span class="p">,</span>
    <span class="kt">cl_sync_point_khr</span><span class="o">*</span> <span class="n">sync_point</span><span class="p">,</span>
    <span class="kt">cl_mutable_command_khr</span><span class="o">*</span> <span class="n">mutable_handle</span><span class="p">);</span>

<span class="kt">cl_int</span> <span class="nf">clCommandCopyImageToBufferKHR</span><span class="p">(</span>
    <span class="kt">cl_command_buffer_khr</span> <span class="n">command_buffer</span><span class="p">,</span>
    <span class="kt">cl_command_queue</span> <span class="n">command_queue</span><span class="p">,</span>
    <span class="kt">cl_mem</span> <span class="n">src_image</span><span class="p">,</span>
    <span class="kt">cl_mem</span> <span class="n">dst_buffer</span><span class="p">,</span>
    <span class="k">const</span> <span class="kt">size_t</span><span class="o">*</span> <span class="n">src_origin</span><span class="p">,</span>
    <span class="k">const</span> <span class="kt">size_t</span><span class="o">*</span> <span class="n">region</span><span class="p">,</span>
    <span class="kt">size_t</span> <span class="n">dst_offset</span><span class="p">,</span>
    <span class="kt">cl_uint</span> <span class="n">num_sync_points_in_wait_list</span><span class="p">,</span>
    <span class="k">const</span> <span class="kt">cl_sync_point_khr</span><span class="o">*</span> <span class="n">sync_point_wait_list</span><span class="p">,</span>
    <span class="kt">cl_sync_point_khr</span><span class="o">*</span> <span class="n">sync_point</span><span class="p">,</span>
    <span class="kt">cl_mutable_command_khr</span><span class="o">*</span> <span class="n">mutable_handle</span><span class="p">);</span>

<span class="kt">cl_int</span> <span class="nf">clCommandFillBufferKHR</span><span class="p">(</span>
    <span class="kt">cl_command_buffer_khr</span> <span class="n">command_buffer</span><span class="p">,</span>
    <span class="kt">cl_command_queue</span> <span class="n">command_queue</span><span class="p">,</span>
    <span class="kt">cl_mem</span> <span class="n">buffer</span><span class="p">,</span>
    <span class="k">const</span> <span class="kt">void</span><span class="o">*</span> <span class="n">pattern</span><span class="p">,</span>
    <span class="kt">size_t</span> <span class="n">pattern_size</span><span class="p">,</span>
    <span class="kt">size_t</span> <span class="n">offset</span><span class="p">,</span>
    <span class="kt">size_t</span> <span class="n">size</span><span class="p">,</span>
    <span class="kt">cl_uint</span> <span class="n">num_sync_points_in_wait_list</span><span class="p">,</span>
    <span class="k">const</span> <span class="kt">cl_sync_point_khr</span><span class="o">*</span> <span class="n">sync_point_wait_list</span><span class="p">,</span>
    <span class="kt">cl_sync_point_khr</span><span class="o">*</span> <span class="n">sync_point</span><span class="p">,</span>
    <span class="kt">cl_mutable_command_khr</span><span class="o">*</span> <span class="n">mutable_handle</span><span class="p">);</span>

<span class="kt">cl_int</span> <span class="nf">clCommandFillImageKHR</span><span class="p">(</span>
    <span class="kt">cl_command_buffer_khr</span> <span class="n">command_buffer</span><span class="p">,</span>
    <span class="kt">cl_command_queue</span> <span class="n">command_queue</span><span class="p">,</span>
    <span class="kt">cl_mem</span> <span class="n">image</span><span class="p">,</span>
    <span class="k">const</span> <span class="kt">void</span><span class="o">*</span> <span class="n">fill_color</span><span class="p">,</span>
    <span class="k">const</span> <span class="kt">size_t</span><span class="o">*</span> <span class="n">origin</span><span class="p">,</span>
    <span class="k">const</span> <span class="kt">size_t</span><span class="o">*</span> <span class="n">region</span><span class="p">,</span>
    <span class="kt">cl_uint</span> <span class="n">num_sync_points_in_wait_list</span><span class="p">,</span>
    <span class="k">const</span> <span class="kt">cl_sync_point_khr</span><span class="o">*</span> <span class="n">sync_point_wait_list</span><span class="p">,</span>
    <span class="kt">cl_sync_point_khr</span><span class="o">*</span> <span class="n">sync_point</span><span class="p">,</span>
    <span class="kt">cl_mutable_command_khr</span><span class="o">*</span> <span class="n">mutable_handle</span><span class="p">);</span>

<span class="kt">cl_int</span> <span class="nf">clCommandNDRangeKernelKHR</span><span class="p">(</span>
    <span class="kt">cl_command_buffer_khr</span> <span class="n">command_buffer</span><span class="p">,</span>
    <span class="kt">cl_command_queue</span> <span class="n">command_queue</span><span class="p">,</span>
    <span class="k">const</span> <span class="kt">cl_ndrange_kernel_command_properties_khr</span><span class="o">*</span> <span class="n">properties</span><span class="p">,</span>
    <span class="kt">cl_kernel</span> <span class="n">kernel</span><span class="p">,</span>
    <span class="kt">cl_uint</span> <span class="n">work_dim</span><span class="p">,</span>
    <span class="k">const</span> <span class="kt">size_t</span><span class="o">*</span> <span class="n">global_work_offset</span><span class="p">,</span>
    <span class="k">const</span> <span class="kt">size_t</span><span class="o">*</span> <span class="n">global_work_size</span><span class="p">,</span>
    <span class="k">const</span> <span class="kt">size_t</span><span class="o">*</span> <span class="n">local_work_size</span><span class="p">,</span>
    <span class="kt">cl_uint</span> <span class="n">num_sync_points_in_wait_list</span><span class="p">,</span>
    <span class="k">const</span> <span class="kt">cl_sync_point_khr</span><span class="o">*</span> <span class="n">sync_point_wait_list</span><span class="p">,</span>
    <span class="kt">cl_sync_point_khr</span><span class="o">*</span> <span class="n">sync_point</span><span class="p">,</span>
    <span class="kt">cl_mutable_command_khr</span><span class="o">*</span> <span class="n">mutable_handle</span><span class="p">);</span>

<span class="kt">cl_int</span> <span class="nf">clGetCommandBufferInfoKHR</span><span class="p">(</span>
    <span class="kt">cl_command_buffer_khr</span> <span class="n">command_buffer</span><span class="p">,</span>
    <span class="kt">cl_command_buffer_info_khr</span> <span class="n">param_name</span><span class="p">,</span>
    <span class="kt">size_t</span> <span class="n">param_value_size</span><span class="p">,</span>
    <span class="kt">void</span><span class="o">*</span> <span class="n">param_value</span><span class="p">,</span>
    <span class="kt">size_t</span><span class="o">*</span> <span class="n">param_value_size_ret</span><span class="p">);</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_new_api_enums_7"><a class="anchor" href="#_new_api_enums_7"></a>46.6. New API Enums</h3>
<div class="paragraph">
<p>Enums for querying device command-buffer capabilities with
<strong>clGetDeviceInfo</strong>, see <a href="#command-buffer-queries">device queries table</a>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="opencl"><span class="c1">// Accepted values for the param_name parameter to clGetDeviceInfo</span>
<span class="n">CL_DEVICE_COMMAND_BUFFER_CAPABILITIES_KHR</span>              <span class="mh">0x12A9</span>
<span class="n">CL_DEVICE_COMMAND_BUFFER_REQUIRED_QUEUE_PROPERTIES_KHR</span> <span class="mh">0x12AA</span>

<span class="c1">// Bits for cl_device_command_buffer_capabilities_khr bitfield</span>
<span class="n">CL_COMMAND_BUFFER_CAPABILITY_KERNEL_PRINTF_KHR</span>        <span class="p">(</span><span class="mh">0x1</span> <span class="o">&lt;&lt;</span> <span class="mi">0</span><span class="p">)</span>
<span class="n">CL_COMMAND_BUFFER_CAPABILITY_DEVICE_SIDE_ENQUEUE_KHR</span>  <span class="p">(</span><span class="mh">0x1</span> <span class="o">&lt;&lt;</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">CL_COMMAND_BUFFER_CAPABILITY_SIMULTANEOUS_USE_KHR</span>     <span class="p">(</span><span class="mh">0x1</span> <span class="o">&lt;&lt;</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">CL_COMMAND_BUFFER_CAPABILITY_OUT_OF_ORDER_KHR</span>         <span class="p">(</span><span class="mh">0x1</span> <span class="o">&lt;&lt;</span> <span class="mi">3</span><span class="p">)</span>

<span class="c1">// Values for cl_command_buffer_state_khr</span>
<span class="n">CL_COMMAND_BUFFER_STATE_RECORDING_KHR</span>              <span class="mh">0x0</span>
<span class="n">CL_COMMAND_BUFFER_STATE_EXECUTABLE_KHR</span>             <span class="mh">0x1</span>
<span class="n">CL_COMMAND_BUFFER_STATE_PENDING_KHR</span>                <span class="mh">0x2</span>
<span class="n">CL_COMMAND_BUFFER_STATE_INVALID_KHR</span>                <span class="mh">0x3</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Enums for base <a href="#command-buffer">command-buffers</a> functionality:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="opencl"><span class="c1">// Error codes</span>
<span class="n">CL_INVALID_COMMAND_BUFFER_KHR</span>                      <span class="o">-</span><span class="mi">1138</span>
<span class="n">CL_INVALID_SYNC_POINT_WAIT_LIST_KHR</span>                <span class="o">-</span><span class="mi">1139</span>
<span class="n">CL_INCOMPATIBLE_COMMAND_QUEUE_KHR</span>                  <span class="o">-</span><span class="mi">1140</span>

<span class="c1">// Bitfield to clCreateCommandBufferKHR</span>
<span class="n">CL_COMMAND_BUFFER_FLAGS_KHR</span>                        <span class="mh">0x1293</span>

<span class="c1">// Bits for cl_command_buffer_flags_khr bitfield</span>
<span class="n">CL_COMMAND_BUFFER_SIMULTANEOUS_USE_KHR</span>             <span class="p">(</span><span class="mh">0x1</span> <span class="o">&lt;&lt;</span> <span class="mi">0</span><span class="p">)</span>

<span class="c1">// cl_command_buffer_info_khr queries to clGetCommandBufferInfoKHR</span>
<span class="n">CL_COMMAND_BUFFER_QUEUES_KHR</span>                       <span class="mh">0x1294</span>
<span class="n">CL_COMMAND_BUFFER_NUM_QUEUES_KHR</span>                   <span class="mh">0x1295</span>
<span class="n">CL_COMMAND_BUFFER_REFERENCE_COUNT_KHR</span>              <span class="mh">0x1296</span>
<span class="n">CL_COMMAND_BUFFER_STATE_KHR</span>                        <span class="mh">0x1297</span>
<span class="n">CL_COMMAND_BUFFER_PROPERTIES_ARRAY_KHR</span>             <span class="mh">0x1298</span>
<span class="n">CL_COMMAND_BUFFER_CONTEXT_KHR</span>                      <span class="mh">0x1299</span>

<span class="c1">// cl_event command-buffer enqueue command type</span>
<span class="n">CL_COMMAND_COMMAND_BUFFER_KHR</span>                      <span class="mh">0x12A8</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_modifications_to_section_4_2_of_the_opencl_api_specification"><a class="anchor" href="#_modifications_to_section_4_2_of_the_opencl_api_specification"></a>46.7. Modifications to section 4.2 of the OpenCL API Specification</h3>
<div class="paragraph">
<p>Add to <strong>Table 5</strong>, <em>Device Queries</em>, of section 4.2:</p>
</div>
<table id="command-buffer-queries" class="tableblock frame-all grid-all stretch">
<caption class="title">Table 5. List of supported param_names by <strong>clGetDeviceInfo</strong></caption>
<colgroup>
<col style="width: 16.6666%;">
<col style="width: 16.6666%;">
<col style="width: 66.6668%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Device Info</th>
<th class="tableblock halign-left valign-top">Return Type</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CL_DEVICE_<wbr>COMMAND_<wbr>BUFFER_<wbr>CAPABILITIES_<wbr>KHR</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>cl_device_<wbr>command_<wbr>buffer_<wbr>capabilities_<wbr>khr</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Describes device command-buffer capabilities, encoded as bits in a bitfield.
  Supported capabilities are:</p>
<p class="tableblock">  <code>CL_COMMAND_<wbr>BUFFER_<wbr>CAPABILITY_<wbr>KERNEL_<wbr>PRINTF_<wbr>KHR</code> Device supports the ability
  to record commands that execute kernels which contain printf calls.</p>
<p class="tableblock">  <code>CL_COMMAND_<wbr>BUFFER_<wbr>CAPABILITY_<wbr>DEVICE_<wbr>SIDE_<wbr>ENQUEUE_<wbr>KHR</code> Device supports the
  ability to record commands that execute kernels which contain device-side
  kernel-enqueue calls.</p>
<p class="tableblock">  <code>CL_COMMAND_<wbr>BUFFER_<wbr>CAPABILITY_<wbr>SIMULTANEOUS_<wbr>USE_<wbr>KHR</code> Device supports the
  command-buffers having a <a href="#pending_count">Pending Count</a> that exceeds 1.</p>
<p class="tableblock">  <code>CL_COMMAND_<wbr>BUFFER_<wbr>CAPABILITY_<wbr>OUT_<wbr>OF_<wbr>ORDER_<wbr>KHR</code> Device supports the ability
  to record command-buffers to out-of-order command-queues.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CL_DEVICE_<wbr>COMMAND_<wbr>BUFFER_<wbr>REQUIRED_<wbr>QUEUE_<wbr>PROPERTIES_<wbr>KHR</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>cl_command_<wbr>queue_<wbr>properties</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Bitmask of the minimum properties with which a command-queue must be created
  to allow a command-buffer to be executed on it. It is valid for a
  command-queue to be created with extra properties in addition to this
  base requirement and still be compatible with command-buffer execution.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="command-buffers"><a class="anchor" href="#command-buffers"></a>46.8. Add new section "Section 5.X - Command Buffers" to OpenCL API Specification</h3>
<div class="paragraph">
<p>A <em>command-buffer</em> object represents a series of operations to be enqueued
on one or more command-queues without any application code interaction.
Grouping the operations together allows efficient enqueuing of repetitive
operations, as well as enabling driver optimizations.</p>
</div>
<div class="paragraph">
<p>Command-buffers are <em>sequential use</em> by default, but may also be set to
<em>simultaneous use</em> on creation if the device optionally supports this
capability. A sequential use command-buffer must have a <a href="#pending_count">Pending Count</a> of 0 or 1. The simultaneous use capability removes this
restriction and allows command-buffers to have a <a href="#pending_count">Pending
Count</a> greater than 1.</p>
</div>
<div id="compatible" class="paragraph">
<p>Command-buffers are created using an ordered list of command-queues that
commands are recorded to and execute on by default. These command-queues can be
replaced on command-buffer enqueue with different command-queues, provided for
each element in the replacement list the substitute command-queue is compatible
with the command-queue used on command-buffer creation. Where a <em>compatible</em>
command-queue is defined as a command-queue with identical properties targeting
the same device and in the same OpenCL context.</p>
</div>
<div class="sect3">
<h4 id="_add_new_section_section_5_x_1_command_buffer_lifecycle"><a class="anchor" href="#_add_new_section_section_5_x_1_command_buffer_lifecycle"></a>46.8.1. Add new section "Section 5.X.1 - Command Buffer Lifecycle"</h4>
<div class="paragraph">
<p>A command-buffer is always in one of the following states:</p>
</div>
<div id="recording" class="dlist">
<dl>
<dt class="hdlist1">Recording</dt>
<dd>
<p>Initial state of a command-buffer on creation, where commands can be
recorded to the command-buffer.</p>
</dd>
</dl>
</div>
<div id="executable" class="dlist">
<dl>
<dt class="hdlist1">Executable</dt>
<dd>
<p>State after command recording has finished with
<strong>clFinalizeCommandBufferKHR</strong> and the command-buffer may be enqueued.</p>
</dd>
</dl>
</div>
<div id="pending" class="dlist">
<dl>
<dt class="hdlist1">Pending</dt>
<dd>
<p>Once a command-buffer has been enqueued to a command-queue it enters
the Pending state until completion, at which point it moves back to the
<a href="#executable">Executable</a> state.</p>
</dd>
</dl>
</div>
<div id="invalid" class="dlist">
<dl>
<dt class="hdlist1">Invalid</dt>
<dd>
<p>A command-buffer can enter the Invalid state if a resource that was
used in a command has been modified or freed. The only valid operation to
perform on a command-buffer in the Invalid state is to call
<strong>clReleaseCommandBufferKHR</strong> for each of the reference counts the application
owns.</p>
</dd>
</dl>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiIHN0YW5kYWxvbmU9Im5vIj8+CjwhLS0gQ3JlYXRlZCB3aXRoIElua3NjYXBlIChodHRwOi8vd3d3Lmlua3NjYXBlLm9yZy8pIC0tPgoKPHN2ZwogICB3aWR0aD0iMjI0LjYzNTAzbW0iCiAgIGhlaWdodD0iOTIuNTkyOTE4bW0iCiAgIHZpZXdCb3g9IjAgMCAyMjQuNjM1MDMgOTIuNTkyOTE4IgogICB2ZXJzaW9uPSIxLjEiCiAgIGlkPSJzdmc4IgogICBzb2RpcG9kaTpkb2NuYW1lPSJjb21tYW5kYnVmZmVyX2xpZmVjeWNsZS5zdmciCiAgIGlua3NjYXBlOnZlcnNpb249IjEuMSAoYzY4ZTIyYzM4NywgMjAyMS0wNS0yMykiCiAgIHhtbG5zOmlua3NjYXBlPSJodHRwOi8vd3d3Lmlua3NjYXBlLm9yZy9uYW1lc3BhY2VzL2lua3NjYXBlIgogICB4bWxuczpzb2RpcG9kaT0iaHR0cDovL3NvZGlwb2RpLnNvdXJjZWZvcmdlLm5ldC9EVEQvc29kaXBvZGktMC5kdGQiCiAgIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIKICAgeG1sbnM6c3ZnPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIKICAgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIgogICB4bWxuczpjYz0iaHR0cDovL2NyZWF0aXZlY29tbW9ucy5vcmcvbnMjIgogICB4bWxuczpkYz0iaHR0cDovL3B1cmwub3JnL2RjL2VsZW1lbnRzLzEuMS8iPgogIDxkZWZzCiAgICAgaWQ9ImRlZnMyIj4KICAgIDxyZWN0CiAgICAgICB4PSI3MzQuNTA3MTMiCiAgICAgICB5PSIxNzYuMDA3MzciCiAgICAgICB3aWR0aD0iMTgwIgogICAgICAgaGVpZ2h0PSI3MCIKICAgICAgIGlkPSJyZWN0MTc3NjkiIC8+CiAgICA8bWFya2VyCiAgICAgICBpbmtzY2FwZTpzdG9ja2lkPSJBcnJvdzFNZW5kIgogICAgICAgb3JpZW50PSJhdXRvIgogICAgICAgcmVmWT0iMCIKICAgICAgIHJlZlg9IjAiCiAgICAgICBpZD0ibWFya2VyNTc0MSIKICAgICAgIHN0eWxlPSJvdmVyZmxvdzp2aXNpYmxlIgogICAgICAgaW5rc2NhcGU6aXNzdG9jaz0idHJ1ZSI+CiAgICAgIDxwYXRoCiAgICAgICAgIGlkPSJwYXRoNTczOSIKICAgICAgICAgZD0iTSAwLDAgNSwtNSAtMTIuNSwwIDUsNSBaIgogICAgICAgICBzdHlsZT0iZmlsbDojMDAwMDAwO2ZpbGwtb3BhY2l0eToxO2ZpbGwtcnVsZTpldmVub2RkO3N0cm9rZTojMDAwMDAwO3N0cm9rZS13aWR0aDoxLjAwMDAwMDAzcHQ7c3Ryb2tlLW9wYWNpdHk6MSIKICAgICAgICAgdHJhbnNmb3JtPSJtYXRyaXgoLTAuNCwwLDAsLTAuNCwtNCwwKSIKICAgICAgICAgaW5rc2NhcGU6Y29ubmVjdG9yLWN1cnZhdHVyZT0iMCIgLz4KICAgIDwvbWFya2VyPgogICAgPG1hcmtlcgogICAgICAgaW5rc2NhcGU6c3RvY2tpZD0iQXJyb3cxTWVuZCIKICAgICAgIG9yaWVudD0iYXV0byIKICAgICAgIHJlZlk9IjAiCiAgICAgICByZWZYPSIwIgogICAgICAgaWQ9Im1hcmtlcjU1NzEiCiAgICAgICBzdHlsZT0ib3ZlcmZsb3c6dmlzaWJsZSIKICAgICAgIGlua3NjYXBlOmlzc3RvY2s9InRydWUiPgogICAgICA8cGF0aAogICAgICAgICBpZD0icGF0aDU1NjkiCiAgICAgICAgIGQ9Ik0gMCwwIDUsLTUgLTEyLjUsMCA1LDUgWiIKICAgICAgICAgc3R5bGU9ImZpbGw6IzAwMDAwMDtmaWxsLW9wYWNpdHk6MTtmaWxsLXJ1bGU6ZXZlbm9kZDtzdHJva2U6IzAwMDAwMDtzdHJva2Utd2lkdGg6MS4wMDAwMDAwM3B0O3N0cm9rZS1vcGFjaXR5OjEiCiAgICAgICAgIHRyYW5zZm9ybT0ibWF0cml4KC0wLjQsMCwwLC0wLjQsLTQsMCkiCiAgICAgICAgIGlua3NjYXBlOmNvbm5lY3Rvci1jdXJ2YXR1cmU9IjAiIC8+CiAgICA8L21hcmtlcj4KICAgIDxtYXJrZXIKICAgICAgIGlua3NjYXBlOmlzc3RvY2s9InRydWUiCiAgICAgICBzdHlsZT0ib3ZlcmZsb3c6dmlzaWJsZSIKICAgICAgIGlkPSJtYXJrZXIzNDU3IgogICAgICAgcmVmWD0iMCIKICAgICAgIHJlZlk9IjAiCiAgICAgICBvcmllbnQ9ImF1dG8iCiAgICAgICBpbmtzY2FwZTpzdG9ja2lkPSJBcnJvdzFNZW5kIgogICAgICAgaW5rc2NhcGU6Y29sbGVjdD0iYWx3YXlzIj4KICAgICAgPHBhdGgKICAgICAgICAgdHJhbnNmb3JtPSJtYXRyaXgoLTAuNCwwLDAsLTAuNCwtNCwwKSIKICAgICAgICAgc3R5bGU9ImZpbGw6IzAwMDAwMDtmaWxsLW9wYWNpdHk6MTtmaWxsLXJ1bGU6ZXZlbm9kZDtzdHJva2U6IzAwMDAwMDtzdHJva2Utd2lkdGg6MS4wMDAwMDAwM3B0O3N0cm9rZS1vcGFjaXR5OjEiCiAgICAgICAgIGQ9Ik0gMCwwIDUsLTUgLTEyLjUsMCA1LDUgWiIKICAgICAgICAgaWQ9InBhdGgzNDU1IgogICAgICAgICBpbmtzY2FwZTpjb25uZWN0b3ItY3VydmF0dXJlPSIwIiAvPgogICAgPC9tYXJrZXI+CiAgICA8bWFya2VyCiAgICAgICBpbmtzY2FwZTpzdG9ja2lkPSJBcnJvdzFNc3RhcnQiCiAgICAgICBvcmllbnQ9ImF1dG8iCiAgICAgICByZWZZPSIwIgogICAgICAgcmVmWD0iMCIKICAgICAgIGlkPSJtYXJrZXIxNDA0IgogICAgICAgc3R5bGU9Im92ZXJmbG93OnZpc2libGUiCiAgICAgICBpbmtzY2FwZTppc3N0b2NrPSJ0cnVlIj4KICAgICAgPHBhdGgKICAgICAgICAgaWQ9InBhdGgxNDAyIgogICAgICAgICBkPSJNIDAsMCA1LC01IC0xMi41LDAgNSw1IFoiCiAgICAgICAgIHN0eWxlPSJmaWxsOiMwMDAwMDA7ZmlsbC1vcGFjaXR5OjE7ZmlsbC1ydWxlOmV2ZW5vZGQ7c3Ryb2tlOiMwMDAwMDA7c3Ryb2tlLXdpZHRoOjEuMDAwMDAwMDNwdDtzdHJva2Utb3BhY2l0eToxIgogICAgICAgICB0cmFuc2Zvcm09Im1hdHJpeCgwLjQsMCwwLDAuNCw0LDApIgogICAgICAgICBpbmtzY2FwZTpjb25uZWN0b3ItY3VydmF0dXJlPSIwIiAvPgogICAgPC9tYXJrZXI+CiAgICA8bWFya2VyCiAgICAgICBpbmtzY2FwZTpzdG9ja2lkPSJBcnJvdzFNc3RhcnQiCiAgICAgICBvcmllbnQ9ImF1dG8iCiAgICAgICByZWZZPSIwIgogICAgICAgcmVmWD0iMCIKICAgICAgIGlkPSJBcnJvdzFNc3RhcnQiCiAgICAgICBzdHlsZT0ib3ZlcmZsb3c6dmlzaWJsZSIKICAgICAgIGlua3NjYXBlOmlzc3RvY2s9InRydWUiPgogICAgICA8cGF0aAogICAgICAgICBpZD0icGF0aDk2OCIKICAgICAgICAgZD0iTSAwLDAgNSwtNSAtMTIuNSwwIDUsNSBaIgogICAgICAgICBzdHlsZT0iZmlsbDojMDAwMDAwO2ZpbGwtb3BhY2l0eToxO2ZpbGwtcnVsZTpldmVub2RkO3N0cm9rZTojMDAwMDAwO3N0cm9rZS13aWR0aDoxLjAwMDAwMDAzcHQ7c3Ryb2tlLW9wYWNpdHk6MSIKICAgICAgICAgdHJhbnNmb3JtPSJtYXRyaXgoMC40LDAsMCwwLjQsNCwwKSIKICAgICAgICAgaW5rc2NhcGU6Y29ubmVjdG9yLWN1cnZhdHVyZT0iMCIgLz4KICAgIDwvbWFya2VyPgogICAgPG1hcmtlcgogICAgICAgaW5rc2NhcGU6c3RvY2tpZD0iQXJyb3cxTWVuZCIKICAgICAgIG9yaWVudD0iYXV0byIKICAgICAgIHJlZlk9IjAiCiAgICAgICByZWZYPSIwIgogICAgICAgaWQ9Im1hcmtlcjEyNDYiCiAgICAgICBzdHlsZT0ib3ZlcmZsb3c6dmlzaWJsZSIKICAgICAgIGlua3NjYXBlOmlzc3RvY2s9InRydWUiPgogICAgICA8cGF0aAogICAgICAgICBpZD0icGF0aDEyNDQiCiAgICAgICAgIGQ9Ik0gMCwwIDUsLTUgLTEyLjUsMCA1LDUgWiIKICAgICAgICAgc3R5bGU9ImZpbGw6IzAwMDAwMDtmaWxsLW9wYWNpdHk6MTtmaWxsLXJ1bGU6ZXZlbm9kZDtzdHJva2U6IzAwMDAwMDtzdHJva2Utd2lkdGg6MS4wMDAwMDAwM3B0O3N0cm9rZS1vcGFjaXR5OjEiCiAgICAgICAgIHRyYW5zZm9ybT0ibWF0cml4KC0wLjQsMCwwLC0wLjQsLTQsMCkiCiAgICAgICAgIGlua3NjYXBlOmNvbm5lY3Rvci1jdXJ2YXR1cmU9IjAiIC8+CiAgICA8L21hcmtlcj4KICAgIDxtYXJrZXIKICAgICAgIGlua3NjYXBlOnN0b2NraWQ9IkFycm93MU1lbmQiCiAgICAgICBvcmllbnQ9ImF1dG8iCiAgICAgICByZWZZPSIwIgogICAgICAgcmVmWD0iMCIKICAgICAgIGlkPSJBcnJvdzFNZW5kIgogICAgICAgc3R5bGU9Im92ZXJmbG93OnZpc2libGUiCiAgICAgICBpbmtzY2FwZTppc3N0b2NrPSJ0cnVlIj4KICAgICAgPHBhdGgKICAgICAgICAgaWQ9InBhdGg5NzEiCiAgICAgICAgIGQ9Ik0gMCwwIDUsLTUgLTEyLjUsMCA1LDUgWiIKICAgICAgICAgc3R5bGU9ImZpbGw6IzAwMDAwMDtmaWxsLW9wYWNpdHk6MTtmaWxsLXJ1bGU6ZXZlbm9kZDtzdHJva2U6IzAwMDAwMDtzdHJva2Utd2lkdGg6MS4wMDAwMDAwM3B0O3N0cm9rZS1vcGFjaXR5OjEiCiAgICAgICAgIHRyYW5zZm9ybT0ibWF0cml4KC0wLjQsMCwwLC0wLjQsLTQsMCkiCiAgICAgICAgIGlua3NjYXBlOmNvbm5lY3Rvci1jdXJ2YXR1cmU9IjAiIC8+CiAgICA8L21hcmtlcj4KICAgIDxtYXJrZXIKICAgICAgIGlua3NjYXBlOnN0b2NraWQ9IkFycm93MU1lbmQiCiAgICAgICBvcmllbnQ9ImF1dG8iCiAgICAgICByZWZZPSIwIgogICAgICAgcmVmWD0iMCIKICAgICAgIGlkPSJtYXJrZXIxMjQ2LTUiCiAgICAgICBzdHlsZT0ib3ZlcmZsb3c6dmlzaWJsZSIKICAgICAgIGlua3NjYXBlOmlzc3RvY2s9InRydWUiPgogICAgICA8cGF0aAogICAgICAgICBpZD0icGF0aDEyNDQtMSIKICAgICAgICAgZD0iTSAwLDAgNSwtNSAtMTIuNSwwIDUsNSBaIgogICAgICAgICBzdHlsZT0iZmlsbDojMDAwMDAwO2ZpbGwtb3BhY2l0eToxO2ZpbGwtcnVsZTpldmVub2RkO3N0cm9rZTojMDAwMDAwO3N0cm9rZS13aWR0aDoxcHQ7c3Ryb2tlLW9wYWNpdHk6MSIKICAgICAgICAgdHJhbnNmb3JtPSJtYXRyaXgoLTAuNCwwLDAsLTAuNCwtNCwwKSIKICAgICAgICAgaW5rc2NhcGU6Y29ubmVjdG9yLWN1cnZhdHVyZT0iMCIgLz4KICAgIDwvbWFya2VyPgogICAgPG1hcmtlcgogICAgICAgaW5rc2NhcGU6c3RvY2tpZD0iQXJyb3cxTWVuZCIKICAgICAgIG9yaWVudD0iYXV0byIKICAgICAgIHJlZlk9IjAiCiAgICAgICByZWZYPSIwIgogICAgICAgaWQ9Im1hcmtlcjEyNDYtNiIKICAgICAgIHN0eWxlPSJvdmVyZmxvdzp2aXNpYmxlIgogICAgICAgaW5rc2NhcGU6aXNzdG9jaz0idHJ1ZSI+CiAgICAgIDxwYXRoCiAgICAgICAgIGlkPSJwYXRoMTI0NC03IgogICAgICAgICBkPSJNIDAsMCA1LC01IC0xMi41LDAgNSw1IFoiCiAgICAgICAgIHN0eWxlPSJmaWxsOiMwMDAwMDA7ZmlsbC1vcGFjaXR5OjE7ZmlsbC1ydWxlOmV2ZW5vZGQ7c3Ryb2tlOiMwMDAwMDA7c3Ryb2tlLXdpZHRoOjFwdDtzdHJva2Utb3BhY2l0eToxIgogICAgICAgICB0cmFuc2Zvcm09Im1hdHJpeCgtMC40LDAsMCwtMC40LC00LDApIgogICAgICAgICBpbmtzY2FwZTpjb25uZWN0b3ItY3VydmF0dXJlPSIwIiAvPgogICAgPC9tYXJrZXI+CiAgICA8bWFya2VyCiAgICAgICBpbmtzY2FwZTpzdG9ja2lkPSJBcnJvdzFNZW5kIgogICAgICAgb3JpZW50PSJhdXRvIgogICAgICAgcmVmWT0iMCIKICAgICAgIHJlZlg9IjAiCiAgICAgICBpZD0ibWFya2VyMTI0Ni02OCIKICAgICAgIHN0eWxlPSJvdmVyZmxvdzp2aXNpYmxlIgogICAgICAgaW5rc2NhcGU6aXNzdG9jaz0idHJ1ZSI+CiAgICAgIDxwYXRoCiAgICAgICAgIGlkPSJwYXRoMTI0NC0zIgogICAgICAgICBkPSJNIDAsMCA1LC01IC0xMi41LDAgNSw1IFoiCiAgICAgICAgIHN0eWxlPSJmaWxsOiMwMDAwMDA7ZmlsbC1vcGFjaXR5OjE7ZmlsbC1ydWxlOmV2ZW5vZGQ7c3Ryb2tlOiMwMDAwMDA7c3Ryb2tlLXdpZHRoOjFwdDtzdHJva2Utb3BhY2l0eToxIgogICAgICAgICB0cmFuc2Zvcm09Im1hdHJpeCgtMC40LDAsMCwtMC40LC00LDApIgogICAgICAgICBpbmtzY2FwZTpjb25uZWN0b3ItY3VydmF0dXJlPSIwIiAvPgogICAgPC9tYXJrZXI+CiAgICA8bWFya2VyCiAgICAgICBpbmtzY2FwZTpzdG9ja2lkPSJBcnJvdzFNZW5kIgogICAgICAgb3JpZW50PSJhdXRvIgogICAgICAgcmVmWT0iMCIKICAgICAgIHJlZlg9IjAiCiAgICAgICBpZD0ibWFya2VyMTI0Ni02OC02IgogICAgICAgc3R5bGU9Im92ZXJmbG93OnZpc2libGUiCiAgICAgICBpbmtzY2FwZTppc3N0b2NrPSJ0cnVlIj4KICAgICAgPHBhdGgKICAgICAgICAgaWQ9InBhdGgxMjQ0LTMtOCIKICAgICAgICAgZD0iTSAwLDAgNSwtNSAtMTIuNSwwIDUsNSBaIgogICAgICAgICBzdHlsZT0iZmlsbDojMDAwMDAwO2ZpbGwtb3BhY2l0eToxO2ZpbGwtcnVsZTpldmVub2RkO3N0cm9rZTojMDAwMDAwO3N0cm9rZS13aWR0aDoxcHQ7c3Ryb2tlLW9wYWNpdHk6MSIKICAgICAgICAgdHJhbnNmb3JtPSJtYXRyaXgoLTAuNCwwLDAsLTAuNCwtNCwwKSIKICAgICAgICAgaW5rc2NhcGU6Y29ubmVjdG9yLWN1cnZhdHVyZT0iMCIgLz4KICAgIDwvbWFya2VyPgogICAgPG1hcmtlcgogICAgICAgaW5rc2NhcGU6c3RvY2tpZD0iQXJyb3cxTXN0YXJ0IgogICAgICAgb3JpZW50PSJhdXRvIgogICAgICAgcmVmWT0iMCIKICAgICAgIHJlZlg9IjAiCiAgICAgICBpZD0iQXJyb3cxTXN0YXJ0LTQiCiAgICAgICBzdHlsZT0ib3ZlcmZsb3c6dmlzaWJsZSIKICAgICAgIGlua3NjYXBlOmlzc3RvY2s9InRydWUiPgogICAgICA8cGF0aAogICAgICAgICBpZD0icGF0aDk2OC00IgogICAgICAgICBkPSJNIDAsMCA1LC01IC0xMi41LDAgNSw1IFoiCiAgICAgICAgIHN0eWxlPSJmaWxsOiMwMDAwMDA7ZmlsbC1vcGFjaXR5OjE7ZmlsbC1ydWxlOmV2ZW5vZGQ7c3Ryb2tlOiMwMDAwMDA7c3Ryb2tlLXdpZHRoOjFwdDtzdHJva2Utb3BhY2l0eToxIgogICAgICAgICB0cmFuc2Zvcm09Im1hdHJpeCgwLjQsMCwwLDAuNCw0LDApIgogICAgICAgICBpbmtzY2FwZTpjb25uZWN0b3ItY3VydmF0dXJlPSIwIiAvPgogICAgPC9tYXJrZXI+CiAgPC9kZWZzPgogIDxzb2RpcG9kaTpuYW1lZHZpZXcKICAgICBpZD0iYmFzZSIKICAgICBwYWdlY29sb3I9IiNmZmZmZmYiCiAgICAgYm9yZGVyY29sb3I9IiM2NjY2NjYiCiAgICAgYm9yZGVyb3BhY2l0eT0iMS4wIgogICAgIGlua3NjYXBlOnBhZ2VvcGFjaXR5PSIwLjAiCiAgICAgaW5rc2NhcGU6cGFnZXNoYWRvdz0iMiIKICAgICBpbmtzY2FwZTp6b29tPSIxLjQxNDIxMzYiCiAgICAgaW5rc2NhcGU6Y3g9IjI3Ny4xODU4NSIKICAgICBpbmtzY2FwZTpjeT0iMTM5LjMwMDAzIgogICAgIGlua3NjYXBlOmRvY3VtZW50LXVuaXRzPSJtbSIKICAgICBpbmtzY2FwZTpjdXJyZW50LWxheWVyPSJsYXllcjEiCiAgICAgc2hvd2dyaWQ9InRydWUiCiAgICAgaW5rc2NhcGU6c25hcC10ZXh0LWJhc2VsaW5lPSJ0cnVlIgogICAgIGlua3NjYXBlOnNuYXAtb2JqZWN0LW1pZHBvaW50cz0idHJ1ZSIKICAgICBpbmtzY2FwZTptZWFzdXJlLXN0YXJ0PSIyNDUsOTE1IgogICAgIGlua3NjYXBlOm1lYXN1cmUtZW5kPSI1NzAsOTE1IgogICAgIHNob3dndWlkZXM9ImZhbHNlIgogICAgIGZpdC1tYXJnaW4tbGVmdD0iMSIKICAgICBmaXQtbWFyZ2luLXRvcD0iMSIKICAgICBmaXQtbWFyZ2luLXJpZ2h0PSIxIgogICAgIGZpdC1tYXJnaW4tYm90dG9tPSIxIgogICAgIGlua3NjYXBlOndpbmRvdy13aWR0aD0iMTkyMCIKICAgICBpbmtzY2FwZTp3aW5kb3ctaGVpZ2h0PSI5ODYiCiAgICAgaW5rc2NhcGU6d2luZG93LXg9Ii0xMSIKICAgICBpbmtzY2FwZTp3aW5kb3cteT0iLTExIgogICAgIGlua3NjYXBlOndpbmRvdy1tYXhpbWl6ZWQ9IjEiCiAgICAgaW5rc2NhcGU6cGFnZWNoZWNrZXJib2FyZD0iMCI+CiAgICA8aW5rc2NhcGU6Z3JpZAogICAgICAgdHlwZT0ieHlncmlkIgogICAgICAgaWQ9ImdyaWQ5MDciCiAgICAgICBvcmlnaW54PSIzLjgzODM0MzgiCiAgICAgICBvcmlnaW55PSItMjEyLjcyMzA1IiAvPgogIDwvc29kaXBvZGk6bmFtZWR2aWV3PgogIDxtZXRhZGF0YQogICAgIGlkPSJtZXRhZGF0YTUiPgogICAgPHJkZjpSREY+CiAgICAgIDxjYzpXb3JrCiAgICAgICAgIHJkZjphYm91dD0iIj4KICAgICAgICA8ZGM6Zm9ybWF0PmltYWdlL3N2Zyt4bWw8L2RjOmZvcm1hdD4KICAgICAgICA8ZGM6dHlwZQogICAgICAgICAgIHJkZjpyZXNvdXJjZT0iaHR0cDovL3B1cmwub3JnL2RjL2RjbWl0eXBlL1N0aWxsSW1hZ2UiIC8+CiAgICAgIDwvY2M6V29yaz4KICAgIDwvcmRmOlJERj4KICA8L21ldGFkYXRhPgogIDxnCiAgICAgaW5rc2NhcGU6bGFiZWw9IkxheWVyIDEiCiAgICAgaW5rc2NhcGU6Z3JvdXBtb2RlPSJsYXllciIKICAgICBpZD0ibGF5ZXIxIgogICAgIHRyYW5zZm9ybT0idHJhbnNsYXRlKDMuODM4MzQzOCw4LjMxNTk2MzcpIj4KICAgIDxyZWN0CiAgICAgICBzdHlsZT0iZmlsbDpub25lO2ZpbGwtb3BhY2l0eToxO3N0cm9rZTojMDAwMDAwO3N0cm9rZS13aWR0aDowLjM4NTAyNTtzdHJva2UtbWl0ZXJsaW1pdDo0O3N0cm9rZS1kYXNoYXJyYXk6bm9uZTtzdHJva2UtZGFzaG9mZnNldDowO3N0cm9rZS1vcGFjaXR5OjEiCiAgICAgICBpZD0icmVjdDgxNS0xLTQtMy02LTEtNjgtMi01LTIiCiAgICAgICB3aWR0aD0iNjMuNDk5OTk2IgogICAgICAgaGVpZ2h0PSI3LjkzNzUwMDUiCiAgICAgICB4PSI3OS4zNzUiCiAgICAgICB5PSI5LjE0ODQ4NjEiIC8+CiAgICA8dGV4dAogICAgICAgaWQ9InRleHQ4MjMtNC0yLTktNC03LTktMi0wIgogICAgICAgeT0iMTQuNDQwMTUzIgogICAgICAgeD0iMTA3Ljk0OTk5IgogICAgICAgc3R5bGU9ImZvbnQtc3R5bGU6bm9ybWFsO2ZvbnQtdmFyaWFudDpub3JtYWw7Zm9udC13ZWlnaHQ6bm9ybWFsO2ZvbnQtc3RyZXRjaDpub3JtYWw7Zm9udC1zaXplOjQuMjMzMzNweDtsaW5lLWhlaWdodDoxLjI1O2ZvbnQtZmFtaWx5OnNhbnMtc2VyaWY7LWlua3NjYXBlLWZvbnQtc3BlY2lmaWNhdGlvbjonc2Fucy1zZXJpZiwgTm9ybWFsJztmb250LXZhcmlhbnQtbGlnYXR1cmVzOm5vcm1hbDtmb250LXZhcmlhbnQtY2Fwczpub3JtYWw7Zm9udC12YXJpYW50LW51bWVyaWM6bm9ybWFsO2ZvbnQtZmVhdHVyZS1zZXR0aW5nczpub3JtYWw7dGV4dC1hbGlnbjpjZW50ZXI7bGV0dGVyLXNwYWNpbmc6MHB4O3dvcmQtc3BhY2luZzowcHg7d3JpdGluZy1tb2RlOmxyLXRiO3RleHQtYW5jaG9yOm1pZGRsZTtmaWxsOiMwMDAwMDA7ZmlsbC1vcGFjaXR5OjE7c3Ryb2tlOm5vbmU7c3Ryb2tlLXdpZHRoOjAuMzk2ODc1IgogICAgICAgeG1sOnNwYWNlPSJwcmVzZXJ2ZSI+PHRzcGFuCiAgICAgICAgIGlkPSJ0c3BhbjgyNS02LTAtMi01LTYtMjYtNC0yIgogICAgICAgICBzdHlsZT0iZm9udC1zdHlsZTpub3JtYWw7Zm9udC12YXJpYW50Om5vcm1hbDtmb250LXdlaWdodDpub3JtYWw7Zm9udC1zdHJldGNoOm5vcm1hbDtmb250LXNpemU6NC4yMzMzM3B4O2ZvbnQtZmFtaWx5OnNhbnMtc2VyaWY7LWlua3NjYXBlLWZvbnQtc3BlY2lmaWNhdGlvbjonc2Fucy1zZXJpZiwgTm9ybWFsJztmb250LXZhcmlhbnQtbGlnYXR1cmVzOm5vcm1hbDtmb250LXZhcmlhbnQtY2Fwczpub3JtYWw7Zm9udC12YXJpYW50LW51bWVyaWM6bm9ybWFsO2ZvbnQtZmVhdHVyZS1zZXR0aW5nczpub3JtYWw7dGV4dC1hbGlnbjpjZW50ZXI7d3JpdGluZy1tb2RlOmxyLXRiO3RleHQtYW5jaG9yOm1pZGRsZTtzdHJva2Utd2lkdGg6MC4zOTY4NzUiCiAgICAgICAgIHk9IjE0LjQ0MDE1MyIKICAgICAgICAgeD0iMTA3Ljk0OTk5IgogICAgICAgICBzb2RpcG9kaTpyb2xlPSJsaW5lIj5SZWNvcmRpbmc8L3RzcGFuPjwvdGV4dD4KICAgIDxyZWN0CiAgICAgICBzdHlsZT0iZmlsbDpub25lO2ZpbGwtb3BhY2l0eToxO3N0cm9rZTojMDAwMDAwO3N0cm9rZS13aWR0aDowLjM4NTAyNTtzdHJva2UtbWl0ZXJsaW1pdDo0O3N0cm9rZS1kYXNoYXJyYXk6bm9uZTtzdHJva2UtZGFzaG9mZnNldDowO3N0cm9rZS1vcGFjaXR5OjEiCiAgICAgICBpZD0icmVjdDgxNS0xLTQtMy02LTEtNjgtMi01LTciCiAgICAgICB3aWR0aD0iNjMuNDk5OTk2IgogICAgICAgaGVpZ2h0PSI3LjkzNzUwMDUiCiAgICAgICB4PSI3OS4zNzUiCiAgICAgICB5PSI3MC4wMDI2NTUiIC8+CiAgICA8dGV4dAogICAgICAgaWQ9InRleHQ4MjMtNC0yLTktNC03LTktMi03IgogICAgICAgeT0iNzUuMjk0MzE5IgogICAgICAgeD0iMTA1LjgzMzMxIgogICAgICAgc3R5bGU9ImZvbnQtc3R5bGU6bm9ybWFsO2ZvbnQtdmFyaWFudDpub3JtYWw7Zm9udC13ZWlnaHQ6bm9ybWFsO2ZvbnQtc3RyZXRjaDpub3JtYWw7Zm9udC1zaXplOjQuMjMzMzNweDtsaW5lLWhlaWdodDoxLjI1O2ZvbnQtZmFtaWx5OnNhbnMtc2VyaWY7LWlua3NjYXBlLWZvbnQtc3BlY2lmaWNhdGlvbjonc2Fucy1zZXJpZiwgTm9ybWFsJztmb250LXZhcmlhbnQtbGlnYXR1cmVzOm5vcm1hbDtmb250LXZhcmlhbnQtY2Fwczpub3JtYWw7Zm9udC12YXJpYW50LW51bWVyaWM6bm9ybWFsO2ZvbnQtZmVhdHVyZS1zZXR0aW5nczpub3JtYWw7dGV4dC1hbGlnbjpjZW50ZXI7bGV0dGVyLXNwYWNpbmc6MHB4O3dvcmQtc3BhY2luZzowcHg7d3JpdGluZy1tb2RlOmxyLXRiO3RleHQtYW5jaG9yOm1pZGRsZTtmaWxsOiMwMDAwMDA7ZmlsbC1vcGFjaXR5OjE7c3Ryb2tlOm5vbmU7c3Ryb2tlLXdpZHRoOjAuMzk2ODc1IgogICAgICAgeG1sOnNwYWNlPSJwcmVzZXJ2ZSI+PHRzcGFuCiAgICAgICAgIGlkPSJ0c3BhbjgyNS02LTAtMi01LTYtMjYtNC0wIgogICAgICAgICBzdHlsZT0iZm9udC1zdHlsZTpub3JtYWw7Zm9udC12YXJpYW50Om5vcm1hbDtmb250LXdlaWdodDpub3JtYWw7Zm9udC1zdHJldGNoOm5vcm1hbDtmb250LXNpemU6NC4yMzMzM3B4O2ZvbnQtZmFtaWx5OnNhbnMtc2VyaWY7LWlua3NjYXBlLWZvbnQtc3BlY2lmaWNhdGlvbjonc2Fucy1zZXJpZiwgTm9ybWFsJztmb250LXZhcmlhbnQtbGlnYXR1cmVzOm5vcm1hbDtmb250LXZhcmlhbnQtY2Fwczpub3JtYWw7Zm9udC12YXJpYW50LW51bWVyaWM6bm9ybWFsO2ZvbnQtZmVhdHVyZS1zZXR0aW5nczpub3JtYWw7dGV4dC1hbGlnbjpjZW50ZXI7d3JpdGluZy1tb2RlOmxyLXRiO3RleHQtYW5jaG9yOm1pZGRsZTtzdHJva2Utd2lkdGg6MC4zOTY4NzUiCiAgICAgICAgIHk9Ijc1LjI5NDMxOSIKICAgICAgICAgeD0iMTA1LjgzMzMxIgogICAgICAgICBzb2RpcG9kaTpyb2xlPSJsaW5lIj5QZW5kaW5nPC90c3Bhbj48L3RleHQ+CiAgICA8cmVjdAogICAgICAgc3R5bGU9ImZpbGw6bm9uZTtmaWxsLW9wYWNpdHk6MTtzdHJva2U6IzAwMDAwMDtzdHJva2Utd2lkdGg6MC4zODUwMjU7c3Ryb2tlLW1pdGVybGltaXQ6NDtzdHJva2UtZGFzaGFycmF5Om5vbmU7c3Ryb2tlLWRhc2hvZmZzZXQ6MDtzdHJva2Utb3BhY2l0eToxIgogICAgICAgaWQ9InJlY3Q4MTUtMS00LTMtNi0xLTY4LTItNS0xIgogICAgICAgd2lkdGg9IjYzLjQ5OTk5NiIKICAgICAgIGhlaWdodD0iNy45Mzc1MDA1IgogICAgICAgeD0iMTU2LjEwNDE3IgogICAgICAgeT0iMzUuNjA2ODE5IiAvPgogICAgPHRleHQKICAgICAgIGlkPSJ0ZXh0ODIzLTQtMi05LTQtNy05LTItOSIKICAgICAgIHk9IjQwLjg5ODQ4NyIKICAgICAgIHg9IjE3OS45MTY2NyIKICAgICAgIHN0eWxlPSJmb250LXN0eWxlOm5vcm1hbDtmb250LXZhcmlhbnQ6bm9ybWFsO2ZvbnQtd2VpZ2h0Om5vcm1hbDtmb250LXN0cmV0Y2g6bm9ybWFsO2ZvbnQtc2l6ZTo0LjIzMzMzcHg7bGluZS1oZWlnaHQ6MS4yNTtmb250LWZhbWlseTpzYW5zLXNlcmlmOy1pbmtzY2FwZS1mb250LXNwZWNpZmljYXRpb246J3NhbnMtc2VyaWYsIE5vcm1hbCc7Zm9udC12YXJpYW50LWxpZ2F0dXJlczpub3JtYWw7Zm9udC12YXJpYW50LWNhcHM6bm9ybWFsO2ZvbnQtdmFyaWFudC1udW1lcmljOm5vcm1hbDtmb250LWZlYXR1cmUtc2V0dGluZ3M6bm9ybWFsO3RleHQtYWxpZ246Y2VudGVyO2xldHRlci1zcGFjaW5nOjBweDt3b3JkLXNwYWNpbmc6MHB4O3dyaXRpbmctbW9kZTpsci10Yjt0ZXh0LWFuY2hvcjptaWRkbGU7ZmlsbDojMDAwMDAwO2ZpbGwtb3BhY2l0eToxO3N0cm9rZTpub25lO3N0cm9rZS13aWR0aDowLjM5Njg3NSIKICAgICAgIHhtbDpzcGFjZT0icHJlc2VydmUiPjx0c3BhbgogICAgICAgICBpZD0idHNwYW44MjUtNi0wLTItNS02LTI2LTQtOSIKICAgICAgICAgc3R5bGU9ImZvbnQtc3R5bGU6bm9ybWFsO2ZvbnQtdmFyaWFudDpub3JtYWw7Zm9udC13ZWlnaHQ6bm9ybWFsO2ZvbnQtc3RyZXRjaDpub3JtYWw7Zm9udC1zaXplOjQuMjMzMzNweDtmb250LWZhbWlseTpzYW5zLXNlcmlmOy1pbmtzY2FwZS1mb250LXNwZWNpZmljYXRpb246J3NhbnMtc2VyaWYsIE5vcm1hbCc7Zm9udC12YXJpYW50LWxpZ2F0dXJlczpub3JtYWw7Zm9udC12YXJpYW50LWNhcHM6bm9ybWFsO2ZvbnQtdmFyaWFudC1udW1lcmljOm5vcm1hbDtmb250LWZlYXR1cmUtc2V0dGluZ3M6bm9ybWFsO3RleHQtYWxpZ246Y2VudGVyO3dyaXRpbmctbW9kZTpsci10Yjt0ZXh0LWFuY2hvcjptaWRkbGU7c3Ryb2tlLXdpZHRoOjAuMzk2ODc1IgogICAgICAgICB5PSI0MC44OTg0ODciCiAgICAgICAgIHg9IjE3OS45MTY2NyIKICAgICAgICAgc29kaXBvZGk6cm9sZT0ibGluZSI+RXhlY3V0YWJsZTwvdHNwYW4+PC90ZXh0PgogICAgPHJlY3QKICAgICAgIHN0eWxlPSJmaWxsOm5vbmU7ZmlsbC1vcGFjaXR5OjE7c3Ryb2tlOiMwMDAwMDA7c3Ryb2tlLXdpZHRoOjAuMzg1MDI1O3N0cm9rZS1taXRlcmxpbWl0OjQ7c3Ryb2tlLWRhc2hhcnJheTpub25lO3N0cm9rZS1kYXNob2Zmc2V0OjA7c3Ryb2tlLW9wYWNpdHk6MSIKICAgICAgIGlkPSJyZWN0ODE1LTEtNC0zLTYtMS02OC0yLTUtOSIKICAgICAgIHdpZHRoPSI2My40OTk5OTYiCiAgICAgICBoZWlnaHQ9IjcuOTM3NTAwNSIKICAgICAgIHg9Ii0yLjY0NTgzMTEiCiAgICAgICB5PSIzNS45ODQ3NDkiIC8+CiAgICA8dGV4dAogICAgICAgaWQ9InRleHQ4MjMtNC0yLTktNC03LTktMi02IgogICAgICAgeT0iNDEuMDEwNzkyIgogICAgICAgeD0iMzAuMDY2MzgiCiAgICAgICBzdHlsZT0iZm9udC1zdHlsZTpub3JtYWw7Zm9udC12YXJpYW50Om5vcm1hbDtmb250LXdlaWdodDpub3JtYWw7Zm9udC1zdHJldGNoOm5vcm1hbDtmb250LXNpemU6NC4yMzMzM3B4O2xpbmUtaGVpZ2h0OjEuMjU7Zm9udC1mYW1pbHk6c2Fucy1zZXJpZjstaW5rc2NhcGUtZm9udC1zcGVjaWZpY2F0aW9uOidzYW5zLXNlcmlmLCBOb3JtYWwnO2ZvbnQtdmFyaWFudC1saWdhdHVyZXM6bm9ybWFsO2ZvbnQtdmFyaWFudC1jYXBzOm5vcm1hbDtmb250LXZhcmlhbnQtbnVtZXJpYzpub3JtYWw7Zm9udC1mZWF0dXJlLXNldHRpbmdzOm5vcm1hbDt0ZXh0LWFsaWduOmNlbnRlcjtsZXR0ZXItc3BhY2luZzowcHg7d29yZC1zcGFjaW5nOjBweDt3cml0aW5nLW1vZGU6bHItdGI7dGV4dC1hbmNob3I6bWlkZGxlO2ZpbGw6IzAwMDAwMDtmaWxsLW9wYWNpdHk6MTtzdHJva2U6bm9uZTtzdHJva2Utd2lkdGg6MC4zOTY4NzUiCiAgICAgICB4bWw6c3BhY2U9InByZXNlcnZlIj48dHNwYW4KICAgICAgICAgaWQ9InRzcGFuODI1LTYtMC0yLTUtNi0yNi00LTkzIgogICAgICAgICBzdHlsZT0iZm9udC1zdHlsZTpub3JtYWw7Zm9udC12YXJpYW50Om5vcm1hbDtmb250LXdlaWdodDpub3JtYWw7Zm9udC1zdHJldGNoOm5vcm1hbDtmb250LXNpemU6NC4yMzMzM3B4O2ZvbnQtZmFtaWx5OnNhbnMtc2VyaWY7LWlua3NjYXBlLWZvbnQtc3BlY2lmaWNhdGlvbjonc2Fucy1zZXJpZiwgTm9ybWFsJztmb250LXZhcmlhbnQtbGlnYXR1cmVzOm5vcm1hbDtmb250LXZhcmlhbnQtY2Fwczpub3JtYWw7Zm9udC12YXJpYW50LW51bWVyaWM6bm9ybWFsO2ZvbnQtZmVhdHVyZS1zZXR0aW5nczpub3JtYWw7dGV4dC1hbGlnbjpjZW50ZXI7d3JpdGluZy1tb2RlOmxyLXRiO3RleHQtYW5jaG9yOm1pZGRsZTtzdHJva2Utd2lkdGg6MC4zOTY4NzUiCiAgICAgICAgIHk9IjQxLjAxMDc5MiIKICAgICAgICAgeD0iMzAuMDY2MzgiCiAgICAgICAgIHNvZGlwb2RpOnJvbGU9ImxpbmUiPkludmFsaWQ8L3RzcGFuPjwvdGV4dD4KICAgIDx0ZXh0CiAgICAgICB4bWw6c3BhY2U9InByZXNlcnZlIgogICAgICAgc3R5bGU9ImZvbnQtc3R5bGU6bm9ybWFsO2ZvbnQtdmFyaWFudDpub3JtYWw7Zm9udC13ZWlnaHQ6bm9ybWFsO2ZvbnQtc3RyZXRjaDpub3JtYWw7Zm9udC1zaXplOjQuMjMzMzNweDtsaW5lLWhlaWdodDoxLjI1O2ZvbnQtZmFtaWx5OnNhbnMtc2VyaWY7LWlua3NjYXBlLWZvbnQtc3BlY2lmaWNhdGlvbjonc2Fucy1zZXJpZiwgTm9ybWFsJztmb250LXZhcmlhbnQtbGlnYXR1cmVzOm5vcm1hbDtmb250LXZhcmlhbnQtY2Fwczpub3JtYWw7Zm9udC12YXJpYW50LW51bWVyaWM6bm9ybWFsO2ZvbnQtZmVhdHVyZS1zZXR0aW5nczpub3JtYWw7dGV4dC1hbGlnbjpjZW50ZXI7bGV0dGVyLXNwYWNpbmc6MHB4O3dvcmQtc3BhY2luZzowcHg7d3JpdGluZy1tb2RlOmxyLXRiO3RleHQtYW5jaG9yOm1pZGRsZTtmaWxsOiMwMDAwMDA7ZmlsbC1vcGFjaXR5OjE7c3Ryb2tlOm5vbmU7c3Ryb2tlLXdpZHRoOjAuMzk2ODc1IgogICAgICAgeD0iMTA4LjQ3OTE1IgogICAgICAgeT0iLTQuMDk5NjIyNyIKICAgICAgIGlkPSJ0ZXh0OTA1Ij48dHNwYW4KICAgICAgICAgc29kaXBvZGk6cm9sZT0ibGluZSIKICAgICAgICAgaWQ9InRzcGFuOTAzIgogICAgICAgICB4PSIxMDguNDc5MTUiCiAgICAgICAgIHk9Ii00LjA5OTYyMjciCiAgICAgICAgIHN0eWxlPSJmb250LXN0eWxlOm5vcm1hbDtmb250LXZhcmlhbnQ6bm9ybWFsO2ZvbnQtd2VpZ2h0Om5vcm1hbDtmb250LXN0cmV0Y2g6bm9ybWFsO2ZvbnQtc2l6ZTo0LjIzMzMzcHg7Zm9udC1mYW1pbHk6c2Fucy1zZXJpZjstaW5rc2NhcGUtZm9udC1zcGVjaWZpY2F0aW9uOidzYW5zLXNlcmlmLCBOb3JtYWwnO2ZvbnQtdmFyaWFudC1saWdhdHVyZXM6bm9ybWFsO2ZvbnQtdmFyaWFudC1jYXBzOm5vcm1hbDtmb250LXZhcmlhbnQtbnVtZXJpYzpub3JtYWw7Zm9udC1mZWF0dXJlLXNldHRpbmdzOm5vcm1hbDt0ZXh0LWFsaWduOmNlbnRlcjt3cml0aW5nLW1vZGU6bHItdGI7dGV4dC1hbmNob3I6bWlkZGxlO3N0cm9rZS13aWR0aDowLjM5Njg3NSI+Q3JlYXRlPC90c3Bhbj48L3RleHQ+CiAgICA8cGF0aAogICAgICAgc3R5bGU9ImZpbGw6bm9uZTtzdHJva2U6IzAwMDAwMDtzdHJva2Utd2lkdGg6MC40MjI4MDFweDtzdHJva2UtbGluZWNhcDpidXR0O3N0cm9rZS1saW5lam9pbjptaXRlcjtzdHJva2Utb3BhY2l0eToxO21hcmtlci1lbmQ6dXJsKCNtYXJrZXIxMjQ2KSIKICAgICAgIGQ9Im0gMTc3LjI3MDgzLDQzLjU0NDMyIGMgLTIuNzk5MjIsMTIuODU5OTQ3IC0xNS4wMDQsMjIuMjkxODA5IC0zNC4zOTU4MywyOS4xMDQxNjYiCiAgICAgICBpZD0icGF0aDkyOCIKICAgICAgIGlua3NjYXBlOmNvbm5lY3Rvci1jdXJ2YXR1cmU9IjAiCiAgICAgICBzb2RpcG9kaTpub2RldHlwZXM9ImNjIiAvPgogICAgPHBhdGgKICAgICAgIHN0eWxlPSJmaWxsOm5vbmU7c3Ryb2tlOiMwMDAwMDA7c3Ryb2tlLXdpZHRoOjAuMzg3MzExcHg7c3Ryb2tlLWxpbmVjYXA6YnV0dDtzdHJva2UtbGluZWpvaW46bWl0ZXI7c3Ryb2tlLW9wYWNpdHk6MTttYXJrZXItZW5kOnVybCgjbWFya2VyMTI0Ni02OCkiCiAgICAgICBkPSJtIDE0Mi44NzUsNzAuMDAyNjUzIGMgMi41ODM5LC0xMS42OTA4NjYgMTMuODQ5ODUsLTIwLjI2NTI3OCAzMS43NSwtMjYuNDU4MzMzIgogICAgICAgaWQ9InBhdGg5MjgtMyIKICAgICAgIGlua3NjYXBlOmNvbm5lY3Rvci1jdXJ2YXR1cmU9IjAiCiAgICAgICBzb2RpcG9kaTpub2RldHlwZXM9ImNjIiAvPgogICAgPHBhdGgKICAgICAgIHN0eWxlPSJmaWxsOm5vbmU7c3Ryb2tlOiMwMDAwMDA7c3Ryb2tlLXdpZHRoOjAuMzM1NDIxcHg7c3Ryb2tlLWxpbmVjYXA6YnV0dDtzdHJva2UtbGluZWpvaW46bWl0ZXI7c3Ryb2tlLW9wYWNpdHk6MTttYXJrZXItZW5kOnVybCgjbWFya2VyMTI0Ni02OC02KSIKICAgICAgIGQ9Im0gMTQyLjg3NSwxMS43OTQzMiBjIDExLjY5MDg3LDEuOTM3OTI1IDIwLjI2NTI4LDEwLjM4NzM4NyAyNi40NTgzMywyMy44MTI1IgogICAgICAgaWQ9InBhdGg5MjgtMy04IgogICAgICAgaW5rc2NhcGU6Y29ubmVjdG9yLWN1cnZhdHVyZT0iMCIKICAgICAgIHNvZGlwb2RpOm5vZGV0eXBlcz0iY2MiIC8+CiAgICA8cGF0aAogICAgICAgc3R5bGU9ImZpbGw6bm9uZTtzdHJva2U6IzAwMDAwMDtzdHJva2Utd2lkdGg6MC40NTExNTY7c3Ryb2tlLWxpbmVjYXA6YnV0dDtzdHJva2UtbGluZWpvaW46bWl0ZXI7c3Ryb2tlLW1pdGVybGltaXQ6NDtzdHJva2UtZGFzaGFycmF5OjEuODA0NjIsIDEuODA0NjI7c3Ryb2tlLWRhc2hvZmZzZXQ6MDtzdHJva2Utb3BhY2l0eToxO21hcmtlci1zdGFydDp1cmwoI0Fycm93MU1zdGFydCkiCiAgICAgICBkPSJtIDYxLjkxMjUwMSw0My4wMTUxNTMgYyAyNi45MjAzODgsMCA0NC4xNTU3NTksMC42MTA4MDcgNDkuMjEyNDk5LDI2Ljk4NzUiCiAgICAgICBpZD0icGF0aDkyOC05IgogICAgICAgaW5rc2NhcGU6Y29ubmVjdG9yLWN1cnZhdHVyZT0iMCIKICAgICAgIHNvZGlwb2RpOm5vZGV0eXBlcz0iY2MiIC8+CiAgICA8cGF0aAogICAgICAgc3R5bGU9ImZpbGw6bm9uZTtzdHJva2U6IzAwMDAwMDtzdHJva2Utd2lkdGg6MC4zODk2Mjg7c3Ryb2tlLWxpbmVjYXA6YnV0dDtzdHJva2UtbGluZWpvaW46bWl0ZXI7c3Ryb2tlLW1pdGVybGltaXQ6NDtzdHJva2UtZGFzaGFycmF5OjEuNTU4NTEsIDEuNTU4NTE7c3Ryb2tlLWRhc2hvZmZzZXQ6MDtzdHJva2Utb3BhY2l0eToxO21hcmtlci1zdGFydDp1cmwoI0Fycm93MU1zdGFydC00KSIKICAgICAgIGQ9Im0gNjIuMTUzNzI3LDM3LjMxMzY0OCBjIDI2Ljc4ODQyNiwwIDQzLjkzOTMxMywtMC40NTc4MTIgNDguOTcxMjczLC0yMC4yMjc2NjIiCiAgICAgICBpZD0icGF0aDkyOC05LTMiCiAgICAgICBpbmtzY2FwZTpjb25uZWN0b3ItY3VydmF0dXJlPSIwIgogICAgICAgc29kaXBvZGk6bm9kZXR5cGVzPSJjYyIgLz4KICAgIDxwYXRoCiAgICAgICBzdHlsZT0iZmlsbDpub25lO3N0cm9rZTojMDAwMDAwO3N0cm9rZS13aWR0aDowLjM5Njg3NDk2cHg7c3Ryb2tlLWxpbmVjYXA6YnV0dDtzdHJva2UtbGluZWpvaW46bWl0ZXI7c3Ryb2tlLW9wYWNpdHk6MTttYXJrZXItZW5kOnVybCgjbWFya2VyMzQ1NykiCiAgICAgICBkPSJNIDEwOC40NzkxNywtMi4xMTUyNDcyIFYgNy44MDY2MjczIgogICAgICAgaWQ9InBhdGgzNDQ3IgogICAgICAgaW5rc2NhcGU6Y29ubmVjdG9yLWN1cnZhdHVyZT0iMCIgLz4KICAgIDx0ZXh0CiAgICAgICB4bWw6c3BhY2U9InByZXNlcnZlIgogICAgICAgc3R5bGU9ImZvbnQtc3R5bGU6bm9ybWFsO2ZvbnQtdmFyaWFudDpub3JtYWw7Zm9udC13ZWlnaHQ6bm9ybWFsO2ZvbnQtc3RyZXRjaDpub3JtYWw7Zm9udC1zaXplOjQuMjMzMzNweDtsaW5lLWhlaWdodDoxLjI1O2ZvbnQtZmFtaWx5OnNhbnMtc2VyaWY7LWlua3NjYXBlLWZvbnQtc3BlY2lmaWNhdGlvbjonc2Fucy1zZXJpZiwgTm9ybWFsJztmb250LXZhcmlhbnQtbGlnYXR1cmVzOm5vcm1hbDtmb250LXZhcmlhbnQtY2Fwczpub3JtYWw7Zm9udC12YXJpYW50LW51bWVyaWM6bm9ybWFsO2ZvbnQtZmVhdHVyZS1zZXR0aW5nczpub3JtYWw7dGV4dC1hbGlnbjpzdGFydDtsZXR0ZXItc3BhY2luZzowcHg7d29yZC1zcGFjaW5nOjBweDt3cml0aW5nLW1vZGU6bHItdGI7dGV4dC1hbmNob3I6c3RhcnQ7ZmlsbDojMDAwMDAwO2ZpbGwtb3BhY2l0eToxO3N0cm9rZTpub25lO3N0cm9rZS13aWR0aDowLjM5Njg3NSIKICAgICAgIHg9IjE2MS4zOTU4MyIKICAgICAgIHk9IjE5LjczMTgxOSIKICAgICAgIGlkPSJ0ZXh0OTA1LTUtNCI+PHRzcGFuCiAgICAgICAgIHNvZGlwb2RpOnJvbGU9ImxpbmUiCiAgICAgICAgIGlkPSJ0c3BhbjkwMy00LTEiCiAgICAgICAgIHg9IjE2MS4zOTU4MyIKICAgICAgICAgeT0iMTkuNzMxODE5IgogICAgICAgICBzdHlsZT0iZm9udC1zdHlsZTpub3JtYWw7Zm9udC12YXJpYW50Om5vcm1hbDtmb250LXdlaWdodDpub3JtYWw7Zm9udC1zdHJldGNoOm5vcm1hbDtmb250LXNpemU6NC4yMzMzM3B4O2ZvbnQtZmFtaWx5OnNhbnMtc2VyaWY7LWlua3NjYXBlLWZvbnQtc3BlY2lmaWNhdGlvbjonc2Fucy1zZXJpZiwgTm9ybWFsJztmb250LXZhcmlhbnQtbGlnYXR1cmVzOm5vcm1hbDtmb250LXZhcmlhbnQtY2Fwczpub3JtYWw7Zm9udC12YXJpYW50LW51bWVyaWM6bm9ybWFsO2ZvbnQtZmVhdHVyZS1zZXR0aW5nczpub3JtYWw7dGV4dC1hbGlnbjpzdGFydDt3cml0aW5nLW1vZGU6bHItdGI7dGV4dC1hbmNob3I6c3RhcnQ7c3Ryb2tlLXdpZHRoOjAuMzk2ODc1Ij5GaW5hbGl6ZTwvdHNwYW4+PC90ZXh0PgogICAgPHRleHQKICAgICAgIHhtbDpzcGFjZT0icHJlc2VydmUiCiAgICAgICBzdHlsZT0iZm9udC1zdHlsZTpub3JtYWw7Zm9udC12YXJpYW50Om5vcm1hbDtmb250LXdlaWdodDpub3JtYWw7Zm9udC1zdHJldGNoOm5vcm1hbDtmb250LXNpemU6NC4yMzMzM3B4O2xpbmUtaGVpZ2h0OjEuMjU7Zm9udC1mYW1pbHk6c2Fucy1zZXJpZjstaW5rc2NhcGUtZm9udC1zcGVjaWZpY2F0aW9uOidzYW5zLXNlcmlmLCBOb3JtYWwnO2ZvbnQtdmFyaWFudC1saWdhdHVyZXM6bm9ybWFsO2ZvbnQtdmFyaWFudC1jYXBzOm5vcm1hbDtmb250LXZhcmlhbnQtbnVtZXJpYzpub3JtYWw7Zm9udC1mZWF0dXJlLXNldHRpbmdzOm5vcm1hbDt0ZXh0LWFsaWduOmNlbnRlcjtsZXR0ZXItc3BhY2luZzowcHg7d29yZC1zcGFjaW5nOjBweDt3cml0aW5nLW1vZGU6bHItdGI7dGV4dC1hbmNob3I6bWlkZGxlO2ZpbGw6IzAwMDAwMDtmaWxsLW9wYWNpdHk6MTtzdHJva2U6bm9uZTtzdHJva2Utd2lkdGg6MC4zOTY4NzUiCiAgICAgICB4PSIxNzcuODAwMDMiCiAgICAgICB5PSI2NS4yNDAxNSIKICAgICAgIGlkPSJ0ZXh0OTA1LTUtNC0zIj48dHNwYW4KICAgICAgICAgc29kaXBvZGk6cm9sZT0ibGluZSIKICAgICAgICAgaWQ9InRzcGFuOTAzLTQtMS0xIgogICAgICAgICB4PSIxNzcuODAwMDMiCiAgICAgICAgIHk9IjY1LjI0MDE1IgogICAgICAgICBzdHlsZT0iZm9udC1zdHlsZTpub3JtYWw7Zm9udC12YXJpYW50Om5vcm1hbDtmb250LXdlaWdodDpub3JtYWw7Zm9udC1zdHJldGNoOm5vcm1hbDtmb250LXNpemU6NC4yMzMzM3B4O2ZvbnQtZmFtaWx5OnNhbnMtc2VyaWY7LWlua3NjYXBlLWZvbnQtc3BlY2lmaWNhdGlvbjonc2Fucy1zZXJpZiwgTm9ybWFsJztmb250LXZhcmlhbnQtbGlnYXR1cmVzOm5vcm1hbDtmb250LXZhcmlhbnQtY2Fwczpub3JtYWw7Zm9udC12YXJpYW50LW51bWVyaWM6bm9ybWFsO2ZvbnQtZmVhdHVyZS1zZXR0aW5nczpub3JtYWw7dGV4dC1hbGlnbjpjZW50ZXI7d3JpdGluZy1tb2RlOmxyLXRiO3RleHQtYW5jaG9yOm1pZGRsZTtzdHJva2Utd2lkdGg6MC4zOTY4NzUiPkVucXVldWU8L3RzcGFuPjwvdGV4dD4KICAgIDx0ZXh0CiAgICAgICB4bWw6c3BhY2U9InByZXNlcnZlIgogICAgICAgc3R5bGU9ImZvbnQtc3R5bGU6bm9ybWFsO2ZvbnQtdmFyaWFudDpub3JtYWw7Zm9udC13ZWlnaHQ6bm9ybWFsO2ZvbnQtc3RyZXRjaDpub3JtYWw7Zm9udC1zaXplOjQuMjMzMzNweDtsaW5lLWhlaWdodDoxLjI1O2ZvbnQtZmFtaWx5OnNhbnMtc2VyaWY7LWlua3NjYXBlLWZvbnQtc3BlY2lmaWNhdGlvbjonc2Fucy1zZXJpZiwgTm9ybWFsJztmb250LXZhcmlhbnQtbGlnYXR1cmVzOm5vcm1hbDtmb250LXZhcmlhbnQtY2Fwczpub3JtYWw7Zm9udC12YXJpYW50LW51bWVyaWM6bm9ybWFsO2ZvbnQtZmVhdHVyZS1zZXR0aW5nczpub3JtYWw7dGV4dC1hbGlnbjpjZW50ZXI7bGV0dGVyLXNwYWNpbmc6MHB4O3dvcmQtc3BhY2luZzowcHg7d3JpdGluZy1tb2RlOmxyLXRiO3RleHQtYW5jaG9yOm1pZGRsZTtmaWxsOiMwMDAwMDA7ZmlsbC1vcGFjaXR5OjE7c3Ryb2tlOm5vbmU7c3Ryb2tlLXdpZHRoOjAuMzk2ODc1IgogICAgICAgeD0iMTM2LjgzOTE5IgogICAgICAgeT0iNTYuNzczNDg3IgogICAgICAgaWQ9InRleHQ5MDUtNS00LTMtMSI+PHRzcGFuCiAgICAgICAgIHNvZGlwb2RpOnJvbGU9ImxpbmUiCiAgICAgICAgIGlkPSJ0c3BhbjkwMy00LTEtMS05IgogICAgICAgICB4PSIxMzcuNTgzMzMiCiAgICAgICAgIHk9IjU2Ljc3MzQ4NyIKICAgICAgICAgc3R5bGU9ImZvbnQtc3R5bGU6bm9ybWFsO2ZvbnQtdmFyaWFudDpub3JtYWw7Zm9udC13ZWlnaHQ6bm9ybWFsO2ZvbnQtc3RyZXRjaDpub3JtYWw7Zm9udC1zaXplOjQuMjMzMzNweDtmb250LWZhbWlseTpzYW5zLXNlcmlmOy1pbmtzY2FwZS1mb250LXNwZWNpZmljYXRpb246J3NhbnMtc2VyaWYsIE5vcm1hbCc7Zm9udC12YXJpYW50LWxpZ2F0dXJlczpub3JtYWw7Zm9udC12YXJpYW50LWNhcHM6bm9ybWFsO2ZvbnQtdmFyaWFudC1udW1lcmljOm5vcm1hbDtmb250LWZlYXR1cmUtc2V0dGluZ3M6bm9ybWFsO3RleHQtYWxpZ246Y2VudGVyO3dyaXRpbmctbW9kZTpsci10Yjt0ZXh0LWFuY2hvcjptaWRkbGU7c3Ryb2tlLXdpZHRoOjAuMzk2ODc1Ij5Db21wbGV0aW9uIDwvdHNwYW4+PC90ZXh0PgogICAgPHBhdGgKICAgICAgIHN0eWxlPSJmaWxsOm5vbmU7c3Ryb2tlOiMwMDAwMDA7c3Ryb2tlLXdpZHRoOjAuMzk0NjY0O3N0cm9rZS1saW5lY2FwOmJ1dHQ7c3Ryb2tlLWxpbmVqb2luOm1pdGVyO3N0cm9rZS1taXRlcmxpbWl0OjQ7c3Ryb2tlLWRhc2hhcnJheToxLjU3ODY2LCAxLjU3ODY2O3N0cm9rZS1kYXNob2Zmc2V0OjA7c3Ryb2tlLW9wYWNpdHk6MTttYXJrZXItZW5kOnVybCgjbWFya2VyNTU3MSkiCiAgICAgICBkPSJNIDE1Ni4xMDQxNywzOS45NTM1MDIgSCA2MS45MTI0OTgiCiAgICAgICBpZD0icGF0aDU1NTciCiAgICAgICBpbmtzY2FwZTpjb25uZWN0b3ItY3VydmF0dXJlPSIwIiAvPgogICAgPHRleHQKICAgICAgIHhtbDpzcGFjZT0icHJlc2VydmUiCiAgICAgICBzdHlsZT0iZm9udC1zdHlsZTpub3JtYWw7Zm9udC12YXJpYW50Om5vcm1hbDtmb250LXdlaWdodDpub3JtYWw7Zm9udC1zdHJldGNoOm5vcm1hbDtmb250LXNpemU6NC4yMzMzM3B4O2xpbmUtaGVpZ2h0OjEuMjU7Zm9udC1mYW1pbHk6c2Fucy1zZXJpZjstaW5rc2NhcGUtZm9udC1zcGVjaWZpY2F0aW9uOidzYW5zLXNlcmlmLCBOb3JtYWwnO2ZvbnQtdmFyaWFudC1saWdhdHVyZXM6bm9ybWFsO2ZvbnQtdmFyaWFudC1jYXBzOm5vcm1hbDtmb250LXZhcmlhbnQtbnVtZXJpYzpub3JtYWw7Zm9udC1mZWF0dXJlLXNldHRpbmdzOm5vcm1hbDt0ZXh0LWFsaWduOmNlbnRlcjtsZXR0ZXItc3BhY2luZzowcHg7d29yZC1zcGFjaW5nOjBweDt3cml0aW5nLW1vZGU6bHItdGI7dGV4dC1hbmNob3I6bWlkZGxlO2ZpbGw6IzAwMDAwMDtmaWxsLW9wYWNpdHk6MTtzdHJva2U6bm9uZTtzdHJva2Utd2lkdGg6MC4zOTY4NzUiCiAgICAgICB4PSI3NC43NDQ3OTciCiAgICAgICB5PSI1MC4xMzk5NjUiCiAgICAgICBpZD0idGV4dDkwNS02LTMtNCI+PHRzcGFuCiAgICAgICAgIHNvZGlwb2RpOnJvbGU9ImxpbmUiCiAgICAgICAgIHg9Ijc0Ljc0NDc5NyIKICAgICAgICAgeT0iNTAuMTM5OTY1IgogICAgICAgICBzdHlsZT0iZm9udC1zdHlsZTpub3JtYWw7Zm9udC12YXJpYW50Om5vcm1hbDtmb250LXdlaWdodDpub3JtYWw7Zm9udC1zdHJldGNoOm5vcm1hbDtmb250LXNpemU6NC4yMzMzM3B4O2ZvbnQtZmFtaWx5OnNhbnMtc2VyaWY7LWlua3NjYXBlLWZvbnQtc3BlY2lmaWNhdGlvbjonc2Fucy1zZXJpZiwgTm9ybWFsJztmb250LXZhcmlhbnQtbGlnYXR1cmVzOm5vcm1hbDtmb250LXZhcmlhbnQtY2Fwczpub3JtYWw7Zm9udC12YXJpYW50LW51bWVyaWM6bm9ybWFsO2ZvbnQtZmVhdHVyZS1zZXR0aW5nczpub3JtYWw7dGV4dC1hbGlnbjpjZW50ZXI7d3JpdGluZy1tb2RlOmxyLXRiO3RleHQtYW5jaG9yOm1pZGRsZTtzdHJva2Utd2lkdGg6MC4zOTY4NzUiCiAgICAgICAgIGlkPSJ0c3BhbjM3MDktMi0yIj5JbnZhbGlkYXRlPC90c3Bhbj48L3RleHQ+CiAgICA8dGV4dAogICAgICAgeG1sOnNwYWNlPSJwcmVzZXJ2ZSIKICAgICAgIHRyYW5zZm9ybT0ibWF0cml4KDAuMjY0NTgzMzMsMCwwLDAuMjY0NTgzMzMsLTMuODM4MzQzOCwtOC4zMTU5NjM3KSIKICAgICAgIGlkPSJ0ZXh0MTc3NjciCiAgICAgICBzdHlsZT0iZmlsbDpibGFjaztmaWxsLW9wYWNpdHk6MTtsaW5lLWhlaWdodDoxLjI1O3N0cm9rZTpub25lO2ZvbnQtZmFtaWx5OnNhbnMtc2VyaWY7Zm9udC1zdHlsZTpub3JtYWw7Zm9udC13ZWlnaHQ6bm9ybWFsO2ZvbnQtc2l6ZTo0MHB4O3doaXRlLXNwYWNlOnByZTtzaGFwZS1pbnNpZGU6dXJsKCNyZWN0MTc3NjkpIiAvPgogIDwvZz4KPC9zdmc+Cg==" alt="commandbuffer lifecycle">
</div>
<div class="title">Figure 1. Lifecycle of a command-buffer.</div>
</div>
<div id="pending_count" class="paragraph">
<p>The Pending Count is the number of copies of the command
buffer in the <a href="#pending">Pending</a> state. By default a command-buffer&#8217;s Pending
Count must be 0 or 1. If the command-buffer was created with
<code>CL_COMMAND_<wbr>BUFFER_<wbr>SIMULTANEOUS_<wbr>USE_<wbr>KHR</code> then the command-buffer may have a
Pending Count greater than 1.</p>
</div>
</div>
<div class="sect3">
<h4 id="_add_new_section_section_5_x_2_creating_command_buffer_objects"><a class="anchor" href="#_add_new_section_section_5_x_2_creating_command_buffer_objects"></a>46.8.2. Add new section "Section 5.X.2 - Creating Command Buffer Objects"</h4>
<div class="paragraph">
<p>The function</p>
</div>
<div id="clCreateCommandBufferKHR" class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="opencl"><span class="kt">cl_command_buffer_khr</span> <span class="nf">clCreateCommandBufferKHR</span><span class="p">(</span>
    <span class="kt">cl_uint</span> <span class="n">num_queues</span><span class="p">,</span>
    <span class="k">const</span> <span class="kt">cl_command_queue</span><span class="o">*</span> <span class="n">queues</span><span class="p">,</span>
    <span class="k">const</span> <span class="kt">cl_command_buffer_properties_khr</span><span class="o">*</span> <span class="n">properties</span><span class="p">,</span>
    <span class="kt">cl_int</span><span class="o">*</span> <span class="n">errcode_ret</span><span class="p">);</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Is used to create a command-buffer that can record commands to the specified
queues.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Upon creation the command-buffer is defined as being in the
<a href="#recording">Recording</a> state, in order for the command-buffer to be enqueued
it must first be finalized using <strong>clFinalizeCommandBufferKHR</strong> after which no
further commands can be recorded. A command-buffer is submitted for execution
on command-queues with a call to <strong>clEnqueueCommandBufferKHR</strong>.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><em>num_queues</em> The number of command-queues listed in <em>queues</em>. This extension
only supports a single command-queue, so this <strong>must</strong> be one.</p>
</div>
<div class="paragraph">
<p><em>queues</em>  Is a pointer to a command-queue that the command-buffer commands will
be recorded to. <em>queues</em> must be a non-<code>NULL</code> value.</p>
</div>
<div class="paragraph">
<p><em>properties</em>  Specifies a list of properties for the command-buffer and their
corresponding values. Each property name is immediately followed by the
corresponding desired value. The list is terminated with 0.
The list of supported properties is described in the table below. If a
supported property and its value is not specified in properties, its
default value will be used. <em>properties</em> can be <code>NULL</code> in which case the
default values for supported command-buffer properties will be used.</p>
</div>
<table id="commandbuffer-properties" class="tableblock frame-all grid-all stretch">
<caption class="title">Table 69. <strong>clCreateCommandBufferKHR</strong> properties</caption>
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><strong>Recording Properties</strong></th>
<th class="tableblock halign-left valign-top"><strong>Property Value</strong></th>
<th class="tableblock halign-left valign-top"><strong>Description</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CL_COMMAND_<wbr>BUFFER_<wbr>FLAGS_<wbr>KHR</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>cl_command_<wbr>buffer_<wbr>flags_<wbr>khr</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">This is a bitfield and can be set to a combination of the following values:</p>
<p class="tableblock">  <code>CL_COMMAND_<wbr>BUFFER_<wbr>SIMULTANEOUS_<wbr>USE_<wbr>KHR</code> - Allow multiple instances of the
  command-buffer to be submitted to the device for execution. If set, devices
  must support <code>CL_COMMAND_<wbr>BUFFER_<wbr>CAPABILITY_<wbr>SIMULTANEOUS_<wbr>USE_<wbr>KHR</code>.</p>
<p class="tableblock">  The default value of this property is <code>0</code>.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><em>errcode_ret</em> Returns an appropriate error code. If <em>errcode_ret</em> is <code>NULL</code>, no
error code is returned.</p>
</div>
<div class="paragraph">
<p><strong>clCreateCommandBufferKHR</strong> returns a valid non-zero command-buffer and
<em>errcode_ret</em> is set to <code>CL_SUCCESS</code> if the command-buffer is created
successfully. Otherwise, it returns a <code>NULL</code> value with one of the following
error values returned in <em>errcode_ret</em>:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>CL_INVALID_<wbr>COMMAND_<wbr>QUEUE</code> if any command-queue in <em>queues</em> is not a valid
command-queue.</p>
</li>
<li>
<p><code>CL_INCOMPATIBLE_<wbr>COMMAND_<wbr>QUEUE_<wbr>KHR</code> if any command-queue in <em>queues</em> is an
out-of-order command-queue and the device associated with the command-queue
does not support the <code>CL_COMMAND_<wbr>BUFFER_<wbr>CAPABILITY_<wbr>OUT_<wbr>OF_<wbr>ORDER_<wbr>KHR</code>
capability.</p>
</li>
<li>
<p><code>CL_INCOMPATIBLE_<wbr>COMMAND_<wbr>QUEUE_<wbr>KHR</code> if the properties of any command-queue in
<em>queues</em> does not contain the minimum properties specified by
<code>CL_DEVICE_<wbr>COMMAND_<wbr>BUFFER_<wbr>REQUIRED_<wbr>QUEUE_<wbr>PROPERTIES_<wbr>KHR</code>.</p>
</li>
<li>
<p><code>CL_INVALID_<wbr>CONTEXT</code> if all the command-queues in <em>queues</em> do not have the
same OpenCL context.</p>
</li>
<li>
<p><code>CL_INVALID_<wbr>VALUE</code> if <em>num_queues</em> is not one.</p>
</li>
<li>
<p><code>CL_INVALID_<wbr>VALUE</code> if <em>queues</em> is <code>NULL</code>.</p>
</li>
<li>
<p><code>CL_INVALID_<wbr>VALUE</code> if values specified in <em>properties</em> are not valid, or if
the same property name is specified more than once.</p>
</li>
<li>
<p><code>CL_INVALID_<wbr>PROPERTY</code> if values specified in <em>properties</em> are valid but are
not supported by all the devices associated with command-queues in <em>queues</em>.</p>
</li>
<li>
<p><code>CL_OUT_<wbr>OF_<wbr>RESOURCES</code> if there is a failure to allocate resources
required by the OpenCL implementation on the device.</p>
</li>
<li>
<p><code>CL_OUT_<wbr>OF_<wbr>HOST_<wbr>MEMORY</code> if there is a failure to allocate resources
required by the OpenCL implementation on the host.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The function</p>
</div>
<div id="clRetainCommandBufferKHR" class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="opencl"><span class="kt">cl_int</span> <span class="nf">clRetainCommandBufferKHR</span><span class="p">(</span>
    <span class="kt">cl_command_buffer_khr</span> <span class="n">command_buffer</span><span class="p">);</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Increments the <em>command_buffer</em> reference count.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>A command-buffer object updates the reference count for objects such as
buffers, images, and kernels used as parameters for commands recorded to the
command-buffer.</p>
</div>
<div class="paragraph">
<p>For example, recording a ND-range kernel via <strong>clCommandNDRangeKernelKHR</strong> into a
command-buffer and then releasing the kernel object will still allow continued
safe use of the command-buffer. As the reference count of the kernel object
will have been incremented when the command was recorded, and then on
command-buffer release the kernel reference count will be decremented. If at
that point the kernel reference count reaches 0, the kernel object will be
freed.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><em>command_buffer</em> Specifies the command-buffer to retain.</p>
</div>
<div class="paragraph">
<p><strong>clRetainCommandBufferKHR</strong> returns <code>CL_SUCCESS</code> if the function is executed
successfully. Otherwise, it returns one of the following errors:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>CL_INVALID_<wbr>COMMAND_<wbr>BUFFER_<wbr>KHR</code> if <em>command_buffer</em> is not a valid
command-buffer.</p>
</li>
<li>
<p><code>CL_OUT_<wbr>OF_<wbr>RESOURCES</code> if there is a failure to allocate resources required by
the OpenCL implementation on the device.</p>
</li>
<li>
<p><code>CL_OUT_<wbr>OF_<wbr>HOST_<wbr>MEMORY</code> if there is a failure to allocate resources required by
the OpenCL implementation on the host.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The function</p>
</div>
<div id="clReleaseCommandBufferKHR" class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="opencl"><span class="kt">cl_int</span> <span class="nf">clReleaseCommandBufferKHR</span><span class="p">(</span>
    <span class="kt">cl_command_buffer_khr</span> <span class="n">command_buffer</span><span class="p">);</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Decrements the <em>command_buffer</em> reference count.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>After the <em>command_buffer</em> reference count becomes zero and has finished
execution, the command-buffer is deleted.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><em>command_buffer</em> Specifies the command-buffer to release.</p>
</div>
<div class="paragraph">
<p><strong>clReleaseCommandBufferKHR</strong> returns <code>CL_SUCCESS</code> if the function is executed
successfully. Otherwise, it returns one of the following errors:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>CL_INVALID_<wbr>COMMAND_<wbr>BUFFER_<wbr>KHR</code> if <em>command_buffer</em> is not a valid
command-buffer.</p>
</li>
<li>
<p><code>CL_OUT_<wbr>OF_<wbr>RESOURCES</code> if there is a failure to allocate resources
required by the OpenCL implementation on the device.</p>
</li>
<li>
<p><code>CL_OUT_<wbr>OF_<wbr>HOST_<wbr>MEMORY</code> if there is a failure to allocate resources
required by the OpenCL implementation on the host.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_add_new_section_section_5_x_2_enqueuing_a_command_buffer"><a class="anchor" href="#_add_new_section_section_5_x_2_enqueuing_a_command_buffer"></a>46.8.3. Add new section "Section 5.X.2 - Enqueuing a Command Buffer"</h4>
<div class="paragraph">
<p>The function</p>
</div>
<div id="clFinalizeCommandBufferKHR" class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="opencl"><span class="kt">cl_int</span> <span class="nf">clFinalizeCommandBufferKHR</span><span class="p">(</span>
    <span class="kt">cl_command_buffer_khr</span> <span class="n">command_buffer</span><span class="p">);</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Finalizes command recording ready for enqueuing the command-buffer on a
command-queue.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p><strong>clFinalizeCommandBufferKHR</strong> places the command-buffer in the
<a href="#executable">Executable</a> state where commands can no longer be recorded, at
this point the command-buffer is ready to be enqueued.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><em>command_buffer</em> Refers to a valid command-buffer object.</p>
</div>
<div class="paragraph">
<p><strong>clFinalizeCommandBufferKHR</strong> returns <code>CL_SUCCESS</code> if the function is executed
successfully. Otherwise, it returns one of the following errors:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>CL_INVALID_<wbr>COMMAND_<wbr>BUFFER_<wbr>KHR</code> if <em>command_buffer</em> is not a valid
command-buffer.</p>
</li>
<li>
<p><code>CL_INVALID_<wbr>OPERATION</code> if <em>command_buffer</em> is not in the
<a href="#recording">Recording</a> state.</p>
</li>
<li>
<p><code>CL_OUT_<wbr>OF_<wbr>RESOURCES</code> if there is a failure to allocate resources required by
the OpenCL implementation on the device.</p>
</li>
<li>
<p><code>CL_OUT_<wbr>OF_<wbr>HOST_<wbr>MEMORY</code> if there is a failure to allocate resources required
by the OpenCL implementation on the host.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The function</p>
</div>
<div id="clEnqueueCommandBufferKHR" class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="opencl"><span class="kt">cl_int</span> <span class="nf">clEnqueueCommandBufferKHR</span><span class="p">(</span>
    <span class="kt">cl_uint</span> <span class="n">num_queues</span><span class="p">,</span>
    <span class="kt">cl_command_queue</span><span class="o">*</span> <span class="n">queues</span><span class="p">,</span>
    <span class="kt">cl_command_buffer_khr</span> <span class="n">command_buffer</span><span class="p">,</span>
    <span class="kt">cl_uint</span> <span class="n">num_events_in_wait_list</span><span class="p">,</span>
    <span class="k">const</span> <span class="kt">cl_event</span><span class="o">*</span> <span class="n">event_wait_list</span><span class="p">,</span>
    <span class="kt">cl_event</span><span class="o">*</span> <span class="n">event</span><span class="p">);</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Enqueues a command-buffer to execute on command-queues specified by <em>queues</em>,
or on default command-queues used during recording if <em>queues</em> is empty.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>To enqueue a command-buffer it must be in a <a href="#executable">Executable</a> state,
see <strong>clFinalizeCommandBufferKHR</strong>.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><em>num_queues</em> The number of command-queues listed in <em>queues</em>.</p>
</div>
<div class="paragraph">
<p><em>queues</em>  A pointer to an ordered list of command-queues
<a href="#compatible">compatible</a> with the command-queues used on recording. <em>queues</em>
can be <code>NULL</code> in which case the default command-queues used on command-buffer
creation are used and <em>num_queues</em> must be 0.</p>
</div>
<div class="paragraph">
<p><em>command_buffer</em> Refers to a valid command-buffer object.</p>
</div>
<div class="paragraph">
<p><em>event_wait_list</em>, <em>num_events_in_wait_list</em> Specify events that need to
complete before this particular command can be executed. If
<em>event_wait_list</em> is <code>NULL</code>, then this particular command does not wait
on any event to complete. If <em>event_wait_list</em> is <code>NULL</code>,
<em>num_events_in_wait_list</em> must be 0. If event_wait_list is not <code>NULL</code>,
the list of events pointed to by <em>event_wait_list</em> must be valid and
<em>num_events_in_wait_list</em> must be greater than 0. The events specified
in <em>event_wait_list</em> act as synchronization points. The context associated
with events in <em>event_wait_list</em> and command_queue must be the same. The memory
associated with <em>event_wait_list</em> can be reused or freed after the function
returns.</p>
</div>
<div class="paragraph">
<p><em>event</em> Returns an event object that identifies this command and
can be used to query for profiling information or queue a wait for this
particular command to complete. <em>event</em> can be <code>NULL</code> in which case it will not
be possible for the application to wait on this command or query it for
profiling information.</p>
</div>
<div class="paragraph">
<p><strong>clEnqueueCommandBufferKHR</strong> returns <code>CL_SUCCESS</code> if the command-buffer
execution was successfully queued, or one of the errors below:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>CL_INVALID_<wbr>COMMAND_<wbr>BUFFER_<wbr>KHR</code> if <em>command_buffer</em> is not a valid
command-buffer.</p>
</li>
<li>
<p><code>CL_INVALID_<wbr>OPERATION</code> if <em>command_buffer</em> has not been finalized.</p>
</li>
<li>
<p><code>CL_INVALID_<wbr>OPERATION</code> if <em>command_buffer</em> was not created with the
<code>CL_COMMAND_<wbr>BUFFER_<wbr>SIMULTANEOUS_<wbr>USE_<wbr>KHR</code> flag and is in the <a href="#pending">Pending</a> state.</p>
</li>
<li>
<p><code>CL_INVALID_<wbr>VALUE</code> if <em>queues</em> is <code>NULL</code> and <em>num_queues</em> is &gt; 0, or <em>queues</em>
is not <code>NULL</code> and <em>num_queues</em> is 0.</p>
</li>
<li>
<p><code>CL_INVALID_<wbr>VALUE</code> if <em>num_queues</em> is &gt; 0 and not the same value as
<em>num_queues</em> set on <em>command_buffer</em> creation.</p>
</li>
<li>
<p><code>CL_INVALID_<wbr>COMMAND_<wbr>QUEUE</code> if any element of <em>queues</em> is not a valid
command-queue.</p>
</li>
<li>
<p><code>CL_INCOMPATIBLE_<wbr>COMMAND_<wbr>QUEUE_<wbr>KHR</code> if any element of <em>queues</em> is not
<a href="#compatible">compatible</a>  with the command-queue set on <em>command_buffer</em>
creation at the same list index.</p>
</li>
<li>
<p><code>CL_INVALID_<wbr>CONTEXT</code> if any element of <em>queues</em> does not have the same
context as the command-queue set on <em>command_buffer</em> creation at the same list
index.</p>
</li>
<li>
<p><code>CL_INVALID_<wbr>CONTEXT</code> if context associated with <em>command_buffer</em> and
events in <em>event_wait_list</em> are not the same.</p>
</li>
<li>
<p><code>CL_OUT_<wbr>OF_<wbr>RESOURCES</code> if there is a failure to queue the execution instance of
<em>command_buffer</em> on the command-queues because of insufficient resources
needed to execute <em>command_buffer</em>.</p>
</li>
<li>
<p><code>CL_INVALID_<wbr>EVENT_<wbr>WAIT_<wbr>LIST</code> if <em>event_wait_list</em> is <code>NULL</code> and
<em>num_events_in_wait_list</em> &gt; 0, or <em>event_wait_list</em> is not <code>NULL</code>
and <em>num_events_in_wait_list</em> is 0, or if event objects in
<em>event_wait_list</em> are not valid events.</p>
</li>
<li>
<p><code>CL_OUT_<wbr>OF_<wbr>RESOURCES</code> if there is a failure to allocate resources required by
the OpenCL implementation on the device.</p>
</li>
<li>
<p><code>CL_OUT_<wbr>OF_<wbr>HOST_<wbr>MEMORY</code> if there is a failure to allocate resources required
by the OpenCL implementation on the host.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_add_new_section_section_5_x_3_recording_commands_to_a_command_buffer"><a class="anchor" href="#_add_new_section_section_5_x_3_recording_commands_to_a_command_buffer"></a>46.8.4. Add new section "Section 5.X.3 - Recording Commands to a Command Buffer"</h4>
<div class="paragraph">
<p>The function</p>
</div>
<div id="clCommandBarrierWithWaitListKHR" class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="opencl"><span class="kt">cl_int</span> <span class="nf">clCommandBarrierWithWaitListKHR</span><span class="p">(</span>
    <span class="kt">cl_command_buffer_khr</span> <span class="n">command_buffer</span><span class="p">,</span>
    <span class="kt">cl_command_queue</span> <span class="n">command_queue</span><span class="p">,</span>
    <span class="kt">cl_uint</span> <span class="n">num_sync_points_in_wait_list</span><span class="p">,</span>
    <span class="k">const</span> <span class="kt">cl_sync_point_khr</span><span class="o">*</span> <span class="n">sync_point_wait_list</span><span class="p">,</span>
    <span class="kt">cl_sync_point_khr</span><span class="o">*</span> <span class="n">sync_point</span><span class="p">,</span>
    <span class="kt">cl_mutable_command_khr</span><span class="o">*</span> <span class="n">mutable_handle</span><span class="p">);</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Records a barrier operation used as a synchronization point.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p><strong>clCommandBarrierWithWaitListKHR</strong> Waits for either a list of
synchronization-points to complete, or if the list is empty it waits for all
commands previously recorded in <em>command_buffer</em> to complete before it
completes. This command blocks command execution, that is, any following
commands recorded after it do not execute until it completes.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><em>command_buffer</em> Refers to a valid command-buffer object.</p>
</div>
<div class="paragraph">
<p><em>command_queue</em> Specifies the command-queue the command will be recorded to.
Parameter is unused by this extension as only a single command-queue is
supported and <strong>must</strong> be <code>NULL</code>.</p>
</div>
<div class="paragraph">
<p><em>sync_point_wait_list</em>, <em>num_sync_points_in_wait_list</em> Specify
synchronization-points that need to complete before this
particular command can be executed.</p>
</div>
<div class="paragraph">
<p>If <em>sync_point_wait_list</em> is <code>NULL</code>, <em>num_sync_points_in_wait_list</em>
must be 0. If <em>sync_point_wait_list</em> is not <code>NULL</code>, the list of
synchronization-points pointed to by <em>sync_point_wait_list</em> must be
valid and <em>num_sync_points_in_wait_list</em> must be greater than 0.
The synchronization-points specified in <em>sync_point_wait_list</em> are
<strong>device side</strong> synchronization-points. The command-buffer associated
with synchronization-points in <em>sync_point_wait_list</em> must be the same
as <em>command_buffer</em>. The memory associated with <em>sync_point_wait_list</em>
can be reused or freed after the function returns.</p>
</div>
<div class="paragraph">
<p>If <em>sync_point_wait_list</em> is <code>NULL</code>, then this particular command
waits until all previous recorded commands to <em>command_queue</em> have
completed.</p>
</div>
<div class="paragraph">
<p><em>sync_point</em> Returns a synchronization-point ID that identifies this particular
command. Synchronization-point objects are unique and can be used to
identify this barrier command later on. <em>sync_point</em> can be <code>NULL</code> in
which case it will not be possible for the application to record a wait
for this command to complete. If the <em>sync_point_wait_list</em> and the
<em>sync_point</em> arguments are not <code>NULL</code>, the <em>sync_point</em> argument
should not refer to an element of the <em>sync_point_wait_list</em> array.</p>
</div>
<div class="paragraph">
<p><em>mutable_handle</em> Returns a handle to the command. Handle is unused by
this extension and must be passed as <code>NULL</code>.</p>
</div>
<div class="paragraph">
<p><strong>clCommandBarrierWithWaitListKHR</strong> returns <code>CL_SUCCESS</code> if the function is
executed successfully. Otherwise, it returns one of the following errors:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>CL_INVALID_<wbr>COMMAND_<wbr>QUEUE</code> if <em>command_queue</em> is not <code>NULL</code>.</p>
</li>
<li>
<p><code>CL_INVALID_<wbr>COMMAND_<wbr>BUFFER_<wbr>KHR</code> if <em>command_buffer</em> is not a valid
command-buffer.</p>
</li>
<li>
<p><code>CL_INVALID_<wbr>CONTEXT</code> if the context associated with <em>command_queue</em> and
<em>command_buffer</em> is not the same.</p>
</li>
<li>
<p><code>CL_INVALID_<wbr>OPERATION</code> if <em>command_buffer</em> has been finalized.</p>
</li>
<li>
<p><code>CL_INVALID_<wbr>VALUE</code> if <em>mutable_handle</em> is not <code>NULL</code>.</p>
</li>
<li>
<p><code>CL_INVALID_<wbr>SYNC_<wbr>POINT_<wbr>WAIT_<wbr>LIST_<wbr>KHR</code> if <em>sync_point_wait_list</em> is <code>NULL</code> and
<em>num_sync_points_in_wait_list</em> is &gt; 0, or <em>sync_point_wait_list</em> is not
<code>NULL</code> and <em>num_sync_points_in_wait_list</em> is 0, or if
synchronization-point objects in <em>sync_point_wait_list</em> are not valid
synchronization-points.</p>
</li>
<li>
<p><code>CL_OUT_<wbr>OF_<wbr>RESOURCES</code> if there is a failure to allocate resources required by
the OpenCL implementation on the device.</p>
</li>
<li>
<p><code>CL_OUT_<wbr>OF_<wbr>HOST_<wbr>MEMORY</code> if there is a failure to allocate resources required by
the OpenCL implementation on the host.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The function</p>
</div>
<div id="clCommandCopyBufferKHR" class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="opencl"><span class="kt">cl_int</span> <span class="nf">clCommandCopyBufferKHR</span><span class="p">(</span>
    <span class="kt">cl_command_buffer_khr</span> <span class="n">command_buffer</span><span class="p">,</span>
    <span class="kt">cl_command_queue</span> <span class="n">command_queue</span><span class="p">,</span>
    <span class="kt">cl_mem</span> <span class="n">src_buffer</span><span class="p">,</span>
    <span class="kt">cl_mem</span> <span class="n">dst_buffer</span><span class="p">,</span>
    <span class="kt">size_t</span> <span class="n">src_offset</span><span class="p">,</span>
    <span class="kt">size_t</span> <span class="n">dst_offset</span><span class="p">,</span>
    <span class="kt">size_t</span> <span class="n">size</span><span class="p">,</span>
    <span class="kt">cl_uint</span> <span class="n">num_sync_points_in_wait_list</span><span class="p">,</span>
    <span class="k">const</span> <span class="kt">cl_sync_point_khr</span><span class="o">*</span> <span class="n">sync_point_wait_list</span><span class="p">,</span>
    <span class="kt">cl_sync_point_khr</span><span class="o">*</span> <span class="n">sync_point</span><span class="p">,</span>
    <span class="kt">cl_mutable_command_khr</span><span class="o">*</span> <span class="n">mutable_handle</span><span class="p">);</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Records a command to copy from one buffer object to another.</p>
</div>
<div class="paragraph">
<p><em>command_buffer</em> Refers to a valid command-buffer object.</p>
</div>
<div class="paragraph">
<p><em>command_queue</em> Specifies the command-queue the command will be recorded to.
Parameter is unused by this extension as only a single command-queue is
supported and <strong>must</strong> be <code>NULL</code>.</p>
</div>
<div class="paragraph">
<p><em>src_buffer</em>, <em>dst_buffer</em>, <em>src_offset</em>, <em>dst_offset</em>, <em>size</em> Refer to
<strong>clEnqueueCopyBuffer</strong>.</p>
</div>
<div class="paragraph">
<p><em>sync_point_wait_list</em>, <em>num_sync_points_in_wait_list</em> Specify
synchronization-points that need to complete before this
particular command can be executed.</p>
</div>
<div class="paragraph">
<p>If <em>sync_point_wait_list</em> is <code>NULL</code>, <em>num_sync_points_in_wait_list</em>
must be 0. If <em>sync_point_wait_list</em> is not <code>NULL</code>, the list of
synchronization-points pointed to by <em>sync_point_wait_list</em> must be
valid and <em>num_sync_points_in_wait_list</em> must be greater than 0.
The synchronization-points specified in <em>sync_point_wait_list</em> are
<strong>device side</strong> synchronization-points. The command-buffer associated
with synchronization-points in <em>sync_point_wait_list</em> must be the same
as <em>command_buffer</em>. The memory associated with <em>sync_point_wait_list</em>
can be reused or freed after the function returns.</p>
</div>
<div class="paragraph">
<p><em>sync_point</em> Returns a synchronization-point ID that identifies this particular
command. Synchronization-point objects are unique and can be used to
identify this command later on. <em>sync_point</em> can be <code>NULL</code> in which case it
will not be possible for the application to record a wait for this command to
complete. If the <em>sync_point_wait_list</em> and the <em>sync_point</em> arguments are not
<code>NULL</code>, the <em>sync_point</em> argument should not refer to an element of the
<em>sync_point_wait_list</em> array.</p>
</div>
<div class="paragraph">
<p><em>mutable_handle</em> Returns a handle to the command. Handle is unused by
this extension and must be passed as <code>NULL</code>.</p>
</div>
<div class="paragraph">
<p><strong>clCommandCopyBufferKHR</strong> returns <code>CL_SUCCESS</code> if the function is executed
successfully. Otherwise, it returns the errors defined by
<strong>clEnqueueCopyBuffer</strong> except:</p>
</div>
<div class="paragraph">
<p><code>CL_INVALID_<wbr>COMMAND_<wbr>QUEUE</code> is replaced with:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>CL_INVALID_<wbr>COMMAND_<wbr>QUEUE</code> if <em>command_queue</em> is not <code>NULL</code>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><code>CL_INVALID_<wbr>CONTEXT</code> is replaced with:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>CL_INVALID_<wbr>CONTEXT</code> if the context associated with <em>command_queue</em>,
<em>command_buffer</em>, <em>src_buffer</em>, and <em>dst_buffer</em> are not the same.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><code>CL_INVALID_<wbr>EVENT_<wbr>WAIT_<wbr>LIST</code> is replaced with:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>CL_INVALID_<wbr>SYNC_<wbr>POINT_<wbr>WAIT_<wbr>LIST_<wbr>KHR</code> if <em>sync_point_wait_list</em> is <code>NULL</code> and
<em>num_sync_points_in_wait_list</em> is &gt; 0, or <em>sync_point_wait_list</em> is not
<code>NULL</code> and <em>num_sync_points_in_wait_list</em> is 0, or if
synchronization-point objects in <em>sync_point_wait_list</em> are not valid
synchronization-points.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>New errors:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>CL_INVALID_<wbr>COMMAND_<wbr>BUFFER_<wbr>KHR</code> if <em>command_buffer</em> is not a valid
command-buffer.</p>
</li>
<li>
<p><code>CL_INVALID_<wbr>OPERATION</code> if <em>command_buffer</em> has been finalized.</p>
</li>
<li>
<p><code>CL_INVALID_<wbr>VALUE</code> if <em>mutable_handle</em> is not <code>NULL</code>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The function</p>
</div>
<div id="clCommandCopyBufferRectKHR" class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="opencl"><span class="kt">cl_int</span> <span class="nf">clCommandCopyBufferRectKHR</span><span class="p">(</span>
    <span class="kt">cl_command_buffer_khr</span> <span class="n">command_buffer</span><span class="p">,</span>
    <span class="kt">cl_command_queue</span> <span class="n">command_queue</span><span class="p">,</span>
    <span class="kt">cl_mem</span> <span class="n">src_buffer</span><span class="p">,</span>
    <span class="kt">cl_mem</span> <span class="n">dst_buffer</span><span class="p">,</span>
    <span class="k">const</span> <span class="kt">size_t</span><span class="o">*</span> <span class="n">src_origin</span><span class="p">,</span>
    <span class="k">const</span> <span class="kt">size_t</span><span class="o">*</span> <span class="n">dst_origin</span><span class="p">,</span>
    <span class="k">const</span> <span class="kt">size_t</span><span class="o">*</span> <span class="n">region</span><span class="p">,</span>
    <span class="kt">size_t</span> <span class="n">src_row_pitch</span><span class="p">,</span>
    <span class="kt">size_t</span> <span class="n">src_slice_pitch</span><span class="p">,</span>
    <span class="kt">size_t</span> <span class="n">dst_row_pitch</span><span class="p">,</span>
    <span class="kt">size_t</span> <span class="n">dst_slice_pitch</span><span class="p">,</span>
    <span class="kt">cl_uint</span> <span class="n">num_sync_points_in_wait_list</span><span class="p">,</span>
    <span class="k">const</span> <span class="kt">cl_sync_point_khr</span><span class="o">*</span> <span class="n">sync_point_wait_list</span><span class="p">,</span>
    <span class="kt">cl_sync_point_khr</span><span class="o">*</span> <span class="n">sync_point</span><span class="p">,</span>
    <span class="kt">cl_mutable_command_khr</span><span class="o">*</span> <span class="n">mutable_handle</span><span class="p">);</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Records a command to copy a rectangular region from a buffer object to another
buffer object.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p><strong>clCommandCopyBufferRectKHR</strong> records a command to copy a 2D or 3D rectangular
region from the buffer object identified by <em>src_buffer</em> to a 2D or 3D region
in the buffer object identified by <em>dst_buffer</em>. Copying begins at the source
offset and destination offset which are computed as described in the
description for <em>src_origin</em> and <em>dst_origin</em>.</p>
</div>
<div class="paragraph">
<p>Each byte of the region&#8217;s width is copied from the source offset to the
destination offset. After copying each width, the source and destination
offsets are incremented by their respective source and destination row
pitches. After copying each 2D rectangle, the source and destination offsets
are incremented by their respective source and destination slice pitches.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><em>command_buffer</em> Refers to a valid command-buffer object.</p>
</div>
<div class="paragraph">
<p><em>command_queue</em> Specifies the command-queue the command will be recorded to.
Parameter is unused by this extension as only a single command-queue is
supported and <strong>must</strong> be <code>NULL</code>.</p>
</div>
<div class="paragraph">
<p><em>src_origin</em>, <em>dst_origin</em>, <em>region</em>, <em>src_row_pitch</em>, <em>src_slice_pitch</em>,
<em>dst_row_pitch</em>, <em>dst_slice_pitch</em> Refer to <strong>clEnqueueCopyBufferRect</strong>.</p>
</div>
<div class="paragraph">
<p><em>sync_point_wait_list</em>, <em>num_sync_points_in_wait_list</em> Specify
synchronization-points that need to complete before this
particular command can be executed.</p>
</div>
<div class="paragraph">
<p>If <em>sync_point_wait_list</em> is <code>NULL</code>, <em>num_sync_points_in_wait_list</em>
must be 0. If <em>sync_point_wait_list</em> is not <code>NULL</code>, the list of
synchronization-points pointed to by <em>sync_point_wait_list</em> must be
valid and <em>num_sync_points_in_wait_list</em> must be greater than 0.
The synchronization-points specified in <em>sync_point_wait_list</em> are
<strong>device side</strong> synchronization-points. The command-buffer associated
with synchronization-points in <em>sync_point_wait_list</em> must be the same
as <em>command_buffer</em>. The memory associated with <em>sync_point_wait_list</em>
can be reused or freed after the function returns.</p>
</div>
<div class="paragraph">
<p><em>sync_point</em> Returns a synchronization-point ID that identifies this particular
command. Synchronization-point objects are unique and can be used to
identify this command later on. <em>sync_point</em> can be <code>NULL</code> in which case it
will not be possible for the application to record a wait for this command to
complete. If the <em>sync_point_wait_list</em> and the <em>sync_point</em> arguments are not
<code>NULL</code>, the <em>sync_point</em> argument should not refer to an element of the
<em>sync_point_wait_list</em> array.</p>
</div>
<div class="paragraph">
<p><em>mutable_handle</em> Returns a handle to the command. Handle is unused by
this extension and must be passed as <code>NULL</code>.</p>
</div>
<div class="paragraph">
<p><strong>clCommandCopyBufferRectKHR</strong> returns <code>CL_SUCCESS</code> if the function is executed
successfully. Otherwise, it returns the errors defined by
<strong>clEnqueueCopyBufferRect</strong> except:</p>
</div>
<div class="paragraph">
<p><code>CL_INVALID_<wbr>COMMAND_<wbr>QUEUE</code> is replaced with:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>CL_INVALID_<wbr>COMMAND_<wbr>QUEUE</code> if <em>command_queue</em> is not <code>NULL</code>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><code>CL_INVALID_<wbr>CONTEXT</code> is replaced with:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>CL_INVALID_<wbr>CONTEXT</code> if the context associated with <em>command_queue</em>,
<em>command_buffer</em>, <em>src_buffer</em>, and <em>dst_buffer</em> are not the same.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><code>CL_INVALID_<wbr>EVENT_<wbr>WAIT_<wbr>LIST</code> is replaced with:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>CL_INVALID_<wbr>SYNC_<wbr>POINT_<wbr>WAIT_<wbr>LIST_<wbr>KHR</code> if <em>sync_point_wait_list</em> is <code>NULL</code> and
<em>num_sync_points_in_wait_list</em> is &gt; 0, or <em>sync_point_wait_list</em> is not
<code>NULL</code> and <em>num_sync_points_in_wait_list</em> is 0, or if
synchronization-point objects in <em>sync_point_wait_list</em> are not valid
synchronization-points.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>New errors:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>CL_INVALID_<wbr>COMMAND_<wbr>BUFFER_<wbr>KHR</code> if <em>command_buffer</em> is not a valid
command-buffer.</p>
</li>
<li>
<p><code>CL_INVALID_<wbr>OPERATION</code> if <em>command_buffer</em> has been finalized.</p>
</li>
<li>
<p><code>CL_INVALID_<wbr>VALUE</code> if <em>mutable_handle</em> is not <code>NULL</code>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The function</p>
</div>
<div id="clCommandCopyBufferToImageKHR" class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="opencl"><span class="kt">cl_int</span> <span class="nf">clCommandCopyBufferToImageKHR</span><span class="p">(</span>
    <span class="kt">cl_command_buffer_khr</span> <span class="n">command_buffer</span><span class="p">,</span>
    <span class="kt">cl_command_queue</span> <span class="n">command_queue</span><span class="p">,</span>
    <span class="kt">cl_mem</span> <span class="n">src_buffer</span><span class="p">,</span>
    <span class="kt">cl_mem</span> <span class="n">dst_image</span><span class="p">,</span>
    <span class="kt">size_t</span> <span class="n">src_offset</span><span class="p">,</span>
    <span class="k">const</span> <span class="kt">size_t</span><span class="o">*</span> <span class="n">dst_origin</span><span class="p">,</span>
    <span class="k">const</span> <span class="kt">size_t</span><span class="o">*</span> <span class="n">region</span><span class="p">,</span>
    <span class="kt">cl_uint</span> <span class="n">num_sync_points_in_wait_list</span><span class="p">,</span>
    <span class="k">const</span> <span class="kt">cl_sync_point_khr</span><span class="o">*</span> <span class="n">sync_point_wait_list</span><span class="p">,</span>
    <span class="kt">cl_sync_point_khr</span><span class="o">*</span> <span class="n">sync_point</span><span class="p">,</span>
    <span class="kt">cl_mutable_command_khr</span><span class="o">*</span> <span class="n">mutable_handle</span><span class="p">);</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Records a command to copy a buffer object to an image object.</p>
</div>
<div class="paragraph">
<p><em>command_buffer</em> Refers to a valid command-buffer object.</p>
</div>
<div class="paragraph">
<p><em>command_queue</em> Specifies the command-queue the command will be recorded to.
Parameter is unused by this extension as only a single command-queue is
supported and <strong>must</strong> be <code>NULL</code>.</p>
</div>
<div class="paragraph">
<p><em>src_buffer</em>, <em>dst_image</em>, <em>src_offset</em>, <em>dst_origin</em>, <em>region</em> Refer to
<strong>clEnqueueCopyBufferToImage</strong></p>
</div>
<div class="paragraph">
<p><em>sync_point_wait_list</em>, <em>num_sync_points_in_wait_list</em> Specify
synchronization-points that need to complete before this
particular command can be executed.</p>
</div>
<div class="paragraph">
<p>If <em>sync_point_wait_list</em> is <code>NULL</code>, <em>num_sync_points_in_wait_list</em>
must be 0. If <em>sync_point_wait_list</em> is not <code>NULL</code>, the list of
synchronization-points pointed to by <em>sync_point_wait_list</em> must be
valid and <em>num_sync_points_in_wait_list</em> must be greater than 0.
The synchronization-points specified in <em>sync_point_wait_list</em> are
<strong>device side</strong> synchronization-points. The command-buffer associated
with synchronization-points in <em>sync_point_wait_list</em> must be the same
as <em>command_buffer</em>. The memory associated with <em>sync_point_wait_list</em>
can be reused or freed after the function returns.</p>
</div>
<div class="paragraph">
<p><em>sync_point</em> Returns a synchronization-point ID that identifies this particular
command. Synchronization-point objects are unique and can be used to
identify this command later on. <em>sync_point</em> can be <code>NULL</code> in which case it
will not be possible for the application to record a wait for this command to
complete. If the <em>sync_point_wait_list</em> and the <em>sync_point</em> arguments are not
<code>NULL</code>, the <em>sync_point</em> argument should not refer to an element of the
<em>sync_point_wait_list</em> array.</p>
</div>
<div class="paragraph">
<p><em>mutable_handle</em> Returns a handle to the command. Handle is unused by
this extension and must be passed as <code>NULL</code>.</p>
</div>
<div class="paragraph">
<p><strong>clCommandCopyBufferToImageKHR</strong> returns <code>CL_SUCCESS</code> if the function is executed
successfully. Otherwise, it returns the errors defined by
<strong>clEnqueueCopyBufferToImage</strong> except:</p>
</div>
<div class="paragraph">
<p><code>CL_INVALID_<wbr>COMMAND_<wbr>QUEUE</code> is replaced with:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>CL_INVALID_<wbr>COMMAND_<wbr>QUEUE</code> if <em>command_queue</em> is not <code>NULL</code>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><code>CL_INVALID_<wbr>CONTEXT</code> is replaced with:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>CL_INVALID_<wbr>CONTEXT</code> if the context associated with <em>command_queue</em>,
<em>command_buffer</em>, <em>src_buffer</em>, and <em>dst_image</em> are not the same.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><code>CL_INVALID_<wbr>EVENT_<wbr>WAIT_<wbr>LIST</code> is replaced with:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>CL_INVALID_<wbr>SYNC_<wbr>POINT_<wbr>WAIT_<wbr>LIST_<wbr>KHR</code> if <em>sync_point_wait_list</em> is <code>NULL</code> and
<em>num_sync_points_in_wait_list</em> is &gt; 0, or <em>sync_point_wait_list</em> is not
<code>NULL</code> and <em>num_sync_points_in_wait_list</em> is 0, or if
synchronization-point objects in <em>sync_point_wait_list</em> are not valid
synchronization-points.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>New errors:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>CL_INVALID_<wbr>COMMAND_<wbr>BUFFER_<wbr>KHR</code> if <em>command_buffer</em> is not a valid
command-buffer.</p>
</li>
<li>
<p><code>CL_INVALID_<wbr>OPERATION</code> if <em>command_buffer</em> has been finalized.</p>
</li>
<li>
<p><code>CL_INVALID_<wbr>VALUE</code> if <em>mutable_handle</em> is not <code>NULL</code>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The function</p>
</div>
<div id="clCommandCopyImageKHR" class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="opencl"><span class="kt">cl_int</span> <span class="nf">clCommandCopyImageKHR</span><span class="p">(</span>
    <span class="kt">cl_command_buffer_khr</span> <span class="n">command_buffer</span><span class="p">,</span>
    <span class="kt">cl_command_queue</span> <span class="n">command_queue</span><span class="p">,</span>
    <span class="kt">cl_mem</span> <span class="n">src_image</span><span class="p">,</span>
    <span class="kt">cl_mem</span> <span class="n">dst_image</span><span class="p">,</span>
    <span class="k">const</span> <span class="kt">size_t</span><span class="o">*</span> <span class="n">src_origin</span><span class="p">,</span>
    <span class="k">const</span> <span class="kt">size_t</span><span class="o">*</span> <span class="n">dst_origin</span><span class="p">,</span>
    <span class="k">const</span> <span class="kt">size_t</span><span class="o">*</span> <span class="n">region</span><span class="p">,</span>
    <span class="kt">cl_uint</span> <span class="n">num_sync_points_in_wait_list</span><span class="p">,</span>
    <span class="k">const</span> <span class="kt">cl_sync_point_khr</span><span class="o">*</span> <span class="n">sync_point_wait_list</span><span class="p">,</span>
    <span class="kt">cl_sync_point_khr</span><span class="o">*</span> <span class="n">sync_point</span><span class="p">,</span>
    <span class="kt">cl_mutable_command_khr</span><span class="o">*</span> <span class="n">mutable_handle</span><span class="p">);</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Records a command to copy image objects.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>It is currently a requirement that the <em>src_image</em> and <em>dst_image</em> image
memory objects for <strong>clCommandCopyImageKHR</strong> must have the exact same image
format, i.e. the <code>cl_image_<wbr>format</code> descriptor specified when <em>src_image</em> and
<em>dst_image</em> are created must match.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><em>command_buffer</em> Refers to a valid command-buffer object.</p>
</div>
<div class="paragraph">
<p><em>command_queue</em> Specifies the command-queue the command will be recorded to.
Parameter is unused by this extension as only a single command-queue is
supported and <strong>must</strong> be <code>NULL</code>.</p>
</div>
<div class="paragraph">
<p><em>src_image</em>, <em>dst_image</em>, <em>src_origin</em>, <em>dst_origin</em>, <em>region</em> Refer to
<strong>clEnqueueCopyImage</strong>.</p>
</div>
<div class="paragraph">
<p><em>sync_point_wait_list</em>, <em>num_sync_points_in_wait_list</em> Specify
synchronization-points that need to complete before this
particular command can be executed.</p>
</div>
<div class="paragraph">
<p>If <em>sync_point_wait_list</em> is <code>NULL</code>, <em>num_sync_points_in_wait_list</em>
must be 0. If <em>sync_point_wait_list</em> is not <code>NULL</code>, the list of
synchronization-points pointed to by <em>sync_point_wait_list</em> must be
valid and <em>num_sync_points_in_wait_list</em> must be greater than 0.
The synchronization-points specified in <em>sync_point_wait_list</em> are
<strong>device side</strong> synchronization-points. The command-buffer associated
with synchronization-points in <em>sync_point_wait_list</em> must be the same
as <em>command_buffer</em>. The memory associated with <em>sync_point_wait_list</em>
can be reused or freed after the function returns.</p>
</div>
<div class="paragraph">
<p><em>sync_point</em> Returns a synchronization-point ID that identifies this particular
command. Synchronization-point objects are unique and can be used to
identify this command later on. <em>sync_point</em> can be <code>NULL</code> in which case it
will not be possible for the application to record a wait for this command to
complete. If the <em>sync_point_wait_list</em> and the <em>sync_point</em> arguments are not
<code>NULL</code>, the <em>sync_point</em> argument should not refer to an element of the
<em>sync_point_wait_list</em> array.</p>
</div>
<div class="paragraph">
<p><em>mutable_handle</em> Returns a handle to the command. Handle is unused by
this extension and must be passed as <code>NULL</code>.</p>
</div>
<div class="paragraph">
<p><strong>clCommandCopyImageKHR</strong> returns <code>CL_SUCCESS</code> if the function is executed
successfully. Otherwise, it returns the errors defined by
<strong>clEnqueueCopyImage</strong> except:</p>
</div>
<div class="paragraph">
<p><code>CL_INVALID_<wbr>COMMAND_<wbr>QUEUE</code> is replaced with:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>CL_INVALID_<wbr>COMMAND_<wbr>QUEUE</code> if <em>command_queue</em> is not <code>NULL</code>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><code>CL_INVALID_<wbr>CONTEXT</code> is replaced with:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>CL_INVALID_<wbr>CONTEXT</code> if the context associated with <em>command_queue</em>,
<em>command_buffer</em>, <em>src_image</em>, and <em>dst_image</em> are not the same.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><code>CL_INVALID_<wbr>EVENT_<wbr>WAIT_<wbr>LIST</code> is replaced with:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>CL_INVALID_<wbr>SYNC_<wbr>POINT_<wbr>WAIT_<wbr>LIST_<wbr>KHR</code> if <em>sync_point_wait_list</em> is <code>NULL</code> and
<em>num_sync_points_in_wait_list</em> is &gt; 0, or <em>sync_point_wait_list</em> is not
<code>NULL</code> and <em>num_sync_points_in_wait_list</em> is 0, or if
synchronization-point objects in <em>sync_point_wait_list</em> are not valid
synchronization-points.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>New errors:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>CL_INVALID_<wbr>COMMAND_<wbr>BUFFER_<wbr>KHR</code> if <em>command_buffer</em> is not a valid
command-buffer.</p>
</li>
<li>
<p><code>CL_INVALID_<wbr>OPERATION</code> if <em>command_buffer</em> has been finalized.</p>
</li>
<li>
<p><code>CL_INVALID_<wbr>VALUE</code> if <em>mutable_handle</em> is not <code>NULL</code>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The function</p>
</div>
<div id="clCommandCopyImageToBufferKHR" class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="opencl"><span class="kt">cl_int</span> <span class="nf">clCommandCopyImageToBufferKHR</span><span class="p">(</span>
    <span class="kt">cl_command_buffer_khr</span> <span class="n">command_buffer</span><span class="p">,</span>
    <span class="kt">cl_command_queue</span> <span class="n">command_queue</span><span class="p">,</span>
    <span class="kt">cl_mem</span> <span class="n">src_image</span><span class="p">,</span>
    <span class="kt">cl_mem</span> <span class="n">dst_buffer</span><span class="p">,</span>
    <span class="k">const</span> <span class="kt">size_t</span><span class="o">*</span> <span class="n">src_origin</span><span class="p">,</span>
    <span class="k">const</span> <span class="kt">size_t</span><span class="o">*</span> <span class="n">region</span><span class="p">,</span>
    <span class="kt">size_t</span> <span class="n">dst_offset</span><span class="p">,</span>
    <span class="kt">cl_uint</span> <span class="n">num_sync_points_in_wait_list</span><span class="p">,</span>
    <span class="k">const</span> <span class="kt">cl_sync_point_khr</span><span class="o">*</span> <span class="n">sync_point_wait_list</span><span class="p">,</span>
    <span class="kt">cl_sync_point_khr</span><span class="o">*</span> <span class="n">sync_point</span><span class="p">,</span>
    <span class="kt">cl_mutable_command_khr</span><span class="o">*</span> <span class="n">mutable_handle</span><span class="p">);</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Records a command to copy an image object to a buffer object.</p>
</div>
<div class="paragraph">
<p><em>command_buffer</em> Refers to a valid command-buffer object.</p>
</div>
<div class="paragraph">
<p><em>command_queue</em> Specifies the command-queue the command will be recorded to.
Parameter is unused by this extension as only a single command-queue is
supported and <strong>must</strong> be <code>NULL</code>.</p>
</div>
<div class="paragraph">
<p><em>src_image</em>, <em>dst_buffer</em>, <em>src_origin</em>, <em>region</em>, <em>dst_offset</em>
Refer to <strong>clEnqueueCopyImageToBuffer</strong>.</p>
</div>
<div class="paragraph">
<p><em>sync_point_wait_list</em>, <em>num_sync_points_in_wait_list</em> Specify
synchronization-points that need to complete before this
particular command can be executed.</p>
</div>
<div class="paragraph">
<p>If <em>sync_point_wait_list</em> is <code>NULL</code>, <em>num_sync_points_in_wait_list</em>
must be 0. If <em>sync_point_wait_list</em> is not <code>NULL</code>, the list of
synchronization-points pointed to by <em>sync_point_wait_list</em> must be
valid and <em>num_sync_points_in_wait_list</em> must be greater than 0.
The synchronization-points specified in <em>sync_point_wait_list</em> are
<strong>device side</strong> synchronization-points. The command-buffer associated
with synchronization-points in <em>sync_point_wait_list</em> must be the same
as <em>command_buffer</em>. The memory associated with <em>sync_point_wait_list</em>
can be reused or freed after the function returns.</p>
</div>
<div class="paragraph">
<p><em>sync_point</em> Returns a synchronization-point ID that identifies this particular
command. Synchronization-point objects are unique and can be used to
identify this command later on. <em>sync_point</em> can be <code>NULL</code> in which case it
will not be possible for the application to record a wait for this command to
complete. If the <em>sync_point_wait_list</em> and the <em>sync_point</em> arguments are not
<code>NULL</code>, the <em>sync_point</em> argument should not refer to an element of the
<em>sync_point_wait_list</em> array.</p>
</div>
<div class="paragraph">
<p><em>mutable_handle</em> Returns a handle to the command. Handle is unused by
this extension and must be passed as <code>NULL</code>.</p>
</div>
<div class="paragraph">
<p><strong>clCommandCopyImageToBufferKHR</strong> returns <code>CL_SUCCESS</code> if the function is
executed successfully. Otherwise, it returns the errors defined by
<strong>clEnqueueCopyImageToBuffer</strong> except:</p>
</div>
<div class="paragraph">
<p><code>CL_INVALID_<wbr>COMMAND_<wbr>QUEUE</code> is replaced with:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>CL_INVALID_<wbr>COMMAND_<wbr>QUEUE</code> if <em>command_queue</em> is not <code>NULL</code>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><code>CL_INVALID_<wbr>CONTEXT</code> is replaced with:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>CL_INVALID_<wbr>CONTEXT</code> if the context associated with <em>command_queue</em>,
<em>command_buffer</em>, <em>src_image</em>, and <em>dst_buffer</em> are not the same.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><code>CL_INVALID_<wbr>EVENT_<wbr>WAIT_<wbr>LIST</code> is replaced with:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>CL_INVALID_<wbr>SYNC_<wbr>POINT_<wbr>WAIT_<wbr>LIST_<wbr>KHR</code> if <em>sync_point_wait_list</em> is <code>NULL</code> and
<em>num_sync_points_in_wait_list</em> is &gt; 0, or <em>sync_point_wait_list</em> is not
<code>NULL</code> and <em>num_sync_points_in_wait_list</em> is 0, or if
synchronization-point objects in <em>sync_point_wait_list</em> are not valid
synchronization-points.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>New errors:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>CL_INVALID_<wbr>COMMAND_<wbr>BUFFER_<wbr>KHR</code> if <em>command_buffer</em> is not a valid
command-buffer.</p>
</li>
<li>
<p><code>CL_INVALID_<wbr>OPERATION</code> if <em>command_buffer</em> has been finalized.</p>
</li>
<li>
<p><code>CL_INVALID_<wbr>VALUE</code> if <em>mutable_handle</em> is not <code>NULL</code>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The function</p>
</div>
<div id="clCommandFillBufferKHR" class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="opencl"><span class="kt">cl_int</span> <span class="nf">clCommandFillBufferKHR</span><span class="p">(</span>
    <span class="kt">cl_command_buffer_khr</span> <span class="n">command_buffer</span><span class="p">,</span>
    <span class="kt">cl_command_queue</span> <span class="n">command_queue</span><span class="p">,</span>
    <span class="kt">cl_mem</span> <span class="n">buffer</span><span class="p">,</span>
    <span class="k">const</span> <span class="kt">void</span><span class="o">*</span> <span class="n">pattern</span><span class="p">,</span>
    <span class="kt">size_t</span> <span class="n">pattern_size</span><span class="p">,</span>
    <span class="kt">size_t</span> <span class="n">offset</span><span class="p">,</span>
    <span class="kt">size_t</span> <span class="n">size</span><span class="p">,</span>
    <span class="kt">cl_uint</span> <span class="n">num_sync_points_in_wait_list</span><span class="p">,</span>
    <span class="k">const</span> <span class="kt">cl_sync_point_khr</span><span class="o">*</span> <span class="n">sync_point_wait_list</span><span class="p">,</span>
    <span class="kt">cl_sync_point_khr</span><span class="o">*</span> <span class="n">sync_point</span><span class="p">,</span>
    <span class="kt">cl_mutable_command_khr</span><span class="o">*</span> <span class="n">mutable_handle</span><span class="p">);</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Records a command to fill a buffer object with a pattern of a given pattern
size.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The usage information which indicates whether the memory object can be read or
written by a kernel and/or the host and is given by the <code>cl_mem_<wbr>flags</code> argument
value specified when <em>buffer</em> is created is ignored by
<strong>clCommandFillBufferKHR</strong>.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><em>command_buffer</em> Refers to a valid command-buffer object.</p>
</div>
<div class="paragraph">
<p><em>command_queue</em> Specifies the command-queue the command will be recorded to.
Parameter is unused by this extension as only a single command-queue is
supported and <strong>must</strong> be <code>NULL</code>.</p>
</div>
<div class="paragraph">
<p><em>buffer</em>, <em>pattern</em>, <em>pattern_size</em>, <em>offset</em>, <em>size</em> Refer to
<strong>clEnqueueFillBuffer</strong>.</p>
</div>
<div class="paragraph">
<p><em>sync_point_wait_list</em>, <em>num_sync_points_in_wait_list</em> Specify
synchronization-points that need to complete before this
particular command can be executed.</p>
</div>
<div class="paragraph">
<p>If <em>sync_point_wait_list</em> is <code>NULL</code>, <em>num_sync_points_in_wait_list</em>
must be 0. If <em>sync_point_wait_list</em> is not <code>NULL</code>, the list of
synchronization-points pointed to by <em>sync_point_wait_list</em> must be
valid and <em>num_sync_points_in_wait_list</em> must be greater than 0.
The synchronization-points specified in <em>sync_point_wait_list</em> are
<strong>device side</strong> synchronization-points. The command-buffer associated
with synchronization-points in <em>sync_point_wait_list</em> must be the same
as <em>command_buffer</em>. The memory associated with <em>sync_point_wait_list</em>
can be reused or freed after the function returns.</p>
</div>
<div class="paragraph">
<p><em>sync_point</em> Returns a synchronization-point ID that identifies this particular
command. Synchronization-point objects are unique and can be used to
identify this command later on. <em>sync_point</em> can be <code>NULL</code> in which case it
will not be possible for the application to record a wait for this command to
complete. If the <em>sync_point_wait_list</em> and the <em>sync_point</em> arguments are not
<code>NULL</code>, the <em>sync_point</em> argument should not refer to an element of the
<em>sync_point_wait_list</em> array.</p>
</div>
<div class="paragraph">
<p><em>mutable_handle</em> Returns a handle to the command. Handle is unused by
this extension and must be passed as <code>NULL</code>.</p>
</div>
<div class="paragraph">
<p><strong>clCommandFillBufferKHR</strong> returns <code>CL_SUCCESS</code> if the function is executed
successfully. Otherwise, it returns the errors defined by
<strong>clEnqueueFillBuffer</strong> except:</p>
</div>
<div class="paragraph">
<p><code>CL_INVALID_<wbr>COMMAND_<wbr>QUEUE</code> is replaced with:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>CL_INVALID_<wbr>COMMAND_<wbr>QUEUE</code> if <em>command_queue</em> is not <code>NULL</code>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><code>CL_INVALID_<wbr>CONTEXT</code> is replaced with:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>CL_INVALID_<wbr>CONTEXT</code> if the context associated with <em>command_queue</em>,
<em>command_buffer</em>, and <em>buffer</em> are not the same.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><code>CL_INVALID_<wbr>EVENT_<wbr>WAIT_<wbr>LIST</code> is replaced with:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>CL_INVALID_<wbr>SYNC_<wbr>POINT_<wbr>WAIT_<wbr>LIST_<wbr>KHR</code> if <em>sync_point_wait_list</em> is <code>NULL</code> and
<em>num_sync_points_in_wait_list</em> is &gt; 0, or <em>sync_point_wait_list</em> is not
<code>NULL</code> and <em>num_sync_points_in_wait_list</em> is 0, or if
synchronization-point objects in <em>sync_point_wait_list</em> are not valid
synchronization-points.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>New errors:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>CL_INVALID_<wbr>COMMAND_<wbr>BUFFER_<wbr>KHR</code> if <em>command_buffer</em> is not a valid
command-buffer.</p>
</li>
<li>
<p><code>CL_INVALID_<wbr>OPERATION</code> if <em>command_buffer</em> has been finalized.</p>
</li>
<li>
<p><code>CL_INVALID_<wbr>VALUE</code> if <em>mutable_handle</em> is not <code>NULL</code>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The function</p>
</div>
<div id="clCommandFillImageKHR" class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="opencl"><span class="kt">cl_int</span> <span class="nf">clCommandFillImageKHR</span><span class="p">(</span>
    <span class="kt">cl_command_buffer_khr</span> <span class="n">command_buffer</span><span class="p">,</span>
    <span class="kt">cl_command_queue</span> <span class="n">command_queue</span><span class="p">,</span>
    <span class="kt">cl_mem</span> <span class="n">image</span><span class="p">,</span>
    <span class="k">const</span> <span class="kt">void</span><span class="o">*</span> <span class="n">fill_color</span><span class="p">,</span>
    <span class="k">const</span> <span class="kt">size_t</span><span class="o">*</span> <span class="n">origin</span><span class="p">,</span>
    <span class="k">const</span> <span class="kt">size_t</span><span class="o">*</span> <span class="n">region</span><span class="p">,</span>
    <span class="kt">cl_uint</span> <span class="n">num_sync_points_in_wait_list</span><span class="p">,</span>
    <span class="k">const</span> <span class="kt">cl_sync_point_khr</span><span class="o">*</span> <span class="n">sync_point_wait_list</span><span class="p">,</span>
    <span class="kt">cl_sync_point_khr</span><span class="o">*</span> <span class="n">sync_point</span><span class="p">,</span>
    <span class="kt">cl_mutable_command_khr</span><span class="o">*</span> <span class="n">mutable_handle</span><span class="p">);</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Records a command to fill an image object with a specified color.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The usage information which indicates whether the memory object can be read or
written by a kernel and/or the host and is given by the <code>cl_mem_<wbr>flags</code> argument
value specified when image is created is ignored by <strong>clCommandFillImageKHR</strong>.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><em>command_buffer</em> Refers to a valid command-buffer object.</p>
</div>
<div class="paragraph">
<p><em>command_queue</em> Specifies the command-queue the command will be recorded to.
Parameter is unused by this extension as only a single command-queue is
supported and <strong>must</strong> be <code>NULL</code>.</p>
</div>
<div class="paragraph">
<p><em>image</em>, <em>fill_color</em>, <em>origin</em>, <em>region</em> Refer to <strong>clEnqueueFillImage</strong>.</p>
</div>
<div class="paragraph">
<p><em>sync_point_wait_list</em>, <em>num_sync_points_in_wait_list</em> Specify
synchronization-points that need to complete before this
particular command can be executed.</p>
</div>
<div class="paragraph">
<p>If <em>sync_point_wait_list</em> is <code>NULL</code>, <em>num_sync_points_in_wait_list</em>
must be 0. If <em>sync_point_wait_list</em> is not <code>NULL</code>, the list of
synchronization-points pointed to by <em>sync_point_wait_list</em> must be
valid and <em>num_sync_points_in_wait_list</em> must be greater than 0.
The synchronization-points specified in <em>sync_point_wait_list</em> are
<strong>device side</strong> synchronization-points. The command-buffer associated
with synchronization-points in <em>sync_point_wait_list</em> must be the same
as <em>command_buffer</em>. The memory associated with <em>sync_point_wait_list</em>
can be reused or freed after the function returns.</p>
</div>
<div class="paragraph">
<p><em>sync_point</em> Returns a synchronization-point ID that identifies this particular
command. Synchronization-point objects are unique and can be used to
identify this command later on. <em>sync_point</em> can be <code>NULL</code> in which case it
will not be possible for the application to record a wait for this command to
complete. If the <em>sync_point_wait_list</em> and the <em>sync_point</em> arguments are not
<code>NULL</code>, the <em>sync_point</em> argument should not refer to an element of the
<em>sync_point_wait_list</em> array.</p>
</div>
<div class="paragraph">
<p><em>mutable_handle</em> Returns a handle to the command. Handle is unused by
this extension and must be passed as <code>NULL</code>.</p>
</div>
<div class="paragraph">
<p><strong>clCommandFillImageKHR</strong> returns <code>CL_SUCCESS</code> if the function is executed
successfully. Otherwise, it returns the errors defined by
<strong>clEnqueueFillImage</strong> except:</p>
</div>
<div class="paragraph">
<p><code>CL_INVALID_<wbr>COMMAND_<wbr>QUEUE</code> is replaced with:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>CL_INVALID_<wbr>COMMAND_<wbr>QUEUE</code> if <em>command_queue</em> is not <code>NULL</code>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><code>CL_INVALID_<wbr>CONTEXT</code> is replaced with:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>CL_INVALID_<wbr>CONTEXT</code> if the context associated with <em>command_queue</em>,
<em>command_buffer</em>, and <em>image</em> are not the same.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><code>CL_INVALID_<wbr>EVENT_<wbr>WAIT_<wbr>LIST</code> is replaced with:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>CL_INVALID_<wbr>SYNC_<wbr>POINT_<wbr>WAIT_<wbr>LIST_<wbr>KHR</code> if <em>sync_point_wait_list</em> is <code>NULL</code> and
<em>num_sync_points_in_wait_list</em> is &gt; 0, or <em>sync_point_wait_list</em> is not
<code>NULL</code> and <em>num_sync_points_in_wait_list</em> is 0, or if
synchronization-point objects in <em>sync_point_wait_list</em> are not valid
synchronization-points.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>New errors:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>CL_INVALID_<wbr>COMMAND_<wbr>BUFFER_<wbr>KHR</code> if <em>command_buffer</em> is not a valid
command-buffer.</p>
</li>
<li>
<p><code>CL_INVALID_<wbr>OPERATION</code> if <em>command_buffer</em> has been finalized.</p>
</li>
<li>
<p><code>CL_INVALID_<wbr>VALUE</code> if <em>mutable_handle</em> is not <code>NULL</code>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The function</p>
</div>
<div id="clCommandNDRangeKernelKHR" class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="opencl"><span class="kt">cl_int</span> <span class="nf">clCommandNDRangeKernelKHR</span><span class="p">(</span>
    <span class="kt">cl_command_buffer_khr</span> <span class="n">command_buffer</span><span class="p">,</span>
    <span class="kt">cl_command_queue</span> <span class="n">command_queue</span><span class="p">,</span>
    <span class="k">const</span> <span class="kt">cl_ndrange_kernel_command_properties_khr</span><span class="o">*</span> <span class="n">properties</span><span class="p">,</span>
    <span class="kt">cl_kernel</span> <span class="n">kernel</span><span class="p">,</span>
    <span class="kt">cl_uint</span> <span class="n">work_dim</span><span class="p">,</span>
    <span class="k">const</span> <span class="kt">size_t</span><span class="o">*</span> <span class="n">global_work_offset</span><span class="p">,</span>
    <span class="k">const</span> <span class="kt">size_t</span><span class="o">*</span> <span class="n">global_work_size</span><span class="p">,</span>
    <span class="k">const</span> <span class="kt">size_t</span><span class="o">*</span> <span class="n">local_work_size</span><span class="p">,</span>
    <span class="kt">cl_uint</span> <span class="n">num_sync_points_in_wait_list</span><span class="p">,</span>
    <span class="k">const</span> <span class="kt">cl_sync_point_khr</span><span class="o">*</span> <span class="n">sync_point_wait_list</span><span class="p">,</span>
    <span class="kt">cl_sync_point_khr</span><span class="o">*</span> <span class="n">sync_point</span><span class="p">,</span>
    <span class="kt">cl_mutable_command_khr</span><span class="o">*</span> <span class="n">mutable_handle</span><span class="p">);</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Records a command to execute a kernel on a device.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The work-group size to be used for <em>kernel</em> can also be specified in the
program source using the
<code>__attribute__((reqd_work_group_size(X, Y, Z)))</code> qualifier. In this case the
size of work group specified by <em>local_work_size</em> must match the value
specified by the <code>reqd_work_group_size</code> <code>__attribute__</code> qualifier.</p>
</div>
<div class="paragraph">
<p>These work-group instances are executed in parallel across multiple compute
units or concurrently on the same compute unit.</p>
</div>
<div class="paragraph">
<p>Each work-item is uniquely identified by a global identifier. The global ID,
which can be read inside the kernel, is computed using the value given by
<em>global_work_size</em> and <em>global_work_offset</em>. In addition, a work-item is
also identified within a work-group by a unique local ID. The local ID,
which can also be read by the kernel, is computed using the value given by
<em>local_work_size</em>. The starting local ID is always (0, 0, &#8230;&#8203; 0).</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><em>command_buffer</em> Refers to a valid command-buffer object.</p>
</div>
<div class="paragraph">
<p><em>command_queue</em> Specifies the command-queue the command will be recorded to.
Parameter is unused by this extension as only a single command-queue is
supported and <strong>must</strong> be <code>NULL</code>.</p>
</div>
<div class="paragraph">
<p><em>properties</em> Specifies a list of properties for the kernel command and their
corresponding values. Each property name is immediately followed by the
corresponding desired value. The list is terminated with 0. If no properties are
required, <em>properties</em> may be <code>NULL</code>. This extension does not define any
properties.</p>
</div>
<div class="paragraph">
<p><em>kernel</em> A valid kernel object which <strong>must</strong> have its arguments set. Any
changes to <em>kernel</em> after calling <strong>clCommandNDRangeKernelKHR</strong>, such as with
<strong>clSetKernelArg</strong> or <strong>clSetKernelExecInfo</strong>, have no effect on the recorded
command. If <em>kernel</em> is recorded to a following <strong>clCommandNDRangeKernelKHR</strong>
command however, then that command will capture the updated state of <em>kernel</em>.</p>
</div>
<div class="paragraph">
<p><em>work_dim</em>, <em>global_work_offset</em>, <em>global_work_size</em>, <em>local_work_size</em> Refer
to <strong>clEnqueueNDRangeKernel</strong>.</p>
</div>
<div class="paragraph">
<p><em>sync_point_wait_list</em>, <em>num_sync_points_in_wait_list</em> Specify
synchronization-points that need to complete before this
particular command can be executed.</p>
</div>
<div class="paragraph">
<p>If <em>sync_point_wait_list</em> is <code>NULL</code>, <em>num_sync_points_in_wait_list</em>
must be 0. If <em>sync_point_wait_list</em> is not <code>NULL</code>, the list of
synchronization-points pointed to by <em>sync_point_wait_list</em> must be
valid and <em>num_sync_points_in_wait_list</em> must be greater than 0.
The synchronization-points specified in <em>sync_point_wait_list</em> are
<strong>device side</strong> synchronization-points. The command-buffer associated
with synchronization-points in <em>sync_point_wait_list</em> must be the same
as <em>command_buffer</em>. The memory associated with <em>sync_point_wait_list</em>
can be reused or freed after the function returns.</p>
</div>
<div class="paragraph">
<p><em>sync_point</em> Returns a synchronization-point ID that identifies this particular
command. Synchronization-point objects are unique and can be used to
identify this command later on. <em>sync_point</em> can be <code>NULL</code> in which case it
will not be possible for the application to record a wait for this command to
complete. If the <em>sync_point_wait_list</em> and the <em>sync_point</em> arguments are not
<code>NULL</code>, the <em>sync_point</em> argument should not refer to an element of the
<em>sync_point_wait_list</em> array.</p>
</div>
<div class="paragraph">
<p><em>mutable_handle</em> Returns a handle to the command. Handle is unused by
this extension and must be passed as <code>NULL</code>.</p>
</div>
<div class="paragraph">
<p><strong>clCommandNDRangeKernelKHR</strong> returns <code>CL_SUCCESS</code> if the function is executed
successfully. Otherwise, it returns the errors defined by
<strong>clEnqueueNDRangeKernel</strong> except:</p>
</div>
<div class="paragraph">
<p><code>CL_INVALID_<wbr>COMMAND_<wbr>QUEUE</code> is replaced with:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>CL_INVALID_<wbr>COMMAND_<wbr>QUEUE</code> if <em>command_queue</em> is not <code>NULL</code>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><code>CL_INVALID_<wbr>CONTEXT</code> is replaced with:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>CL_INVALID_<wbr>CONTEXT</code> if the context associated with <em>command_queue</em>,
<em>command_buffer</em>, and <em>kernel</em> are not the same.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><code>CL_INVALID_<wbr>EVENT_<wbr>WAIT_<wbr>LIST</code> is replaced with:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>CL_INVALID_<wbr>SYNC_<wbr>POINT_<wbr>WAIT_<wbr>LIST_<wbr>KHR</code> if <em>sync_point_wait_list</em> is <code>NULL</code> and
<em>num_sync_points_in_wait_list</em> is &gt; 0, or <em>sync_point_wait_list</em> is not
<code>NULL</code> and <em>num_sync_points_in_wait_list</em> is 0, or if
synchronization-point objects in <em>sync_point_wait_list</em> are not valid
synchronization-points.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>New errors:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>CL_INVALID_<wbr>COMMAND_<wbr>BUFFER_<wbr>KHR</code> if <em>command_buffer</em> is not a valid
command-buffer.</p>
</li>
<li>
<p><code>CL_INVALID_<wbr>VALUE</code> if values specified in <em>properties</em> are not valid</p>
</li>
<li>
<p><code>CL_INVALID_<wbr>OPERATION</code> if <em>command_buffer</em> has been finalized.</p>
</li>
<li>
<p><code>CL_INVALID_<wbr>VALUE</code> if <em>mutable_handle</em> is not <code>NULL</code>.</p>
</li>
<li>
<p><code>CL_INVALID_<wbr>OPERATION</code> if the device associated with <em>command_queue</em> does not
support <code>CL_COMMAND_<wbr>BUFFER_<wbr>CAPABILITY_<wbr>KERNEL_<wbr>PRINTF_<wbr>KHR</code> and <em>kernel</em> contains
a printf call.</p>
</li>
<li>
<p><code>CL_INVALID_<wbr>OPERATION</code> if the device associated with <em>command_queue</em> does not
support <code>CL_COMMAND_<wbr>BUFFER_<wbr>CAPABILITY_<wbr>DEVICE_<wbr>SIDE_<wbr>ENQUEUE_<wbr>KHR</code> and <em>kernel</em>
contains a kernel-enqueue call.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_add_new_section_section_5_x_4_command_buffer_queries"><a class="anchor" href="#_add_new_section_section_5_x_4_command_buffer_queries"></a>46.8.5. Add new section "Section 5.X.4 - Command Buffer Queries"</h4>
<div class="paragraph">
<p>The function</p>
</div>
<div id="clGetCommandBufferInfoKHR" class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="opencl"><span class="kt">cl_int</span> <span class="nf">clGetCommandBufferInfoKHR</span><span class="p">(</span>
    <span class="kt">cl_command_buffer_khr</span> <span class="n">command_buffer</span><span class="p">,</span>
    <span class="kt">cl_command_buffer_info_khr</span> <span class="n">param_name</span><span class="p">,</span>
    <span class="kt">size_t</span> <span class="n">param_value_size</span><span class="p">,</span>
    <span class="kt">void</span><span class="o">*</span> <span class="n">param_value</span><span class="p">,</span>
    <span class="kt">size_t</span><span class="o">*</span> <span class="n">param_value_size_ret</span><span class="p">);</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Queries information about a command-buffer.</p>
</div>
<div class="paragraph">
<p><em>command_buffer</em> Specifies the command-buffer being queried.</p>
</div>
<div class="paragraph">
<p><em>param_name</em> Specifies the information to query.</p>
</div>
<div class="paragraph">
<p><em>param_value_size</em> Specifies the size in bytes of memory pointed to by
<em>param_value</em>. This size must be  size of return type as described in the table
below. If <em>param_value</em> is <code>NULL</code>, it is ignored.</p>
</div>
<div class="paragraph">
<p><em>param_value</em> A pointer to memory where the appropriate result being queried is
returned. If <em>param_value</em> is <code>NULL</code>, it is ignored.</p>
</div>
<div class="paragraph">
<p><em>param_value_size_ret</em> Returns the actual size in bytes of data being queried by
<em>param_value</em>. If <em>param_value_size_ret</em> is <code>NULL</code>, it is ignored.</p>
</div>
<div class="paragraph">
<p>The list of supported <em>param_name</em> values and the information returned in
<em>param_value</em> by <strong>clGetCommandBufferInfoKHR</strong> is described in the table below.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 70. <strong>clGetCommandBufferInfoKHR</strong> values</caption>
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Command Buffer Info</th>
<th class="tableblock halign-left valign-top">Return Type</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CL_COMMAND_<wbr>BUFFER_<wbr>NUM_<wbr>QUEUES_<wbr>KHR</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>cl_uint</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The number of command-queues specified when <em>command_buffer</em> was created.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CL_COMMAND_<wbr>BUFFER_<wbr>QUEUES_<wbr>KHR</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>cl_command_<wbr>queue</code>[]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Return the list of command-queues specified when the <em>command_buffer</em> was
  created.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CL_COMMAND_<wbr>BUFFER_<wbr>REFERENCE_<wbr>COUNT_<wbr>KHR</code> <sup class="footnote">[<a id="_footnoteref_2" class="footnote" href="#_footnotedef_2" title="View footnote.">2</a>]</sup></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>cl_uint</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Return the <em>command_buffer</em> reference count.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CL_COMMAND_<wbr>BUFFER_<wbr>STATE_<wbr>KHR</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>cl_command_<wbr>buffer_<wbr>state_<wbr>khr</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Return the state of <em>command_buffer</em>.</p>
<p class="tableblock">  <code>CL_COMMAND_<wbr>BUFFER_<wbr>STATE_<wbr>RECORDING_<wbr>KHR</code> is returned when <em>command_buffer</em> has
  not been finalized.</p>
<p class="tableblock">  <code>CL_COMMAND_<wbr>BUFFER_<wbr>STATE_<wbr>EXECUTABLE_<wbr>KHR</code> is returned when <em>command_buffer</em>
  has been finalized and there is not a <a href="#pending">Pending</a> instance of
  <em>command_buffer</em> awaiting completion on a command_queue.</p>
<p class="tableblock">  <code>CL_COMMAND_<wbr>BUFFER_<wbr>STATE_<wbr>PENDING_<wbr>KHR</code> is returned when an instance of
  <em>command_buffer</em> has been enqueued for execution but not yet completed.</p>
<p class="tableblock">  <code>CL_COMMAND_<wbr>BUFFER_<wbr>STATE_<wbr>INVALID_<wbr>KHR</code> is returned when <em>command_buffer</em> is
  in an <a href="#invalid">Invalid</a> state.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CL_COMMAND_<wbr>BUFFER_<wbr>PROPERTIES_<wbr>ARRAY_<wbr>KHR</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>cl_command_<wbr>buffer_<wbr>properties_<wbr>khr</code>[]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Return the <em>properties</em> argument specified in <strong>clCreateCommandBufferKHR</strong>.</p>
<p class="tableblock">  If the <em>properties</em> argument specified in <strong>clCreateCommandBufferKHR</strong> used to
  create <em>command_buffer</em> was not <code>NULL</code>, the implementation must return the
  values specified in the properties argument.</p>
<p class="tableblock">  If the <em>properties</em> argument specified in <strong>clCreateCommandBufferKHR</strong> used to
  create <em>command_buffer</em> was <code>NULL</code>, the implementation may return either a
  <em>param_value_size_ret</em> of 0 (i.e. there is are no properties to be returned),
  or the implementation may return a property value of 0 (where 0 is used to
  terminate the properties list).</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CL_COMMAND_<wbr>BUFFER_<wbr>CONTEXT_<wbr>KHR</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>cl_context</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Return the context associated with <em>command_buffer</em>.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><strong>clGetCommandBufferInfoKHR</strong> returns <code>CL_SUCCESS</code> if the function is executed
successfully. Otherwise, it returns one of the following errors:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>CL_INVALID_<wbr>COMMAND_<wbr>BUFFER_<wbr>KHR</code> if <em>command_buffer</em> is not a valid
command-buffer.</p>
</li>
<li>
<p><code>CL_INVALID_<wbr>VALUE</code> if <em>param_name</em> is not one of the supported values
or if size in bytes specified by <em>param_value_size</em> is less than size of
return type and <em>param_value</em> is not a <code>NULL</code> value.</p>
</li>
<li>
<p><code>CL_OUT_<wbr>OF_<wbr>RESOURCES</code> if there is a failure to allocate resources required by
the OpenCL implementation on the device.</p>
</li>
<li>
<p><code>CL_OUT_<wbr>OF_<wbr>HOST_<wbr>MEMORY</code> if there is a failure to allocate resources required by
the OpenCL implementation on the host.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_modifications_to_section_5_11_of_the_opencl_api_specification"><a class="anchor" href="#_modifications_to_section_5_11_of_the_opencl_api_specification"></a>46.9. Modifications to section 5.11 of the OpenCL API Specification</h3>
<div class="paragraph">
<p>In the opening paragraph add <strong>clEnqueueCommandBufferKHR</strong> to list of commands that
can return an event object.</p>
</div>
<div class="paragraph">
<p>Add to Table 37, <em>Event Command Types</em>:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Events Created By</th>
<th class="tableblock halign-left valign-top">Event Command Type</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>clEnqueueCommandBufferKHR</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CL_COMMAND_<wbr>COMMAND_<wbr>BUFFER_<wbr>KHR</code></p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="_sample_code"><a class="anchor" href="#_sample_code"></a>46.10. Sample Code</h3>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="opencl">  <span class="cp">#define CL_CHECK(ERROR)                             \
    if (ERROR) {                                      \
      std::cerr &lt;&lt; "OpenCL error: " &lt;&lt; ERROR &lt;&lt; "\n"; \
      return ERROR;                                   \
    }
</span>
  <span class="kt">int</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span>
    <span class="kt">cl_platform_id</span> <span class="n">platform</span><span class="p">;</span>
    <span class="n">CL_CHECK</span><span class="p">(</span><span class="n">clGetPlatformIDs</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">platform</span><span class="p">,</span> <span class="nb">nullptr</span><span class="p">));</span>
    <span class="kt">cl_device_id</span> <span class="n">device</span><span class="p">;</span>
    <span class="n">CL_CHECK</span><span class="p">(</span><span class="n">clGetDeviceIDs</span><span class="p">(</span><span class="n">platform</span><span class="p">,</span> <span class="n">CL_DEVICE_TYPE_ALL</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">device</span><span class="p">,</span> <span class="nb">nullptr</span><span class="p">));</span>

    <span class="kt">cl_int</span> <span class="n">error</span><span class="p">;</span>
    <span class="kt">cl_context</span> <span class="n">context</span> <span class="o">=</span>
        <span class="n">clCreateContext</span><span class="p">(</span><span class="nb">nullptr</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">device</span><span class="p">,</span> <span class="nb">nullptr</span><span class="p">,</span> <span class="nb">nullptr</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">error</span><span class="p">);</span>
    <span class="n">CL_CHECK</span><span class="p">(</span><span class="n">error</span><span class="p">);</span>

    <span class="k">const</span> <span class="kt">char</span><span class="o">*</span> <span class="n">code</span> <span class="o">=</span> <span class="s">R"OpenCLC(
  kernel void vector_addition(global int* tile1, global int* tile2,
                              global int* res) {
    size_t index = get_global_id(0);
    res[index] = tile1[index] + tile2[index];
  }
  )OpenCLC"</span><span class="p">;</span>
    <span class="k">const</span> <span class="kt">size_t</span> <span class="n">length</span> <span class="o">=</span> <span class="n">std</span><span class="o">::</span><span class="n">strlen</span><span class="p">(</span><span class="n">code</span><span class="p">);</span>

    <span class="kt">cl_program</span> <span class="n">program</span> <span class="o">=</span>
        <span class="n">clCreateProgramWithSource</span><span class="p">(</span><span class="n">context</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">code</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">length</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">error</span><span class="p">);</span>
    <span class="n">CL_CHECK</span><span class="p">(</span><span class="n">error</span><span class="p">);</span>

    <span class="n">CL_CHECK</span><span class="p">(</span><span class="n">clBuildProgram</span><span class="p">(</span><span class="n">program</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">device</span><span class="p">,</span> <span class="nb">nullptr</span><span class="p">,</span> <span class="nb">nullptr</span><span class="p">,</span> <span class="nb">nullptr</span><span class="p">));</span>

    <span class="kt">cl_kernel</span> <span class="n">kernel</span> <span class="o">=</span> <span class="n">clCreateKernel</span><span class="p">(</span><span class="n">program</span><span class="p">,</span> <span class="s">"vector_addition"</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">error</span><span class="p">);</span>
    <span class="n">CL_CHECK</span><span class="p">(</span><span class="n">error</span><span class="p">);</span>

    <span class="k">constexpr</span> <span class="kt">size_t</span> <span class="n">frame_count</span> <span class="o">=</span> <span class="mi">60</span><span class="p">;</span>
    <span class="k">constexpr</span> <span class="kt">size_t</span> <span class="n">frame_elements</span> <span class="o">=</span> <span class="mi">1024</span><span class="p">;</span>
    <span class="k">constexpr</span> <span class="kt">size_t</span> <span class="n">frame_size</span> <span class="o">=</span> <span class="n">frame_elements</span> <span class="o">*</span> <span class="k">sizeof</span><span class="p">(</span><span class="kt">cl_int</span><span class="p">);</span>

    <span class="k">constexpr</span> <span class="kt">size_t</span> <span class="n">tile_count</span> <span class="o">=</span> <span class="mi">16</span><span class="p">;</span>
    <span class="k">constexpr</span> <span class="kt">size_t</span> <span class="n">tile_elements</span> <span class="o">=</span> <span class="n">frame_elements</span> <span class="o">/</span> <span class="n">tile_count</span><span class="p">;</span>
    <span class="k">constexpr</span> <span class="kt">size_t</span> <span class="n">tile_size</span> <span class="o">=</span> <span class="n">tile_elements</span> <span class="o">*</span> <span class="k">sizeof</span><span class="p">(</span><span class="kt">cl_int</span><span class="p">);</span>

    <span class="kt">cl_mem</span> <span class="n">buffer_tile1</span> <span class="o">=</span>
        <span class="n">clCreateBuffer</span><span class="p">(</span><span class="n">context</span><span class="p">,</span> <span class="n">CL_MEM_READ_ONLY</span><span class="p">,</span> <span class="n">tile_size</span><span class="p">,</span> <span class="nb">nullptr</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">error</span><span class="p">);</span>
    <span class="n">CL_CHECK</span><span class="p">(</span><span class="n">error</span><span class="p">);</span>
    <span class="kt">cl_mem</span> <span class="n">buffer_tile2</span> <span class="o">=</span>
        <span class="n">clCreateBuffer</span><span class="p">(</span><span class="n">context</span><span class="p">,</span> <span class="n">CL_MEM_READ_ONLY</span><span class="p">,</span> <span class="n">tile_size</span><span class="p">,</span> <span class="nb">nullptr</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">error</span><span class="p">);</span>
    <span class="n">CL_CHECK</span><span class="p">(</span><span class="n">error</span><span class="p">);</span>
    <span class="kt">cl_mem</span> <span class="n">buffer_res</span> <span class="o">=</span>
        <span class="n">clCreateBuffer</span><span class="p">(</span><span class="n">context</span><span class="p">,</span> <span class="n">CL_MEM_WRITE_ONLY</span><span class="p">,</span> <span class="n">tile_size</span><span class="p">,</span> <span class="nb">nullptr</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">error</span><span class="p">);</span>
    <span class="n">CL_CHECK</span><span class="p">(</span><span class="n">error</span><span class="p">);</span>

    <span class="n">CL_CHECK</span><span class="p">(</span><span class="n">clSetKernelArg</span><span class="p">(</span><span class="n">kernel</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="k">sizeof</span><span class="p">(</span><span class="n">buffer_tile1</span><span class="p">),</span> <span class="o">&amp;</span><span class="n">buffer_tile1</span><span class="p">));</span>
    <span class="n">CL_CHECK</span><span class="p">(</span><span class="n">clSetKernelArg</span><span class="p">(</span><span class="n">kernel</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="k">sizeof</span><span class="p">(</span><span class="n">buffer_tile2</span><span class="p">),</span> <span class="o">&amp;</span><span class="n">buffer_tile2</span><span class="p">));</span>
    <span class="n">CL_CHECK</span><span class="p">(</span><span class="n">clSetKernelArg</span><span class="p">(</span><span class="n">kernel</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="k">sizeof</span><span class="p">(</span><span class="n">buffer_res</span><span class="p">),</span> <span class="o">&amp;</span><span class="n">buffer_res</span><span class="p">));</span>

    <span class="kt">cl_command_queue</span> <span class="n">command_queue</span> <span class="o">=</span>
      <span class="n">clCreateCommandQueue</span><span class="p">(</span><span class="n">context</span><span class="p">,</span> <span class="n">device</span><span class="p">,</span>
                           <span class="n">CL_QUEUE_OUT_OF_ORDER_EXEC_MODE_ENABLE</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">error</span><span class="p">);</span>
    <span class="n">CL_CHECK</span><span class="p">(</span><span class="n">error</span><span class="p">);</span>

    <span class="kt">cl_command_buffer_khr</span> <span class="n">command_buffer</span> <span class="o">=</span>
        <span class="n">clCreateCommandBufferKHR</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">command_queue</span><span class="p">,</span> <span class="nb">nullptr</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">error</span><span class="p">);</span>
    <span class="n">CL_CHECK</span><span class="p">(</span><span class="n">error</span><span class="p">);</span>

    <span class="kt">cl_mem</span> <span class="n">buffer_src1</span> <span class="o">=</span>
        <span class="n">clCreateBuffer</span><span class="p">(</span><span class="n">context</span><span class="p">,</span> <span class="n">CL_MEM_READ_ONLY</span><span class="p">,</span> <span class="n">frame_size</span><span class="p">,</span> <span class="nb">nullptr</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">error</span><span class="p">);</span>
    <span class="n">CL_CHECK</span><span class="p">(</span><span class="n">error</span><span class="p">);</span>
    <span class="kt">cl_mem</span> <span class="n">buffer_src2</span> <span class="o">=</span>
        <span class="n">clCreateBuffer</span><span class="p">(</span><span class="n">context</span><span class="p">,</span> <span class="n">CL_MEM_READ_ONLY</span><span class="p">,</span> <span class="n">frame_size</span><span class="p">,</span> <span class="nb">nullptr</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">error</span><span class="p">);</span>
    <span class="n">CL_CHECK</span><span class="p">(</span><span class="n">error</span><span class="p">);</span>
    <span class="kt">cl_mem</span> <span class="n">buffer_dst</span> <span class="o">=</span>
        <span class="n">clCreateBuffer</span><span class="p">(</span><span class="n">context</span><span class="p">,</span> <span class="n">CL_MEM_WRITE_ONLY</span><span class="p">,</span> <span class="n">frame_size</span><span class="p">,</span> <span class="nb">nullptr</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">error</span><span class="p">);</span>
    <span class="n">CL_CHECK</span><span class="p">(</span><span class="n">error</span><span class="p">);</span>

    <span class="kt">cl_sync_point_khr</span> <span class="n">tile_sync_point</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="k">for</span> <span class="p">(</span><span class="kt">size_t</span> <span class="n">tile_index</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">tile_index</span> <span class="o">&lt;</span> <span class="n">tile_count</span><span class="p">;</span> <span class="n">tile_index</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
      <span class="n">std</span><span class="o">::</span><span class="n">array</span><span class="o">&lt;</span><span class="kt">cl_sync_point_khr</span><span class="p">,</span> <span class="mi">2</span><span class="o">&gt;</span> <span class="n">copy_sync_points</span><span class="p">;</span>
      <span class="n">CL_CHECK</span><span class="p">(</span><span class="n">clCommandCopyBufferKHR</span><span class="p">(</span><span class="n">command_buffer</span><span class="p">,</span>
          <span class="n">command_queue</span><span class="p">,</span> <span class="n">buffer_src1</span><span class="p">,</span> <span class="n">buffer_tile1</span><span class="p">,</span> <span class="n">tile_index</span> <span class="o">*</span> <span class="n">tile_size</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span>
          <span class="n">tile_size</span><span class="p">,</span> <span class="n">tile_sync_point</span> <span class="o">?</span> <span class="mi">1</span> <span class="o">:</span> <span class="mi">0</span><span class="p">,</span>
          <span class="n">tile_sync_point</span> <span class="o">?</span> <span class="o">&amp;</span><span class="n">tile_sync_point</span> <span class="o">:</span> <span class="nb">nullptr</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">copy_sync_points</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span>
          <span class="nb">nullptr</span><span class="p">);</span>
      <span class="n">CL_CHECK</span><span class="p">(</span><span class="n">clCommandCopyBufferKHR</span><span class="p">(</span><span class="n">command_buffer</span><span class="p">,</span>
          <span class="n">command_queue</span><span class="p">,</span> <span class="n">buffer_src2</span><span class="p">,</span> <span class="n">buffer_tile2</span><span class="p">,</span> <span class="n">tile_index</span> <span class="o">*</span> <span class="n">tile_size</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span>
          <span class="n">tile_size</span><span class="p">,</span> <span class="n">tile_sync_point</span> <span class="o">?</span> <span class="mi">1</span> <span class="o">:</span> <span class="mi">0</span><span class="p">,</span>
          <span class="n">tile_sync_point</span> <span class="o">?</span> <span class="o">&amp;</span><span class="n">tile_sync_point</span> <span class="o">:</span> <span class="nb">nullptr</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">copy_sync_points</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span>
          <span class="nb">nullptr</span><span class="p">);</span>

      <span class="kt">cl_sync_point_khr</span> <span class="n">nd_sync_point</span><span class="p">;</span>
      <span class="n">CL_CHECK</span><span class="p">(</span><span class="n">clCommandNDRangeKernelKHR</span><span class="p">(</span><span class="n">command_buffer</span><span class="p">,</span>
          <span class="n">command_queue</span><span class="p">,</span> <span class="nb">nullptr</span><span class="p">,</span> <span class="n">kernel</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="nb">nullptr</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">tile_elements</span><span class="p">,</span> <span class="nb">nullptr</span><span class="p">,</span>
          <span class="n">copy_sync_points</span><span class="p">.</span><span class="n">size</span><span class="p">(),</span> <span class="n">copy_sync_points</span><span class="p">.</span><span class="n">data</span><span class="p">(),</span> <span class="o">&amp;</span><span class="n">nd_sync_point</span><span class="p">,</span>
          <span class="nb">nullptr</span><span class="p">));</span>

      <span class="n">CL_CHECK</span><span class="p">(</span><span class="n">clCommandCopyBufferKHR</span><span class="p">(</span><span class="n">command_buffer</span><span class="p">,</span>
          <span class="n">command_queue</span><span class="p">,</span> <span class="n">buffer_res</span><span class="p">,</span> <span class="n">buffer_dst</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">tile_index</span> <span class="o">*</span> <span class="n">tile_size</span><span class="p">,</span>
          <span class="n">tile_size</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">nd_sync_point</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">tile_sync_point</span><span class="p">,</span> <span class="nb">nullptr</span><span class="p">));</span>
    <span class="p">}</span>

    <span class="n">CL_CHECK</span><span class="p">(</span><span class="n">clFinalizeCommandBufferKHR</span><span class="p">(</span><span class="n">command_buffer</span><span class="p">));</span>

    <span class="n">std</span><span class="o">::</span><span class="n">random_device</span> <span class="n">random_device</span><span class="p">;</span>
    <span class="n">std</span><span class="o">::</span><span class="n">mt19937</span> <span class="n">random_engine</span><span class="p">{</span><span class="n">random_device</span><span class="p">()};</span>
    <span class="n">std</span><span class="o">::</span><span class="n">uniform_int_distribution</span><span class="o">&lt;</span><span class="kt">cl_int</span><span class="o">&gt;</span> <span class="n">random_distribution</span><span class="p">{</span>
        <span class="mi">0</span><span class="p">,</span> <span class="n">std</span><span class="o">::</span><span class="n">numeric_limits</span><span class="o">&lt;</span><span class="kt">cl_int</span><span class="o">&gt;::</span><span class="n">max</span><span class="p">()</span> <span class="o">/</span> <span class="mi">2</span><span class="p">};</span>
    <span class="k">auto</span> <span class="n">random_generator</span> <span class="o">=</span> <span class="p">[</span><span class="o">&amp;</span><span class="p">]()</span> <span class="p">{</span> <span class="k">return</span> <span class="n">random_distribution</span><span class="p">(</span><span class="n">random_engine</span><span class="p">);</span> <span class="p">};</span>

    <span class="k">for</span> <span class="p">(</span><span class="kt">size_t</span> <span class="n">frame_index</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">frame_index</span> <span class="o">&lt;</span> <span class="n">frame_count</span><span class="p">;</span> <span class="n">frame_index</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
      <span class="n">std</span><span class="o">::</span><span class="n">array</span><span class="o">&lt;</span><span class="kt">cl_event</span><span class="p">,</span> <span class="mi">2</span><span class="o">&gt;</span> <span class="n">write_src_events</span><span class="p">;</span>
      <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">cl_int</span><span class="o">&gt;</span> <span class="n">src1</span><span class="p">(</span><span class="n">frame_elements</span><span class="p">);</span>
      <span class="n">std</span><span class="o">::</span><span class="n">generate</span><span class="p">(</span><span class="n">src1</span><span class="p">.</span><span class="n">begin</span><span class="p">(),</span> <span class="n">src1</span><span class="p">.</span><span class="n">end</span><span class="p">(),</span> <span class="n">random_generator</span><span class="p">);</span>
      <span class="n">CL_CHECK</span><span class="p">(</span><span class="n">clEnqueueWriteBuffer</span><span class="p">(</span><span class="n">command_queue</span><span class="p">,</span> <span class="n">buffer_src1</span><span class="p">,</span> <span class="n">CL_FALSE</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span>
                                    <span class="n">frame_size</span><span class="p">,</span> <span class="n">src1</span><span class="p">.</span><span class="n">data</span><span class="p">(),</span> <span class="mi">0</span><span class="p">,</span> <span class="nb">nullptr</span><span class="p">,</span>
                                    <span class="o">&amp;</span><span class="n">write_src_events</span><span class="p">[</span><span class="mi">0</span><span class="p">]));</span>
      <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">cl_int</span><span class="o">&gt;</span> <span class="n">src2</span><span class="p">(</span><span class="n">frame_elements</span><span class="p">);</span>
      <span class="n">std</span><span class="o">::</span><span class="n">generate</span><span class="p">(</span><span class="n">src2</span><span class="p">.</span><span class="n">begin</span><span class="p">(),</span> <span class="n">src2</span><span class="p">.</span><span class="n">end</span><span class="p">(),</span> <span class="n">random_generator</span><span class="p">);</span>
      <span class="n">CL_CHECK</span><span class="p">(</span><span class="n">clEnqueueWriteBuffer</span><span class="p">(</span><span class="n">command_queue</span><span class="p">,</span> <span class="n">buffer_src2</span><span class="p">,</span> <span class="n">CL_FALSE</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span>
                                    <span class="n">frame_size</span><span class="p">,</span> <span class="n">src2</span><span class="p">.</span><span class="n">data</span><span class="p">(),</span> <span class="mi">0</span><span class="p">,</span> <span class="nb">nullptr</span><span class="p">,</span>
                                    <span class="o">&amp;</span><span class="n">write_src_events</span><span class="p">[</span><span class="mi">1</span><span class="p">]));</span>

      <span class="n">CL_CHECK</span><span class="p">(</span><span class="n">clEnqueueCommandBufferKHR</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">,</span> <span class="n">command_buffer</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span>
                                         <span class="n">write_src_events</span><span class="p">.</span><span class="n">data</span><span class="p">(),</span> <span class="nb">nullptr</span><span class="p">));</span>

      <span class="n">CL_CHECK</span><span class="p">(</span><span class="n">clFinish</span><span class="p">(</span><span class="n">command_queue</span><span class="p">));</span>

      <span class="n">CL_CHECK</span><span class="p">(</span><span class="n">clReleaseEvent</span><span class="p">(</span><span class="n">write_src_event</span><span class="p">[</span><span class="mi">0</span><span class="p">]));</span>
      <span class="n">CL_CHECK</span><span class="p">(</span><span class="n">clReleaseEvent</span><span class="p">(</span><span class="n">write_src_event</span><span class="p">[</span><span class="mi">1</span><span class="p">]));</span>
    <span class="p">}</span>

    <span class="n">CL_CHECK</span><span class="p">(</span><span class="n">clReleaseCommandBufferKHR</span><span class="p">(</span><span class="n">command_buffer</span><span class="p">));</span>
    <span class="n">CL_CHECK</span><span class="p">(</span><span class="n">clReleaseCommandQueue</span><span class="p">(</span><span class="n">command_queue</span><span class="p">));</span>

    <span class="n">CL_CHECK</span><span class="p">(</span><span class="n">clReleaseMemObject</span><span class="p">(</span><span class="n">buffer_src1</span><span class="p">));</span>
    <span class="n">CL_CHECK</span><span class="p">(</span><span class="n">clReleaseMemObject</span><span class="p">(</span><span class="n">buffer_src2</span><span class="p">));</span>
    <span class="n">CL_CHECK</span><span class="p">(</span><span class="n">clReleaseMemObject</span><span class="p">(</span><span class="n">buffer_dst</span><span class="p">));</span>

    <span class="n">CL_CHECK</span><span class="p">(</span><span class="n">clReleaseMemObject</span><span class="p">(</span><span class="n">buffer_tile1</span><span class="p">));</span>
    <span class="n">CL_CHECK</span><span class="p">(</span><span class="n">clReleaseMemObject</span><span class="p">(</span><span class="n">buffer_tile2</span><span class="p">));</span>
    <span class="n">CL_CHECK</span><span class="p">(</span><span class="n">clReleaseMemObject</span><span class="p">(</span><span class="n">buffer_res</span><span class="p">));</span>

    <span class="n">CL_CHECK</span><span class="p">(</span><span class="n">clReleaseKernel</span><span class="p">(</span><span class="n">kernel</span><span class="p">));</span>
    <span class="n">CL_CHECK</span><span class="p">(</span><span class="n">clReleaseProgram</span><span class="p">(</span><span class="n">program</span><span class="p">));</span>
    <span class="n">CL_CHECK</span><span class="p">(</span><span class="n">clReleaseContext</span><span class="p">(</span><span class="n">context</span><span class="p">));</span>

    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
  <span class="p">}</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_issues_3"><a class="anchor" href="#_issues_3"></a>46.11. Issues</h3>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Introduce a <code>clCloneCommandBufferKHR</code> entry-point for cloning a
command-buffer.</p>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p><strong>UNRESOLVED</strong></p>
</div>
</div>
</div>
</li>
<li>
<p>Enable detached command-buffer execution, where command-buffers are executed
on their own internal queue to prevent locking user created queues for the
duration of their execution.</p>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p><strong>UNRESOLVED</strong></p>
</div>
</div>
</div>
</li>
</ol>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
This is a preview of an OpenCL provisional extension specification that has been Ratified under the Khronos Intellectual Property Framework. It is being made publicly available prior to being uploaded to the Khronos registry to enable review and feedback from the community. If you have feedback please create an issue on <a href="https://github.com/KhronosGroup/OpenCL-Docs/" class="bare">https://github.com/KhronosGroup/OpenCL-Docs/</a>
</td>
</tr>
</table>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="cl_khr_expect_assume"><a class="anchor" href="#cl_khr_expect_assume"></a>47. Kernel Optimization Hints</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This extension adds mechanisms to provide information to the compiler that may improve the performance of some kernels.
Specifically, this extension adds the ability to:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Tell the compiler the <em>expected</em> value of a variable.</p>
</li>
<li>
<p>Allow the compiler to <em>assume</em> a condition is true.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>These functions are not required for functional correctness.</p>
</div>
<div class="paragraph">
<p>The initial version of this extension extends the OpenCL SPIR-V environment to support new instructions for offline compilation tool chains.
Similar functionality may be provided by some OpenCL C online compilation tool chains, but formal support in OpenCL C is not required by the initial version of the extension.</p>
</div>
<div class="sect2">
<h3 id="_general_information_46"><a class="anchor" href="#_general_information_46"></a>47.1. General information</h3>
<div class="sect3">
<h4 id="_name_strings_10"><a class="anchor" href="#_name_strings_10"></a>47.1.1. Name Strings</h4>
<div class="paragraph">
<p><code>cl_khr_expect_assume</code></p>
</div>
</div>
<div class="sect3">
<h4 id="_version_history_46"><a class="anchor" href="#_version_history_46"></a>47.1.2. Version History</h4>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 60%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><strong>Date</strong></th>
<th class="tableblock halign-left valign-top"><strong>Version</strong></th>
<th class="tableblock halign-left valign-top"><strong>Description</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">2021-11-10</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.0.0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">First assigned version.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="_dependencies_10"><a class="anchor" href="#_dependencies_10"></a>47.1.3. Dependencies</h4>
<div class="paragraph">
<p>This extension is written against the OpenCL Specifications Version V3.0.8.</p>
</div>
<div class="paragraph">
<p>The initial version of this extension extends the OpenCL SPIR-V environment to support new instructions.
Please refer to the OpenCL SPIR-V Environment Specification that describes how this extension modifies the OpenCL SPIR-V environment.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_sample_code_2"><a class="anchor" href="#_sample_code_2"></a>47.2. Sample Code</h3>
<div class="paragraph">
<p>Although this extension does not formally extend OpenCL C, the ability to provide <em>expect</em> and <em>assume</em> information is supported by many OpenCL C compiler tool chains.
The sample code below describes how to test for and provide <em>expect</em> and <em>assume</em> information to compilers based on Clang:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="opencl_c"><span class="c1">// __has_builtin is an optional compiler feature that is supported by Clang.</span>
<span class="c1">// If this feature is not supported, we will assume the builtin is not present.</span>
<span class="cp">#ifndef __has_builtin
#define __has_builtin(x)    0
#endif
</span>
<span class="nx">kernel</span> <span class="kt">void</span> <span class="nf">test</span><span class="p">(</span><span class="nx">global</span> <span class="kt">int</span><span class="o">*</span> <span class="n">dst</span><span class="p">,</span> <span class="nx">global</span> <span class="kt">int</span><span class="o">*</span> <span class="n">src</span><span class="p">)</span>
<span class="p">{</span>
    <span class="kt">int</span> <span class="n">value</span> <span class="o">=</span> <span class="n">src</span><span class="p">[</span><span class="fm">get_global_id</span><span class="p">(</span><span class="mi">0</span><span class="p">)];</span>

    <span class="c1">// Tell the compiler that the most likely source value is zero.</span>
<span class="cp">#if __has_builtin(__builtin_expect)
</span>    <span class="n">value</span> <span class="o">=</span> <span class="n">__builtin_expect</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
<span class="cp">#endif
</span>
    <span class="c1">// Tell the compiler that the source value is non-negative.</span>
    <span class="c1">// Behavior is undefined if the source value is actually negative.</span>
<span class="cp">#if __has_builtin(__builtin_assume)
</span>    <span class="n">__builtin_assume</span><span class="p">(</span><span class="n">value</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">);</span>
<span class="cp">#endif
</span>
    <span class="n">dst</span><span class="p">[</span><span class="fm">get_global_id</span><span class="p">(</span><span class="mi">0</span><span class="p">)]</span> <span class="o">=</span> <span class="n">value</span> <span class="o">%</span> <span class="mi">4</span><span class="p">;</span>
<span class="p">}</span></code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="cl_khr_subgroup_rotate"><a class="anchor" href="#cl_khr_subgroup_rotate"></a>48. Subgroup Rotation</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This extension adds support for a new subgroup data exchange operation that
makes it possible to rotate values through the work items in a subgroup.</p>
</div>
<div class="sect2">
<h3 id="_general_information_47"><a class="anchor" href="#_general_information_47"></a>48.1. General Information</h3>
<div class="sect3">
<h4 id="_name_strings_11"><a class="anchor" href="#_name_strings_11"></a>48.1.1. Name Strings</h4>
<div class="paragraph">
<p><code>cl_khr_subgroup_rotate</code></p>
</div>
</div>
<div class="sect3">
<h4 id="_version_history_47"><a class="anchor" href="#_version_history_47"></a>48.1.2. Version History</h4>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 60%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><strong>Date</strong></th>
<th class="tableblock halign-left valign-top"><strong>Version</strong></th>
<th class="tableblock halign-left valign-top"><strong>Description</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">2022-04-22</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.0.0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Initial version.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="_dependencies_11"><a class="anchor" href="#_dependencies_11"></a>48.1.3. Dependencies</h4>
<div class="paragraph">
<p>This extension is written against the OpenCL Specification Version 3.0.10,
and OpenCL C Specification Version 3.0.10 and OpenCL Environment Specification
Version 3.0.10.</p>
</div>
<div class="paragraph">
<p>This extension requires OpenCL 2.0.</p>
</div>
</div>
<div class="sect3">
<h4 id="_contributors_7"><a class="anchor" href="#_contributors_7"></a>48.1.4. Contributors</h4>
<div class="paragraph">
<p>Kvin Petit, Arm Ltd.<br>
Ben Ashbaugh, Intel<br>
Ruihao Zhang, Qualcomm<br>
Sven van Haastregt, Arm Ltd.<br>
Anastasia Stulova, Arm Ltd.<br>
Stuart Brady, Arm Ltd.<br></p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_new_opencl_c_functions_3"><a class="anchor" href="#_new_opencl_c_functions_3"></a>48.2. New OpenCL C Functions</h3>
<div class="paragraph">
<p>This extension adds the following built-in function:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="opencl_c"><span class="kp">gentype</span> <span class="n">sub_group_rotate</span><span class="p">(</span><span class="kp">gentype</span> <span class="n">value</span><span class="p">,</span> <span class="kt">int</span> <span class="n">delta</span><span class="p">)</span>
<span class="kp">gentype</span> <span class="n">sub_group_clustered_rotate</span><span class="p">(</span><span class="kp">gentype</span> <span class="n">value</span><span class="p">,</span> <span class="kt">int</span> <span class="n">delta</span><span class="p">,</span> <span class="kt">uint</span> <span class="n">clustersize</span><span class="p">)</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_modifications_to_the_opencl_c_specification_3"><a class="anchor" href="#_modifications_to_the_opencl_c_specification_3"></a>48.3. Modifications to the OpenCL C Specification</h3>
<div class="dlist">
<dl>
<dt class="hdlist1">(Add a new section 6.15.x, <strong>Subgroup Rotation</strong>) </dt>
<dd>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The following preprocessor definitions are added:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="opencl_c"><span class="cp">#define cl_khr_subgroup_rotate 1</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The table below describes a specialized OpenCL C programming language built-in
function that allow work items in a subgroup to exchange data. This function
need not be encountered by all work items in a subgroup executing the kernel.
For the functions below, the generic type name <code>gentype</code> may be one of the
supported built-in scalar data types <code>char</code>, <code>uchar</code>, <code>short</code>, <code>ushort</code>, <code>int</code>,
<code>uint</code>, <code>long</code>, <code>ulong</code>, <code>float</code>, <code>double</code> (if double precision is supported),
or <code>half</code> (if half precision is supported).</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><strong>Function</strong></th>
<th class="tableblock halign-left valign-top"><strong>Description</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="opencl_c"><span class="kp">gentype</span> <span class="n">sub_group_rotate</span><span class="p">(</span>
    <span class="kp">gentype</span> <span class="n">value</span><span class="p">,</span> <span class="kt">int</span> <span class="n">delta</span><span class="p">)</span></code></pre>
</div>
</div></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Returns <em>value</em> for the work item with subgroup local ID equal to the remainder
of the division of the sum of this work item&#8217;s subgroup local ID and <em>delta</em> by
the maximum subgroup size.<br>
The value of <em>delta</em> is required to be dynamically-uniform for all work items in
the subgroup, otherwise the behavior is undefined.</p>
<p class="tableblock">The return value is undefined if the work item with subgroup local ID equal to the
calculated index is inactive.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="opencl_c"><span class="kp">gentype</span> <span class="n">sub_group_clustered_rotate</span><span class="p">(</span>
    <span class="kp">gentype</span> <span class="n">value</span><span class="p">,</span> <span class="kt">int</span> <span class="n">delta</span><span class="p">,</span>
    <span class="kt">uint</span> <span class="n">clustersize</span><span class="p">)</span></code></pre>
</div>
</div></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Returns <em>value</em> for the work item with subgroup local ID equal to the sum of, the
remainder of the division of the sum of this work item&#8217;s ID within the cluster and
<em>delta</em> by <em>clustersize</em>, and the subgroup local ID of the first work-item of the
cluster to which the work-item executing the function belongs.<br>
The value of <em>delta</em> is required to be dynamically-uniform for all work items in
the subgroup, otherwise the behavior is undefined.</p>
<p class="tableblock"><em>clustersize</em> must be an integer constant expression and a power of two, smaller
than or equal to the maximum subgroup size, otherwise the behavior is undefined.</p>
<p class="tableblock">The return value is undefined if the work item with subgroup local ID equal to the
calculated index is inactive.</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</dd>
</dl>
</div>
</div>
<div class="sect2">
<h3 id="_modifications_to_the_opencl_spir_v_environment_specification_2"><a class="anchor" href="#_modifications_to_the_opencl_spir_v_environment_specification_2"></a>48.4. Modifications to the OpenCL SPIR-V Environment Specification</h3>
<div class="paragraph">
<p>See OpenCL SPIR-V Environment Specification.</p>
</div>
</div>
<div class="sect2">
<h3 id="_interactions_with_other_extensions_3"><a class="anchor" href="#_interactions_with_other_extensions_3"></a>48.5. Interactions with Other Extensions</h3>
<div class="paragraph">
<p>If <code>cl_khr_il_program</code> is supported then the SPIR-V environment specification
modifications described above apply.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="cl_khr_work_group_uniform_arithmetic"><a class="anchor" href="#cl_khr_work_group_uniform_arithmetic"></a>49. Work Group Uniform Arithmetic</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This extension adds additional work-group collective functions to OpenCL C.
Specifically, this extension adds support for work-group scans and reductions for the following operators:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Logical operations (<code>and</code>, <code>or</code>, and <code>xor</code>).</p>
</li>
<li>
<p>Bitwise operations (<code>and</code>, <code>or</code>, and <code>xor</code>).</p>
</li>
<li>
<p>Integer multiplication (<code>mul</code>).</p>
</li>
<li>
<p>Floating-point multiplication (<code>mul</code>).</p>
</li>
</ul>
</div>
<div class="sect2">
<h3 id="_general_information_48"><a class="anchor" href="#_general_information_48"></a>49.1. General Information</h3>
<div class="sect3">
<h4 id="_name_strings_12"><a class="anchor" href="#_name_strings_12"></a>49.1.1. Name Strings</h4>
<div class="paragraph">
<p><code>cl_khr_work_group_uniform_arithmetic</code></p>
</div>
</div>
<div class="sect3">
<h4 id="_version_history_48"><a class="anchor" href="#_version_history_48"></a>49.1.2. Version History</h4>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 60%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><strong>Date</strong></th>
<th class="tableblock halign-left valign-top"><strong>Version</strong></th>
<th class="tableblock halign-left valign-top"><strong>Description</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">2022-04-29</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.0.0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Initial version.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="_dependencies_12"><a class="anchor" href="#_dependencies_12"></a>49.1.3. Dependencies</h4>
<div class="paragraph">
<p>This extension is written against the OpenCL Specification
Version 3.0.10.</p>
</div>
<div class="paragraph">
<p>This extension requires OpenCL 2.0.</p>
</div>
</div>
<div class="sect3">
<h4 id="_contributors_8"><a class="anchor" href="#_contributors_8"></a>49.1.4. Contributors</h4>
<div class="paragraph">
<p>Kevin Petit, Arm Ltd.<br>
Ben Ashbaugh, Intel<br></p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_new_opencl_c_functions_4"><a class="anchor" href="#_new_opencl_c_functions_4"></a>49.2. New OpenCL C Functions</h3>
<div class="paragraph">
<p>The following functions are added to OpenCL C.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="opencl_c"><span class="kt">int</span> <span class="nf">work_group_reduce_logical_and</span><span class="p">(</span><span class="kt">int</span> <span class="n">predicate</span><span class="p">);</span>
<span class="kt">int</span> <span class="nf">work_group_reduce_logical_or</span><span class="p">(</span><span class="kt">int</span> <span class="n">predicate</span><span class="p">);</span>
<span class="kt">int</span> <span class="nf">work_group_reduce_logical_xor</span><span class="p">(</span><span class="kt">int</span> <span class="n">predicate</span><span class="p">);</span>

<span class="kt">int</span> <span class="nf">work_group_scan_inclusive_logical_and</span><span class="p">(</span><span class="kt">int</span> <span class="n">predicate</span><span class="p">);</span>
<span class="kt">int</span> <span class="nf">work_group_scan_inclusive_logical_or</span><span class="p">(</span><span class="kt">int</span> <span class="n">predicate</span><span class="p">);</span>
<span class="kt">int</span> <span class="nf">work_group_scan_inclusive_logical_xor</span><span class="p">(</span><span class="kt">int</span> <span class="n">predicate</span><span class="p">);</span>

<span class="kt">int</span> <span class="nf">work_group_scan_exclusive_logical_and</span><span class="p">(</span><span class="kt">int</span> <span class="n">predicate</span><span class="p">);</span>
<span class="kt">int</span> <span class="nf">work_group_scan_exclusive_logical_or</span><span class="p">(</span><span class="kt">int</span> <span class="n">predicate</span><span class="p">);</span>
<span class="kt">int</span> <span class="nf">work_group_scan_exclusive_logical_xor</span><span class="p">(</span><span class="kt">int</span> <span class="n">predicate</span><span class="p">);</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>For the following functions, the generic type name <code>gentype</code> may be one of the supported built-in scalar data types <code>int</code>, <code>uint</code>, <code>long</code>, or <code>ulong</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="opencl_c"><span class="kp">gentype</span> <span class="nf">work_group_reduce_and</span><span class="p">(</span><span class="kp">gentype</span> <span class="n">value</span><span class="p">);</span>
<span class="kp">gentype</span> <span class="nf">work_group_reduce_or</span><span class="p">(</span><span class="kp">gentype</span> <span class="n">value</span><span class="p">);</span>
<span class="kp">gentype</span> <span class="nf">work_group_reduce_xor</span><span class="p">(</span><span class="kp">gentype</span> <span class="n">value</span><span class="p">);</span>

<span class="kp">gentype</span> <span class="nf">work_group_scan_inclusive_and</span><span class="p">(</span><span class="kp">gentype</span> <span class="n">value</span><span class="p">);</span>
<span class="kp">gentype</span> <span class="nf">work_group_scan_inclusive_or</span><span class="p">(</span><span class="kp">gentype</span> <span class="n">value</span><span class="p">);</span>
<span class="kp">gentype</span> <span class="nf">work_group_scan_inclusive_xor</span><span class="p">(</span><span class="kp">gentype</span> <span class="n">value</span><span class="p">);</span>

<span class="kp">gentype</span> <span class="nf">work_group_scan_exclusive_and</span><span class="p">(</span><span class="kp">gentype</span> <span class="n">value</span><span class="p">);</span>
<span class="kp">gentype</span> <span class="nf">work_group_scan_exclusive_or</span><span class="p">(</span><span class="kp">gentype</span> <span class="n">value</span><span class="p">);</span>
<span class="kp">gentype</span> <span class="nf">work_group_scan_exclusive_xor</span><span class="p">(</span><span class="kp">gentype</span> <span class="n">value</span><span class="p">);</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>For the following functions, the generic type name <code>gentype</code> may be one of the supported built-in scalar data types <code>int</code>, <code>uint</code>, <code>long</code>, <code>ulong</code>, <code>float</code>, <code>double</code> (if double precision is supported), or <code>half</code> (if half precision is supported).</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="opencl_c"><span class="kp">gentype</span> <span class="nf">work_group_reduce_mul</span><span class="p">(</span><span class="kp">gentype</span> <span class="n">value</span><span class="p">);</span>
<span class="kp">gentype</span> <span class="nf">work_group_scan_inclusive_mul</span><span class="p">(</span><span class="kp">gentype</span> <span class="n">value</span><span class="p">);</span>
<span class="kp">gentype</span> <span class="nf">work_group_scan_exclusive_mul</span><span class="p">(</span><span class="kp">gentype</span> <span class="n">value</span><span class="p">);</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_modifications_to_the_opencl_c_specification_4"><a class="anchor" href="#_modifications_to_the_opencl_c_specification_4"></a>49.3. Modifications to the OpenCL C Specification</h3>
<div class="dlist">
<dl>
<dt class="hdlist1">(Add to Section 6.15.16, <strong>Work-group Collective Functions</strong>) </dt>
<dd>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The table below describes the OpenCL C programming language built-in functions that perform
logical arithmetic operations across work items in a work-group. These functions must be
encountered by all work items in a work-group executing the kernel, otherwise the behavior is
undefined. For these functions, a non-zero <em>predicate</em> argument or return value is logically
<code>true</code> and a zero <em>predicate</em> argument or return value is logically <code>false</code>.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 66.6666%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Function</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="opencl_c"><span class="kt">int</span> <span class="nf">work_group_reduce_logical_and</span><span class="p">(</span><span class="kt">int</span> <span class="n">predicate</span><span class="p">);</span>
<span class="kt">int</span> <span class="nf">work_group_reduce_logical_or</span><span class="p">(</span><span class="kt">int</span> <span class="n">predicate</span><span class="p">);</span>
<span class="kt">int</span> <span class="nf">work_group_reduce_logical_xor</span><span class="p">(</span><span class="kt">int</span> <span class="n">predicate</span><span class="p">);</span></code></pre>
</div>
</div></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Returns the logical <strong>and</strong>, <strong>or</strong>, or <strong>xor</strong> of <em>predicate</em> for all work items in the work-group.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="opencl_c"><span class="kt">int</span> <span class="nf">work_group_scan_inclusive_logical_and</span><span class="p">(</span><span class="kt">int</span> <span class="n">predicate</span><span class="p">);</span>
<span class="kt">int</span> <span class="nf">work_group_scan_inclusive_logical_or</span><span class="p">(</span><span class="kt">int</span> <span class="n">predicate</span><span class="p">);</span>
<span class="kt">int</span> <span class="nf">work_group_scan_inclusive_logical_xor</span><span class="p">(</span><span class="kt">int</span> <span class="n">predicate</span><span class="p">);</span></code></pre>
</div>
</div></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Returns the result of an inclusive scan operation, which is the logical
  <strong>and</strong>, <strong>or</strong>, or <strong>xor</strong> of <em>predicate</em> for all work items in the work-group with
  a work-group linear local ID less than or equal to this work items work-group
  linear local ID.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="c"><span class="kt">int</span> <span class="nf">work_group_scan_exclusive_logical_and</span><span class="p">(</span><span class="kt">int</span> <span class="n">predicate</span><span class="p">);</span>
<span class="kt">int</span> <span class="nf">work_group_scan_exclusive_logical_or</span><span class="p">(</span><span class="kt">int</span> <span class="n">predicate</span><span class="p">);</span>
<span class="kt">int</span> <span class="nf">work_group_scan_exclusive_logical_xor</span><span class="p">(</span><span class="kt">int</span> <span class="n">predicate</span><span class="p">);</span></code></pre>
</div>
</div></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Returns the result of an exclusive scan operation, which is the logical
  <strong>and</strong>, <strong>or</strong>, or <strong>xor</strong> of <em>predicate</em> for all work items in the work-group with
  a work-group linear local ID less than this work items work-group linear
  local ID.</p>
<p class="tableblock">  If there is no work item in the work-group with a work-group linear local ID
  less than this work items work-group linear local ID then an identity value
  <code>I</code> is returned. For <strong>and</strong>, the identity value is <code>true</code> (non-zero). For <strong>or</strong>
  and <strong>xor</strong>, the identity value is <code>false</code> (zero).</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>The table below describes the OpenCL C programming language built-in functions
that perform bitwise integer operations across work items in a work-group. These
functions must be encountered by all work items in a work-group executing the
kernel, otherwise the behavior is undefined. For the functions below, the
generic type name <code>gentype</code> may be one of the supported built-in scalar data
types <code>int</code>, <code>uint</code>, <code>long</code>, and <code>ulong</code>.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 66.6666%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Function</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="opencl_c"><span class="kp">gentype</span> <span class="nf">work_group_reduce_and</span><span class="p">(</span><span class="kp">gentype</span> <span class="n">value</span><span class="p">);</span>
<span class="kp">gentype</span> <span class="nf">work_group_reduce_or</span><span class="p">(</span><span class="kp">gentype</span> <span class="n">value</span><span class="p">);</span>
<span class="kp">gentype</span> <span class="nf">work_group_reduce_xor</span><span class="p">(</span><span class="kp">gentype</span> <span class="n">value</span><span class="p">);</span></code></pre>
</div>
</div></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Returns the bitwise <strong>and</strong>, <strong>or</strong>, or <strong>xor</strong> of <em>value</em> for all work items in the work-group.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="opencl_c"><span class="kp">gentype</span> <span class="nf">work_group_scan_inclusive_and</span><span class="p">(</span><span class="kp">gentype</span> <span class="n">value</span><span class="p">);</span>
<span class="kp">gentype</span> <span class="nf">work_group_scan_inclusive_or</span><span class="p">(</span><span class="kp">gentype</span> <span class="n">value</span><span class="p">);</span>
<span class="kp">gentype</span> <span class="nf">work_group_scan_inclusive_xor</span><span class="p">(</span><span class="kp">gentype</span> <span class="n">value</span><span class="p">);</span></code></pre>
</div>
</div></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Returns the result of an inclusive scan operation, which is the bitwise <strong>and</strong>,
  <strong>or</strong>, or <strong>xor</strong> of <em>value</em> for all work items in the work-group with a
  work-group linear local ID less than or equal to this work items work-group
  linear local ID.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="opencl_c"><span class="kp">gentype</span> <span class="nf">work_group_scan_exclusive_and</span><span class="p">(</span><span class="kp">gentype</span> <span class="n">value</span><span class="p">);</span>
<span class="kp">gentype</span> <span class="nf">work_group_scan_exclusive_or</span><span class="p">(</span><span class="kp">gentype</span> <span class="n">value</span><span class="p">);</span>
<span class="kp">gentype</span> <span class="nf">work_group_scan_exclusive_xor</span><span class="p">(</span><span class="kp">gentype</span> <span class="n">value</span><span class="p">);</span></code></pre>
</div>
</div></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Returns the result of an exclusive scan operation, which is the bitwise <strong>and</strong>,
  <strong>or</strong>, or <strong>xor</strong> of <em>value</em> for all work items in the work-group with a
  work-group linear local ID less than this work items work-group linear local
  ID.</p>
<p class="tableblock">  If there is no work item in the work-group with a work-group linear local ID less than
  this work items work-group linear local ID then an identity value <code>I</code> is returned.
  For <strong>and</strong>, the identity value is <code>~0</code> (all bits set). For <strong>or</strong> and <strong>xor</strong>, the identity
  value is <code>0</code>.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>The table below describes the OpenCL C programming language built-in functions
that perform multiplicative operations across work items in a work-group. These
functions must be encountered by all work items in a work-group executing the
kernel, otherwise the behavior is undefined. For the functions below, the
generic type name <code>gentype</code> may be one of the supported built-in scalar data
types <code>int</code>, <code>uint</code>, <code>long</code>, <code>ulong</code>, <code>float</code>, <code>double</code> (if double precision is
supported), or <code>half</code> (if half precision is supported).</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 66.6666%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Function</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="opencl_c"><span class="kp">gentype</span> <span class="nf">work_group_reduce_mul</span><span class="p">(</span><span class="kp">gentype</span> <span class="n">value</span><span class="p">);</span></code></pre>
</div>
</div></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Returns the multiplication of <em>value</em> for all work items in the work-group.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="opencl_c"><span class="kp">gentype</span> <span class="nf">work_group_scan_inclusive_mul</span><span class="p">(</span><span class="kp">gentype</span> <span class="n">value</span><span class="p">);</span></code></pre>
</div>
</div></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Returns the result of an inclusive scan operation which is the multiplication
  of <em>value</em> for all work items in the work-group with a work-group linear local
  ID less than or equal to this work items work-group linear local ID.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="opencl_c"><span class="kp">gentype</span> <span class="nf">work_group_scan_exclusive_mul</span><span class="p">(</span><span class="kp">gentype</span> <span class="n">value</span><span class="p">);</span></code></pre>
</div>
</div></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Returns the result of an exclusive scan operation which is the multiplication
  of <em>value</em> for all work items in the work-group with a work-group linear local
  ID less than this work items work-group linear local ID.</p>
<p class="tableblock">  If there is no work item in the work-group with a work-group linear local ID
  less than this work items work-group linear local ID then the identity value
  <code>1</code> is returned.</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</dd>
</dl>
</div>
</div>
<div class="sect2">
<h3 id="_issues_4"><a class="anchor" href="#_issues_4"></a>49.4. Issues</h3>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>For these built-in functions, do we only want to support the types supported by the existing work-group collective functions, or do we want to support the types supported by the sub-group collective functions?</p>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p><code>RESOLVED</code>: The extension will require the same types as the existing work-group collective functions.</p>
</div>
<div class="paragraph">
<p>The difference are the 8-bit and 16-bit types: <code>char</code>, <code>uchar</code>, <code>short</code>, and <code>ushort</code>.  Note that <code>half</code> is already supported, if half-precision is supported.</p>
</div>
</div>
</div>
</li>
</ol>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="cl_khr_command_buffer_mutable_dispatch"><a class="anchor" href="#cl_khr_command_buffer_mutable_dispatch"></a>50. Command Buffers - Mutable Dispatch (Provisional)</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This extension enables users to modify the configuration of kernel execution
commands between command-buffer enqueues.</p>
</div>
<div class="sect2">
<h3 id="_general_information_49"><a class="anchor" href="#_general_information_49"></a>50.1. General Information</h3>
<div class="sect3">
<h4 id="_name_strings_13"><a class="anchor" href="#_name_strings_13"></a>50.1.1. Name Strings</h4>
<div class="paragraph">
<p><code>cl_khr_command_buffer_mutable_dispatch</code></p>
</div>
</div>
<div class="sect3">
<h4 id="_version_history_49"><a class="anchor" href="#_version_history_49"></a>50.1.2. Version History</h4>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 60%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><strong>Date</strong></th>
<th class="tableblock halign-left valign-top"><strong>Version</strong></th>
<th class="tableblock halign-left valign-top"><strong>Description</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">2022-08-31</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.9.0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">First assigned version (provisional).</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="_dependencies_13"><a class="anchor" href="#_dependencies_13"></a>50.1.3. Dependencies</h4>
<div class="paragraph">
<p>This extension requires the <code>cl_khr_command_buffer</code> extension version 0.9.0.</p>
</div>
</div>
<div class="sect3">
<h4 id="_contributors_9"><a class="anchor" href="#_contributors_9"></a>50.1.4. Contributors</h4>
<div class="paragraph">
<p>Ewan Crawford, Codeplay Software Ltd.<br>
Gordon Brown, Codeplay Software Ltd.<br>
Kenneth Benzie, Codeplay Software Ltd.<br>
Alastair Murray, Codeplay Software Ltd.<br>
Jack Frankland, Codeplay Software Ltd.<br>
Balaji Calidas, Qualcomm Technologies Inc.<br>
Joshua Kelly, Qualcomm Technologies, Inc.<br>
Kevin Petit, Arm Ltd.<br>
Aharon Abramson, Intel.<br>
Ben Ashbaugh, Intel.<br>
Boaz Ouriel, Intel.<br>
Pekka Jskelinen, Tampere University<br>
Jan Solanti, Tampere University<br>
Nikhil Joshi, NVIDIA<br>
James Price, Google<br></p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_overview_3"><a class="anchor" href="#_overview_3"></a>50.2. Overview</h3>
<div class="paragraph">
<p>The <code>cl_khr_command_buffer</code> extension separates command construction from
enqueue by providing a mechanism to record a set of commands which can then be
repeatedly enqueued. However, the commands recorded to the command-buffer are
immutable between enqueues.</p>
</div>
<div class="paragraph">
<p><code>cl_khr_command_buffer_mutable_dispatch</code> removes this restriction, in particular,
this extension allows the configuration of a kernel execution command in a
command-buffer, called a <em>mutable-dispatch</em>, to be modified. This allows inputs
and outputs to the kernel, as well as work-item sizes and offsets, to change
without having to re-record the entire command sequence in a new command-buffer.</p>
</div>
</div>
<div class="sect2">
<h3 id="_interactions_with_other_extensions_4"><a class="anchor" href="#_interactions_with_other_extensions_4"></a>50.3. Interactions with Other Extensions</h3>
<div class="paragraph">
<p>The <code>cl_command_<wbr>buffer_<wbr>structure_<wbr>type_<wbr>khr</code> type has been added to this
extension for the purpose of allowing expansion of mutable functionality in
future extensions layered on top of <code>cl_khr_command_buffer_mutable_dispatch</code>.
Any parameter that is a structure containing a <code>void* next</code> member <strong>must</strong> have
a value of <code>next</code> that is either <code>NULL</code>, or is a pointer to a valid structure
defined by <code>cl_khr_command_buffer_mutable_dispatch</code> or an extension layered on
top. To be a valid structure in the pointer chain the first member of the
structure <strong>must</strong> be a <code>cl_command_<wbr>buffer_<wbr>structure_<wbr>type_<wbr>khr</code> identifier for the
structure being iterated through, and the second member a <code>void* next</code> pointer
to the next structure in the chain.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>This approach is based on structure pointer chains in Vulkan, for more details
see the "Valid Usage for Structure Pointer Chains" section of the Vulkan
specification.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>This is designed so that another extension layered on
<code>cl_khr_command_buffer_mutable_dispatch</code> could allow modification of commands
recorded to a command-buffer other than kernel execution commands. As all
command recording entry-points return a <code>cl_mutable_<wbr>command_<wbr>khr</code> handle, and
aspects like which <code>cl_mem</code> object a command uses could also be updated between
enqueues of the command-buffer.</p>
</div>
</div>
<div class="sect2">
<h3 id="_new_types_5"><a class="anchor" href="#_new_types_5"></a>50.4. New Types</h3>
<div class="sect3">
<h4 id="_mutable_command_types"><a class="anchor" href="#_mutable_command_types"></a>50.4.1. Mutable Command Types</h4>
<div class="paragraph">
<p>Types for using mutable-commands objects from
<a href="#mutable-commands">Section 5.X.5</a>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="opencl"><span class="c1">// Bitfield covering each aspect of a mutable-dispatch which can be updated</span>
<span class="k">typedef</span> <span class="kt">cl_bitfield</span> <span class="kt">cl_mutable_dispatch_fields_khr</span><span class="p">;</span>

<span class="c1">// For querying mutable-command objects with clGetMutableCommandInfoKHR</span>
<span class="k">typedef</span> <span class="kt">cl_uint</span> <span class="kt">cl_mutable_command_info_khr</span><span class="p">;</span>

<span class="c1">// Identifies the type of a structure to allow structure pointer chains</span>
<span class="k">typedef</span> <span class="kt">cl_uint</span> <span class="kt">cl_command_buffer_structure_type_khr</span><span class="p">;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Struct type for setting kernel arguments normally passed using <strong>clSetKernelArg</strong>
and <strong>clSetKernelArgSVMPointer</strong>:</p>
</div>
<div id="cl_mutable_dispatch_arg_khr" class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="opencl"><span class="k">typedef</span> <span class="k">struct</span> <span class="nc">cl_mutable_dispatch_arg_khr</span> <span class="p">{</span>
    <span class="kt">cl_uint</span>        <span class="n">arg_index</span><span class="p">;</span>
    <span class="kt">size_t</span>         <span class="n">arg_size</span><span class="p">;</span>
    <span class="k">const</span> <span class="kt">void</span><span class="o">*</span>    <span class="n">arg_value</span><span class="p">;</span>
<span class="p">}</span> <span class="kt">cl_mutable_dispatch_arg_khr</span><span class="p">;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Struct type for setting kernel execution info normally passed using
<strong>clSetKernelExecInfo</strong>:</p>
</div>
<div id="cl_mutable_dispatch_exec_info_khr" class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="opencl"><span class="k">typedef</span> <span class="k">struct</span> <span class="nc">cl_mutable_dispatch_exec_info_khr</span> <span class="p">{</span>
    <span class="kt">cl_uint</span>        <span class="n">param_name</span><span class="p">;</span>
    <span class="kt">size_t</span>         <span class="n">param_value_size</span><span class="p">;</span>
    <span class="k">const</span> <span class="kt">void</span><span class="o">*</span>    <span class="n">param_value</span><span class="p">;</span>
<span class="p">}</span> <span class="kt">cl_mutable_dispatch_exec_info_khr</span><span class="p">;</span></code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p><em>param_name</em> is of type <code>cl_uint</code> rather than <code>cl_kernel_<wbr>exec_<wbr>info</code> so that the
extension can be implemented on OpenCL 1.2 where the <code>cl_kernel_<wbr>exec_<wbr>info</code>
typedef is unavailable.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Struct type passed to <strong>clUpdateMutableCommandsKHR</strong> for setting the kernel
configuration of a mutable <strong>clCommandNDRangeKernelKHR</strong> command:</p>
</div>
<div id="cl_mutable_dispatch_config_khr" class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="opencl"><span class="k">typedef</span> <span class="k">struct</span> <span class="nc">cl_mutable_dispatch_config_khr</span> <span class="p">{</span>
    <span class="kt">cl_command_buffer_structure_type_khr</span>        <span class="n">type</span><span class="p">;</span>
    <span class="k">const</span> <span class="kt">void</span><span class="o">*</span>                                 <span class="n">next</span><span class="p">;</span>
    <span class="kt">cl_mutable_command_khr</span>                      <span class="n">command</span><span class="p">;</span>
    <span class="kt">cl_uint</span>                                     <span class="n">num_args</span><span class="p">;</span>
    <span class="kt">cl_uint</span>                                     <span class="n">num_svm_args</span><span class="p">;</span>
    <span class="kt">cl_uint</span>                                     <span class="n">num_exec_infos</span><span class="p">;</span>
    <span class="kt">cl_uint</span>                                     <span class="n">work_dim</span><span class="p">;</span>
    <span class="k">const</span> <span class="kt">cl_mutable_dispatch_arg_khr</span><span class="o">*</span>          <span class="n">arg_list</span><span class="p">;</span>
    <span class="k">const</span> <span class="kt">cl_mutable_dispatch_arg_khr</span><span class="o">*</span>          <span class="n">arg_svm_list</span><span class="p">;</span>
    <span class="k">const</span> <span class="kt">cl_mutable_dispatch_exec_info_khr</span><span class="o">*</span>    <span class="n">exec_info_list</span><span class="p">;</span>
    <span class="k">const</span> <span class="kt">size_t</span><span class="o">*</span>                               <span class="n">global_work_offset</span><span class="p">;</span>
    <span class="k">const</span> <span class="kt">size_t</span><span class="o">*</span>                               <span class="n">global_work_size</span><span class="p">;</span>
    <span class="k">const</span> <span class="kt">size_t</span><span class="o">*</span>                               <span class="n">local_work_size</span><span class="p">;</span>
<span class="p">}</span> <span class="kt">cl_mutable_dispatch_config_khr</span><span class="p">;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p><em>type</em> Type of this structure, must be
<code>CL_STRUCTURE_<wbr>TYPE_<wbr>MUTABLE_<wbr>DISPATCH_<wbr>CONFIG_<wbr>KHR</code>.</p>
</div>
<div class="paragraph">
<p><em>next</em> Is <code>NULL</code> or a pointer to an extending structure.</p>
</div>
<div class="paragraph">
<p><em>command</em> A mutable-command object returned by <strong>clCommandNDRangeKernelKHR</strong>
representing a kernel execution as part of a command-buffer.</p>
</div>
<div class="paragraph">
<p><em>num_args</em> Is the number of kernel arguments being changed.</p>
</div>
<div class="paragraph">
<p><em>num_svm_args</em> Is the number of SVM kernel arguments being changed.</p>
</div>
<div class="paragraph">
<p><em>num_exec_infos</em> Is the number of kernel execution info objects to set for
this dispatch.</p>
</div>
<div class="paragraph">
<p><em>work_dim</em> Is the number of dimensions used to specify the global work-items
and work-items in the work-group. See <strong>clEnqueueNDRangeKernel</strong> for valid usage.</p>
</div>
<div class="paragraph">
<p><em>arg_list</em> Is an array describing the new kernel arguments for this enqueue. It
must contain <em>num_args</em> array elements, each of which encapsulates parameters
passed to <strong>clSetKernelArg</strong>. See <strong>clSetKernelArg</strong> for usage of
<code>cl_mutable_<wbr>dispatch_<wbr>arg_<wbr>khr</code> members.</p>
</div>
<div class="paragraph">
<p><em>arg_svm_list</em> is an array describing the new SVM kernel arguments for this
enqueue. It must contain <em>num_svm_args</em> array elements, each of which
encapsulates parameters passed to <strong>clSetKernelArgSVMPointer</strong>. See
<strong>clSetKernelArgSVMPointer</strong> for usage of
<code>cl_mutable_<wbr>dispatch_<wbr>arg_<wbr>khr</code> members,
<code>arg_size</code> is ignored.</p>
</div>
<div class="paragraph">
<p><em>exec_info_list</em> Is an array containing <em>num_exec_infos</em> elements
specifying the list of execution info objects use for this command-buffer
enqueue. See <strong>clSetKernelExecInfo</strong> for usage of
<code>cl_mutable_<wbr>dispatch_<wbr>exec_<wbr>info_<wbr>khr</code>
members.</p>
</div>
<div class="paragraph">
<p><em>global_work_offset</em> Can be used to specify an array of <em>work_dim</em> unsigned
values that describe the offset used to calculate the global ID of a work-item.
If <em>global_work_offset</em> is <code>NULL</code> then the global offset of the dispatch is not
changed. See <strong>clEnqueueNDRangeKernel</strong> for valid usage.</p>
</div>
<div class="paragraph">
<p><em>global_work_size</em> Points to an array of <em>work_dim</em> unsigned values that
describe the number of global work-items in <em>work_dim</em> dimensions that will
execute the kernel function. If <em>global_work_size</em> is <code>NULL</code> then the number of
global work-items in the dispatch is not changed. See <strong>clEnqueueNDRangeKernel</strong>
for valid usage.</p>
</div>
<div class="paragraph">
<p><em>local_work_size</em> Points to an array of <em>work_dim</em> unsigned values that
describe the number of work-items that make up a work-group that will execute
the kernel. If <em>local_work_size</em> is <code>NULL</code> then the number of local work-items
in the dispatch is not changed. See <strong>clEnqueueNDRangeKernel</strong> for valid usage.</p>
</div>
<div id="cl_mutable_base_config_khr" class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="opencl"><span class="k">typedef</span> <span class="k">struct</span> <span class="nc">_cl_mutable_base_config_khr</span> <span class="p">{</span>
    <span class="kt">cl_command_buffer_structure_type_khr</span> <span class="n">type</span><span class="p">,</span>
    <span class="k">const</span> <span class="kt">void</span><span class="o">*</span> <span class="n">next</span><span class="p">,</span>
    <span class="kt">cl_uint</span> <span class="n">num_mutable_dispatch</span><span class="p">,</span>
    <span class="k">const</span> <span class="kt">cl_mutable_dispatch_config_khr</span><span class="o">*</span> <span class="n">mutable_dispatch_list</span>
<span class="p">}</span> <span class="kt">cl_mutable_base_config_khr</span><span class="p">;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p><em>type</em> Type of this structure, must be
<code>CL_STRUCTURE_<wbr>TYPE_<wbr>MUTABLE_<wbr>BASE_<wbr>CONFIG_<wbr>KHR</code></p>
</div>
<div class="paragraph">
<p><em>next</em> Is <code>NULL</code> or a pointer to an extending structure.</p>
</div>
<div class="paragraph">
<p><em>num_mutable_dispatch</em> Is the number of mutable-dispatch objects to configure
in this enqueue of the command-buffer.</p>
</div>
<div class="paragraph">
<p><em>mutable_dispatch_list</em> Is an array containing <em>num_mutable_dispatch</em> elements
describing the configurations of mutable kernel execution commands in the
command-buffer. For a description of struct members making up each array
element see <code>cl_mutable_<wbr>dispatch_<wbr>config_<wbr>khr</code>.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_new_api_functions_7"><a class="anchor" href="#_new_api_functions_7"></a>50.5. New API Functions</h3>
<div class="paragraph">
<p>Mutable-handle entry points from <a href="#mutable-commands">Section 5.X.5</a>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="opencl"><span class="kt">cl_int</span> <span class="nf">clUpdateMutableCommandsKHR</span><span class="p">(</span>
    <span class="kt">cl_command_buffer_khr</span> <span class="n">command_buffer</span><span class="p">,</span>
    <span class="k">const</span> <span class="kt">cl_mutable_base_config_khr</span><span class="o">*</span> <span class="n">mutable_config</span><span class="p">);</span>

<span class="kt">cl_int</span> <span class="nf">clGetMutableCommandInfoKHR</span><span class="p">(</span>
    <span class="kt">cl_mutable_command_khr</span> <span class="n">command</span><span class="p">,</span>
    <span class="kt">cl_mutable_command_info_khr</span> <span class="n">param_name</span><span class="p">,</span>
    <span class="kt">size_t</span> <span class="n">param_value_size</span><span class="p">,</span>
    <span class="kt">void</span><span class="o">*</span> <span class="n">param_value</span><span class="p">,</span>
    <span class="kt">size_t</span><span class="o">*</span> <span class="n">param_value_size_ret</span><span class="p">);</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_new_api_enums_8"><a class="anchor" href="#_new_api_enums_8"></a>50.6. New API Enums</h3>
<div class="paragraph">
<p>Enums for working with mutable-command objects from
<a href="#mutable-commands">Section 5.X.5</a>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="opencl"><span class="c1">// Error code</span>
<span class="n">CL_INVALID_MUTABLE_COMMAND_KHR</span>                     <span class="o">-</span><span class="mi">1141</span>

<span class="c1">// Accepted values for the param_name parameter to clGetDeviceInfo</span>
<span class="n">CL_DEVICE_MUTABLE_DISPATCH_CAPABILITIES_KHR</span>        <span class="mh">0x12B0</span>

<span class="c1">// Property to cl_ndrange_kernel_command_properties_khr</span>
<span class="n">CL_MUTABLE_DISPATCH_UPDATABLE_FIELDS_KHR</span>           <span class="mh">0x12B1</span>

<span class="c1">// Bits for cl_mutable_dispatch_fields_khr bitfield</span>
<span class="n">CL_MUTABLE_DISPATCH_GLOBAL_OFFSET_KHR</span>              <span class="p">(</span><span class="mh">0x1</span> <span class="o">&lt;&lt;</span> <span class="mi">0</span><span class="p">)</span>
<span class="n">CL_MUTABLE_DISPATCH_GLOBAL_SIZE_KHR</span>                <span class="p">(</span><span class="mh">0x1</span> <span class="o">&lt;&lt;</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">CL_MUTABLE_DISPATCH_LOCAL_SIZE_KHR</span>                 <span class="p">(</span><span class="mh">0x1</span> <span class="o">&lt;&lt;</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">CL_MUTABLE_DISPATCH_ARGUMENTS_KHR</span>                  <span class="p">(</span><span class="mh">0x1</span> <span class="o">&lt;&lt;</span> <span class="mi">3</span><span class="p">)</span>
<span class="n">CL_MUTABLE_DISPATCH_EXEC_INFO_KHR</span>                  <span class="p">(</span><span class="mh">0x1</span> <span class="o">&lt;&lt;</span> <span class="mi">4</span><span class="p">)</span>

<span class="c1">// cl_mutable_command_info_khr</span>
<span class="n">CL_MUTABLE_COMMAND_COMMAND_QUEUE_KHR</span>               <span class="mh">0x12A0</span>
<span class="n">CL_MUTABLE_COMMAND_COMMAND_BUFFER_KHR</span>              <span class="mh">0x12A1</span>
<span class="n">CL_MUTABLE_DISPATCH_PROPERTIES_ARRAY_KHR</span>           <span class="mh">0x12A2</span>
<span class="n">CL_MUTABLE_DISPATCH_KERNEL_KHR</span>                     <span class="mh">0x12A3</span>
<span class="n">CL_MUTABLE_DISPATCH_DIMENSIONS_KHR</span>                 <span class="mh">0x12A4</span>
<span class="n">CL_MUTABLE_DISPATCH_GLOBAL_WORK_OFFSET_KHR</span>         <span class="mh">0x12A5</span>
<span class="n">CL_MUTABLE_DISPATCH_GLOBAL_WORK_SIZE_KHR</span>           <span class="mh">0x12A6</span>
<span class="n">CL_MUTABLE_DISPATCH_LOCAL_WORK_SIZE_KHR</span>            <span class="mh">0x12A7</span>
<span class="n">CL_MUTABLE_COMMAND_COMMAND_TYPE_KHR</span>                <span class="mh">0x12AD</span>

<span class="c1">// Bits for cl_command_buffer_flags_khr</span>
<span class="n">CL_COMMAND_BUFFER_MUTABLE_KHR</span>                    <span class="p">(</span><span class="mh">0x1</span> <span class="o">&lt;&lt;</span> <span class="mi">1</span><span class="p">)</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Enum values for <code>cl_command_<wbr>buffer_<wbr>structure_<wbr>type_<wbr>khr</code> allowing the structure
types used for mutating commands between enqueues to be extended by future
extensions built on top of <code>cl_khr_command_buffer_mutable_dispatch</code>. Based on
structure pointer chains in Vulkan.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="opencl"><span class="n">CL_STRUCTURE_TYPE_MUTABLE_BASE_CONFIG_KHR</span>          <span class="mi">0</span>
<span class="n">CL_STRUCTURE_TYPE_MUTABLE_DISPATCH_CONFIG_KHR</span>      <span class="mi">1</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_modifications_to_section_4_2_of_the_opencl_api_specification_2"><a class="anchor" href="#_modifications_to_section_4_2_of_the_opencl_api_specification_2"></a>50.7. Modifications to section 4.2 of the OpenCL API Specification</h3>
<div class="paragraph">
<p>Add to <strong>Table 5</strong>, <em>Device Queries</em>, of section 4.2:</p>
</div>
<table id="command-dispatch-queries" class="tableblock frame-all grid-all stretch">
<caption class="title">Table 5. List of supported param_names by <strong>clGetDeviceInfo</strong></caption>
<colgroup>
<col style="width: 16.6666%;">
<col style="width: 16.6666%;">
<col style="width: 66.6668%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Device Info</th>
<th class="tableblock halign-left valign-top">Return Type</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CL_DEVICE_<wbr>MUTABLE_<wbr>DISPATCH_<wbr>CAPABILITIES_<wbr>KHR</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>cl_mutable_<wbr>dispatch_<wbr>fields_<wbr>khr</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Describes device mutable-dispatch capabilities, encoded as bits in a bitfield.
  Supported capabilities are:</p>
<p class="tableblock">  <code>CL_MUTABLE_<wbr>DISPATCH_<wbr>GLOBAL_<wbr>OFFSET_<wbr>KHR</code> Device supports the ability to modify
  the <em>global_work_offset</em> of kernel execution after command recording.</p>
<p class="tableblock">  <code>CL_MUTABLE_<wbr>DISPATCH_<wbr>GLOBAL_<wbr>SIZE_<wbr>KHR</code> Device supports the ability to modify
  the <em>global_work_size</em> of kernel execution after command recording.</p>
<p class="tableblock">  <code>CL_MUTABLE_<wbr>DISPATCH_<wbr>LOCAL_<wbr>SIZE_<wbr>KHR</code> Device supports the ability to modify
  the <em>local_work_size</em> of kernel execution after command recording.</p>
<p class="tableblock">  <code>CL_MUTABLE_<wbr>DISPATCH_<wbr>ARGUMENTS_<wbr>KHR</code> Device supports the ability to modify
  arguments set on a kernel after command recording.</p>
<p class="tableblock">  <code>CL_MUTABLE_<wbr>DISPATCH_<wbr>EXEC_<wbr>INFO_<wbr>KHR</code> Device supports the ability to modify
  execution information set on a kernel after command recording.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="_modifications_to_section_5_x_command_buffers_of_the_opencl_api_specification"><a class="anchor" href="#_modifications_to_section_5_x_command_buffers_of_the_opencl_api_specification"></a>50.8. Modifications to Section 5.X - Command Buffers of the OpenCL API Specification</h3>
<div class="sect3">
<h4 id="_modifications_to_clcreatecommandbufferkhr"><a class="anchor" href="#_modifications_to_clcreatecommandbufferkhr"></a>50.8.1. Modifications to clCreateCommandBufferKHR</h4>
<div class="paragraph">
<p>Modify the <code>CL_COMMAND_<wbr>BUFFER_<wbr>FLAGS_<wbr>KHR</code> property in the
<a href="#commandbuffer-properties">clCreateCommandBufferKHR properties</a> table to
introduce a new flag to the bitfield. The following text is now included in the
description of property values.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><strong>Recording Properties</strong></th>
<th class="tableblock halign-left valign-top"><strong>Property Value</strong></th>
<th class="tableblock halign-left valign-top"><strong>Description</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CL_COMMAND_<wbr>BUFFER_<wbr>FLAGS_<wbr>KHR</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>cl_command_<wbr>buffer_<wbr>flags_<wbr>khr</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CL_COMMAND_<wbr>BUFFER_<wbr>MUTABLE_<wbr>KHR</code> - Enables modification of the
  command-buffer, by default command-buffers are immutable. If set,
  commands in the command-buffer may be updated via <strong>clUpdateMutableCommandsKHR</strong>.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="_modifications_to_clcommandndrangekernelkhr"><a class="anchor" href="#_modifications_to_clcommandndrangekernelkhr"></a>50.8.2. Modifications to clCommandNDRangeKernelKHR</h4>
<div class="sect4">
<h5 id="_properties_parameter"><a class="anchor" href="#_properties_parameter"></a>50.8.2.1. Properties Parameter</h5>
<div class="paragraph">
<p>Description of the <em>properties</em> parameter is changed to:</p>
</div>
<div class="paragraph">
<p><em>properties</em> Specifies a list of properties for the kernel command and their
corresponding values. Each property name is immediately followed by the
corresponding desired value. The list is terminated with 0. If a supported
property and its value is not specified in <em>properties</em>, its default value will
be used. <em>properties</em> may be <code>NULL</code> in which case the default values for
supported properties will be used. The list of supported properties is described
in the table below.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 71. <strong>clCommandNDRangeKernelKHR</strong> properties</caption>
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><strong>Recording Properties</strong></th>
<th class="tableblock halign-left valign-top"><strong>Property Value</strong></th>
<th class="tableblock halign-left valign-top"><strong>Description</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CL_MUTABLE_<wbr>DISPATCH_<wbr>UPDATABLE_<wbr>FIELDS_<wbr>KHR</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>cl_mutable_<wbr>dispatch_<wbr>fields_<wbr>khr</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">This is a bitfield and can be set to a combination of the following values:</p>
<p class="tableblock">  <code>CL_MUTABLE_<wbr>DISPATCH_<wbr>GLOBAL_<wbr>OFFSET_<wbr>KHR</code>
  Determines whether the <em>global_work_offset</em> of kernel execution can be
  modified after recording. If set, the <em>global_work_offset</em> of the kernel
  execution can be changed with <strong>clUpdateMutableCommandsKHR</strong> using the
  <code>cl_mutable_<wbr>dispatch_<wbr>config_<wbr>khr</code> field
  of the <em>mutable_config</em> parameter. Otherwise, the <em>global_work_offset</em> cannot
  be modified.</p>
<p class="tableblock">  <code>CL_MUTABLE_<wbr>DISPATCH_<wbr>GLOBAL_<wbr>SIZE_<wbr>KHR</code>
  Determines whether the <em>global_work_size</em> of kernel execution can be
  modified after recording. If set, the <em>global_work_size</em> of the kernel
  execution can be changed with <strong>clUpdateMutableCommandsKHR</strong> using the
  <code>cl_mutable_<wbr>dispatch_<wbr>config_<wbr>khr</code> field
  of the <em>mutable_config</em> parameter. Otherwise, the <em>global_work_size</em> cannot be
  modified.</p>
<p class="tableblock">  <code>CL_MUTABLE_<wbr>DISPATCH_<wbr>LOCAL_<wbr>SIZE_<wbr>KHR</code>
  Determines whether the <em>local_work_size</em> of kernel execution can be
  modified after recording. If set, the <em>local_work_size</em> of the kernel
  execution can be changed with <strong>clUpdateMutableCommandsKHR</strong> using the
  <code>cl_mutable_<wbr>dispatch_<wbr>config_<wbr>khr</code> field
  of the <em>mutable_config</em> parameter. Otherwise, the <em>local_work_size</em> cannot be
  modified.</p>
<p class="tableblock">  <code>CL_MUTABLE_<wbr>DISPATCH_<wbr>ARGUMENTS_<wbr>KHR</code>
  Determines whether the kernel arguments set on <em>kernel</em> can be updated
  between executions. If set, the kernel arguments normally set with
  <strong>clSetKernelArg</strong> and <strong>clSetKernelArgSVMPointer</strong> can be changed with
  <strong>clUpdateMutableCommandsKHR</strong> using the
  <code>cl_mutable_<wbr>dispatch_<wbr>config_<wbr>khr</code> field
  of the <em>mutable_config</em> parameter. Otherwise, the kernel arguments cannot be
  modified between executions.</p>
<p class="tableblock">  <code>CL_MUTABLE_<wbr>DISPATCH_<wbr>EXEC_<wbr>INFO_<wbr>KHR</code>
  Determines whether the information passed to <em>kernel</em> can be updated between
  executions. If set, the execution information of the kernel can be changed
  with <strong>clUpdateMutableCommandsKHR</strong> using the
  <code>cl_mutable_<wbr>dispatch_<wbr>config_<wbr>khr</code> field of
  the <em>mutable_config</em> parameter. Otherwise, the kernel execution information
  cannot be modified.</p>
<p class="tableblock">  If <code>CL_MUTABLE_<wbr>DISPATCH_<wbr>UPDATABLE_<wbr>FIELDS_<wbr>KHR</code> is not specified then it
  defaults to the value returned by the
  <code>CL_DEVICE_<wbr>MUTABLE_<wbr>DISPATCH_<wbr>CAPABILITIES_<wbr>KHR</code> device query.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="_mutable_handle_parameter"><a class="anchor" href="#_mutable_handle_parameter"></a>50.8.2.2. Mutable Handle Parameter</h5>
<div class="paragraph">
<p>Description of the <em>mutable_handle</em> parameter is changed to:</p>
</div>
<div class="paragraph">
<p><em>mutable_handle</em> Returns a handle to the command that can be used in the
<code>cl_mutable_<wbr>dispatch_<wbr>config_<wbr>khr</code> struct
to update the command configuration between recordings, may be <code>NULL</code>. The
lifetime of this handle is tied to the parent command-buffer, such that freeing
the command-buffer will also free this handle.</p>
</div>
</div>
<div class="sect4">
<h5 id="_additional_errors"><a class="anchor" href="#_additional_errors"></a>50.8.2.3. Additional Errors</h5>
<div class="paragraph">
<p>The error condition:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>CL_INVALID_<wbr>OPERATION</code> if <em>mutable_handle</em> is not <code>NULL</code>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Is replaced with</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>CL_INVALID_<wbr>OPERATION</code> if the requested
<code>CL_MUTABLE_<wbr>DISPATCH_<wbr>UPDATABLE_<wbr>FIELDS_<wbr>KHR</code> properties are not reported by
<code>CL_DEVICE_<wbr>MUTABLE_<wbr>DISPATCH_<wbr>CAPABILITIES_<wbr>KHR</code> for the device associated with
<em>command_queue</em>. If <em>command_queue</em> is <code>NULL</code>, the device associated with
<em>command_buffer</em> must report support for these properties.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect3">
<h4 id="mutable-commands"><a class="anchor" href="#mutable-commands"></a>50.8.3. New Section in the OpenCL API specification 5.X.5 - Mutable Commands:</h4>
<div class="paragraph">
<p>A generic <code>cl_mutable_<wbr>command_<wbr>khr</code> handle is called a <em>mutable-command</em> object
as it can be returned from any command recording entry-point in the
<code>cl_khr_command_buffer</code> family of extensions. The mutable-command handles
returned by <strong>clCommandNDRangeKernelKHR</strong> in particular are referred to as
<em>mutable-dispatch</em> objects, and can be modified through the fields of
<code>cl_mutable_<wbr>dispatch_<wbr>config_<wbr>khr</code>.</p>
</div>
<div class="paragraph">
<p>Mutable-command handles are updated between enqueues using entry-point
<strong>clUpdateMutableCommandsKHR</strong>. To enable performant usage, all aspects of
mutation are encapsulated inside a single
<code>cl_mutable_<wbr>base_<wbr>config_<wbr>khr</code> parameter. This means
that the runtime has access to all the information about how the command-buffer
will change, allowing the command-buffer to be rebuilt as efficiently as
possible. Any modifications to the arguments or execution info of a mutable-dispatch
handle using <code>cl_mutable_<wbr>dispatch_<wbr>arg_<wbr>khr</code> or
<code>cl_mutable_<wbr>dispatch_<wbr>exec_<wbr>info_<wbr>khr</code> have no
affect on the original kernel object used when the command was recorded, and
only influence the <strong>clCommandNDRangeKernelKHR</strong> command associated with the
mutable-dispatch.</p>
</div>
<div class="paragraph">
<p>To facilitate performant usage for pipelined work flows, where applications
repeatedly call command-buffer update then enqueue, implementations may defer
some of the work to allow <strong>clUpdateMutableCommandsKHR</strong> to return immediately.
Deferring any recompilation until <strong>clEnqueueCommandBufferKHR</strong> avoids blocking
in host code and keeps device occupancy high. This is only possible with a
command-buffer created with the <code>CL_COMMAND_<wbr>BUFFER_<wbr>SIMULTANEOUS_<wbr>USE_<wbr>KHR</code> flag,
as without this the enqueued command-buffer must complete before any modification
occurs.</p>
</div>
<div class="paragraph">
<p>The function</p>
</div>
<div id="clUpdateMutableCommandsKHR" class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="opencl"><span class="kt">cl_int</span> <span class="nf">clUpdateMutableCommandsKHR</span><span class="p">(</span>
    <span class="kt">cl_command_buffer_khr</span> <span class="n">command_buffer</span><span class="p">,</span>
    <span class="k">const</span> <span class="kt">cl_mutable_base_config_khr</span><span class="o">*</span> <span class="n">mutable_config</span><span class="p">);</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Modifies the configuration of mutable-command handles returned during
<em>command_buffer</em> recording, updating the behaviour of those commands in future
enqueues of <em>command_buffer</em>. Using this function when <em>command_buffer</em> is in
the <a href="#pending">pending</a> state and not created with the
<code>CL_COMMAND_<wbr>BUFFER_<wbr>SIMULTANEOUS_<wbr>USE_<wbr>KHR</code> flag causes undefined behaviour.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Performant usage is to call <strong>clUpdateMutableCommandsKHR</strong> only when the desired
state of all commands is known, rather than iteratively updating each command
individually.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><em>command_buffer</em> Refers to a valid command-buffer object.</p>
</div>
<div class="paragraph">
<p><em>mutable_config</em> Is a pointer to a
<code>cl_mutable_<wbr>base_<wbr>config_<wbr>khr</code> structure defining
updates to make to mutable-commands.</p>
</div>
<div class="paragraph">
<p><strong>clUpdateMutableCommandsKHR</strong> returns <code>CL_SUCCESS</code> if all the mutable-command
objects were updated successfully. Otherwise, none of the updates to
mutable-command objects are preserved and one of the errors below is returned:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>CL_INVALID_<wbr>COMMAND_<wbr>BUFFER_<wbr>KHR</code> if <em>command_buffer</em> is not a valid
command-buffer.</p>
</li>
<li>
<p><code>CL_INVALID_<wbr>OPERATION</code> if <em>command_buffer</em> has not been finalized.</p>
</li>
<li>
<p><code>CL_INVALID_<wbr>OPERATION</code> if <em>command_buffer</em> was not created with the
<code>CL_COMMAND_<wbr>BUFFER_<wbr>MUTABLE_<wbr>KHR</code> flag.</p>
</li>
<li>
<p><code>CL_INVALID_<wbr>VALUE</code> if the <em>type</em> member of <em>mutable_config</em> is not
<code>CL_STRUCTURE_<wbr>TYPE_<wbr>MUTABLE_<wbr>BASE_<wbr>CONFIG_<wbr>KHR</code>.</p>
</li>
<li>
<p><code>CL_INVALID_<wbr>VALUE</code> if the <em>mutable_dispatch_list</em> member of <em>mutable_config</em>
is <code>NULL</code> and <em>num_mutable_dispatch</em> &gt; 0, or <em>mutable_dispatch_list</em> is not
<code>NULL</code> and <em>num_mutable_dispatch</em> is 0.</p>
</li>
<li>
<p><code>CL_INVALID_<wbr>VALUE</code> if the <em>next</em> member of <em>mutable_config</em> is not <code>NULL</code> and
any iteration of the structure pointer chain does not contain valid <em>type</em>
and <em>next</em> members.</p>
</li>
<li>
<p><code>CL_INVALID_<wbr>VALUE</code> if <em>mutable_config</em> is <code>NULL</code>, or if both <em>next</em> and
<em>mutable_dispatch_list</em> members of <em>mutable_config</em> are <code>NULL</code>.</p>
</li>
<li>
<p><code>CL_OUT_<wbr>OF_<wbr>RESOURCES</code> if there is a failure to allocate resources required by
the OpenCL implementation on the device.</p>
</li>
<li>
<p><code>CL_OUT_<wbr>OF_<wbr>HOST_<wbr>MEMORY</code> if there is a failure to allocate resources required by
the OpenCL implementation on the host.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>If the <em>mutable_dispatch_list</em> member of <em>mutable_config</em> is non-<code>NULL</code>, then
errors defined by <strong>clEnqueueNDRangeKernel</strong>, <strong>clSetKernelExecInfo</strong>,
<strong>clSetKernelArg</strong>, and <strong>clSetKernelArgSVMPointer</strong> are returned by
<strong>clUpdateMutableCommandsKHR</strong> if any of the array elements are set to an invalid
value. Additionally, the following errors are returned if any
<code>cl_mutable_<wbr>dispatch_<wbr>config_<wbr>khr</code> element of
the array violates the defined conditions:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>CL_INVALID_<wbr>MUTABLE_<wbr>COMMAND_<wbr>KHR</code> if <em>command</em> is not a valid mutable
command object, or created from <em>command_buffer</em>.</p>
</li>
<li>
<p><code>CL_INVALID_<wbr>VALUE</code> if <em>type</em> is not
<code>CL_STRUCTURE_<wbr>TYPE_<wbr>MUTABLE_<wbr>DISPATCH_<wbr>CONFIG_<wbr>KHR</code>.</p>
</li>
<li>
<p><code>CL_INVALID_<wbr>OPERATION</code> if values of <em>local_work_size</em> and/or
<em>global_work_size</em> result in an increase to the number of work-groups in the
ND-range.</p>
</li>
<li>
<p><code>CL_INVALID_<wbr>OPERATION</code> if the values of <em>local_work_size</em> and/or
<em>global_work_size</em> result in a change to work-group uniformity.</p>
</li>
<li>
<p><code>CL_INVALID_<wbr>OPERATION</code> if the <em>work_dim</em> is different from the <em>work_dim</em> set
on <em>command</em> recording.</p>
</li>
<li>
<p><code>CL_INVALID_<wbr>OPERATION</code> if the <code>CL_MUTABLE_<wbr>DISPATCH_<wbr>GLOBAL_<wbr>OFFSET_<wbr>KHR</code> property
was not set on <em>command</em> recording and <em>global_work_offset</em> is not <code>NULL</code>.</p>
</li>
<li>
<p><code>CL_INVALID_<wbr>OPERATION</code> if the <code>CL_MUTABLE_<wbr>DISPATCH_<wbr>GLOBAL_<wbr>SIZE_<wbr>KHR</code> property
was not set on <em>command</em> recording and <em>global_work_size</em> is not <code>NULL</code>.</p>
</li>
<li>
<p><code>CL_INVALID_<wbr>OPERATION</code> if the <code>CL_MUTABLE_<wbr>DISPATCH_<wbr>LOCAL_<wbr>SIZE_<wbr>KHR</code> property
was not set on <em>command</em> recording and <em>local_work_size</em> is not <code>NULL</code>.</p>
</li>
<li>
<p><code>CL_INVALID_<wbr>OPERATION</code> if the <code>CL_MUTABLE_<wbr>DISPATCH_<wbr>ARGUMENTS_<wbr>KHR</code> property was
not set on <em>command</em> recording and <em>num_args</em> or <em>num_svm_args</em> is non-zero.</p>
</li>
<li>
<p><code>CL_INVALID_<wbr>OPERATION</code> if the <code>CL_MUTABLE_<wbr>DISPATCH_<wbr>EXEC_<wbr>INFO_<wbr>KHR</code> property was
not set on <em>command</em> recording and <em>num_exec_infos</em> is non-zero.</p>
</li>
<li>
<p><code>CL_INVALID_<wbr>VALUE</code> if <em>arg_list</em> is <code>NULL</code> and <em>num_args</em> &gt; 0, or <em>arg_list</em>
is not <code>NULL</code> and <em>num_args</em> is 0.</p>
</li>
<li>
<p><code>CL_INVALID_<wbr>VALUE</code> if <em>arg_svm_list</em> is <code>NULL</code> and <em>num_svm_args</em> &gt; 0, or
<em>arg_svm_list</em> is not <code>NULL</code> and <em>num_svm_args</em> is 0.</p>
</li>
<li>
<p><code>CL_INVALID_<wbr>VALUE</code> if <em>exec_info_list</em> is <code>NULL</code> and <em>num_exec_infos</em> &gt; 0, or
<em>exec_info_list</em> is not <code>NULL</code> and <em>num_exec_infos</em> is 0.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The function</p>
</div>
<div id="clGetMutableCommandInfoKHR" class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="opencl"><span class="kt">cl_int</span> <span class="nf">clGetMutableCommandInfoKHR</span><span class="p">(</span>
    <span class="kt">cl_mutable_command_khr</span> <span class="n">command</span><span class="p">,</span>
    <span class="kt">cl_mutable_command_info_khr</span> <span class="n">param_name</span><span class="p">,</span>
    <span class="kt">size_t</span> <span class="n">param_value_size</span><span class="p">,</span>
    <span class="kt">void</span><span class="o">*</span> <span class="n">param_value</span><span class="p">,</span>
    <span class="kt">size_t</span><span class="o">*</span> <span class="n">param_value_size_ret</span><span class="p">);</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Queries information about the <em>command</em> object.</p>
</div>
<div class="paragraph">
<p><em>command</em> Specifies the mutable-command object being queried.</p>
</div>
<div class="paragraph">
<p><em>param_name</em> Specifies the information to query. The list of supported
<em>param_name</em> types and the information returned in <em>param_value</em> by
<strong>clGetMutableCommandInfoKHR</strong> is described in the
<a href="#mutable-command-object-queries">Mutable Command Object Queries</a> table.</p>
</div>
<div class="paragraph">
<p><em>param_value_size</em> Is used to specify the size in bytes of memory pointed to by
<em>param_value</em>. This size must be  size of return type as described in the
<a href="#mutable-command-object-queries">Mutable Command Object Queries</a> table.</p>
</div>
<div class="paragraph">
<p><em>param_value</em> Is a pointer to memory where the appropriate result being queried
is returned. If <em>param_value</em> is <code>NULL</code>, it is ignored.</p>
</div>
<div class="paragraph">
<p><em>param_value_size_ret</em> Returns the actual size in bytes of data being queried
by <em>param_name</em>. If <em>param_value_size_ret</em> is <code>NULL</code>, it is ignored.</p>
</div>
<table id="mutable-command-object-queries" class="tableblock frame-all grid-all stretch">
<caption class="title">Table 72. <em>Mutable Command Object Queries</em></caption>
<colgroup>
<col style="width: 33%;">
<col style="width: 17%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Mutable Command Info</th>
<th class="tableblock halign-left valign-top">Return Type</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CL_MUTABLE_<wbr>COMMAND_<wbr>COMMAND_<wbr>QUEUE_<wbr>KHR</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>cl_command_<wbr>queue</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Return the command-queue associated with <em>command</em>. If <code>NULL</code> was passed as
  the queue when <em>command</em> was recorded, then the queue associated with the
  command-buffer that <em>command</em> belongs to is returned.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CL_MUTABLE_<wbr>COMMAND_<wbr>COMMAND_<wbr>BUFFER_<wbr>KHR</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>cl_command_<wbr>buffer_<wbr>khr</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Return the command-buffer associated with <em>command</em>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CL_MUTABLE_<wbr>COMMAND_<wbr>COMMAND_<wbr>TYPE_<wbr>KHR</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>cl_command_<wbr>type</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Return the command-type associated with <em>command</em>.</p>
<p class="tableblock">  The list of supported event command types defined by <strong>clGetEventInfo</strong> is used
  with the matching command.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CL_MUTABLE_<wbr>DISPATCH_<wbr>PROPERTIES_<wbr>ARRAY_<wbr>KHR</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>cl_ndrange_<wbr>kernel_<wbr>command_<wbr>properties_<wbr>khr</code>[]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Return the properties argument specified on <em>command</em> recording with
  <strong>clCommandNDRangeKernelKHR</strong>.</p>
<p class="tableblock">  If the properties argument specified on creation of <em>command</em> was not
  <code>NULL</code>, the implementation must return the values specified in the
  properties argument in the same order and without including additional
  properties.</p>
<p class="tableblock">  If the properties argument specified on creation of <em>command</em> was <code>NULL</code>,
  or <em>command</em> was not recorded from a <strong>clCommandNDRangeKernelKHR</strong> command, the
  implementation must return <em>param_value_size_ret</em> equal to 0, indicating that
  there are no properties to be returned.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CL_MUTABLE_<wbr>DISPATCH_<wbr>KERNEL_<wbr>KHR</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>cl_kernel</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Return the kernel associated with <em>command</em> when recorded with
  <strong>clCommandNDRangeKernelKHR</strong>.</p>
<p class="tableblock">  If <em>command</em> was not recorded from a <strong>clCommandNDRangeKernelKHR</strong> command, the
  implementation must return <em>param_value_size_ret</em> equal to 0, indicating that
  the value returned in <em>param_value</em> is not valid.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CL_MUTABLE_<wbr>DISPATCH_<wbr>DIMENSIONS_<wbr>KHR</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>cl_uint</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Return the number of work-item dimensions specified when <em>command</em> was
  created.</p>
<p class="tableblock">  If <em>command</em> was not recorded from a <strong>clCommandNDRangeKernelKHR</strong> command, the
  implementation must return <em>param_value_size_ret</em> equal to 0, indicating that
  the value returned in <em>param_value</em> is not valid.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CL_MUTABLE_<wbr>DISPATCH_<wbr>GLOBAL_<wbr>WORK_<wbr>OFFSET_<wbr>KHR</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>size_t</code>[]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Return the global work-item offset set on <em>command</em> creation, or from
  the most recent update via <strong>clUpdateMutableCommandsKHR</strong> where this value
  was modified. The output array contains <em>work_dim</em> values, where <em>work_dim</em> is
  returned by the query <code>CL_MUTABLE_<wbr>DISPATCH_<wbr>DIMENSIONS_<wbr>KHR</code>. If a global work-item
  offset was not set, zero is returned for each element in the array.</p>
<p class="tableblock">  If <em>command</em> was not recorded from a <strong>clCommandNDRangeKernelKHR</strong> command, the
  implementation must return <em>param_value_size_ret</em> equal to 0, indicating that
  the value returned in <em>param_value</em> is not valid.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CL_MUTABLE_<wbr>DISPATCH_<wbr>GLOBAL_<wbr>WORK_<wbr>SIZE_<wbr>KHR</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>size_t</code>[]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Return the global work-item size set on <em>command</em> creation, or from
  the most recent update via <strong>clUpdateMutableCommandsKHR</strong> where this value
  was modified. The output array contains <em>work_dim</em> values, where <em>work_dim</em> is
  returned by the query <code>CL_MUTABLE_<wbr>DISPATCH_<wbr>DIMENSIONS_<wbr>KHR</code>.
  If a global work-item size was not set, zero is returned for each element in
  the array.</p>
<p class="tableblock">  If <em>command</em> was not recorded from a <strong>clCommandNDRangeKernelKHR</strong> command, the
  implementation must return <em>param_value_size_ret</em> equal to 0, indicating that
  the value returned in <em>param_value</em> is not valid.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CL_MUTABLE_<wbr>DISPATCH_<wbr>LOCAL_<wbr>WORK_<wbr>SIZE_<wbr>KHR</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>size_t</code>[]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Return the local work-item size set on <em>command</em> creation, or from
  the most recent update via <strong>clUpdateMutableCommandsKHR</strong> where this value
  was modified. The output array contains <em>work_dim</em> values, where <em>work_dim</em> is
  returned by the query <code>CL_MUTABLE_<wbr>DISPATCH_<wbr>DIMENSIONS_<wbr>KHR</code>. If a local work-item
  size was not set, zero is returned for each element in the array.</p>
<p class="tableblock">  If <em>command</em> was not recorded from a <strong>clCommandNDRangeKernelKHR</strong> command, the
  implementation must return <em>param_value_size_ret</em> equal to 0, indicating that
  the value returned in <em>param_value</em> is not valid.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><strong>clGetMutableCommandInfoKHR</strong> returns <code>CL_SUCCESS</code> if the function is executed
successfully. Otherwise, it returns one of the following errors:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>CL_INVALID_<wbr>VALUE</code> if <em>param_name</em> is not valid, or if size in bytes
specified by <em>param_value_size</em> is &lt; size of return type as described in the
<a href="#mutable-command-object-queries">Mutable Command Object Queries</a> table
and <em>param_value</em> is not <code>NULL</code>.</p>
</li>
<li>
<p><code>CL_INVALID_<wbr>MUTABLE_<wbr>COMMAND_<wbr>KHR</code> if <em>command</em> is not a valid mutable
command object.</p>
</li>
<li>
<p><code>CL_OUT_<wbr>OF_<wbr>RESOURCES</code> if there is a failure to allocate resources
required by the OpenCL implementation on the device.</p>
</li>
<li>
<p><code>CL_OUT_<wbr>OF_<wbr>HOST_<wbr>MEMORY</code> if there is a failure to allocate resources
required by the OpenCL implementation on the host.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_sample_code_3"><a class="anchor" href="#_sample_code_3"></a>50.9. Sample Code</h3>
<div class="paragraph">
<p>Sample application updating the arguments to a mutable-dispatch between
command-buffer submissions.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="opencl">  <span class="cp">#define CL_CHECK(ERROR)                             \
    if (ERROR) {                                      \
      std::cerr &lt;&lt; "OpenCL error: " &lt;&lt; ERROR &lt;&lt; "\n"; \
      return ERROR;                                   \
    }
</span>
  <span class="kt">int</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span>
    <span class="kt">cl_platform_id</span> <span class="n">platform</span><span class="p">;</span>
    <span class="n">CL_CHECK</span><span class="p">(</span><span class="n">clGetPlatformIDs</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">platform</span><span class="p">,</span> <span class="nb">nullptr</span><span class="p">));</span>
    <span class="kt">cl_device_id</span> <span class="n">device</span><span class="p">;</span>
    <span class="n">CL_CHECK</span><span class="p">(</span><span class="n">clGetDeviceIDs</span><span class="p">(</span><span class="n">platform</span><span class="p">,</span> <span class="n">CL_DEVICE_TYPE_ALL</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">device</span><span class="p">,</span> <span class="nb">nullptr</span><span class="p">));</span>

    <span class="kt">cl_mutable_dispatch_fields_khr</span> <span class="n">mutable_capabilities</span><span class="p">;</span>
    <span class="n">CL_CHECK</span><span class="p">(</span><span class="n">clGetDeviceInfo</span><span class="p">(</span><span class="n">device</span><span class="p">,</span> <span class="n">CL_DEVICE_MUTABLE_DISPATCH_CAPABILITIES_KHR</span><span class="p">,</span>
                             <span class="k">sizeof</span><span class="p">(</span><span class="n">mutable_capabilities</span><span class="p">),</span> <span class="o">&amp;</span><span class="n">mutable_capabilities</span><span class="p">,</span>
                             <span class="nb">nullptr</span><span class="p">));</span>
    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="p">(</span><span class="n">mutable_capabilities</span> <span class="o">&amp;</span> <span class="n">CL_MUTABLE_DISPATCH_ARGUMENTS_KHR</span><span class="p">))</span> <span class="p">{</span>
      <span class="n">std</span><span class="o">::</span><span class="n">cerr</span>
          <span class="o">&lt;&lt;</span> <span class="s">"Device does not support update arguments to a mutable-dispatch, "</span>
             <span class="s">"skipping example.</span><span class="se">\n</span><span class="s">"</span><span class="p">;</span>
      <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="kt">cl_int</span> <span class="n">error</span><span class="p">;</span>
    <span class="kt">cl_context</span> <span class="n">context</span> <span class="o">=</span>
        <span class="n">clCreateContext</span><span class="p">(</span><span class="nb">nullptr</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">device</span><span class="p">,</span> <span class="nb">nullptr</span><span class="p">,</span> <span class="nb">nullptr</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">error</span><span class="p">);</span>
    <span class="n">CL_CHECK</span><span class="p">(</span><span class="n">error</span><span class="p">);</span>

    <span class="k">const</span> <span class="kt">char</span><span class="o">*</span> <span class="n">code</span> <span class="o">=</span> <span class="s">R"OpenCLC(
  kernel void vector_addition(global int* tile1, global int* tile2,
                              global int* res) {
    size_t index = get_global_id(0);
    res[index] = tile1[index] + tile2[index];
  }
  )OpenCLC"</span><span class="p">;</span>
    <span class="k">const</span> <span class="kt">size_t</span> <span class="n">length</span> <span class="o">=</span> <span class="n">std</span><span class="o">::</span><span class="n">strlen</span><span class="p">(</span><span class="n">code</span><span class="p">);</span>

    <span class="kt">cl_program</span> <span class="n">program</span> <span class="o">=</span>
        <span class="n">clCreateProgramWithSource</span><span class="p">(</span><span class="n">context</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">code</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">length</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">error</span><span class="p">);</span>
    <span class="n">CL_CHECK</span><span class="p">(</span><span class="n">error</span><span class="p">);</span>

    <span class="n">CL_CHECK</span><span class="p">(</span><span class="n">clBuildProgram</span><span class="p">(</span><span class="n">program</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">device</span><span class="p">,</span> <span class="nb">nullptr</span><span class="p">,</span> <span class="nb">nullptr</span><span class="p">,</span> <span class="nb">nullptr</span><span class="p">));</span>

    <span class="kt">cl_kernel</span> <span class="n">kernel</span> <span class="o">=</span> <span class="n">clCreateKernel</span><span class="p">(</span><span class="n">program</span><span class="p">,</span> <span class="s">"vector_addition"</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">error</span><span class="p">);</span>
    <span class="n">CL_CHECK</span><span class="p">(</span><span class="n">error</span><span class="p">);</span>

    <span class="c1">// Set the parameters of the frames</span>
    <span class="k">constexpr</span> <span class="kt">size_t</span> <span class="n">iterations</span> <span class="o">=</span> <span class="mi">60</span><span class="p">;</span>
    <span class="k">constexpr</span> <span class="kt">size_t</span> <span class="n">elem_size</span> <span class="o">=</span> <span class="k">sizeof</span><span class="p">(</span><span class="kt">cl_int</span><span class="p">);</span>
    <span class="k">constexpr</span> <span class="kt">size_t</span> <span class="n">frame_width</span> <span class="o">=</span> <span class="mi">32</span><span class="p">;</span>
    <span class="k">constexpr</span> <span class="kt">size_t</span> <span class="n">frame_count</span> <span class="o">=</span> <span class="n">frame_width</span> <span class="o">*</span> <span class="n">frame_width</span><span class="p">;</span>
    <span class="k">constexpr</span> <span class="kt">size_t</span> <span class="n">frame_size</span> <span class="o">=</span> <span class="n">frame_count</span> <span class="o">*</span> <span class="n">elem_size</span><span class="p">;</span>

    <span class="kt">cl_mem</span> <span class="n">input_A_buffers</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="nb">nullptr</span><span class="p">,</span> <span class="nb">nullptr</span><span class="p">};</span>
    <span class="kt">cl_mem</span> <span class="n">input_B_buffers</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="nb">nullptr</span><span class="p">,</span> <span class="nb">nullptr</span><span class="p">};</span>
    <span class="kt">cl_mem</span> <span class="n">output_buffers</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="nb">nullptr</span><span class="p">,</span> <span class="nb">nullptr</span><span class="p">};</span>

    <span class="c1">// Create the buffer to swap between even and odd kernel iterations</span>
    <span class="k">for</span> <span class="p">(</span><span class="kt">size_t</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
      <span class="n">input_A_buffers</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span>
          <span class="n">clCreateBuffer</span><span class="p">(</span><span class="n">context</span><span class="p">,</span> <span class="n">CL_MEM_READ_ONLY</span><span class="p">,</span> <span class="n">frame_size</span><span class="p">,</span> <span class="nb">nullptr</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">error</span><span class="p">);</span>
      <span class="n">CL_CHECK</span><span class="p">(</span><span class="n">error</span><span class="p">);</span>

      <span class="n">input_B_buffers</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span>
          <span class="n">clCreateBuffer</span><span class="p">(</span><span class="n">context</span><span class="p">,</span> <span class="n">CL_MEM_READ_ONLY</span><span class="p">,</span> <span class="n">frame_size</span><span class="p">,</span> <span class="nb">nullptr</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">error</span><span class="p">);</span>
      <span class="n">CL_CHECK</span><span class="p">(</span><span class="n">error</span><span class="p">);</span>

      <span class="n">output_buffers</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span>
          <span class="n">clCreateBuffer</span><span class="p">(</span><span class="n">context</span><span class="p">,</span> <span class="n">CL_MEM_WRITE_ONLY</span><span class="p">,</span> <span class="n">frame_size</span><span class="p">,</span> <span class="nb">nullptr</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">error</span><span class="p">);</span>
      <span class="n">CL_CHECK</span><span class="p">(</span><span class="n">error</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="kt">cl_command_queue</span> <span class="n">command_queue</span> <span class="o">=</span>
        <span class="n">clCreateCommandQueue</span><span class="p">(</span><span class="n">context</span><span class="p">,</span> <span class="n">device</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">error</span><span class="p">);</span>
    <span class="n">CL_CHECK</span><span class="p">(</span><span class="n">error</span><span class="p">);</span>

    <span class="c1">// Create command-buffer with mutable flag so we can update it</span>
    <span class="kt">cl_command_buffer_properties_khr</span> <span class="n">properties</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
        <span class="n">CL_COMMAND_BUFFER_FLAGS_KHR</span><span class="p">,</span> <span class="n">CL_COMMAND_BUFFER_MUTABLE_KHR</span><span class="p">,</span> <span class="mi">0</span><span class="p">};</span>
    <span class="kt">cl_command_buffer_khr</span> <span class="n">command_buffer</span> <span class="o">=</span>
        <span class="n">clCreateCommandBufferKHR</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">command_queue</span><span class="p">,</span> <span class="n">properties</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">error</span><span class="p">);</span>
    <span class="n">CL_CHECK</span><span class="p">(</span><span class="n">error</span><span class="p">);</span>

    <span class="n">CL_CHECK</span><span class="p">(</span><span class="n">clSetKernelArg</span><span class="p">(</span><span class="n">kernel</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="k">sizeof</span><span class="p">(</span><span class="kt">cl_mem</span><span class="p">),</span> <span class="o">&amp;</span><span class="n">input_A_buffers</span><span class="p">[</span><span class="mi">0</span><span class="p">]));</span>
    <span class="n">CL_CHECK</span><span class="p">(</span><span class="n">clSetKernelArg</span><span class="p">(</span><span class="n">kernel</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="k">sizeof</span><span class="p">(</span><span class="kt">cl_mem</span><span class="p">),</span> <span class="o">&amp;</span><span class="n">input_B_buffers</span><span class="p">[</span><span class="mi">0</span><span class="p">]));</span>
    <span class="n">CL_CHECK</span><span class="p">(</span><span class="n">clSetKernelArg</span><span class="p">(</span><span class="n">kernel</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="k">sizeof</span><span class="p">(</span><span class="kt">cl_mem</span><span class="p">),</span> <span class="o">&amp;</span><span class="n">output_buffers</span><span class="p">[</span><span class="mi">0</span><span class="p">]));</span>

    <span class="c1">// Instruct the nd-range command to allow for mutable kernel arguments</span>
    <span class="kt">cl_ndrange_kernel_command_properties_khr</span> <span class="n">mutable_properties</span><span class="p">[]</span> <span class="o">=</span> <span class="p">{</span>
        <span class="n">CL_MUTABLE_DISPATCH_UPDATABLE_FIELDS_KHR</span><span class="p">,</span>
        <span class="n">CL_MUTABLE_DISPATCH_ARGUMENTS_KHR</span><span class="p">,</span> <span class="mi">0</span><span class="p">};</span>

    <span class="c1">// Create command handle for mutating nd-range command</span>
    <span class="kt">cl_mutable_command_khr</span> <span class="n">command_handle</span> <span class="o">=</span> <span class="nb">nullptr</span><span class="p">;</span>

    <span class="c1">// Add the nd-range kernel command</span>
    <span class="n">error</span> <span class="o">=</span> <span class="n">clCommandNDRangeKernelKHR</span><span class="p">(</span>
        <span class="n">command_buffer</span><span class="p">,</span> <span class="n">command_queue</span><span class="p">,</span> <span class="n">mutable_properties</span><span class="p">,</span> <span class="n">kernel</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="nb">nullptr</span><span class="p">,</span>
        <span class="o">&amp;</span><span class="n">frame_count</span><span class="p">,</span> <span class="nb">nullptr</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="nb">nullptr</span><span class="p">,</span> <span class="nb">nullptr</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">command_handle</span><span class="p">);</span>
    <span class="n">CL_CHECK</span><span class="p">(</span><span class="n">error</span><span class="p">);</span>

    <span class="n">CL_CHECK</span><span class="p">(</span><span class="n">clFinalizeCommandBufferKHR</span><span class="p">(</span><span class="n">command_buffer</span><span class="p">));</span>

    <span class="c1">// Prepare for random input generation</span>
    <span class="n">std</span><span class="o">::</span><span class="n">random_device</span> <span class="n">random_device</span><span class="p">;</span>
    <span class="n">std</span><span class="o">::</span><span class="n">mt19937</span> <span class="n">random_engine</span><span class="p">{</span><span class="n">random_device</span><span class="p">()};</span>
    <span class="n">std</span><span class="o">::</span><span class="n">uniform_int_distribution</span><span class="o">&lt;</span><span class="kt">cl_int</span><span class="o">&gt;</span> <span class="n">random_distribution</span><span class="p">{</span>
        <span class="n">std</span><span class="o">::</span><span class="n">numeric_limits</span><span class="o">&lt;</span><span class="kt">cl_int</span><span class="o">&gt;::</span><span class="n">min</span><span class="p">()</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span>
        <span class="n">std</span><span class="o">::</span><span class="n">numeric_limits</span><span class="o">&lt;</span><span class="kt">cl_int</span><span class="o">&gt;::</span><span class="n">max</span><span class="p">()</span> <span class="o">/</span> <span class="mi">2</span><span class="p">};</span>

    <span class="c1">// Iterate over each frame</span>
    <span class="k">for</span> <span class="p">(</span><span class="kt">size_t</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">iterations</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
      <span class="c1">// Set the buffers for the current frame</span>
      <span class="kt">cl_mem</span> <span class="n">input_A_buffer</span> <span class="o">=</span> <span class="n">input_A_buffers</span><span class="p">[</span><span class="n">i</span> <span class="o">%</span> <span class="mi">2</span><span class="p">];</span>
      <span class="kt">cl_mem</span> <span class="n">input_B_buffer</span> <span class="o">=</span> <span class="n">input_B_buffers</span><span class="p">[</span><span class="n">i</span> <span class="o">%</span> <span class="mi">2</span><span class="p">];</span>
      <span class="kt">cl_mem</span> <span class="n">output_buffer</span> <span class="o">=</span> <span class="n">output_buffers</span><span class="p">[</span><span class="n">i</span> <span class="o">%</span> <span class="mi">2</span><span class="p">];</span>

      <span class="c1">// Generate input A data</span>
      <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">cl_int</span><span class="o">&gt;</span> <span class="n">input_a</span><span class="p">(</span><span class="n">frame_count</span><span class="p">);</span>
      <span class="n">std</span><span class="o">::</span><span class="n">generate</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">begin</span><span class="p">(</span><span class="n">input_a</span><span class="p">),</span> <span class="n">std</span><span class="o">::</span><span class="n">end</span><span class="p">(</span><span class="n">input_a</span><span class="p">),</span>
                    <span class="p">[</span><span class="o">&amp;</span><span class="p">]()</span> <span class="p">{</span> <span class="k">return</span> <span class="n">random_distribution</span><span class="p">(</span><span class="n">random_engine</span><span class="p">);</span> <span class="p">});</span>

      <span class="c1">// Write the generated data to the input A buffer</span>
      <span class="n">error</span> <span class="o">=</span>
          <span class="n">clEnqueueWriteBuffer</span><span class="p">(</span><span class="n">command_queue</span><span class="p">,</span> <span class="n">input_A_buffer</span><span class="p">,</span> <span class="n">CL_FALSE</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span>
                               <span class="n">frame_size</span><span class="p">,</span> <span class="n">input_a</span><span class="p">.</span><span class="n">data</span><span class="p">(),</span> <span class="mi">0</span><span class="p">,</span> <span class="nb">nullptr</span><span class="p">,</span> <span class="nb">nullptr</span><span class="p">);</span>
      <span class="n">CL_CHECK</span><span class="p">(</span><span class="n">error</span><span class="p">);</span>

      <span class="c1">// Generate input B data</span>
      <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">cl_int</span><span class="o">&gt;</span> <span class="n">input_b</span><span class="p">(</span><span class="n">frame_count</span><span class="p">);</span>
      <span class="n">std</span><span class="o">::</span><span class="n">generate</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">begin</span><span class="p">(</span><span class="n">input_b</span><span class="p">),</span> <span class="n">std</span><span class="o">::</span><span class="n">end</span><span class="p">(</span><span class="n">input_b</span><span class="p">),</span>
                    <span class="p">[</span><span class="o">&amp;</span><span class="p">]()</span> <span class="p">{</span> <span class="k">return</span> <span class="n">random_distribution</span><span class="p">(</span><span class="n">random_engine</span><span class="p">);</span> <span class="p">});</span>

      <span class="c1">// Write the generated data to the input B buffer</span>
      <span class="n">error</span> <span class="o">=</span>
          <span class="n">clEnqueueWriteBuffer</span><span class="p">(</span><span class="n">command_queue</span><span class="p">,</span> <span class="n">input_B_buffer</span><span class="p">,</span> <span class="n">CL_FALSE</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span>
                               <span class="n">frame_size</span><span class="p">,</span> <span class="n">input_b</span><span class="p">.</span><span class="n">data</span><span class="p">(),</span> <span class="mi">0</span><span class="p">,</span> <span class="nb">nullptr</span><span class="p">,</span> <span class="nb">nullptr</span><span class="p">);</span>
      <span class="n">CL_CHECK</span><span class="p">(</span><span class="n">error</span><span class="p">);</span>

      <span class="c1">// If not executing the first frame</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">i</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
        <span class="c1">// Configure the mutable configuration to update the kernel arguments</span>
        <span class="kt">cl_mutable_dispatch_arg_khr</span> <span class="n">arg_0</span><span class="p">{</span><span class="mi">0</span><span class="p">,</span> <span class="k">sizeof</span><span class="p">(</span><span class="kt">cl_mem</span><span class="p">),</span> <span class="o">&amp;</span><span class="n">input_A_buffer</span><span class="p">};</span>
        <span class="kt">cl_mutable_dispatch_arg_khr</span> <span class="n">arg_1</span><span class="p">{</span><span class="mi">1</span><span class="p">,</span> <span class="k">sizeof</span><span class="p">(</span><span class="kt">cl_mem</span><span class="p">),</span> <span class="o">&amp;</span><span class="n">input_B_buffer</span><span class="p">};</span>
        <span class="kt">cl_mutable_dispatch_arg_khr</span> <span class="n">arg_2</span><span class="p">{</span><span class="mi">2</span><span class="p">,</span> <span class="k">sizeof</span><span class="p">(</span><span class="kt">cl_mem</span><span class="p">),</span> <span class="o">&amp;</span><span class="n">output_buffer</span><span class="p">};</span>
        <span class="kt">cl_mutable_dispatch_arg_khr</span> <span class="n">args</span><span class="p">[]</span> <span class="o">=</span> <span class="p">{</span><span class="n">arg_0</span><span class="p">,</span> <span class="n">arg_1</span><span class="p">,</span> <span class="n">arg_2</span><span class="p">};</span>
        <span class="kt">cl_mutable_dispatch_config_khr</span> <span class="n">dispatch_config</span><span class="p">{</span>
            <span class="n">CL_STRUCTURE_TYPE_MUTABLE_DISPATCH_CONFIG_KHR</span><span class="p">,</span>
            <span class="nb">nullptr</span><span class="p">,</span>
            <span class="n">command_handle</span><span class="p">,</span>
            <span class="mi">3</span> <span class="cm">/* num_args */</span><span class="p">,</span>
            <span class="mi">0</span> <span class="cm">/* num_svm_arg */</span><span class="p">,</span>
            <span class="mi">0</span> <span class="cm">/* num_exec_infos */</span><span class="p">,</span>
            <span class="mi">0</span> <span class="cm">/* work_dim - 0 means no change to dimensions */</span><span class="p">,</span>
            <span class="n">args</span> <span class="cm">/* arg_list */</span><span class="p">,</span>
            <span class="nb">nullptr</span> <span class="cm">/* arg_svm_list - nullptr means no change*/</span><span class="p">,</span>
            <span class="nb">nullptr</span> <span class="cm">/* exec_info_list */</span><span class="p">,</span>
            <span class="nb">nullptr</span> <span class="cm">/* global_work_offset */</span><span class="p">,</span>
            <span class="nb">nullptr</span> <span class="cm">/* global_work_size */</span><span class="p">,</span>
            <span class="nb">nullptr</span> <span class="cm">/* local_work_size */</span><span class="p">};</span>
        <span class="kt">cl_mutable_base_config_khr</span> <span class="n">mutable_config</span><span class="p">{</span>
            <span class="n">CL_STRUCTURE_TYPE_MUTABLE_BASE_CONFIG_KHR</span><span class="p">,</span> <span class="nb">nullptr</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span>
            <span class="o">&amp;</span><span class="n">dispatch_config</span><span class="p">};</span>

        <span class="c1">// Update the command buffer with the mutable configuration</span>
        <span class="n">error</span> <span class="o">=</span> <span class="n">clUpdateMutableCommandsKHR</span><span class="p">(</span><span class="n">command_buffer</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">mutable_config</span><span class="p">);</span>
        <span class="n">CL_CHECK</span><span class="p">(</span><span class="n">error</span><span class="p">);</span>
      <span class="p">}</span>

      <span class="c1">// Enqueue the command buffer</span>
      <span class="n">error</span> <span class="o">=</span> <span class="n">clEnqueueCommandBufferKHR</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">nullptr</span><span class="p">,</span> <span class="n">command_buffer</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="nb">nullptr</span><span class="p">,</span>
                                        <span class="nb">nullptr</span><span class="p">);</span>
      <span class="n">CL_CHECK</span><span class="p">(</span><span class="n">error</span><span class="p">);</span>

      <span class="c1">// Allocate memory for the output data</span>
      <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">cl_int</span><span class="o">&gt;</span> <span class="n">output</span><span class="p">(</span><span class="n">frame_count</span><span class="p">);</span>

      <span class="c1">// Read the output data from the output buffer</span>
      <span class="n">error</span> <span class="o">=</span> <span class="n">clEnqueueReadBuffer</span><span class="p">(</span><span class="n">command_queue</span><span class="p">,</span> <span class="n">output_buffer</span><span class="p">,</span> <span class="n">CL_TRUE</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span>
                                  <span class="n">frame_size</span><span class="p">,</span> <span class="n">output</span><span class="p">.</span><span class="n">data</span><span class="p">(),</span> <span class="mi">0</span><span class="p">,</span> <span class="nb">nullptr</span><span class="p">,</span> <span class="nb">nullptr</span><span class="p">);</span>
      <span class="n">CL_CHECK</span><span class="p">(</span><span class="n">error</span><span class="p">);</span>

      <span class="c1">// Flush and execute the read buffer</span>
      <span class="n">error</span> <span class="o">=</span> <span class="n">clFinish</span><span class="p">(</span><span class="n">command_queue</span><span class="p">);</span>
      <span class="n">CL_CHECK</span><span class="p">(</span><span class="n">error</span><span class="p">);</span>

      <span class="c1">// Verify the results of the frame</span>
      <span class="k">for</span> <span class="p">(</span><span class="kt">size_t</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">frame_count</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">const</span> <span class="kt">cl_int</span> <span class="n">result</span> <span class="o">=</span> <span class="n">input_a</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">input_b</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">output</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">!=</span> <span class="n">result</span><span class="p">)</span> <span class="p">{</span>
          <span class="n">std</span><span class="o">::</span><span class="n">cerr</span> <span class="o">&lt;&lt;</span> <span class="s">"Error: Incorrect result at index "</span> <span class="o">&lt;&lt;</span> <span class="n">i</span> <span class="o">&lt;&lt;</span> <span class="s">" - Expected "</span>
                    <span class="o">&lt;&lt;</span> <span class="n">output</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&lt;&lt;</span> <span class="s">" was "</span> <span class="o">&lt;&lt;</span> <span class="n">result</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
          <span class="n">std</span><span class="o">::</span><span class="n">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
        <span class="p">}</span>
      <span class="p">}</span>
    <span class="p">}</span>

    <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">"Result verified</span><span class="se">\n</span><span class="s">"</span><span class="p">;</span>

    <span class="n">CL_CHECK</span><span class="p">(</span><span class="n">clReleaseCommandBufferKHR</span><span class="p">(</span><span class="n">command_buffer</span><span class="p">));</span>
    <span class="k">for</span> <span class="p">(</span><span class="kt">size_t</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
      <span class="n">CL_CHECK</span><span class="p">(</span><span class="n">clReleaseMemObject</span><span class="p">(</span><span class="n">input_A_buffers</span><span class="p">[</span><span class="n">i</span><span class="p">]));</span>
      <span class="n">CL_CHECK</span><span class="p">(</span><span class="n">clReleaseMemObject</span><span class="p">(</span><span class="n">input_B_buffers</span><span class="p">[</span><span class="n">i</span><span class="p">]));</span>
      <span class="n">CL_CHECK</span><span class="p">(</span><span class="n">clReleaseMemObject</span><span class="p">(</span><span class="n">output_buffers</span><span class="p">[</span><span class="n">i</span><span class="p">]));</span>
    <span class="p">}</span>
    <span class="n">CL_CHECK</span><span class="p">(</span><span class="n">clReleaseCommandQueue</span><span class="p">(</span><span class="n">command_queue</span><span class="p">));</span>
    <span class="n">CL_CHECK</span><span class="p">(</span><span class="n">clReleaseKernel</span><span class="p">(</span><span class="n">kernel</span><span class="p">));</span>
    <span class="n">CL_CHECK</span><span class="p">(</span><span class="n">clReleaseProgram</span><span class="p">(</span><span class="n">program</span><span class="p">));</span>
    <span class="n">CL_CHECK</span><span class="p">(</span><span class="n">clReleaseContext</span><span class="p">(</span><span class="n">context</span><span class="p">));</span>
    <span class="n">CL_CHECK</span><span class="p">(</span><span class="n">clReleaseDevice</span><span class="p">(</span><span class="n">device</span><span class="p">));</span>
    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
  <span class="p">}</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_issues_5"><a class="anchor" href="#_issues_5"></a>50.10. Issues</h3>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Include simpler, more user friendly, entry-points for updating kernel
arguments?</p>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p><strong>RESOLVED</strong>: Can be implemented in the ecosystem as a layer on top, if
that layer proves popular then can be introduced, possibly as another
extension on top.</p>
</div>
</div>
</div>
</li>
<li>
<p>Add a command-buffer clone entry-point for deep copying a command-buffer?
Arguments could then be updated and both command-buffers used. Useful for
techniques like double buffering.</p>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p><strong>Resolved</strong>: In the use-case we&#8217;re targeting a user would only have a handle to
the original command-buffer, but not the clone, which may limit the usefulness
of this capability. Additionally, an implementation could be complicated by
non-trivial deep copying of the underlying objects contained in the
command-buffer. As a result of this new entry-point being an additive change to
the specification it is omitted, and if its functionality has demand later, it
may be a introduced as a stand alone extension.</p>
</div>
</div>
</div>
</li>
<li>
<p>Introduce a <code>CL_MUTABLE_DISPATCH_ADDITIONAL_WORK_GROUPS_KHR</code> capability to
allow the number of work-groups in kernel execution to be increased during
update.</p>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p><strong>Resolved</strong>: Can be included in the final release of the extension if there is
implementation coverage.</p>
</div>
</div>
</div>
</li>
</ol>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="cl_khr_command_buffer_multi_device"><a class="anchor" href="#cl_khr_command_buffer_multi_device"></a>51. Command Buffers - Multiple Devices (Provisional)</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This extension enables users to record commands across multiple queues in the same command-buffer,
providing execution of heterogeneous task graphs from command-queues associated with different devices.</p>
</div>
<div class="sect2">
<h3 id="_general_information_50"><a class="anchor" href="#_general_information_50"></a>51.1. General Information</h3>
<div class="sect3">
<h4 id="_name_strings_14"><a class="anchor" href="#_name_strings_14"></a>51.1.1. Name Strings</h4>
<div class="paragraph">
<p><code>cl_khr_command_buffer_multi_device</code></p>
</div>
</div>
<div class="sect3">
<h4 id="_version_history_50"><a class="anchor" href="#_version_history_50"></a>51.1.2. Version History</h4>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 60%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><strong>Date</strong></th>
<th class="tableblock halign-left valign-top"><strong>Version</strong></th>
<th class="tableblock halign-left valign-top"><strong>Description</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">2023-04-14</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.9.0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">First assigned version (provisional).</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="_dependencies_14"><a class="anchor" href="#_dependencies_14"></a>51.1.3. Dependencies</h4>
<div class="paragraph">
<p>This extension requires the <code>cl_khr_command_buffer</code> extension version 0.9.0.</p>
</div>
</div>
<div class="sect3">
<h4 id="_contributors_10"><a class="anchor" href="#_contributors_10"></a>51.1.4. Contributors</h4>
<div class="paragraph">
<p>Ewan Crawford, Codeplay Software Ltd.<br>
Gordon Brown, Codeplay Software Ltd.<br>
Kenneth Benzie, Codeplay Software Ltd.<br>
Alastair Murray, Codeplay Software Ltd.<br>
Jack Frankland, Codeplay Software Ltd.<br>
Balaji Calidas, Qualcomm Technologies Inc.<br>
Joshua Kelly, Qualcomm Technologies, Inc.<br>
Kevin Petit, Arm Ltd.<br>
Aharon Abramson, Intel.<br>
Ben Ashbaugh, Intel.<br>
Boaz Ouriel, Intel.<br>
Pekka Jskelinen, Tampere University<br>
Jan Solanti, Tampere University<br>
Nikhil Joshi, NVIDIA<br>
James Price, Google<br></p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_overview_4"><a class="anchor" href="#_overview_4"></a>51.2. Overview</h3>
<div class="paragraph">
<p>The <code>cl_khr_command_buffer</code> extension separates command construction from
enqueue by providing a mechanism to record a set of commands which can then be
repeatedly enqueued. However, the commands in a command-buffer can
only be recorded to a single command-queue specified on command-buffer creation.</p>
</div>
<div class="paragraph">
<p><code>cl_khr_command_buffer_multi_device</code> extends the scope of a command-buffer to
allow commands to be recorded across multiple queues in the same command-buffer,
providing execution of heterogeneous task graphs from command-queues associated
with different devices.</p>
</div>
<div class="paragraph">
<p>The ability for a user to deep copy an existing command-buffer so that the
commands target a different device is also made possible by
<code>cl_khr_command_buffer_multi_device</code>. Depending on platform support the mapping
of commands to the new target device can be done either explicitly by the user,
or automatically by the OpenCL runtime.</p>
</div>
</div>
<div class="sect2">
<h3 id="_new_types_6"><a class="anchor" href="#_new_types_6"></a>51.3. New Types</h3>
<div class="paragraph">
<p>Bitfield for querying command-buffer capabilities of an OpenCL Platform with
<strong>clGetPlatformInfo</strong>, see the
<a href="#cl_khr_command_buffer_multi_device-platform-queries">platform queries table</a>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="opencl"><span class="k">typedef</span> <span class="kt">cl_bitfield</span> <span class="kt">cl_platform_command_buffer_capabilities_khr</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_new_api_functions_8"><a class="anchor" href="#_new_api_functions_8"></a>51.4. New API Functions</h3>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="opencl"><span class="kt">cl_command_buffer_khr</span> <span class="nf">clRemapCommandBufferKHR</span><span class="p">(</span>
    <span class="kt">cl_command_buffer_khr</span> <span class="n">command_buffer</span><span class="p">,</span>
    <span class="kt">cl_bool</span> <span class="n">automatic</span><span class="p">,</span>
    <span class="kt">cl_uint</span> <span class="n">num_queues</span><span class="p">,</span>
    <span class="k">const</span> <span class="kt">cl_command_queue</span><span class="o">*</span> <span class="n">queues</span><span class="p">,</span>
    <span class="kt">cl_uint</span> <span class="n">num_handles</span><span class="p">,</span>
    <span class="k">const</span> <span class="kt">cl_mutable_command_khr</span><span class="o">*</span> <span class="n">handles</span><span class="p">,</span>
    <span class="kt">cl_mutable_command_khr</span><span class="o">*</span> <span class="n">handles_ret</span><span class="p">,</span>
    <span class="kt">cl_int</span><span class="o">*</span> <span class="n">errcode_ret</span><span class="p">);</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_new_api_enums_9"><a class="anchor" href="#_new_api_enums_9"></a>51.5. New API Enums</h3>
<div class="paragraph">
<p>Enums for querying device command-buffer capabilities with
<strong>clGetDeviceInfo</strong>, see the
<a href="#cl_khr_command_buffer_multi_device-device-queries">device queries table</a>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="opencl"><span class="c1">// Accepted values for the param_name parameter to clGetDeviceInfo</span>
<span class="n">CL_DEVICE_COMMAND_BUFFER_NUM_SYNC_DEVICES_KHR</span>      <span class="mh">0x12AB</span>
<span class="n">CL_DEVICE_COMMAND_BUFFER_SYNC_DEVICES_KHR</span>          <span class="mh">0x12AC</span>

<span class="c1">// Bits for cl_device_command_buffer_capabilities_khr bitfield</span>
<span class="n">CL_COMMAND_BUFFER_CAPABILITY_MULTIPLE_QUEUE_KHR</span>    <span class="p">(</span><span class="mh">0x1</span> <span class="o">&lt;&lt;</span> <span class="mi">4</span><span class="p">)</span>

<span class="c1">// Bits for cl_command_buffer_flags_khr</span>
<span class="n">CL_COMMAND_BUFFER_DEVICE_SIDE_SYNC_KHR</span>             <span class="p">(</span><span class="mh">0x1</span> <span class="o">&lt;&lt;</span> <span class="mi">2</span><span class="p">)</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Enums for querying platform command-buffer capabilities with
<strong>clGetPlatformInfo</strong>, see the
<a href="#cl_khr_command_buffer_multi_device-platform-queries">platform queries table</a>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="opencl"><span class="c1">// Accepted values for the param_name parameter to clGetPlatformInfo</span>
<span class="n">CL_PLATFORM_COMMAND_BUFFER_CAPABILITIES_KHR</span>        <span class="mh">0x0908</span>

<span class="c1">// Bits for cl_platform_command_buffer_capabilities_khr bitfield</span>
<span class="n">CL_COMMAND_BUFFER_PLATFORM_UNIVERSAL_SYNC_KHR</span>      <span class="p">(</span><span class="mh">0x1</span> <span class="o">&lt;&lt;</span> <span class="mi">0</span><span class="p">)</span>
<span class="n">CL_COMMAND_BUFFER_PLATFORM_REMAP_QUEUES_KHR</span>        <span class="p">(</span><span class="mh">0x1</span> <span class="o">&lt;&lt;</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">CL_COMMAND_BUFFER_PLATFORM_AUTOMATIC_REMAP_KHR</span>     <span class="p">(</span><span class="mh">0x1</span> <span class="o">&lt;&lt;</span> <span class="mi">2</span><span class="p">)</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_modifications_to_section_4_1_of_the_opencl_api_specification"><a class="anchor" href="#_modifications_to_section_4_1_of_the_opencl_api_specification"></a>51.6. Modifications to section 4.1 of the OpenCL API Specification</h3>
<div class="paragraph">
<p>Add to <strong>Table 3</strong>, <em>Platform Queries</em>,</p>
</div>
<table id="cl_khr_command_buffer_multi_device-platform-queries" class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 16.6666%;">
<col style="width: 16.6666%;">
<col style="width: 66.6668%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Platform Info</th>
<th class="tableblock halign-left valign-top">Return Type</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CL_PLATFORM_<wbr>COMMAND_<wbr>BUFFER_<wbr>CAPABILITIES_<wbr>KHR</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>cl_platform_<wbr>command_<wbr>buffer_<wbr>capabilities_<wbr>khr</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Describes platform command-buffer capabilities, encoded as bits in a bitfield.
  Supported capabilities are:</p>
<p class="tableblock">  <code>CL_COMMAND_<wbr>BUFFER_<wbr>PLATFORM_<wbr>UNIVERSAL_<wbr>SYNC_<wbr>KHR</code> - Platform supports the ability
  to synchronize all commands in a command-buffer using sync-points, irrespective
  of the queue the individual commands are recorded to.</p>
<p class="tableblock">  <code>CL_COMMAND_<wbr>BUFFER_<wbr>PLATFORM_<wbr>REMAP_<wbr>QUEUES_<wbr>KHR</code> - Platform supports the ability
  to create a deep copy of an existing command-buffer with the commands
  explicitly remapped to different, potentially <a href="#compatible">incompatible</a>,
  queues.</p>
<p class="tableblock">  <code>CL_COMMAND_<wbr>BUFFER_<wbr>PLATFORM_<wbr>AUTOMATIC_<wbr>REMAP_<wbr>KHR</code> - Platform supports the
  ability to create a remapped command-buffer where the mapping of commands to
  queues is done by the OpenCL runtime in a way it determines as optimal. If
  <code>CL_COMMAND_<wbr>BUFFER_<wbr>PLATFORM_<wbr>AUTOMATIC_<wbr>REMAP_<wbr>KHR</code> is reported,
  <code>CL_COMMAND_<wbr>BUFFER_<wbr>PLATFORM_<wbr>REMAP_<wbr>QUEUES_<wbr>KHR</code> must also be reported.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="_modifications_to_section_4_2_of_the_opencl_api_specification_3"><a class="anchor" href="#_modifications_to_section_4_2_of_the_opencl_api_specification_3"></a>51.7. Modifications to section 4.2 of the OpenCL API Specification</h3>
<div class="paragraph">
<p>Add <code>CL_DEVICE_<wbr>COMMAND_<wbr>BUFFER_<wbr>NUM_<wbr>SYNC_<wbr>DEVICES_<wbr>KHR</code> and
<code>CL_DEVICE_<wbr>COMMAND_<wbr>BUFFER_<wbr>SYNC_<wbr>DEVICES_<wbr>KHR</code> rows to <strong>Table 5</strong>, <em>Device Queries</em>,
of section 4.2. Also, add additional text to the
<code>CL_DEVICE_<wbr>COMMAND_<wbr>BUFFER_<wbr>CAPABILITIES_<wbr>KHR</code> row:</p>
</div>
<table id="cl_khr_command_buffer_multi_device-device-queries" class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 16.6666%;">
<col style="width: 16.6666%;">
<col style="width: 66.6668%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><code>cl_device_<wbr>info</code></th>
<th class="tableblock halign-left valign-top">Return Type</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CL_DEVICE_<wbr>COMMAND_<wbr>BUFFER_<wbr>CAPABILITIES_<wbr>KHR</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>cl_device_<wbr>command_<wbr>buffer_<wbr>capabilities_<wbr>khr</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Describes device command-buffer capabilities, encoded as bits in a bitfield.
  Supported capabilities are:</p>
<p class="tableblock">  <code>CL_COMMAND_<wbr>BUFFER_<wbr>CAPABILITY_<wbr>MULTIPLE_<wbr>QUEUE_<wbr>KHR</code> Device supports the ability
  to record commands to more than one command-queue associated with <em>device</em> in
  a single command-buffer.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CL_DEVICE_<wbr>COMMAND_<wbr>BUFFER_<wbr>NUM_<wbr>SYNC_<wbr>DEVICES_<wbr>KHR</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>cl_uint</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Return the number of devices <em>device</em> can use device-side synchronization
  with.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CL_DEVICE_<wbr>COMMAND_<wbr>BUFFER_<wbr>SYNC_<wbr>DEVICES_<wbr>KHR</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>cl_device_<wbr>id</code>[]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Return the list of devices and sub-devices <em>device</em> can use device-side
  synchronization with. A device should list itself only if it has native
  support for synchronizing commands.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="_modifications_to_section_5_11_of_the_opencl_api_specification_2"><a class="anchor" href="#_modifications_to_section_5_11_of_the_opencl_api_specification_2"></a>51.8. Modifications to section 5.11 of the OpenCL API Specification</h3>
<div class="paragraph">
<p>Add additional wording to the description column of <strong>Table 36</strong>, <em>Event Object
Queries</em>:</p>
</div>
<div class="paragraph">
<p><code>CL_EVENT_<wbr>COMMAND_<wbr>QUEUE</code> - For events returned by a command-buffer enqueue
operation to multiple command-queues, <code>NULL</code> is returned.</p>
</div>
<div class="paragraph">
<p><code>CL_EVENT_<wbr>COMMAND_<wbr>EXECUTION_<wbr>STATUS</code> - For events returned by a command-buffer
enqueue operation to multiple command-queues the semantics of execution status
is as follows:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>CL_QUEUED</code> - Command-buffer has been enqueued across the command-queues.</p>
</li>
<li>
<p><code>CL_SUBMITTED</code> - Commands from the command-buffer have been submitted by
the host to any device associated with one of the command-queues.</p>
</li>
<li>
<p><code>CL_RUNNING</code> - Any command from the command-buffer has started execution on
a device.</p>
</li>
<li>
<p><code>CL_COMPLETE</code> - All commands have completed on all devices.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_modifications_to_section_5_14_of_the_opencl_api_specification"><a class="anchor" href="#_modifications_to_section_5_14_of_the_opencl_api_specification"></a>51.9. Modifications to section 5.14 of the OpenCL API Specification</h3>
<div class="sect3">
<h4 id="_query_updates"><a class="anchor" href="#_query_updates"></a>51.9.1. Query Updates</h4>
<div class="paragraph">
<p>Add additional wording to description column of <strong>Table 38</strong>, <em>Event Profiling
Queries</em>:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>CL_PROFILING_<wbr>COMMAND_<wbr>QUEUED</code> - For events returned by a command-buffer
enqueue operation to multiple command-queues, the host time when the
command-buffer has been enqueued across the command-queues is used.</p>
</li>
<li>
<p><code>CL_PROFILING_<wbr>COMMAND_<wbr>SUBMIT</code> - For events returned by a command-buffer
enqueue operation to multiple command-queues, the host time is used when
command-buffer commands have been submitted to any command-queue.</p>
</li>
<li>
<p><code>CL_PROFILING_<wbr>COMMAND_<wbr>START</code> - For events returned by a command-buffer
enqueue operation to multiple command-queues, the host time is used when
any device starts executing a command-buffer command.</p>
</li>
<li>
<p><code>CL_PROFILING_<wbr>COMMAND_<wbr>END</code> - For events returned by a command-buffer
enqueue operation to multiple command-queues, the host time is used when
the last command-buffer command finishes execution on any device.</p>
</li>
<li>
<p><code>CL_PROFILING_<wbr>COMMAND_<wbr>COMPLETE</code> - For events returned by a command-buffer
enqueue operation to multiple command-queues, the host time is used when the
command-buffer has completed execution across all command-queues.</p>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>If no reliable device timer sources are available to inform the host side,
or parallel runtime scheduling makes it impossible to identify a first/last
command, then an implementation may fallback to reporting
<code>CL_PROFILING_<wbr>COMMAND_<wbr>SUBMIT</code> and <code>CL_PROFILING_<wbr>COMMAND_<wbr>COMPLETE</code> for
<code>CL_PROFILING_<wbr>COMMAND_<wbr>START</code> and <code>CL_PROFILING_<wbr>COMMAND_<wbr>END</code> respectively.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_error_updates"><a class="anchor" href="#_error_updates"></a>51.9.2. Error Updates</h4>
<div class="paragraph">
<p>Extend the wording defining the <code>CL_PROFILING_<wbr>INFO_<wbr>NOT_<wbr>AVAILABLE</code> error return
code from <strong>clGetEventProfilingInfo</strong> to append the following sentence:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>If <em>event</em> was created from a call to <strong>clEnqueueCommandBufferKHR</strong>,
<code>CL_PROFILING_<wbr>INFO_<wbr>NOT_<wbr>AVAILABLE</code> is returned if all the queues passed
do not have <code>CL_QUEUE_<wbr>PROFILING_<wbr>ENABLE</code> set.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_modifications_to_section_5_x_command_buffers_of_the_opencl_api_specification_2"><a class="anchor" href="#_modifications_to_section_5_x_command_buffers_of_the_opencl_api_specification_2"></a>51.10. Modifications to Section 5.X - Command Buffers of the OpenCL API Specification</h3>
<div class="sect3">
<h4 id="_additional_section_5_x_introduction_text"><a class="anchor" href="#_additional_section_5_x_introduction_text"></a>51.10.1. Additional Section 5.X Introduction Text</h4>
<div class="paragraph">
<p>A command-buffer can contain commands recorded to the queues of different
devices if a vendor provides support for inter-device <code>cl_sync_<wbr>point_<wbr>khr</code>
synchronization. This feature is reported either through
<code>CL_DEVICE_<wbr>COMMAND_<wbr>BUFFER_<wbr>SYNC_<wbr>DEVICES_<wbr>KHR</code>, which informs the user what devices can
synchronize with each other natively on the device-side, or through
<code>CL_COMMAND_<wbr>BUFFER_<wbr>PLATFORM_<wbr>UNIVERSAL_<wbr>SYNC_<wbr>KHR</code>, which allows synchronization
between all devices in a platform, falling back to host-side synchronization
when device-side synchronization isn&#8217;t available. These two mechanisms are
referred to as <strong>device-side sync</strong> and <strong>universal sync</strong> respectively.</p>
</div>
<div class="paragraph">
<p>If these mechanisms don&#8217;t report that more than one device can be used in a
command-buffer, it will still be possible to perform multiple queue recording in a
command-buffer if the <code>CL_COMMAND_<wbr>BUFFER_<wbr>CAPABILITY_<wbr>MULTIPLE_<wbr>QUEUE_<wbr>KHR</code>
capability is reported for a device. However, with this capability all the
queues commands are recorded to must target the same device.</p>
</div>
<div class="paragraph">
<p>Commands recorded to different command-queues in the same command-buffer may be
executed concurrently to each other unless synchronized explicitly with
sync-points. Ordering of other commands submitted to the same command-queues as
used to enqueue a command-buffer is the responsibility of the programmer. A
command-buffer enqueue spanning multiple queues can return an event to use for
synchronization, which will complete once all commands in the command-buffer
have completed. If ordering restrictions are required, this event (or
command-queue barriers) may be used by the user to synchronize the
command-buffer enqueue with regular commands, or another command-buffer enqueue.</p>
</div>
</div>
<div class="sect3">
<h4 id="_add_new_section_section_5_x_y_remapping_command_buffers"><a class="anchor" href="#_add_new_section_section_5_x_y_remapping_command_buffers"></a>51.10.2. Add new section "Section 5.X.Y - Remapping Command Buffers"</h4>
<div class="paragraph">
<p>Platforms reporting the <code>CL_COMMAND_<wbr>BUFFER_<wbr>PLATFORM_<wbr>REMAP_<wbr>QUEUES_<wbr>KHR</code> capability
support generating a deep copy of a command-buffer with its commands remapped to a
list of command-queues that are potentially <a href="#compatible">incompatible</a> with the queues
used to create the command-buffer. That is, the remapped command-buffer can
execute on queues that differ in terms of properties and/or associated device
from the original command-buffer queues.</p>
</div>
<div class="paragraph">
<p>This functionality is invoked through a new synchronous entry-point
<strong>clRemapCommandBufferKHR</strong> which takes a list of queues to which the commands
should now target. It then returns a command-buffer containing the same
commands as the original, with the same command dependencies, but targeting
different queues. A list of command handles may also be passed to the
entry-point, which allows handles to the equivalent commands in the remapped
command-buffer to be returned by an output parameter.</p>
</div>
<div class="paragraph">
<p>Device properties restrict remapping possibilities, as existing commands
can have a configuration which is not supported by another device, and so
remapping may fail with an error relating to this incompatibility. Examples
of command configurations which can introduce incompatibilities when trying to
map to a new device are:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Program language features used in a kernel not supported by the new device.</p>
</li>
<li>
<p>ND-Range configuration, e.g exceeds new the device max work-group size.</p>
</li>
<li>
<p>Misalignment of sub-buffers based on minimum alignment of new device.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>In additional to this functionality, platforms reporting
<code>CL_COMMAND_<wbr>BUFFER_<wbr>PLATFORM_<wbr>AUTOMATIC_<wbr>REMAP_<wbr>KHR</code> allow the user to create a
remapped command-buffer where the mapping of queues to commands is determined by
the OpenCL runtime in a way it determines as optimal. This is particularly
useful in hot plugging environments where devices may appear and disappear
during runtime.</p>
</div>
<div class="paragraph">
<p>The function</p>
</div>
<div id="clRemapCommandBufferKHR" class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="opencl"><span class="kt">cl_command_buffer_khr</span> <span class="nf">clRemapCommandBufferKHR</span><span class="p">(</span>
    <span class="kt">cl_command_buffer_khr</span> <span class="n">command_buffer</span><span class="p">,</span>
    <span class="kt">cl_bool</span> <span class="n">automatic</span><span class="p">,</span>
    <span class="kt">cl_uint</span> <span class="n">num_queues</span><span class="p">,</span>
    <span class="k">const</span> <span class="kt">cl_command_queue</span><span class="o">*</span> <span class="n">queues</span><span class="p">,</span>
    <span class="kt">cl_uint</span> <span class="n">num_handles</span><span class="p">,</span>
    <span class="k">const</span> <span class="kt">cl_mutable_command_khr</span><span class="o">*</span> <span class="n">handles</span><span class="p">,</span>
    <span class="kt">cl_mutable_command_khr</span><span class="o">*</span> <span class="n">handles_ret</span><span class="p">,</span>
    <span class="kt">cl_int</span><span class="o">*</span> <span class="n">errcode_ret</span><span class="p">);</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Creates a deep copy of the input command-buffer with the copied commands
remapped to target the passed command-queues. The returned command-buffer
has the same state as the input command-buffer, unless the input
command-buffer is in the <a href="#pending">Pending</a> state, in which case the returned
command-buffer has state <a href="#executable">Executable</a>.</p>
</div>
<div class="paragraph">
<p><em>command_buffer</em> Specifies the command-buffer to create a remapped deep copy of.</p>
</div>
<div class="paragraph">
<p><em>automatic</em> Indicates if the remapping is done explicitly by the user, or
automatically by the OpenCL runtime. If <em>automatic</em> is <code>CL_FALSE</code>, then each
element of <em>queues</em> will replace the queue used on <em>command_buffer</em> creation at
the same index. If <code>CL_TRUE</code> and <code>CL_COMMAND_<wbr>BUFFER_<wbr>PLATFORM_<wbr>AUTOMATIC_<wbr>REMAP_<wbr>KHR</code>
is supported, then the OpenCL runtime will decide in a way it determines optimal
which of the elements in <em>queues</em> each command in the returned command-buffer
will be associated with.</p>
</div>
<div class="paragraph">
<p><em>num_queues</em> The number of command-queues listed in <em>queues</em>, must not be 0.</p>
</div>
<div class="paragraph">
<p><em>queues</em> A pointer to an ordered list of command-queues for the returned
command-buffer to target, must be a non-<code>NULL</code> value.</p>
</div>
<div class="paragraph">
<p><em>num_handles</em> The number of command handles passed in both <em>handles</em> and
<em>handles_ret</em> lists, may be 0.</p>
</div>
<div class="paragraph">
<p><em>handles</em> An ordered list of handles belonging to <em>command_buffer</em> to create
remapped copies of, may be <code>NULL</code>.</p>
</div>
<div class="paragraph">
<p><em>handles_ret</em> Returns an ordered list of handles where each handle is equivalent
to the handle at the same index in <em>handles</em>, but belonging to the returned
command-buffer.</p>
</div>
<div class="paragraph">
<p><em>errcode_ret</em> Returns an appropriate error code. If <em>errcode_ret</em> is <code>NULL</code>, no
error code is returned.</p>
</div>
<div class="paragraph">
<p><strong>clRemapCommandBufferKHR</strong> returns a valid command-buffer with <em>errcode_ret</em> set
to <code>CL_SUCCESS</code> if the command-buffer is created successfully. Otherwise, it
returns a <code>NULL</code> value without setting <em>handles_ret</em>, and with one of the
following error values returned in <em>errcode_ret</em>:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>CL_INVALID_<wbr>COMMAND_<wbr>BUFFER_<wbr>KHR</code> if <em>command_buffer</em> is not a valid
command-buffer.</p>
</li>
<li>
<p><code>CL_INVALID_<wbr>VALUE</code> if <em>num_queues</em> is 0, or if <em>queues</em> is <code>NULL</code>.</p>
</li>
<li>
<p><code>CL_INVALID_<wbr>VALUE</code> if <em>automatic</em> is <code>CL_FALSE</code> and <em>num_queues</em> is not equal
to the number of queues used on creation of <em>command_buffer</em>.</p>
</li>
<li>
<p><code>CL_INVALID_<wbr>VALUE</code> if <em>handles</em> or <em>handles_ret</em> is <code>NULL</code> and
<em>num_handles</em> is &gt; 0, or either <em>handles</em> or <em>handles_ret</em> is not
<code>NULL</code> and <em>num_handles</em> is 0.</p>
</li>
<li>
<p><code>CL_INVALID_<wbr>VALUE</code> if any handle in <em>handles</em> is not a valid command handle
belonging to <em>command_buffer</em>.</p>
</li>
<li>
<p><code>CL_INVALID_<wbr>COMMAND_<wbr>QUEUE</code> if any command-queue in <em>queues</em> is not a valid
command-queue.</p>
</li>
<li>
<p><code>CL_INVALID_<wbr>CONTEXT</code> if <em>command_buffer</em> and all the command-queues in
<em>queues</em> do not have the same OpenCL context.</p>
</li>
<li>
<p><code>CL_INVALID_<wbr>OPERATION</code> if the platform does not support the
<code>CL_COMMAND_<wbr>BUFFER_<wbr>PLATFORM_<wbr>REMAP_<wbr>QUEUES_<wbr>KHR</code> flag.</p>
</li>
<li>
<p><code>CL_INVALID_<wbr>OPERATION</code> if the platform does not support the
<code>CL_COMMAND_<wbr>BUFFER_<wbr>PLATFORM_<wbr>AUTOMATIC_<wbr>REMAP_<wbr>KHR</code> flag and <em>automatic</em> is
<code>CL_TRUE</code>.</p>
</li>
<li>
<p><code>CL_INCOMPATIBLE_<wbr>COMMAND_<wbr>QUEUE_<wbr>KHR</code> if such an error would be returned by
passing <em>queues</em> to <strong>clCreateCommandBufferKHR</strong>.</p>
</li>
<li>
<p>Any error relating to device support that can be returned by a command
recording entry-point may also be returned. As a command in <em>command_buffer</em>
can have a configuration that is not supported by a device that is associated
with the queue in <em>queues</em> the command is being remapped to.</p>
</li>
<li>
<p><code>CL_OUT_<wbr>OF_<wbr>RESOURCES</code> if there is a failure to allocate resources
required by the OpenCL implementation on the device.</p>
</li>
<li>
<p><code>CL_OUT_<wbr>OF_<wbr>HOST_<wbr>MEMORY</code> if there is a failure to allocate resources
required by the OpenCL implementation on the host.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_modifications_to_clcreatecommandbufferkhr_2"><a class="anchor" href="#_modifications_to_clcreatecommandbufferkhr_2"></a>51.10.3. Modifications to clCreateCommandBufferKHR</h4>

</div>
<div class="sect3">
<h4 id="_new_property_flag"><a class="anchor" href="#_new_property_flag"></a>51.10.4. New Property Flag</h4>
<div class="paragraph">
<p>Modify the <code>CL_COMMAND_<wbr>BUFFER_<wbr>FLAGS_<wbr>KHR</code> property in the
<strong>clCreateCommandBufferKHR</strong> properties table to introduce a new flag to the
bitfield. The following text is now included in the description of property
values.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><strong>Recording Properties</strong></th>
<th class="tableblock halign-left valign-top"><strong>Property Value</strong></th>
<th class="tableblock halign-left valign-top"><strong>Description</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CL_COMMAND_<wbr>BUFFER_<wbr>FLAGS_<wbr>KHR</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>cl_command_<wbr>buffer_<wbr>flags_<wbr>khr</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CL_COMMAND_<wbr>BUFFER_<wbr>DEVICE_<wbr>SIDE_<wbr>SYNC_<wbr>KHR</code> - All commands in the command-buffer
  must use native synchronization, as reported by
  <code>CL_DEVICE_<wbr>COMMAND_<wbr>BUFFER_<wbr>SYNC_<wbr>DEVICES_<wbr>KHR</code>. This can be used as a safeguard
  for performant applications that don&#8217;t want to accidentally fallback to host
  synchronization when passing multiple queues.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="_add_to_clcreatecommandbufferkhr_description"><a class="anchor" href="#_add_to_clcreatecommandbufferkhr_description"></a>51.10.5. Add to clCreateCommandBufferKHR description</h4>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 73. Summary of command-buffer creation configurations</caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">All devices associated with <code>queues</code> can device-side sync</th>
<th class="tableblock halign-left valign-top">Platform supports universal sync</th>
<th class="tableblock halign-left valign-top">Condition</th>
<th class="tableblock halign-left valign-top">Result</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top" rowspan="3"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top" rowspan="3"><p class="tableblock">Yes or No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Any device does not support the multi-queue capability, and has more than one
  queue targeting it</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Error - <code>CL_INCOMPATIBLE_<wbr>COMMAND_<wbr>QUEUE_<wbr>KHR</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">User sets <code>CL_COMMAND_<wbr>BUFFER_<wbr>DEVICE_<wbr>SIDE_<wbr>SYNC_<wbr>KHR</code> flag</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">OK</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Otherwise</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">OK</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top" rowspan="3"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top" rowspan="3"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Any device does not support the multi-queue capability, and has more than one
  queue targeting it</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Error - <code>CL_INCOMPATIBLE_<wbr>COMMAND_<wbr>QUEUE_<wbr>KHR</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">User sets <code>CL_COMMAND_<wbr>BUFFER_<wbr>DEVICE_<wbr>SIDE_<wbr>SYNC_<wbr>KHR</code> flag</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Error - <code>CL_INCOMPATIBLE_<wbr>COMMAND_<wbr>QUEUE_<wbr>KHR</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Otherwise</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">OK - May be performance implications when synchronizing commands between devices
  without device-side sync support.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top" rowspan="2"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top" rowspan="2"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Always</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Error - <code>CL_INCOMPATIBLE_<wbr>COMMAND_<wbr>QUEUE_<wbr>KHR</code></p></td>
</tr>
</tbody>
</table>
<div class="sect4">
<h5 id="_parameter_updates"><a class="anchor" href="#_parameter_updates"></a>51.10.5.1. Parameter Updates</h5>
<div class="paragraph">
<p>Parameter descriptions changed to:</p>
</div>
<div class="paragraph">
<p><em>num_queues</em> The number of command-queues listed in <em>queues</em>.</p>
</div>
<div class="paragraph">
<p><em>queues</em>  Is a pointer to a list of command-queues that the command-buffer may be
executed on. <em>queues</em> must be a non-<code>NULL</code> value and length of the list equal to
<em>num_queues</em>.</p>
</div>
</div>
<div class="sect4">
<h5 id="_error_updates_2"><a class="anchor" href="#_error_updates_2"></a>51.10.5.2. Error Updates</h5>
<div class="paragraph">
<p>The returned error:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>CL_INVALID_<wbr>VALUE</code> if <em>num_queues</em> is not one.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Is changed to:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>CL_INVALID_<wbr>VALUE</code> if <em>num_queues</em> is zero.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Additional errors:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>CL_INCOMPATIBLE_<wbr>COMMAND_<wbr>QUEUE_<wbr>KHR</code> if <em>queues</em> includes more than one
command-queue associated with a device that does not support capability
<code>CL_COMMAND_<wbr>BUFFER_<wbr>CAPABILITY_<wbr>MULTIPLE_<wbr>QUEUE_<wbr>KHR</code>.</p>
</li>
<li>
<p><code>CL_INCOMPATIBLE_<wbr>COMMAND_<wbr>QUEUE_<wbr>KHR</code> if the
<code>CL_COMMAND_<wbr>BUFFER_<wbr>DEVICE_<wbr>SIDE_<wbr>SYNC_<wbr>KHR</code> flag is set, and any device
associated with a command-queue in <em>queues</em> does not have the other devices
associated with <em>queues</em> enumerated in
<code>CL_DEVICE_<wbr>COMMAND_<wbr>BUFFER_<wbr>SYNC_<wbr>DEVICES_<wbr>KHR</code>.</p>
</li>
<li>
<p><code>CL_INCOMPATIBLE_<wbr>COMMAND_<wbr>QUEUE_<wbr>KHR</code> if the platform doesn&#8217;t support the
<code>CL_COMMAND_<wbr>BUFFER_<wbr>PLATFORM_<wbr>UNIVERSAL_<wbr>SYNC_<wbr>KHR</code> capability, and any device
associated with a command-queue in <em>queues</em> does not have the other devices
associated with <em>queues</em> enumerated in
<code>CL_DEVICE_<wbr>COMMAND_<wbr>BUFFER_<wbr>SYNC_<wbr>DEVICES_<wbr>KHR</code>.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_command_recording_entry_points"><a class="anchor" href="#_command_recording_entry_points"></a>51.10.6. Command recording entry points</h4>
<div class="paragraph">
<p>The descriptions of command recording entry-points are modified as described in
this section. These changes apply to all of <strong>clCommandCopyBufferKHR</strong>,
<strong>clCommandCopyBufferRectKHR</strong>, <strong>clCommandCopyBufferToImageKHR</strong>,
<strong>clCommandCopyImageKHR</strong>, <strong>clCommandCopyImageToBufferKHR</strong>,
<strong>clCommandFillBufferKHR</strong>, <strong>clCommandFillImageKHR</strong>, and
<strong>clCommandNDRangeKernelKHR</strong>.</p>
</div>
<div class="sect4">
<h5 id="_parameter_update"><a class="anchor" href="#_parameter_update"></a>51.10.6.1. Parameter Update</h5>
<div class="paragraph">
<p>Parameter description of <em>command_queue</em> is changed to:</p>
</div>
<div class="paragraph">
<p><em>command_queue</em> Specifies the command-queue the command will be recorded to.
If <em>command_queue</em> is <code>NULL</code> then only one command-queue must have been set
on <em>command_buffer</em> creation, otherwise <em>command_queue</em> must be a non-<code>NULL</code>
value.</p>
</div>
</div>
<div class="sect4">
<h5 id="_error_update"><a class="anchor" href="#_error_update"></a>51.10.6.2. Error Update</h5>
<div class="paragraph">
<p>The error condition:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>CL_INVALID_<wbr>COMMAND_<wbr>QUEUE</code> if <em>command_queue</em> is not <code>NULL</code>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Is changed to :</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>CL_INVALID_<wbr>COMMAND_<wbr>QUEUE</code> if <em>command_queue</em> is <code>NULL</code> and <em>command_buffer</em>
was created with more than one queue, or if <em>command_queue</em> is non-<code>NULL</code> and
not a command-queue listed on <em>command_buffer</em> creation.</p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_sample_code_4"><a class="anchor" href="#_sample_code_4"></a>51.11. Sample Code</h3>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="opencl"><span class="cp">#define CL_CHECK(ERROR)                                                        \
  if (ERROR) {                                                                 \
    std::cerr &lt;&lt; "OpenCL error: " &lt;&lt; ERROR &lt;&lt; "\n";                            \
    return ERROR;                                                              \
  }
</span>
<span class="kt">int</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span>
  <span class="kt">cl_platform_id</span> <span class="n">platform</span><span class="p">;</span>
  <span class="n">CL_CHECK</span><span class="p">(</span><span class="n">clGetPlatformIDs</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">platform</span><span class="p">,</span> <span class="nb">nullptr</span><span class="p">));</span>
  <span class="kt">cl_platform_command_buffer_capabilities_khr</span> <span class="n">platform_caps</span><span class="p">;</span>
  <span class="n">CL_CHECK</span><span class="p">(</span><span class="n">clGetPlatformInfo</span><span class="p">(</span><span class="n">platform</span><span class="p">,</span>
                             <span class="n">CL_PLATFORM_COMMAND_BUFFER_CAPABILITIES_KHR</span><span class="p">,</span>
                             <span class="k">sizeof</span><span class="p">(</span><span class="n">platform_caps</span><span class="p">),</span> <span class="o">&amp;</span><span class="n">platform_caps</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">));</span>
  <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="p">(</span><span class="n">platform_caps</span> <span class="o">&amp;</span> <span class="n">CL_COMMAND_BUFFER_PLATFORM_AUTOMATIC_REMAP_KHR</span><span class="p">))</span> <span class="p">{</span>
    <span class="n">std</span><span class="o">::</span><span class="n">cerr</span> <span class="o">&lt;&lt;</span> <span class="s">"Command-buffer remapping not supported but used in example, "</span>
                 <span class="s">"skipping</span><span class="se">\n</span><span class="s">"</span><span class="p">;</span>
    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
  <span class="p">}</span>

  <span class="kt">cl_uint</span> <span class="n">num_devices</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
  <span class="n">CL_CHECK</span><span class="p">(</span><span class="n">clGetDeviceIDs</span><span class="p">(</span><span class="n">platform</span><span class="p">,</span> <span class="n">CL_DEVICE_TYPE_ALL</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">num_devices</span><span class="p">));</span>
  <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">cl_device_id</span><span class="o">&gt;</span> <span class="n">devices</span><span class="p">(</span><span class="n">num_devices</span><span class="p">);</span>
  <span class="n">CL_CHECK</span><span class="p">(</span>
      <span class="n">clGetDeviceIDs</span><span class="p">(</span><span class="n">platform</span><span class="p">,</span> <span class="n">CL_DEVICE_TYPE_ALL</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">devices</span><span class="p">.</span><span class="n">data</span><span class="p">(),</span> <span class="nb">nullptr</span><span class="p">));</span>

  <span class="c1">// Checks omitted for brevity that either a) the platform supports</span>
  <span class="c1">// CL_COMMAND_BUFFER_PLATFORM_UNIVERSAL_SYNC_KHR or b) each device is listed</span>
  <span class="c1">// in the others CL_DEVICE_COMMAND_BUFFER_SYNC_DEVICES_KHR</span>

  <span class="kt">cl_int</span> <span class="n">error</span><span class="p">;</span>
  <span class="kt">cl_context</span> <span class="n">context</span> <span class="o">=</span>
      <span class="n">clCreateContext</span><span class="p">(</span><span class="nb">NULL</span><span class="p">,</span> <span class="n">num_devices</span><span class="p">,</span> <span class="n">devices</span><span class="p">.</span><span class="n">data</span><span class="p">(),</span> <span class="nb">NULL</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">error</span><span class="p">);</span>
  <span class="n">CL_CHECK</span><span class="p">(</span><span class="n">error</span><span class="p">);</span>

  <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">cl_command_queue</span><span class="o">&gt;</span> <span class="n">queues</span><span class="p">(</span><span class="n">num_devices</span><span class="p">);</span>
  <span class="k">for</span> <span class="p">(</span><span class="kt">cl_uint</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">num_devices</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">queues</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">clCreateCommandQueue</span><span class="p">(</span><span class="n">context</span><span class="p">,</span> <span class="n">devices</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="mi">0</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">error</span><span class="p">);</span>
    <span class="n">CL_CHECK</span><span class="p">(</span><span class="n">error</span><span class="p">);</span>
  <span class="p">}</span>

  <span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">code</span> <span class="o">=</span> <span class="s">R"OpenCLC(
  kernel void vector_addition(global int* tile1, global int* tile2,
                              global int* res) {
    size_t index = get_global_id(0);
    res[index] = tile1[index] + tile2[index];
  }
  )OpenCLC"</span><span class="p">;</span>
  <span class="k">const</span> <span class="kt">size_t</span> <span class="n">length</span> <span class="o">=</span> <span class="n">std</span><span class="o">::</span><span class="n">strlen</span><span class="p">(</span><span class="n">code</span><span class="p">);</span>

  <span class="kt">cl_program</span> <span class="n">program</span> <span class="o">=</span>
      <span class="n">clCreateProgramWithSource</span><span class="p">(</span><span class="n">context</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">code</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">length</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">error</span><span class="p">);</span>
  <span class="n">CL_CHECK</span><span class="p">(</span><span class="n">error</span><span class="p">);</span>

  <span class="n">CL_CHECK</span><span class="p">(</span>
      <span class="n">clBuildProgram</span><span class="p">(</span><span class="n">program</span><span class="p">,</span> <span class="n">num_devices</span><span class="p">,</span> <span class="n">devices</span><span class="p">.</span><span class="n">data</span><span class="p">(),</span> <span class="nb">NULL</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">));</span>

  <span class="kt">cl_kernel</span> <span class="n">kernel</span> <span class="o">=</span> <span class="n">clCreateKernel</span><span class="p">(</span><span class="n">program</span><span class="p">,</span> <span class="s">"vector_addition"</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">error</span><span class="p">);</span>
  <span class="n">CL_CHECK</span><span class="p">(</span><span class="n">error</span><span class="p">);</span>

  <span class="k">constexpr</span> <span class="kt">size_t</span> <span class="n">frame_count</span> <span class="o">=</span> <span class="mi">60</span><span class="p">;</span>
  <span class="k">constexpr</span> <span class="kt">size_t</span> <span class="n">frame_elements</span> <span class="o">=</span> <span class="mi">1024</span><span class="p">;</span>
  <span class="k">constexpr</span> <span class="kt">size_t</span> <span class="n">frame_size</span> <span class="o">=</span> <span class="n">frame_elements</span> <span class="o">*</span> <span class="k">sizeof</span><span class="p">(</span><span class="kt">cl_int</span><span class="p">);</span>

  <span class="k">constexpr</span> <span class="kt">size_t</span> <span class="n">tile_count</span> <span class="o">=</span> <span class="mi">16</span><span class="p">;</span>
  <span class="k">constexpr</span> <span class="kt">size_t</span> <span class="n">tile_elements</span> <span class="o">=</span> <span class="n">frame_elements</span> <span class="o">/</span> <span class="n">tile_count</span><span class="p">;</span>
  <span class="k">constexpr</span> <span class="kt">size_t</span> <span class="n">tile_size</span> <span class="o">=</span> <span class="n">tile_elements</span> <span class="o">*</span> <span class="k">sizeof</span><span class="p">(</span><span class="kt">cl_int</span><span class="p">);</span>

  <span class="kt">cl_mem</span> <span class="n">buffer_tile1</span> <span class="o">=</span>
      <span class="n">clCreateBuffer</span><span class="p">(</span><span class="n">context</span><span class="p">,</span> <span class="n">CL_MEM_READ_ONLY</span><span class="p">,</span> <span class="n">tile_size</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">error</span><span class="p">);</span>
  <span class="n">CL_CHECK</span><span class="p">(</span><span class="n">error</span><span class="p">);</span>

  <span class="kt">cl_mem</span> <span class="n">buffer_tile2</span> <span class="o">=</span>
      <span class="n">clCreateBuffer</span><span class="p">(</span><span class="n">context</span><span class="p">,</span> <span class="n">CL_MEM_READ_ONLY</span><span class="p">,</span> <span class="n">tile_size</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">error</span><span class="p">);</span>
  <span class="n">CL_CHECK</span><span class="p">(</span><span class="n">error</span><span class="p">);</span>

  <span class="kt">cl_mem</span> <span class="n">buffer_res</span> <span class="o">=</span>
      <span class="n">clCreateBuffer</span><span class="p">(</span><span class="n">context</span><span class="p">,</span> <span class="n">CL_MEM_WRITE_ONLY</span><span class="p">,</span> <span class="n">tile_size</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">error</span><span class="p">);</span>
  <span class="n">CL_CHECK</span><span class="p">(</span><span class="n">error</span><span class="p">);</span>

  <span class="n">CL_CHECK</span><span class="p">(</span><span class="n">clSetKernelArg</span><span class="p">(</span><span class="n">kernel</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="k">sizeof</span><span class="p">(</span><span class="n">buffer_tile1</span><span class="p">),</span> <span class="o">&amp;</span><span class="n">buffer_tile1</span><span class="p">));</span>
  <span class="n">CL_CHECK</span><span class="p">(</span><span class="n">clSetKernelArg</span><span class="p">(</span><span class="n">kernel</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="k">sizeof</span><span class="p">(</span><span class="n">buffer_tile2</span><span class="p">),</span> <span class="o">&amp;</span><span class="n">buffer_tile2</span><span class="p">));</span>
  <span class="n">CL_CHECK</span><span class="p">(</span><span class="n">clSetKernelArg</span><span class="p">(</span><span class="n">kernel</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="k">sizeof</span><span class="p">(</span><span class="n">buffer_res</span><span class="p">),</span> <span class="o">&amp;</span><span class="n">buffer_res</span><span class="p">));</span>

  <span class="kt">cl_command_buffer_khr</span> <span class="n">original_cmdbuf</span> <span class="o">=</span>
      <span class="n">clCreateCommandBufferKHR</span><span class="p">(</span><span class="n">num_devices</span><span class="p">,</span> <span class="n">queues</span><span class="p">.</span><span class="n">data</span><span class="p">(),</span> <span class="nb">nullptr</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">error</span><span class="p">);</span>
  <span class="n">CL_CHECK</span><span class="p">(</span><span class="n">error</span><span class="p">);</span>

  <span class="kt">cl_mem</span> <span class="n">buffer_src1</span> <span class="o">=</span>
      <span class="n">clCreateBuffer</span><span class="p">(</span><span class="n">context</span><span class="p">,</span> <span class="n">CL_MEM_READ_ONLY</span><span class="p">,</span> <span class="n">frame_size</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">error</span><span class="p">);</span>
  <span class="n">CL_CHECK</span><span class="p">(</span><span class="n">error</span><span class="p">);</span>

  <span class="kt">cl_mem</span> <span class="n">buffer_src2</span> <span class="o">=</span>
      <span class="n">clCreateBuffer</span><span class="p">(</span><span class="n">context</span><span class="p">,</span> <span class="n">CL_MEM_READ_ONLY</span><span class="p">,</span> <span class="n">frame_size</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">error</span><span class="p">);</span>
  <span class="n">CL_CHECK</span><span class="p">(</span><span class="n">error</span><span class="p">);</span>

  <span class="kt">cl_mem</span> <span class="n">buffer_dst</span> <span class="o">=</span>
      <span class="n">clCreateBuffer</span><span class="p">(</span><span class="n">context</span><span class="p">,</span> <span class="n">CL_MEM_READ_WRITE</span><span class="p">,</span> <span class="n">frame_size</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">error</span><span class="p">);</span>
  <span class="n">CL_CHECK</span><span class="p">(</span><span class="n">error</span><span class="p">);</span>

  <span class="kt">cl_sync_point_khr</span> <span class="n">tile_sync_point</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
  <span class="k">for</span> <span class="p">(</span><span class="kt">size_t</span> <span class="n">tile_index</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">tile_index</span> <span class="o">&lt;</span> <span class="n">tile_count</span><span class="p">;</span> <span class="n">tile_index</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
    <span class="kt">cl_sync_point_khr</span> <span class="n">copy_sync_points</span><span class="p">[</span><span class="mi">2</span><span class="p">];</span>
    <span class="n">CL_CHECK</span><span class="p">(</span><span class="n">clCommandCopyBufferKHR</span><span class="p">(</span>
        <span class="n">original_cmdbuf</span><span class="p">,</span> <span class="n">queues</span><span class="p">[</span><span class="n">tile_index</span> <span class="o">%</span> <span class="n">num_devices</span><span class="p">],</span> <span class="n">buffer_src1</span><span class="p">,</span>
        <span class="n">buffer_tile1</span><span class="p">,</span> <span class="n">tile_index</span> <span class="o">*</span> <span class="n">tile_size</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">tile_size</span><span class="p">,</span>
        <span class="n">tile_sync_point</span> <span class="o">?</span> <span class="mi">1</span> <span class="o">:</span> <span class="mi">0</span><span class="p">,</span> <span class="n">tile_sync_point</span> <span class="o">?</span> <span class="o">&amp;</span><span class="n">tile_sync_point</span> <span class="o">:</span> <span class="nb">NULL</span><span class="p">,</span>
        <span class="o">&amp;</span><span class="n">copy_sync_points</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="nb">NULL</span><span class="p">));</span>

    <span class="n">CL_CHECK</span><span class="p">(</span><span class="n">clCommandCopyBufferKHR</span><span class="p">(</span>
                 <span class="n">original_cmdbuf</span><span class="p">,</span> <span class="n">queues</span><span class="p">[</span><span class="n">tile_index</span> <span class="o">%</span> <span class="n">num_devices</span><span class="p">],</span> <span class="n">buffer_src2</span><span class="p">,</span>
                 <span class="n">buffer_tile2</span><span class="p">,</span> <span class="n">tile_index</span> <span class="o">*</span> <span class="n">tile_size</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">tile_size</span><span class="p">,</span>
                 <span class="n">tile_sync_point</span> <span class="o">?</span> <span class="mi">1</span> <span class="o">:</span> <span class="mi">0</span><span class="p">,</span>
                 <span class="n">tile_sync_point</span> <span class="o">?</span> <span class="o">&amp;</span><span class="n">tile_sync_point</span> <span class="o">:</span> <span class="nb">nullptr</span><span class="p">,</span>
                 <span class="o">&amp;</span><span class="n">copy_sync_points</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="nb">NULL</span><span class="p">));</span>

    <span class="kt">cl_sync_point_khr</span> <span class="n">nd_sync_point</span><span class="p">;</span>
    <span class="n">CL_CHECK</span><span class="p">(</span><span class="n">clCommandNDRangeKernelKHR</span><span class="p">(</span>
        <span class="n">original_cmdbuf</span><span class="p">,</span> <span class="n">queues</span><span class="p">[</span><span class="n">tile_index</span> <span class="o">%</span> <span class="n">num_devices</span><span class="p">],</span> <span class="nb">NULL</span><span class="p">,</span> <span class="n">kernel</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span>
        <span class="nb">NULL</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">tile_elements</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">copy_sync_points</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">nd_sync_point</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">));</span>

    <span class="n">CL_CHECK</span><span class="p">(</span><span class="n">clCommandCopyBufferKHR</span><span class="p">(</span>
        <span class="n">original_cmdbuf</span><span class="p">,</span> <span class="n">queues</span><span class="p">[</span><span class="n">tile_index</span> <span class="o">%</span> <span class="n">num_devices</span><span class="p">],</span> <span class="n">buffer_res</span><span class="p">,</span>
        <span class="n">buffer_dst</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">tile_index</span> <span class="o">*</span> <span class="n">tile_size</span><span class="p">,</span> <span class="n">tile_size</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">nd_sync_point</span><span class="p">,</span>
        <span class="o">&amp;</span><span class="n">tile_sync_point</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">));</span>
  <span class="p">}</span>

  <span class="n">CL_CHECK</span><span class="p">(</span><span class="n">clFinalizeCommandBufferKHR</span><span class="p">(</span><span class="n">original_cmdbuf</span><span class="p">));</span>

  <span class="n">std</span><span class="o">::</span><span class="n">random_device</span> <span class="n">random_device</span><span class="p">;</span>
  <span class="n">std</span><span class="o">::</span><span class="n">mt19937</span> <span class="n">random_engine</span><span class="p">{</span><span class="n">random_device</span><span class="p">()};</span>
  <span class="n">std</span><span class="o">::</span><span class="n">uniform_int_distribution</span><span class="o">&lt;</span><span class="kt">cl_int</span><span class="o">&gt;</span> <span class="n">random_distribution</span><span class="p">{</span>
      <span class="mi">0</span><span class="p">,</span> <span class="n">std</span><span class="o">::</span><span class="n">numeric_limits</span><span class="o">&lt;</span><span class="kt">cl_int</span><span class="o">&gt;::</span><span class="n">max</span><span class="p">()</span> <span class="o">/</span> <span class="mi">2</span><span class="p">};</span>
  <span class="k">auto</span> <span class="n">random_generator</span> <span class="o">=</span> <span class="p">[</span><span class="o">&amp;</span><span class="p">]()</span> <span class="p">{</span> <span class="k">return</span> <span class="n">random_distribution</span><span class="p">(</span><span class="n">random_engine</span><span class="p">);</span> <span class="p">};</span>

  <span class="k">auto</span> <span class="n">enqueue_frame</span> <span class="o">=</span> <span class="p">[</span><span class="o">&amp;</span><span class="p">](</span><span class="kt">cl_command_buffer_khr</span> <span class="n">command_buffer</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">for</span> <span class="p">(</span><span class="kt">size_t</span> <span class="n">frame_index</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">frame_index</span> <span class="o">&lt;</span> <span class="n">frame_count</span><span class="p">;</span> <span class="n">frame_index</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
      <span class="n">std</span><span class="o">::</span><span class="n">array</span><span class="o">&lt;</span><span class="kt">cl_event</span><span class="p">,</span> <span class="mi">3</span><span class="o">&gt;</span> <span class="n">enqueue_events</span><span class="p">;</span>
      <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">cl_int</span><span class="o">&gt;</span> <span class="n">src1</span><span class="p">(</span><span class="n">frame_elements</span><span class="p">);</span>
      <span class="n">std</span><span class="o">::</span><span class="n">generate</span><span class="p">(</span><span class="n">src1</span><span class="p">.</span><span class="n">begin</span><span class="p">(),</span> <span class="n">src1</span><span class="p">.</span><span class="n">end</span><span class="p">(),</span> <span class="n">random_generator</span><span class="p">);</span>
      <span class="n">CL_CHECK</span><span class="p">(</span><span class="n">clEnqueueWriteBuffer</span><span class="p">(</span><span class="n">queues</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">buffer_src1</span><span class="p">,</span> <span class="n">CL_FALSE</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span>
                                    <span class="n">frame_size</span><span class="p">,</span> <span class="n">src1</span><span class="p">.</span><span class="n">data</span><span class="p">(),</span> <span class="mi">0</span><span class="p">,</span> <span class="nb">nullptr</span><span class="p">,</span>
                                    <span class="o">&amp;</span><span class="n">enqueue_events</span><span class="p">[</span><span class="mi">0</span><span class="p">]));</span>
      <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">cl_int</span><span class="o">&gt;</span> <span class="n">src2</span><span class="p">(</span><span class="n">frame_elements</span><span class="p">);</span>
      <span class="n">std</span><span class="o">::</span><span class="n">generate</span><span class="p">(</span><span class="n">src2</span><span class="p">.</span><span class="n">begin</span><span class="p">(),</span> <span class="n">src2</span><span class="p">.</span><span class="n">end</span><span class="p">(),</span> <span class="n">random_generator</span><span class="p">);</span>
      <span class="n">CL_CHECK</span><span class="p">(</span><span class="n">clEnqueueWriteBuffer</span><span class="p">(</span><span class="n">queues</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">buffer_src2</span><span class="p">,</span> <span class="n">CL_FALSE</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span>
                                    <span class="n">frame_size</span><span class="p">,</span> <span class="n">src2</span><span class="p">.</span><span class="n">data</span><span class="p">(),</span> <span class="mi">0</span><span class="p">,</span> <span class="nb">nullptr</span><span class="p">,</span>
                                    <span class="o">&amp;</span><span class="n">enqueue_events</span><span class="p">[</span><span class="mi">1</span><span class="p">]));</span>

      <span class="n">CL_CHECK</span><span class="p">(</span><span class="n">clEnqueueCommandBufferKHR</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">,</span> <span class="n">command_buffer</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span>
                                         <span class="n">enqueue_events</span><span class="p">.</span><span class="n">data</span><span class="p">(),</span>
                                         <span class="o">&amp;</span><span class="n">enqueue_events</span><span class="p">[</span><span class="mi">2</span><span class="p">]));</span>

      <span class="n">CL_CHECK</span><span class="p">(</span><span class="n">clWaitForEvents</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">enqueue_events</span><span class="p">[</span><span class="mi">2</span><span class="p">]));</span>

      <span class="k">for</span> <span class="p">(</span><span class="k">auto</span> <span class="n">e</span> <span class="o">:</span> <span class="n">enqueue_events</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">CL_CHECK</span><span class="p">(</span><span class="n">clReleaseEvent</span><span class="p">(</span><span class="n">e</span><span class="p">));</span>
      <span class="p">}</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
  <span class="p">};</span>

  <span class="n">error</span> <span class="o">=</span> <span class="n">enqueue_frame</span><span class="p">(</span><span class="n">original_cmdbuf</span><span class="p">);</span>
  <span class="n">CL_CHECK</span><span class="p">(</span><span class="n">error</span><span class="p">);</span>

  <span class="c1">// Remap from N queues to 1 queue and run again</span>
  <span class="kt">cl_command_buffer_khr</span> <span class="n">remapped_cmdbuf</span> <span class="o">=</span> <span class="n">clRemapCommandBufferKHR</span><span class="p">(</span>
      <span class="n">original_cmdbuf</span><span class="p">,</span> <span class="n">CL_TRUE</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">queues</span><span class="p">.</span><span class="n">data</span><span class="p">(),</span> <span class="mi">0</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">error</span><span class="p">);</span>
  <span class="n">CL_CHECK</span><span class="p">(</span><span class="n">error</span><span class="p">);</span>

  <span class="n">error</span> <span class="o">=</span> <span class="n">enqueue_frame</span><span class="p">(</span><span class="n">remapped_cmdbuf</span><span class="p">);</span>
  <span class="n">CL_CHECK</span><span class="p">(</span><span class="n">error</span><span class="p">);</span>

  <span class="k">for</span> <span class="p">(</span><span class="kt">unsigned</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">num_devices</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">CL_CHECK</span><span class="p">(</span><span class="n">clReleaseCommandQueue</span><span class="p">(</span><span class="n">queues</span><span class="p">[</span><span class="n">i</span><span class="p">]));</span>
  <span class="p">}</span>
  <span class="n">CL_CHECK</span><span class="p">(</span><span class="n">clReleaseMemObject</span><span class="p">(</span><span class="n">buffer_src1</span><span class="p">));</span>
  <span class="n">CL_CHECK</span><span class="p">(</span><span class="n">clReleaseMemObject</span><span class="p">(</span><span class="n">buffer_src2</span><span class="p">));</span>
  <span class="n">CL_CHECK</span><span class="p">(</span><span class="n">clReleaseMemObject</span><span class="p">(</span><span class="n">buffer_dst</span><span class="p">));</span>

  <span class="n">CL_CHECK</span><span class="p">(</span><span class="n">clReleaseMemObject</span><span class="p">(</span><span class="n">buffer_tile1</span><span class="p">));</span>
  <span class="n">CL_CHECK</span><span class="p">(</span><span class="n">clReleaseMemObject</span><span class="p">(</span><span class="n">buffer_tile2</span><span class="p">));</span>
  <span class="n">CL_CHECK</span><span class="p">(</span><span class="n">clReleaseMemObject</span><span class="p">(</span><span class="n">buffer_res</span><span class="p">));</span>

  <span class="n">CL_CHECK</span><span class="p">(</span><span class="n">clReleaseCommandBufferKHR</span><span class="p">(</span><span class="n">original_cmdbuf</span><span class="p">));</span>
  <span class="n">CL_CHECK</span><span class="p">(</span><span class="n">clReleaseCommandBufferKHR</span><span class="p">(</span><span class="n">remapped_cmdbuf</span><span class="p">));</span>

  <span class="n">CL_CHECK</span><span class="p">(</span><span class="n">clReleaseKernel</span><span class="p">(</span><span class="n">kernel</span><span class="p">));</span>
  <span class="n">CL_CHECK</span><span class="p">(</span><span class="n">clReleaseProgram</span><span class="p">(</span><span class="n">program</span><span class="p">));</span>
  <span class="n">CL_CHECK</span><span class="p">(</span><span class="n">clReleaseContext</span><span class="p">(</span><span class="n">context</span><span class="p">));</span>

  <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_issues_6"><a class="anchor" href="#_issues_6"></a>51.12. Issues</h3>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>In cl_event profiling info for a command-buffer running across the queues for
several devices, how do we know what the first &amp; last commands executed are
if there is concurrent execution across devices.</p>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p><strong>RESOLVED</strong>: Allowed an implementation to fallback to <code>CL_PROFILING_<wbr>COMMAND_<wbr>SUBMIT</code>
and <code>CL_PROFILING_<wbr>COMMAND_<wbr>COMPLETE</code> when reporting <code>CL_PROFILING_<wbr>COMMAND_<wbr>START</code> &amp;
<code>CL_PROFILING_<wbr>COMMAND_<wbr>END</code>.</p>
</div>
</div>
</div>
</li>
<li>
<p>Is an atomic constraint required? This would forbid regular clEnqueue* commands,
from interleaving execution on a queue which a command-buffer is being executed
on.</p>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p><strong>RESOLVED</strong>: This behavior can block parallelism, and constraint is expressible
by the user through existing synchronization mechanisms if they require it.</p>
</div>
</div>
</div>
</li>
<li>
<p>It is currently an error if a set of command-queues passed to
<strong>clEnqueueCommandBufferKHR</strong> aren&#8217;t compatible with those set on recording.
Should we relax this as an optional capability that allows an implementation to
do a more expensive command-buffer enqueue for this case?</p>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p><strong>RESOLVED</strong>: Added as an optional feature.</p>
</div>
</div>
</div>
</li>
</ol>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="spirv_extensions"><a class="anchor" href="#spirv_extensions"></a>52. Extensions to the OpenCL SPIR-V Environment</h2>
<div class="sectionbody">
<div class="paragraph">
<p>An OpenCL SPIR-V environment may be modified by OpenCL extensions.
Please refer to the OpenCL SPIR-V Environment Specification for descriptions how OpenCL extensions modify an OpenCL SPIR-V environment.
In addition to the extensions described in this document, the OpenCL SPIR-V Environment Specification also describes how the following OpenCL extensions modify an OpenCL SPIR-V environment:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>cl_khr_spirv_no_integer_wrap_decoration</code></p>
</li>
<li>
<p><code>cl_khr_spirv_extended_debug_info</code></p>
</li>
<li>
<p><code>cl_khr_spirv_linkonce_odr</code></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_extensions_promoted_to_core_features"><a class="anchor" href="#_extensions_promoted_to_core_features"></a>Appendix A: Extensions Promoted to Core Features</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_for_opencl_1_1"><a class="anchor" href="#_for_opencl_1_1"></a>A.1. For OpenCL 1.1:</h3>
<div class="ulist">
<ul>
<li>
<p>The functionality previously described by <strong>cl_khr_byte_addressable_store</strong> is now part of the core feature set.</p>
</li>
<li>
<p>The functionality previously described by <strong>cl_khr_global_int32_base_atomics</strong>, <strong>cl_khr_global_int32_extended_atomics</strong>, <strong>cl_khr_local_int32_base_atomics</strong>, and <strong>cl_khr_local_int32_extended_atomics</strong> is now part of the core feature set.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_for_opencl_1_2"><a class="anchor" href="#_for_opencl_1_2"></a>A.2. For OpenCL 1.2:</h3>
<div class="ulist">
<ul>
<li>
<p>The functionality previously described by <strong>cl_khr_fp64</strong> is now an optional core feature.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_for_opencl_2_0"><a class="anchor" href="#_for_opencl_2_0"></a>A.3. For OpenCL 2.0:</h3>
<div class="ulist">
<ul>
<li>
<p>The functionality described by <strong>cl_khr_3d_image_writes</strong> is part of the core feature set.</p>
</li>
<li>
<p>The functionality described by <strong>cl_khr_create_command_queue</strong> is part of the core feature set.</p>
</li>
<li>
<p>The functionality described by <strong>cl_khr_depth_images</strong> is now part of the core feature set.</p>
</li>
<li>
<p>The functionality described by <strong>cl_khr_image2d_from_buffer</strong> is now part of the core feature set.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_for_opencl_2_1"><a class="anchor" href="#_for_opencl_2_1"></a>A.4. For OpenCL 2.1:</h3>
<div class="ulist">
<ul>
<li>
<p>The functionality described by <strong>cl_khr_il_program</strong> is now part of the core feature set.</p>
</li>
<li>
<p>The API functionality described by <strong>cl_khr_subgroups</strong> is now part of the core API feature set, but the built-in functions described by <strong>cl_khr_subgroups</strong> must still be accessed as an extension to the OpenCL 2.0 C Language specification.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_for_opencl_3_0"><a class="anchor" href="#_for_opencl_3_0"></a>A.5. For OpenCL 3.0:</h3>
<div class="ulist">
<ul>
<li>
<p>The API functionality described by <strong>cl_khr_extended_versioning</strong> is now part of the core API feature set, with minor modifications.</p>
</li>
<li>
<p>The built-in functions described by <strong>cl_khr_subgroups</strong> are now supported in OpenCL C 3.0 when the <code>__opencl_c_subgroups</code> feature is supported.</p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_deprecated_extensions"><a class="anchor" href="#_deprecated_extensions"></a>Appendix B: Deprecated Extensions</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_for_opencl_1_1_2"><a class="anchor" href="#_for_opencl_1_1_2"></a>B.1. For OpenCL 1.1:</h3>
<div class="ulist">
<ul>
<li>
<p>The <strong>cl_khr_select_fprounding_mode</strong> extension has been deprecated.
Its use is no longer recommended.</p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_quick_reference"><a class="anchor" href="#_quick_reference"></a>Appendix C: Quick Reference</h2>
<div class="sectionbody">
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 45.4545%;">
<col style="width: 36.3636%;">
<col style="width: 18.1819%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><strong>Extension Name</strong></th>
<th class="tableblock halign-left valign-top"><strong>Brief Description</strong></th>
<th class="tableblock halign-left valign-top"><strong>Status</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#cl_khr_3d_image_writes">cl_khr_3d_image_writes</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Write to 3D images</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Core Feature in OpenCL 2.0</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#cl_khr_async_work_group_copy_fence">cl_khr_async_work_group_copy_fence</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Asynchronous Copy Fences</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Extension</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#cl_khr_byte_addressable_store">cl_khr_byte_addressable_store</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Read and write from 8-bit and 16-bit pointers</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Core Feature in OpenCL 1.1</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#cl_khr_command_buffer">cl_khr_command_buffer</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Record and Replay Commands</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Provisional Extension</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#cl_khr_command_buffer_multi_device">cl_khr_command_buffer_multi_device</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Allow a command-buffer to contain commands targeting different devices</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Provisional Extension</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#cl_khr_command_buffer_mutable_dispatch">cl_khr_command_buffer_mutable_dispatch</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Modify kernel execution commands between enqueues of a command-buffer</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Provisional Extension</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#cl_khr_create_command_queue">cl_khr_create_command_queue</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">API to Create Command Queues with Properties</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Core Feature in OpenCL 2.0</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#cl_khr_d3d10_sharing">cl_khr_d3d10_sharing</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Share Direct3D 10 Buffers and Textures with OpenCL</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Extension</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#cl_khr_d3d11_sharing">cl_khr_d3d11_sharing</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Share Direct3D 11 Buffers and Textures with OpenCL</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Extension</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#cl_khr_depth_images">cl_khr_depth_images</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Single Channel Depth Images</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Core Feature in OpenCL 2.0</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#cl_khr_device_enqueue_local_arg_types">cl_khr_device_enqueue_local_arg_types</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Pass Non-Void Local Pointers to Child Kernels</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Extension</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#cl_khr_device_uuid">cl_khr_device_uuid</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Unique Device and Driver Identifier Queries</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Extension</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#cl_khr_dx9_media_sharing">cl_khr_dx9_media_sharing</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Share DirectX 9 Media Surfaces with OpenCL</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Extension</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#cl_khr_egl_event">cl_khr_egl_event</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Share EGL Sync Objects with OpenCL</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Extension</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#cl_khr_egl_image">cl_khr_egl_image</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Share EGL Images with OpenCL</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Extension</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#cl_khr_extended_async_copies">cl_khr_extended_async_copies</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2D and 3D Async Copies</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Extension</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#cl_khr_extended_bit_ops">cl_khr_extended_bit_ops</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Bit Insert, Extract, and Reverse Operations</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Extension</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#cl_khr_extended_versioning">cl_khr_extended_versioning</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Extend versioning of platform, devices, extensions, etc.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Core Feature in OpenCL 3.0 (with minor changes)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#cl_khr_external_memory">cl_khr_external_memory</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Common Functionality for External Memory Sharing</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Provisional Extension</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#cl_khr_external_memory">cl_khr_external_memory_dma_buf</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">dma_buf External Memory Handles</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Provisional Extension</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#cl_khr_external_memory">cl_khr_external_memory_dx</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Direct3D 11 and 12 External Memory Handles</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Provisional Extension</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#cl_khr_external_memory">cl_khr_external_memory_opaque_fd</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Opaque File Descriptor External Memory Handles</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Provisional Extension</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#cl_khr_external_memory">cl_khr_external_memory_win32</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">NT Handle External Memory Handles</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Provisional Extension</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#cl_khr_expect_assume">cl_khr_expect_assume</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Kernel Optimization Hints</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Extension</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#cl_khr_external_semaphore">cl_khr_external_semaphore</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Common Functionality for External Semaphore Sharing</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Provisional Extension</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#cl_khr_external_semaphore">cl_khr_external_semaphore_dx_fence</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Direct3D 12 External Semaphore Handles</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Provisional Extension</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#cl_khr_external_semaphore">cl_khr_external_semaphore_opaque_fd</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Opaque File Descriptor External Semaphore Handles</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Provisional Extension</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#cl_khr_external_semaphore">cl_khr_external_semaphore_sync_fd</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Sync FD External Semaphore Handles</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Provisional Extension</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#cl_khr_external_semaphore">cl_khr_external_semaphore_win32</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">NT Handle External Semaphore Handles</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Provisional Extension</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#cl_khr_fp16">cl_khr_fp16</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Operations on 16-bit Floating-Point Values</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Extension</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#cl_khr_fp64">cl_khr_fp64</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Operations on 64-bit Floating-Point Values</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Optional Core Feature in OpenCL 1.2</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#cl_khr_gl_depth_images">cl_khr_gl_depth_images</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Share OpenGL Depth Images with OpenCL</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Extension</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#cl_khr_gl_event">cl_khr_gl_event</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Share OpenGL Fence Sync Objects with OpenCL</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Extension</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#cl_khr_gl_msaa_sharing">cl_khr_gl_msaa_sharing</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Share OpenGL MSAA Textures with OpenCL</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Extension</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#cl_khr_gl_sharing">cl_khr_gl_sharing</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Sharing OpenGL Buffers and Textures with OpenCL</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Extension</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#cl_khr_int32_atomics">cl_khr_global_int32_base_atomics</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Basic Atomic Operations on 32-bit Integers in Global Memory</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Core Feature in OpenCL 1.1</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#cl_khr_int32_atomics">cl_khr_global_int32_extended_atomics</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Extended Atomic Operations on 32-bit Integers in Global Memory</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Core Feature in OpenCL 1.1</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#cl_khr_icd-opencl">cl_khr_icd</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Installable Client Drivers</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Extension</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#cl_khr_il_program">cl_khr_il_program</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Support for Intermediate Language (IL) Programs (SPIR-V)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Core Feature in OpenCL 2.1</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#cl_khr_image2d_from_buffer">cl_khr_image2d_from_buffer</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Create 2D Images from Buffers</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Core Feature in OpenCL 2.0</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#cl_khr_initialize_memory">cl_khr_initialize_memory</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Initialize Local and Private Memory on Allocation</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Extension</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#cl_khr_int64_atomics">cl_khr_int64_base_atomics</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Basic Atomic Operations on 64-bit Integers in Global and Local Memory</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Extension</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#cl_khr_int64_atomics">cl_khr_int64_extended_atomics</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Extended Atomic Operations on 64-bit Integers in Global and Local Memory</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Extension</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#cl_khr_int32_atomics">cl_khr_local_int32_base_atomics</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Basic Atomic Operations on 32-bit Integers in Local Memory</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Core Feature in OpenCL 1.1</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#cl_khr_int32_atomics">cl_khr_local_int32_extended_atomics</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Extended Atomic Operations on 32-bit Integers in Local Memory</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Core Feature in OpenCL 1.1</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#cl_khr_integer_dot_product">cl_khr_integer_dot_product</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Integer dot product operations</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Extension</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#cl_khr_mipmap_image">cl_khr_mipmap_image</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Create and Use Images with Mipmaps</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Extension</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#cl_khr_mipmap_image">cl_khr_mipmap_image_writes</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Write to Images with Mipmaps</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Extension</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#cl_khr_pci_bus_info">cl_khr_pci_bus_info</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Query PCI Bus Information for an OpenCL Device</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Extension</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#cl_khr_priority_hints">cl_khr_priority_hints</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Create Command Queues with Different Priorities</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Extension</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#cl_khr_select_fprounding_mode">cl_khr_select_fprounding_mode</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Set the Current Kernel Rounding Mode</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">DEPRECATED</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#cl_khr_semaphore">cl_khr_semaphore</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Semaphore Synchronization Primitives</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Provisional Extension</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#cl_khr_spir">cl_khr_spir</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Standard Portable Intermediate Representation Programs</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Extension, Superseded by IL Programs / SPIR-V</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#cl_khr_srgb_image_writes">cl_khr_srgb_image_writes</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Write to sRGB Images</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Extension</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#cl_khr_subgroups">cl_khr_subgroups</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Sub-Groupings of Work Items</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Core Feature in OpenCL 2.1 (with minor changes)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#cl_khr_subgroup_ballot">cl_khr_subgroup_ballot</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Exchange Ballots Among Sub-Groupings of Work Items</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Extension</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#cl_khr_subgroup_clustered_reduce">cl_khr_subgroup_clustered_reduce</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Clustered Reductions for Sub-Groupings of Work Items</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Extension</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#cl_khr_subgroup_extended_types">cl_khr_subgroup_extended_types</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Additional Type Support for Sub-Group Functions</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Extension</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#cl_khr_subgroup_named_barrier">cl_khr_subgroup_named_barrier</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Barriers for Subsets of a Work Group</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Extension</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#cl_khr_subgroup_non_uniform_arithmetic">cl_khr_subgroup_non_uniform_arithmetic</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Sub-Group Arithmetic Functions in Non-Uniform Control Flow</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Extension</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#cl_khr_subgroup_non_uniform_vote">cl_khr_subgroup_non_uniform_vote</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Hold Votes Among Sub-Groupings of Work Items</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Extension</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#cl_khr_subgroup_rotate">cl_khr_subgroup_rotate</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Rotation Among Sub-Groupings of Work Items</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Extension</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#cl_khr_subgroup_shuffle">cl_khr_subgroup_shuffle</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">General-Purpose Shuffles Among Sub-Groupings of Work Items</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Extension</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#cl_khr_subgroup_shuffle_relative">cl_khr_subgroup_shuffle_relative</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Relative Shuffles Among Sub-Groupings of Work Items</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Extension</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#cl_khr_suggested_local_work_size">cl_khr_suggested_local_work_size</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Query a Suggested Local Work Size</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Extension</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#cl_khr_terminate_context">cl_khr_terminate_context</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Terminate an OpenCL Context</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Extension</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#cl_khr_throttle_hints">cl_khr_throttle_hints</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Create Command Queues with Different Throttle Policies</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Extension</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#cl_khr_work_group_uniform_arithmetic">cl_khr_work_group_uniform_arithmetic</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Work Group Uniform Arithmetic</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Extension</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div id="footnotes" style="max-width: 100%;">
<hr>
<div class="footnote" id="_footnotedef_1">
<a href="#_footnoteref_1">1</a>. The reference count returned should be considered immediately stale. It is unsuitable for general use in applications. This feature is provided for identifying memory leaks.
</div>
<div class="footnote" id="_footnotedef_2">
<a href="#_footnoteref_2">2</a>. The reference count returned should be considered immediately stale. It is unsuitable for general use in applications. This feature is provided for identifying memory leaks.
</div>
</div>
<div id="footer" style="max-width: 100%;">
<div id="footer-text">
Version v3.0.14<br>
Last updated 2023-04-17 10:42:01 -0700
</div>
</div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/MathJax.js?config=TeX-MML-AM_HTMLorMML"></script>
</body>
</html>